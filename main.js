/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={850:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var r=i(81),n=i.n(r),s=i(645),o=i.n(s)()(n());o.push([e.id,'/**\n * Copyright (c) 2014 The xterm.js authors. All rights reserved.\n * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)\n * https://github.com/chjj/term.js\n * @license MIT\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * Originally forked from (with the author\'s permission):\n *   Fabrice Bellard\'s javascript vt100 for jslinux:\n *   http://bellard.org/jslinux/\n *   Copyright (c) 2011 Fabrice Bellard\n *   The original design remains. The terminal itself\n *   has been extended to include xterm CSI codes, among\n *   other features.\n */\n\n/**\n *  Default styles for xterm.js\n */\n\n.xterm {\n    position: relative;\n    user-select: none;\n    -ms-user-select: none;\n    -webkit-user-select: none;\n}\n\n.xterm.focus,\n.xterm:focus {\n    outline: none;\n}\n\n.xterm .xterm-helpers {\n    position: absolute;\n    top: 0;\n    /**\n     * The z-index of the helpers must be higher than the canvases in order for\n     * IMEs to appear on top.\n     */\n    z-index: 5;\n}\n\n.xterm .xterm-helper-textarea {\n    padding: 0;\n    border: 0;\n    margin: 0;\n    /* Move textarea out of the screen to the far left, so that the cursor is not visible */\n    position: absolute;\n    opacity: 0;\n    left: -9999em;\n    top: 0;\n    width: 0;\n    height: 0;\n    z-index: -5;\n    /** Prevent wrapping so the IME appears against the textarea at the correct position */\n    white-space: nowrap;\n    overflow: hidden;\n    resize: none;\n}\n\n.xterm .composition-view {\n    /* TODO: Composition position got messed up somewhere */\n    background: #000;\n    color: #FFF;\n    display: none;\n    position: absolute;\n    white-space: nowrap;\n    z-index: 1;\n}\n\n.xterm .composition-view.active {\n    display: block;\n}\n\n.xterm .xterm-viewport {\n    /* On OS X this is required in order for the scroll bar to appear fully opaque */\n    background-color: #000;\n    overflow-y: scroll;\n    cursor: default;\n    position: absolute;\n    right: 0;\n    left: 0;\n    top: 0;\n    bottom: 0;\n}\n\n.xterm .xterm-screen {\n    position: relative;\n}\n\n.xterm .xterm-screen canvas {\n    position: absolute;\n    left: 0;\n    top: 0;\n}\n\n.xterm .xterm-scroll-area {\n    visibility: hidden;\n}\n\n.xterm-char-measure-element {\n    display: inline-block;\n    visibility: hidden;\n    position: absolute;\n    top: 0;\n    left: -9999em;\n    line-height: normal;\n}\n\n.xterm {\n    cursor: text;\n}\n\n.xterm.enable-mouse-events {\n    /* When mouse events are enabled (eg. tmux), revert to the standard pointer cursor */\n    cursor: default;\n}\n\n.xterm.xterm-cursor-pointer {\n    cursor: pointer;\n}\n\n.xterm.column-select.focus {\n    /* Column selection mode */\n    cursor: crosshair;\n}\n\n.xterm .xterm-accessibility,\n.xterm .xterm-message {\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 10;\n    color: transparent;\n}\n\n.xterm .live-region {\n    position: absolute;\n    left: -9999px;\n    width: 1px;\n    height: 1px;\n    overflow: hidden;\n}\n\n.xterm-dim {\n    opacity: 0.5;\n}\n\n.xterm-underline {\n    text-decoration: underline;\n}\n\n.xterm-strikethrough {\n    text-decoration: line-through;\n}\n',""]);const a=o},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",r=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),r&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),r&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,r,n,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<e.length;h++){var c=[].concat(e[h]);r&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},963:(e,t,i)=>{var r,n,s;e.exports=(r=Math.floor,n=Math.abs,s=Math.pow,function e(t,i,r){function n(o,a){if(!i[o]){if(!t[o]){if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};t[o][0].call(h.exports,(function(e){return n(t[o][1][e]||e)}),h,h.exports,e,t,i,r)}return i[o].exports}for(var s=void 0,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(e,t,i){"use strict";function r(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function n(e){return o[63&e>>18]+o[63&e>>12]+o[63&e>>6]+o[63&e]}function s(e,t,i){for(var r,s=[],o=t;o<i;o+=3)r=(16711680&e[o]<<16)+(65280&e[o+1]<<8)+(255&e[o+2]),s.push(n(r));return s.join("")}i.byteLength=function(e){var t=r(e),i=t[0],n=t[1];return 3*(i+n)/4-n},i.toByteArray=function(e){var t,i,n=r(e),s=n[0],o=n[1],h=new l(function(e,t,i){return 3*(t+i)/4-i}(0,s,o)),c=0,u=0<o?s-4:s;for(i=0;i<u;i+=4)t=a[e.charCodeAt(i)]<<18|a[e.charCodeAt(i+1)]<<12|a[e.charCodeAt(i+2)]<<6|a[e.charCodeAt(i+3)],h[c++]=255&t>>16,h[c++]=255&t>>8,h[c++]=255&t;return 2===o&&(t=a[e.charCodeAt(i)]<<2|a[e.charCodeAt(i+1)]>>4,h[c++]=255&t),1===o&&(t=a[e.charCodeAt(i)]<<10|a[e.charCodeAt(i+1)]<<4|a[e.charCodeAt(i+2)]>>2,h[c++]=255&t>>8,h[c++]=255&t),h},i.fromByteArray=function(e){for(var t,i=e.length,r=i%3,n=[],a=16383,l=0,h=i-r;l<h;l+=a)n.push(s(e,l,l+a>h?h:l+a));return 1===r?(t=e[i-1],n.push(o[t>>2]+o[63&t<<4]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],n.push(o[t>>10]+o[63&t>>4]+o[63&t<<2]+"=")),n.join("")};for(var o=[],a=[],l="undefined"==typeof Uint8Array?Array:Uint8Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=h.length;c<u;++c)o[c]=h[c],a[h.charCodeAt(c)]=c;a[45]=62,a[95]=63},{}],2:[function(){},{}],3:[function(e,t,i){(function(){(function(){"use strict";var t=String.fromCharCode,r=Math.min;function n(e){if(2147483647<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=o.prototype,t}function o(e,t,i){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return a(e,t,i)}function a(e,t,i){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var i=0|f(e,t),r=n(i),s=r.write(e,t);return s!==i&&(r=r.slice(0,s)),r}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(H(e,ArrayBuffer)||e&&H(e.buffer,ArrayBuffer))return function(e,t,i){if(0>t||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i)).__proto__=o.prototype,r}(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,i);var s=function(e){if(o.isBuffer(e)){var t=0|u(e.length),i=n(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0===e.length?"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0:"number"!=typeof e.length||W(e.length)?n(0):c(e)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(0>e)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),n(0>e?0:0|u(e))}function c(e){for(var t=0>e.length?0:0|u(e.length),i=n(t),r=0;r<t;r+=1)i[r]=255&e[r];return i}function u(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||H(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return I(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return Q(e).length;default:if(n)return r?-1:I(e).length;t=(""+t).toLowerCase(),n=!0}}function d(e,t,i){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),0>=i)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,i);case"utf8":case"utf-8":return C(this,t,i);case"ascii":return x(this,t,i);case"latin1":case"binary":return E(this,t,i);case"base64":return S(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function p(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function g(e,t,i,r,n){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):2147483647<i?i=2147483647:-2147483648>i&&(i=-2147483648),W(i=+i)&&(i=n?0:e.length-1),0>i&&(i=e.length+i),i>=e.length){if(n)return-1;i=e.length-1}else if(0>i){if(!n)return-1;i=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:m(e,t,i,r,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):m(e,[t],i,r,n);throw new TypeError("val must be string, number or Buffer")}function m(e,t,i,r,n){function s(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var o,a=1,l=e.length,h=t.length;if(void 0!==r&&("ucs2"===(r=(r+"").toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(2>e.length||2>t.length)return-1;a=2,l/=2,h/=2,i/=2}if(n){var c=-1;for(o=i;o<l;o++)if(s(e,o)!==s(t,-1===c?0:o-c))-1!==c&&(o-=o-c),c=-1;else if(-1===c&&(c=o),o-c+1===h)return c*a}else for(i+h>l&&(i=l-h),o=i;0<=o;o--){for(var u=!0,f=0;f<h;f++)if(s(e,o+f)!==s(t,f)){u=!1;break}if(u)return o}return-1}function _(e,t,i,r){i=+i||0;var n=e.length-i;r?(r=+r)>n&&(r=n):r=n;var s=t.length;r>s/2&&(r=s/2);for(var o,a=0;a<r;++a){if(W(o=parseInt(t.substr(2*a,2),16)))return a;e[i+a]=o}return a}function v(e,t,i,r){return $(I(t,e.length-i),e,i,r)}function y(e,t,i,r){return $(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,r)}function b(e,t,i,r){return y(e,t,i,r)}function O(e,t,i,r){return $(Q(t),e,i,r)}function w(e,t,i,r){return $(function(e,t){for(var i,r,n,s=[],o=0;o<e.length&&!(0>(t-=2));++o)r=(i=e.charCodeAt(o))>>8,n=i%256,s.push(n),s.push(r);return s}(t,e.length-i),e,i,r)}function S(e,t,i){return 0===t&&i===e.length?N.fromByteArray(e):N.fromByteArray(e.slice(t,i))}function C(e,t,i){i=r(e.length,i);for(var n=[],s=t;s<i;){var o,a,l,h,c=e[s],u=null,f=239<c?4:223<c?3:191<c?2:1;s+f<=i&&(1===f?128>c&&(u=c):2===f?128==(192&(o=e[s+1]))&&127<(h=(31&c)<<6|63&o)&&(u=h):3===f?(o=e[s+1],a=e[s+2],128==(192&o)&&128==(192&a)&&2047<(h=(15&c)<<12|(63&o)<<6|63&a)&&(55296>h||57343<h)&&(u=h)):4===f&&(o=e[s+1],a=e[s+2],l=e[s+3],128==(192&o)&&128==(192&a)&&128==(192&l)&&65535<(h=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&l)&&1114112>h&&(u=h))),null===u?(u=65533,f=1):65535<u&&(u-=65536,n.push(55296|1023&u>>>10),u=56320|1023&u),n.push(u),s+=f}return k(n)}function k(e){var i=e.length;if(i<=4096)return t.apply(String,e);for(var r="",n=0;n<i;)r+=t.apply(String,e.slice(n,n+=4096));return r}function x(e,i,n){var s="";n=r(e.length,n);for(var o=i;o<n;++o)s+=t(127&e[o]);return s}function E(e,i,n){var s="";n=r(e.length,n);for(var o=i;o<n;++o)s+=t(e[o]);return s}function A(e,t,i){var r=e.length;(!t||0>t)&&(t=0),(!i||0>i||i>r)&&(i=r);for(var n="",s=t;s<i;++s)n+=B(e[s]);return n}function T(e,i,r){for(var n=e.slice(i,r),s="",o=0;o<n.length;o+=2)s+=t(n[o]+256*n[o+1]);return s}function P(e,t,i){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,i,r,n,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function R(e,t,i,r){if(i+r>e.length)throw new RangeError("Index out of range");if(0>i)throw new RangeError("Index out of range")}function M(e,t,i,r,n){return t=+t,i>>>=0,n||R(e,0,i,4),F.write(e,t,i,r,23,4),i+4}function D(e,t,i,r,n){return t=+t,i>>>=0,n||R(e,0,i,8),F.write(e,t,i,r,52,8),i+8}function B(e){return 16>e?"0"+e.toString(16):e.toString(16)}function I(e,t){t=t||1/0;for(var i,r=e.length,n=null,s=[],o=0;o<r;++o){if(55295<(i=e.charCodeAt(o))&&57344>i){if(!n){if(56319<i){-1<(t-=3)&&s.push(239,191,189);continue}if(o+1===r){-1<(t-=3)&&s.push(239,191,189);continue}n=i;continue}if(56320>i){-1<(t-=3)&&s.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&-1<(t-=3)&&s.push(239,191,189);if(n=null,128>i){if(0>(t-=1))break;s.push(i)}else if(2048>i){if(0>(t-=2))break;s.push(192|i>>6,128|63&i)}else if(65536>i){if(0>(t-=3))break;s.push(224|i>>12,128|63&i>>6,128|63&i)}else{if(!(1114112>i))throw new Error("Invalid code point");if(0>(t-=4))break;s.push(240|i>>18,128|63&i>>12,128|63&i>>6,128|63&i)}}return s}function Q(e){return N.toByteArray(function(e){if(2>(e=(e=e.split("=")[0]).trim().replace(j,"")).length)return"";for(;0!=e.length%4;)e+="=";return e}(e))}function $(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function H(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function W(e){return e!=e}var N=e("base64-js"),F=e("ieee754");i.Buffer=o,i.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},i.INSPECT_MAX_BYTES=50,i.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){return o.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){return o.isBuffer(this)?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(e,t,i){return a(e,t,i)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(e,t,i){return function(e,t,i){return l(e),0>=e||void 0===t?n(e):"string"==typeof i?n(e).fill(t,i):n(e).fill(t)}(e,t,i)},o.allocUnsafe=function(e){return h(e)},o.allocUnsafeSlow=function(e){return h(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(H(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),H(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,s=0,a=r(i,n);s<a;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0},o.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var r=o.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){var s=e[i];if(H(s,Uint8Array)&&(s=o.from(s)),!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,n),n+=s.length}return r},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):d.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},o.prototype.compare=function(e,t,i,n,s){if(H(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),0>t||i>e.length||0>n||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(this===e)return 0;for(var a=(s>>>=0)-(n>>>=0),l=(i>>>=0)-(t>>>=0),h=r(a,l),c=this.slice(n,s),u=e.slice(t,i),f=0;f<h;++f)if(c[f]!==u[f]){a=c[f],l=u[f];break}return a<l?-1:l<a?1:0},o.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},o.prototype.indexOf=function(e,t,i){return g(this,e,t,i,!0)},o.prototype.lastIndexOf=function(e,t,i){return g(this,e,t,i,!1)},o.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-t;if((void 0===i||i>n)&&(i=n),0<e.length&&(0>i||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return _(this,e,t,i);case"utf8":case"utf-8":return v(this,e,t,i);case"ascii":return y(this,e,t,i);case"latin1":case"binary":return b(this,e,t,i);case"base64":return O(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var i=this.length;0>(e=~~e)?0>(e+=i)&&(e=0):e>i&&(e=i),0>(t=void 0===t?i:~~t)?0>(t+=i)&&(t=0):t>i&&(t=i),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=o.prototype,r},o.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var r=this[e],n=1,s=0;++s<t&&(n*=256);)r+=this[e+s]*n;return r},o.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var r=this[e+--t],n=1;0<t&&(n*=256);)r+=this[e+--t]*n;return r},o.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r>=(n*=128)&&(r-=s(2,8*t)),r},o.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var r=t,n=1,o=this[e+--r];0<r&&(n*=256);)o+=this[e+--r]*n;return o>=(n*=128)&&(o-=s(2,8*t)),o},o.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),F.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),F.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),F.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),F.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||L(this,e,t,i,s(2,8*i)-1,0);var n=1,o=0;for(this[t]=255&e;++o<i&&(n*=256);)this[t+o]=255&e/n;return t+i},o.prototype.writeUIntBE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||L(this,e,t,i,s(2,8*i)-1,0);var n=i-1,o=1;for(this[t+n]=255&e;0<=--n&&(o*=256);)this[t+n]=255&e/o;return t+i},o.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var n=s(2,8*i-1);L(this,e,t,i,n-1,-n)}var o=0,a=1,l=0;for(this[t]=255&e;++o<i&&(a*=256);)0>e&&0===l&&0!==this[t+o-1]&&(l=1),this[t+o]=255&(e/a>>0)-l;return t+i},o.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var n=s(2,8*i-1);L(this,e,t,i,n-1,-n)}var o=i-1,a=1,l=0;for(this[t+o]=255&e;0<=--o&&(a*=256);)0>e&&0===l&&0!==this[t+o+1]&&(l=1),this[t+o]=255&(e/a>>0)-l;return t+i},o.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||L(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,i){return M(this,e,t,!0,i)},o.prototype.writeFloatBE=function(e,t,i){return M(this,e,t,!1,i)},o.prototype.writeDoubleLE=function(e,t,i){return D(this,e,t,!0,i)},o.prototype.writeDoubleBE=function(e,t,i){return D(this,e,t,!1,i)},o.prototype.copy=function(e,t,i,r){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),0<r&&r<i&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>i||i>=this.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var n=r-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,i,r);else if(this===e&&i<t&&t<r)for(var s=n-1;0<=s;--s)e[s+t]=this[s+i];else Uint8Array.prototype.set.call(e,this.subarray(i,r),t);return n},o.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var n=e.charCodeAt(0);("utf8"===r&&128>n||"latin1"===r)&&(e=n)}}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var s;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var a=o.isBuffer(e)?e:o.from(e,r),l=a.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=a[s%l]}return this};var j=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(e,t,i){(function(r){(function(){i.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;e.splice(1,0,i,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"===e||(r++,"%c"===e&&(n=r))})),e.splice(n,0,i)},i.save=function(e){try{e?i.storage.setItem("debug",e):i.storage.removeItem("debug")}catch(e){}},i.load=function(){let e;try{e=i.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},i.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},i.storage=function(){try{return localStorage}catch(e){}}(),i.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],i.log=console.debug||console.log||(()=>{}),t.exports=e("./common")(i);const{formatters:n}=t.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this)}).call(this,e("_process"))},{"./common":5,_process:12}],5:[function(e,t){t.exports=function(t){function i(e){function t(...e){if(!t.enabled)return;const r=t,s=+new Date,o=s-(n||s);r.diff=o,r.prev=n,r.curr=s,n=s,e[0]=i.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,n)=>{if("%%"===t)return"%";a++;const s=i.formatters[n];if("function"==typeof s){const i=e[a];t=s.call(r,i),e.splice(a,1),a--}return t})),i.formatArgs.call(r,e),(r.log||i.log).apply(r,e)}let n,s=null;return t.namespace=e,t.useColors=i.useColors(),t.color=i.selectColor(e),t.extend=r,t.destroy=i.destroy,Object.defineProperty(t,"enabled",{enumerable:!0,configurable:!1,get:()=>null===s?i.enabled(e):s,set:e=>{s=e}}),"function"==typeof i.init&&i.init(t),t}function r(e,t){const r=i(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){return e instanceof Error?e.stack||e.message:e},i.disable=function(){const e=[...i.names.map(s),...i.skips.map(s).map((e=>"-"+e))].join(",");return i.enable(""),e},i.enable=function(e){let t;i.save(e),i.names=[],i.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")))},i.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=i.skips.length;t<r;t++)if(i.skips[t].test(e))return!1;for(t=0,r=i.names.length;t<r;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=e("ms"),i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((e=>{i[e]=t[e]})),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return i.colors[n(t)%i.colors.length]},i.enable(i.load()),i}},{ms:11}],6:[function(e,t){"use strict";function i(e,t){for(const i in t)Object.defineProperty(e,i,{value:t[i],enumerable:!0,configurable:!0});return e}t.exports=function(e,t,r){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof t&&(r=t,t=""),t&&(r.code=t);try{return i(e,r)}catch(t){r.message=e.message,r.stack=e.stack;const n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(e)),i(new n,r)}}},{}],7:[function(e,t){"use strict";function i(){i.init.call(this)}function r(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function n(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function s(e,t,i,s){var o,a,l;if(r(i),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),a=e._events),l=a[t]),void 0===l)l=a[t]=i,++e._eventsCount;else if("function"==typeof l?l=a[t]=s?[i,l]:[l,i]:s?l.unshift(i):l.push(i),0<(o=n(e))&&l.length>o&&!l.warned){l.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=l.length,function(e){console&&console.warn&&console.warn(e)}(h)}return e}function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function a(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=o.bind(r);return n.listener=i,r.wrapFn=n,n}function l(e,t,i){var r=e._events;if(void 0===r)return[];var n=r[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):c(n,n.length)}function h(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function c(e,t){for(var i=Array(t),r=0;r<t;++r)i[r]=e[r];return i}function u(e,t,i,r){if("function"==typeof e.on)r.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(s){r.once&&e.removeEventListener(t,n),i(s)}))}}var f,d="object"==typeof Reflect?Reflect:null,p=d&&"function"==typeof d.apply?d.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};f=d&&"function"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var g=Number.isNaN||function(e){return e!=e};t.exports=i,t.exports.once=function(e,t){return new Promise((function(i,r){function n(i){e.removeListener(t,s),r(i)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",n),i([].slice.call(arguments))}u(e,t,s,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&u(e,"error",t,i)}(e,n,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var m=10;Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(e){if("number"!=typeof e||0>e||g(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");m=e}}),i.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||g(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return n(this)},i.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var s;if(0<t.length&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=n[e];if(void 0===a)return!1;if("function"==typeof a)p(a,this,t);else{var l=a.length,h=c(a,l);for(i=0;i<l;++i)p(h[i],this,t)}return!0},i.prototype.addListener=function(e,t){return s(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return s(this,e,t,!0)},i.prototype.once=function(e,t){return r(t),this.on(e,a(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return r(t),this.prependListener(e,a(this,e,t)),this},i.prototype.removeListener=function(e,t){var i,n,s,o,a;if(r(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(s=-1,o=i.length-1;0<=o;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(0>s)return this;0===s?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,s),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var n,s=Object.keys(i);for(r=0;r<s.length;++r)"removeListener"!==(n=s[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return l(this,e,!0)},i.prototype.rawListeners=function(e){return l(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return 0<this._eventsCount?f(this._events):[]}},{}],8:[function(e,t){t.exports=function(){if("undefined"==typeof globalThis)return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},{}],9:[function(e,t,i){i.read=function(e,t,i,r,n){var o,a,l=8*n-r-1,h=(1<<l)-1,c=h>>1,u=-7,f=i?n-1:0,d=i?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-u)-1,p>>=-u,u+=l;0<u;o=256*o+e[t+f],f+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;0<u;a=256*a+e[t+f],f+=d,u-=8);if(0===o)o=1-c;else{if(o===h)return a?NaN:1/0*(p?-1:1);a+=s(2,r),o-=c}return(p?-1:1)*a*s(2,o-r)},i.write=function(e,t,i,o,a,l){var h,c,u,f=Math.LN2,d=Math.log,p=8*l-a-1,g=(1<<p)-1,m=g>>1,_=23===a?s(2,-24)-s(2,-77):0,v=o?0:l-1,y=o?1:-1,b=0>t||0===t&&0>1/t?1:0;for(t=n(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,h=g):(h=r(d(t)/f),1>t*(u=s(2,-h))&&(h--,u*=2),2<=(t+=1<=h+m?_/u:_*s(2,1-m))*u&&(h++,u/=2),h+m>=g?(c=0,h=g):1<=h+m?(c=(t*u-1)*s(2,a),h+=m):(c=t*s(2,m-1)*s(2,a),h=0));8<=a;e[i+v]=255&c,v+=y,c/=256,a-=8);for(h=h<<a|c,p+=a;0<p;e[i+v]=255&h,v+=y,h/=256,p-=8);e[i+v-y]|=128*b}},{}],10:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},{}],11:[function(e,t){var i=Math.round;function r(e){var t=n(e);return 864e5<=t?i(e/864e5)+"d":36e5<=t?i(e/36e5)+"h":6e4<=t?i(e/6e4)+"m":1e3<=t?i(e/1e3)+"s":e+"ms"}function s(e){var t=n(e);return 864e5<=t?o(e,t,864e5,"day"):36e5<=t?o(e,t,36e5,"hour"):6e4<=t?o(e,t,6e4,"minute"):1e3<=t?o(e,t,1e3,"second"):e+" ms"}function o(e,t,r,n){return i(e/r)+" "+n+(t>=1.5*r?"s":"")}t.exports=function(e,t){t=t||{};var i=typeof e;if("string"==i&&0<e.length)return function(e){if(!(100<(e+="").length)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();return"years"===r||"year"===r||"yrs"===r||"yr"===r||"y"===r?315576e5*i:"weeks"===r||"week"===r||"w"===r?6048e5*i:"days"===r||"day"===r||"d"===r?864e5*i:"hours"===r||"hour"===r||"hrs"===r||"hr"===r||"h"===r?36e5*i:"minutes"===r||"minute"===r||"mins"===r||"min"===r||"m"===r?6e4*i:"seconds"===r||"second"===r||"secs"===r||"sec"===r||"s"===r?1e3*i:"milliseconds"===r||"millisecond"===r||"msecs"===r||"msec"===r||"ms"===r?i:void 0}}}(e);if("number"===i&&isFinite(e))return t.long?s(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],12:[function(e,t){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function n(e){if(h===setTimeout)return setTimeout(e,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function s(){p&&f&&(p=!1,f.length?d=f.concat(d):g=-1,d.length&&o())}function o(){if(!p){var e=n(s);p=!0;for(var t=d.length;t;){for(f=d,d=[];++g<t;)f&&f[g].run();g=-1,t=d.length}f=null,p=!1,function(e){if(c===clearTimeout)return clearTimeout(e);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function l(){}var h,c,u=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:i}catch(e){h=i}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var f,d=[],p=!1,g=-1;u.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new a(e,t)),1!==d.length||p||n(o)},a.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=l,u.addListener=l,u.once=l,u.off=l,u.removeListener=l,u.removeAllListeners=l,u.emit=l,u.prependListener=l,u.prependOnceListener=l,u.listeners=function(){return[]},u.binding=function(){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],13:[function(e,t){(function(e){(function(){let i;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"==typeof window?e:window):e=>(i||(i=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))}).call(this)}).call(this,void 0===i.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i.g)},{}],14:[function(e,t){(function(i,r){(function(){"use strict";var n=e("safe-buffer").Buffer,s=r.crypto||r.msCrypto;t.exports=s&&s.getRandomValues?function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var r=n.allocUnsafe(e);if(0<e)if(65536<e)for(var o=0;o<e;o+=65536)s.getRandomValues(r.slice(o,o+65536));else s.getRandomValues(r);return"function"==typeof t?i.nextTick((function(){t(null,r)})):r}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,e("_process"),void 0===i.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i.g)},{_process:12,"safe-buffer":30}],15:[function(e,t){"use strict";function i(e,t,i){function r(e,i,r){return"string"==typeof t?t:t(e,i,r)}i||(i=Error);var s=function(e){function t(t,i,n){return e.call(this,r(t,i,n))||this}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e),t}(i);s.prototype.name=i.name,s.prototype.code=e,n[e]=s}function r(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return e+""})),2<i?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(e+"")}var n={};i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,i){var n,s;if("string"==typeof t&&function(e,t,i){return e.substr(!i||0>i?0:+i,t.length)===t}(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(r(t,"type"));else{var o=function(e,t,i){return"number"!=typeof i&&(i=0),!(i+t.length>e.length)&&-1!==e.indexOf(t,i)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(o," ").concat(n," ").concat(r(t,"type"))}return s+". Received type ".concat(typeof i)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],16:[function(e,t){(function(i){(function(){"use strict";function r(e){return this instanceof r?(a.call(this,e),l.call(this,e),this.allowHalfOpen=!0,void(e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",n))))):new r(e)}function n(){this._writableState.ended||i.nextTick(s,this)}function s(e){e.end()}var o=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};t.exports=r;var a=e("./_stream_readable"),l=e("./_stream_writable");e("inherits")(r,a);for(var h,c=o(l.prototype),u=0;u<c.length;u++)h=c[u],r.prototype[h]||(r.prototype[h]=l.prototype[h]);Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(e,t){"use strict";function i(e){return this instanceof i?void r.call(this,e):new i(e)}t.exports=i;var r=e("./_stream_transform");e("inherits")(i,r),i.prototype._transform=function(e,t,i){i(null,e)}},{"./_stream_transform":19,inherits:10}],18:[function(e,t){(function(i,r){(function(){"use strict";function n(t,i,r){w=w||e("./_stream_duplex"),t=t||{},"boolean"!=typeof r&&(r=i instanceof w),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=D(this,t,"readableHighWaterMark",r),this.buffer=new R,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(!T&&(T=e("string_decoder/").StringDecoder),this.decoder=new T(t.encoding),this.encoding=t.encoding)}function s(t){if(w=w||e("./_stream_duplex"),!(this instanceof s))return new s(t);var i=this instanceof w;this._readableState=new n(t,this,i),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),k.call(this)}function o(e,t,i,r,n){S("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(S("onEofChunk"),!t.ended){if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?c(e):(t.needReadable=!1,!t.emittedReadable&&(t.emittedReadable=!0,u(e)))}}(e,o);else if(n||(s=l(o,t)),s)W(e,s);else if(o.objectMode||t&&0<t.length)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===x.prototype||(t=function(e){return x.from(e)}(t)),r)o.endEmitted?W(e,new H):a(e,o,t,!0);else if(o.ended)W(e,new Q);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!i?(t=o.decoder.write(t),o.objectMode||0!==t.length?a(e,o,t,!1):f(e,o)):a(e,o,t,!1)}else r||(o.reading=!1,f(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function a(e,t,i,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&c(e)),f(e,t)}function l(e,t){var i;return function(e){return x.isBuffer(e)||e instanceof E}(t)||"string"==typeof t||void 0===t||e.objectMode||(i=new I("chunk",["string","Buffer","Uint8Array"],t)),i}function h(e,t){return 0>=e||0===t.length&&t.ended?0:t.objectMode?1:e==e?(e>t.highWaterMark&&(t.highWaterMark=function(e){return 1073741824<=e?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)):t.flowing&&t.length?t.buffer.head.data.length:t.length}function c(e){var t=e._readableState;S("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(S("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(u,e))}function u(e){var t=e._readableState;S("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,_(e)}function f(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(d,e,t))}function d(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(S("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function p(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function g(e){S("readable nexttick read 0"),e.read(0)}function m(e,t){S("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),_(e),t.flowing&&!t.reading&&e.read(0)}function _(e){var t=e._readableState;for(S("flow",t.flowing);t.flowing&&null!==e.read(););}function v(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function y(e){var t=e._readableState;S("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(b,t,e))}function b(e,t){if(S("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function O(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}var w;t.exports=s,s.ReadableState=n,e("events").EventEmitter;var S,C=function(e,t){return e.listeners(t).length},k=e("./internal/streams/stream"),x=e("buffer").Buffer,E=r.Uint8Array||function(){},A=e("util");S=A&&A.debuglog?A.debuglog("stream"):function(){};var T,P,L,R=e("./internal/streams/buffer_list"),M=e("./internal/streams/destroy"),D=e("./internal/streams/state").getHighWaterMark,B=e("../errors").codes,I=B.ERR_INVALID_ARG_TYPE,Q=B.ERR_STREAM_PUSH_AFTER_EOF,$=B.ERR_METHOD_NOT_IMPLEMENTED,H=B.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(s,k);var W=M.errorOrDestroy,N=["error","close","destroy","pause","resume"];Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),s.prototype.destroy=M.destroy,s.prototype._undestroy=M.undestroy,s.prototype._destroy=function(e,t){t(e)},s.prototype.push=function(e,t){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=x.from(e,t),t=""),i=!0),o(this,e,t,!1,i)},s.prototype.unshift=function(e){return o(this,e,null,!0,!1)},s.prototype.isPaused=function(){return!1===this._readableState.flowing},s.prototype.setEncoding=function(t){T||(T=e("string_decoder/").StringDecoder);var i=new T(t);this._readableState.decoder=i,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";null!==r;)n+=i.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this},s.prototype.read=function(e){S("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0===t.highWaterMark?0<t.length:t.length>=t.highWaterMark)||t.ended))return S("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?y(this):c(this),null;if(0===(e=h(e,t))&&t.ended)return 0===t.length&&y(this),null;var r,n=t.needReadable;return S("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&S("length less than watermark",n=!0),t.ended||t.reading?S("reading or ended",n=!1):n&&(S("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,!t.reading&&(e=h(i,t))),null===(r=0<e?v(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(!t.ended&&(t.needReadable=!0),i!==e&&t.ended&&y(this)),null!==r&&this.emit("data",r),r},s.prototype._read=function(){W(this,new $("_read()"))},s.prototype.pipe=function(e,t){function r(e,t){S("onunpipe"),e===u&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,s())}function n(){S("onend"),e.end()}function s(){S("cleanup"),e.removeListener("close",l),e.removeListener("finish",h),e.removeListener("drain",p),e.removeListener("error",a),e.removeListener("unpipe",r),u.removeListener("end",n),u.removeListener("end",c),u.removeListener("data",o),g=!0,f.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&p()}function o(t){S("ondata");var i=e.write(t);S("dest.write",i),!1===i&&((1===f.pipesCount&&f.pipes===e||1<f.pipesCount&&-1!==O(f.pipes,e))&&!g&&(S("false write response, pause",f.awaitDrain),f.awaitDrain++),u.pause())}function a(t){S("onerror",t),c(),e.removeListener("error",a),0===C(e,"error")&&W(e,t)}function l(){e.removeListener("finish",h),c()}function h(){S("onfinish"),e.removeListener("close",l),c()}function c(){S("unpipe"),u.unpipe(e)}var u=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,S("pipe count=%d opts=%j",f.pipesCount,t);var d=t&&!1===t.end||e===i.stdout||e===i.stderr?c:n;f.endEmitted?i.nextTick(d):u.once("end",d),e.on("unpipe",r);var p=function(e){return function(){var t=e._readableState;S("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&C(e,"data")&&(t.flowing=!0,_(e))}}(u);e.on("drain",p);var g=!1;return u.on("data",o),function(e,t,i){"function"==typeof e.prependListener?e.prependListener(t,i):e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",a),e.once("close",l),e.once("finish",h),e.emit("pipe",u),f.flowing||(S("pipe resume"),u.resume()),e},s.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<n;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=O(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},s.prototype.on=function(e,t){var r=k.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=0<this.listenerCount("readable"),!1!==n.flowing&&this.resume()):"readable"==e&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,S("on readable",n.length,n.reading),n.length?c(this):!n.reading&&i.nextTick(g,this)),r},s.prototype.addListener=s.prototype.on,s.prototype.removeListener=function(e,t){var r=k.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(p,this),r},s.prototype.removeAllListeners=function(e){var t=k.prototype.removeAllListeners.apply(this,arguments);return("readable"===e||void 0===e)&&i.nextTick(p,this),t},s.prototype.resume=function(){var e=this._readableState;return e.flowing||(S("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(m,e,t))}(this,e)),e.paused=!1,this},s.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},s.prototype.wrap=function(e){var t=this,i=this._readableState,r=!1;for(var n in e.on("end",(function(){if(S("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){S("wrapped data"),i.decoder&&(n=i.decoder.write(n)),i.objectMode&&null==n||!(i.objectMode||n&&n.length)||t.push(n)||(r=!0,e.pause())})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<N.length;s++)e.on(N[s],this.emit.bind(this,N[s]));return this._read=function(t){S("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(s.prototype[Symbol.asyncIterator]=function(){return void 0===P&&(P=e("./internal/streams/async_iterator")),P(this)}),Object.defineProperty(s.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(s.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(s.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),s._fromList=v,Object.defineProperty(s.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(s.from=function(t,i){return void 0===L&&(L=e("./internal/streams/from")),L(s,t,i)})}).call(this)}).call(this,e("_process"),void 0===i.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(e,t){"use strict";function i(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(null===r)return this.emit("error",new l);i.writechunk=null,i.writecb=null,null!=t&&this.push(t),r(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function r(e){return this instanceof r?(u.call(this,e),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),void this.on("prefinish",n)):new r(e)}function n(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?s(this,null,null):this._flush((function(t,i){s(e,t,i)}))}function s(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new c;if(e._transformState.transforming)throw new h;return e.push(null)}t.exports=r;var o=e("../errors").codes,a=o.ERR_METHOD_NOT_IMPLEMENTED,l=o.ERR_MULTIPLE_CALLBACK,h=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,c=o.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");e("inherits")(r,u),r.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},r.prototype._transform=function(e,t,i){i(new a("_transform()"))},r.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},r.prototype._read=function(){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},r.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(e,t){(function(i,r){(function(){"use strict";function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(i),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}function s(){}function o(t,i,r){b=b||e("./_stream_duplex"),t=t||{},"boolean"!=typeof r&&(r=i instanceof b),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=E(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===t.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){f(i,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function a(t){var i=this instanceof(b=b||e("./_stream_duplex"));return i||O.call(a,this)?(this._writableState=new o(t,this,i),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),void S.call(this)):new a(t)}function l(e,t){var r=new B;Q(e,r),i.nextTick(t,r)}function h(e,t,r,n){var s;return null===r?s=new D:"string"!=typeof r&&!t.objectMode&&(s=new T("chunk",["string","Buffer"],r)),!s||(Q(e,s),i.nextTick(n,s),!1)}function c(e,t,i,r,n,s){if(!i){var o=function(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=C.from(t,i)),t}(t,r,n);r!==o&&(i=!0,n="buffer",r=o)}var a=t.objectMode?1:r.length;t.length+=a;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var h=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:s,next:null},h?h.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else u(e,t,!1,a,r,n,s);return l}function u(e,t,i,r,n,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new M("write")):i?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function f(e,t){var r=e._writableState,n=r.sync,s=r.writecb;if("function"!=typeof s)throw new L;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,s){--t.pendingcb,r?(i.nextTick(s,n),i.nextTick(v,e,t),e._writableState.errorEmitted=!0,Q(e,n)):(s(n),e._writableState.errorEmitted=!0,Q(e,n),v(e,t))}(e,r,n,t,s);else{var o=g(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||p(e,r),n?i.nextTick(d,e,r,o,s):d(e,r,o,s)}}function d(e,t,i,r){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),v(e,t)}function p(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,s=Array(r),o=t.corkedRequestsFree;o.entry=i;for(var a=0,l=!0;i;)s[a]=i,i.isBuf||(l=!1),i=i.next,a+=1;s.allBuffers=l,u(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;i;){var h=i.chunk,c=i.encoding,f=i.callback;if(u(e,t,!1,t.objectMode?1:h.length,h,c,f),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function g(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function m(e,t){e._final((function(i){t.pendingcb--,i&&Q(e,i),t.prefinished=!0,e.emit("prefinish"),v(e,t)}))}function _(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(m,e,t)))}function v(e,t){var i=g(t);if(i&&(_(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return i}function y(e,t,r){t.ending=!0,v(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}var b;t.exports=a,a.WritableState=o;var O,w={deprecate:e("util-deprecate")},S=e("./internal/streams/stream"),C=e("buffer").Buffer,k=r.Uint8Array||function(){},x=e("./internal/streams/destroy"),E=e("./internal/streams/state").getHighWaterMark,A=e("../errors").codes,T=A.ERR_INVALID_ARG_TYPE,P=A.ERR_METHOD_NOT_IMPLEMENTED,L=A.ERR_MULTIPLE_CALLBACK,R=A.ERR_STREAM_CANNOT_PIPE,M=A.ERR_STREAM_DESTROYED,D=A.ERR_STREAM_NULL_VALUES,B=A.ERR_STREAM_WRITE_AFTER_END,I=A.ERR_UNKNOWN_ENCODING,Q=x.errorOrDestroy;e("inherits")(a,S),o.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(o.prototype,"buffer",{get:w.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(a,Symbol.hasInstance,{value:function(e){return!!O.call(this,e)||!(this!==a)&&e&&e._writableState instanceof o}})):O=function(e){return e instanceof this},a.prototype.pipe=function(){Q(this,new R)},a.prototype.write=function(e,t,i){var r=this._writableState,n=!1,o=!r.objectMode&&function(e){return C.isBuffer(e)||e instanceof k}(e);return o&&!C.isBuffer(e)&&(e=function(e){return C.from(e)}(e)),"function"==typeof t&&(i=t,t=null),o?t="buffer":!t&&(t=r.defaultEncoding),"function"!=typeof i&&(i=s),r.ending?l(this,i):(o||h(this,r,e,i))&&(r.pendingcb++,n=c(this,r,o,e,t,i)),n},a.prototype.cork=function(){this._writableState.corked++},a.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest&&p(this,e))},a.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new I(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),a.prototype._write=function(e,t,i){i(new P("_write()"))},a.prototype._writev=null,a.prototype.end=function(e,t,i){var r=this._writableState;return"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||y(this,r,i),this},Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),a.prototype.destroy=x.destroy,a.prototype._undestroy=x.undestroy,a.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),void 0===i.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(e,t){(function(i){(function(){"use strict";function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){return{value:e,done:t}}function s(e){var t=e[h];if(null!==t){var i=e[g].read();null!==i&&(e[d]=null,e[h]=null,e[c]=null,t(n(i,!1)))}}function o(e){i.nextTick(s,e)}var a,l=e("./end-of-stream"),h=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),f=Symbol("ended"),d=Symbol("lastPromise"),p=Symbol("handlePromise"),g=Symbol("stream"),m=Object.getPrototypeOf((function(){})),_=Object.setPrototypeOf((a={get stream(){return this[g]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[f])return Promise.resolve(n(void 0,!0));if(this[g].destroyed)return new Promise((function(t,r){i.nextTick((function(){e[u]?r(e[u]):t(n(void 0,!0))}))}));var r,s=this[d];if(s)r=new Promise(function(e,t){return function(i,r){e.then((function(){return t[f]?void i(n(void 0,!0)):void t[p](i,r)}),r)}}(s,this));else{var o=this[g].read();if(null!==o)return Promise.resolve(n(o,!1));r=new Promise(this[p])}return this[d]=r,r}},r(a,Symbol.asyncIterator,(function(){return this})),r(a,"return",(function(){var e=this;return new Promise((function(t,i){e[g].destroy(null,(function(e){return e?void i(e):void t(n(void 0,!0))}))}))})),a),m);t.exports=function(e){var t,i=Object.create(_,(r(t={},g,{value:e,writable:!0}),r(t,h,{value:null,writable:!0}),r(t,c,{value:null,writable:!0}),r(t,u,{value:null,writable:!0}),r(t,f,{value:e._readableState.endEmitted,writable:!0}),r(t,p,{value:function(e,t){var r=i[g].read();r?(i[d]=null,i[h]=null,i[c]=null,e(n(r,!1))):(i[h]=e,i[c]=t)},writable:!0}),t));return i[d]=null,l(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=i[c];return null!==t&&(i[d]=null,i[h]=null,i[c]=null,t(e)),void(i[u]=e)}var r=i[h];null!==r&&(i[d]=null,i[h]=null,i[c]=null,r(n(void 0,!0))),i[f]=!0})),e.on("readable",o.bind(null,i)),i}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":24,_process:12}],22:[function(e,t){"use strict";function i(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){for(var i,r=0;r<t.length;r++)(i=t[r]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}function s(e,t,i){o.prototype.copy.call(e,t,i)}var o=e("buffer").Buffer,a=e("util").inspect,l=a&&a.custom||"inspect";t.exports=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.head=null,this.tail=null,this.length=0}return function(e,t,i){t&&n(e.prototype,t),i&&n(e,i)}(e,[{key:"push",value:function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t=o.allocUnsafe(e>>>0),i=this.head,r=0;i;)s(i.data,t,r),r+=i.data.length,i=i.next;return t}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,r=t.data;for(e-=r.length;t=t.next;){var n=t.data,s=e>n.length?n.length:e;if(r+=s===n.length?n:n.slice(0,e),0==(e-=s)){s===n.length?(++i,this.head=t.next?t.next:this.tail=null):(this.head=t,t.data=n.slice(s));break}++i}return this.length-=i,r}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),i=this.head,r=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var n=i.data,s=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,s),0==(e-=s)){s===n.length?(++r,this.head=i.next?i.next:this.tail=null):(this.head=i,i.data=n.slice(s));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return a(this,function(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?i(Object(t),!0).forEach((function(i){r(e,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}));return e}({},t,{depth:0,customInspect:!1}))}}]),e}()},{buffer:3,util:2}],23:[function(e,t){(function(e){(function(){"use strict";function i(e,t){n(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function n(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(s?s(t):t&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,e.nextTick(n,this,t)):e.nextTick(n,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(r,o):(o._writableState.errorEmitted=!0,e.nextTick(i,o,t)):e.nextTick(i,o,t):s?(e.nextTick(r,o),s(t)):e.nextTick(r,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,r=e._writableState;i&&i.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:12}],24:[function(e,t){"use strict";function i(){}var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;t.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];e.apply(this,r)}}}(s||i);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||c()},h=t._writableState&&t._writableState.finished,c=function(){a=!1,h=!0,o||s.call(t)},u=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,u=!0,a||s.call(t)},d=function(e){s.call(t,e)},p=function(){var e;return o&&!u?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):a&&!h?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},g=function(){t.req.on("finish",c)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",c),t.on("abort",p),t.req?g():t.on("request",g)):a&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",f),t.on("finish",c),!1!==n.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},{"../../../errors":15}],25:[function(e,t){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(e,t){"use strict";function i(e){if(e)throw e}function r(t,i,r,n){n=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(n);var s=!1;t.on("close",(function(){s=!0})),void 0===a&&(a=e("./end-of-stream")),a(t,{readable:i,writable:r},(function(e){return e?n(e):(s=!0,void n())}));var o=!1;return function(e){if(!s)return o?void 0:(o=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void n(e||new c("pipe")))}}function n(e){e()}function s(e,t){return e.pipe(t)}function o(e){return e.length&&"function"==typeof e[e.length-1]?e.pop():i}var a,l=e("../../../errors").codes,h=l.ERR_MISSING_ARGS,c=l.ERR_STREAM_DESTROYED;t.exports=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var a=o(t);if(Array.isArray(t[0])&&(t=t[0]),2>t.length)throw new h("streams");var l,c=t.map((function(e,i){var s=i<t.length-1;return r(e,s,0<i,(function(e){l||(l=e),e&&c.forEach(n),s||(c.forEach(n),a(l))}))}));return t.reduce(s)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(e,t){"use strict";var i=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,s){var o=function(e,t,i){return null==e.highWaterMark?t?e[i]:null:e.highWaterMark}(t,s,n);if(null!=o){if(!isFinite(o)||r(o)!==o||0>o)throw new i(s?n:"highWaterMark",o);return r(o)}return e.objectMode?16:16384}}},{"../../../errors":15}],28:[function(e,t){t.exports=e("events").EventEmitter},{events:7}],29:[function(e,t,i){(i=t.exports=e("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=e("./lib/_stream_writable.js"),i.Duplex=e("./lib/_stream_duplex.js"),i.Transform=e("./lib/_stream_transform.js"),i.PassThrough=e("./lib/_stream_passthrough.js"),i.finished=e("./lib/internal/streams/end-of-stream.js"),i.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(e,t,i){function r(e,t){for(var i in e)t[i]=e[i]}function n(e,t,i){return o(e,t,i)}var s=e("buffer"),o=s.Buffer;o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=s:(r(s,i),i.Buffer=n),n.prototype=Object.create(o.prototype),r(o,n),n.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,i)},n.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=o(e);return void 0===t?r.fill(0):"string"==typeof i?r.fill(t,i):r.fill(t),r},n.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},n.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s.SlowBuffer(e)}},{buffer:3}],31:[function(e,t,i){"use strict";function r(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(f.isEncoding===d||!d(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=o,this.end=a,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=f.allocUnsafe(t)}function n(e){return 127>=e?0:6==e>>5?2:14==e>>4?3:30==e>>3?4:2==e>>6?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,i=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0===i?this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length)):i}function o(e,t){if(0==(e.length-t)%2){var i=e.toString("utf16le",t);if(i){var r=i.charCodeAt(i.length-1);if(55296<=r&&56319>=r)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function a(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function l(e,t){var i=(e.length-t)%3;return 0==i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1==i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function c(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}var f=e("safe-buffer").Buffer,d=f.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};i.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},r.prototype.text=function(e,t){var i=function(e,t,i){var r=t.length-1;if(r<i)return 0;var s=n(t[r]);return 0<=s?(0<s&&(e.lastNeed=s-1),s):--r<i||-2===s?0:0<=(s=n(t[r]))?(0<s&&(e.lastNeed=s-2),s):--r<i||-2===s?0:0<=(s=n(t[r]))?(0<s&&(2===s?s=0:e.lastNeed=s-3),s):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var r=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},r.prototype.fillLast=function(e){return this.lastNeed<=e.length?(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),void(this.lastNeed-=e.length))}},{"safe-buffer":30}],32:[function(e,t){(function(e){(function(){function i(t){try{if(!e.localStorage)return!1}catch(e){return!1}var i=e.localStorage[t];return null!=i&&"true"===(i+"").toLowerCase()}t.exports=function(e,t){if(i("noDeprecation"))return e;var r=!1;return function(){if(!r){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this)}).call(this,void 0===i.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i.g)},{}],"/":[function(e,t){function i(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}const r=e("debug")("simple-peer"),n=e("get-browser-rtc"),s=e("randombytes"),o=e("readable-stream"),a=e("queue-microtask"),l=e("err-code"),{Buffer:h}=e("buffer"),c=65536;class u extends o.Duplex{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=s(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||s(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||u.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},u.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:n(),!this._wrtc)throw"undefined"==typeof window?l(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):l(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(e){return void this.destroy(l(e,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch((e=>{this.destroy(l(e,"ERR_PC_PEER_IDENTITY"))})),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach((e=>{this.addStream(e)})),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then((()=>{this.destroyed||(this._pendingCandidates.forEach((e=>{this._addIceCandidate(e)})),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())})).catch((e=>{this.destroy(l(e,"ERR_SET_REMOTE_DESCRIPTION"))})),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(l(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch((e=>{!t.address||t.address.endsWith(".local")?function(e){console.warn(e)}("Ignoring unsupported ICE candidate."):this.destroy(l(e,"ERR_ADD_ICE_CANDIDATE"))}))}send(e){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,t){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(e){this.destroy(l(e,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach((t=>{this.addTrack(t,e)}))}}addTrack(e,t){if(this.destroying)return;if(this.destroyed)throw l(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const i=this._senderMap.get(e)||new Map;let r=i.get(t);if(r)throw r.removed?l(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):l(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");r=this._pc.addTrack(e,t),i.set(t,r),this._senderMap.set(e,i),this._needsNegotiation()}replaceTrack(e,t,i){if(this.destroying)return;if(this.destroyed)throw l(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(e),n=r?r.get(i):null;if(!n)throw l(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,r),null==n.replaceTrack?this.destroy(l(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):n.replaceTrack(t)}removeTrack(e,t){if(this.destroying)return;if(this.destroyed)throw l(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const i=this._senderMap.get(e),r=i?i.get(t):null;if(!r)throw l(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(r):this.destroy(l(e,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach((t=>{this.removeTrack(t,e)}))}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,a((()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1})))}negotiate(){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout((()=>{this._createOffer()}),0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,(()=>{}))}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),a((()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()})))}_setupData(e){if(!e.channel)return this.destroy(l(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=c),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{const t=e.error instanceof Error?e.error:new Error(`Datachannel error: ${e.message} ${e.filename}:${e.lineno}:${e.colno}`);this.destroy(l(t,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval((()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1}),5e3)}_read(){}_write(e,t,i){if(this.destroyed)return i(l(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(e){return this.destroy(l(e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>c?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(!this.destroyed){const e=()=>{setTimeout((()=>this.destroy()),1e3)};this._connected?e():this.once("connect",e)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout((()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))}),this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=i(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})}};this._pc.setLocalDescription(e).then((()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(l(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(l(e,"ERR_CREATE_OFFER"))}))}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach((e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))}))}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=i(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(e).then((()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(l(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(l(e,"ERR_CREATE_ANSWER"))}))}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(l(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),("connected"===e||"completed"===e)&&(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(l(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(l(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach((t=>{Object.assign(e,t)})),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then((i=>{const r=[];i.forEach((e=>{r.push(t(e))})),e(null,r)}),(t=>e(t))):0<this._pc.getStats.length?this._pc.getStats((i=>{if(this.destroyed)return;const r=[];i.result().forEach((e=>{const i={};e.names().forEach((t=>{i[t]=e.stat(t)})),i.id=e.id,i.type=e.type,i.timestamp=e.timestamp,r.push(t(i))})),e(null,r)}),(t=>e(t))):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats(((t,i)=>{if(this.destroyed)return;t&&(i=[]);const r={},n={},s={};let o=!1;i.forEach((e=>{("remotecandidate"===e.type||"remote-candidate"===e.type)&&(r[e.id]=e),("localcandidate"===e.type||"local-candidate"===e.type)&&(n[e.id]=e),("candidatepair"===e.type||"candidate-pair"===e.type)&&(s[e.id]=e)}));const a=e=>{o=!0;let t=n[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=+t.port):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=+t.portNumber):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=+t[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let i=r[e.remoteCandidateId];i&&(i.ip||i.address)?(this.remoteAddress=i.ip||i.address,this.remotePort=+i.port):i&&i.ipAddress?(this.remoteAddress=i.ipAddress,this.remotePort=+i.portNumber):"string"==typeof e.googRemoteAddress&&(i=e.googRemoteAddress.split(":"),this.remoteAddress=i[0],this.remotePort=+i[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach((e=>{"transport"===e.type&&e.selectedCandidatePairId&&a(s[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&a(e)})),o||Object.keys(s).length&&!Object.keys(n).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(e){return this.destroy(l(e,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval((()=>this._onInterval()),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)}))};e()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>c)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach((e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0})),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=h.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach((t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some((e=>e.id===t.id))||(this._remoteStreams.push(t),a((()=>{this._debug("on stream"),this.emit("stream",t)})))}))}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],r.apply(null,e)}}u.WEBRTC_SUPPORT=!!n(),u.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},u.channelConfig={},t.exports=u},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/"))},379:e=>{"use strict";var t=[];function i(e){for(var i=-1,r=0;r<t.length;r++)if(t[r].identifier===e){i=r;break}return i}function r(e,r){for(var s={},o=[],a=0;a<e.length;a++){var l=e[a],h=r.base?l[0]+r.base:l[0],c=s[h]||0,u="".concat(h," ").concat(c);s[h]=c+1;var f=i(u),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)t[f].references++,t[f].updater(d);else{var p=n(d,r);r.byIndex=a,t.splice(a,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function n(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var s=r(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var a=i(s[o]);t[a].references--}for(var l=r(e,n),h=0;h<s.length;h++){var c=i(s[h]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}s=l}}},569:e=>{"use strict";var t={};e.exports=function(e,i){var r=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(i)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var r="";i.supports&&(r+="@supports (".concat(i.supports,") {")),i.media&&(r+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(r+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),r+=i.css,n&&(r+="}"),i.media&&(r+="}"),i.supports&&(r+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},617:e=>{self,e.exports=(()=>{"use strict";var e={775:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0;var i=function(){function e(){}return e.prototype.activate=function(e){this._terminal=e},e.prototype.dispose=function(){},e.prototype.fit=function(){var e=this.proposeDimensions();if(e&&this._terminal){var t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}},e.prototype.proposeDimensions=function(){if(this._terminal&&this._terminal.element&&this._terminal.element.parentElement){var e=this._terminal._core;if(0!==e._renderService.dimensions.actualCellWidth&&0!==e._renderService.dimensions.actualCellHeight){var t=window.getComputedStyle(this._terminal.element.parentElement),i=parseInt(t.getPropertyValue("height")),r=Math.max(0,parseInt(t.getPropertyValue("width"))),n=window.getComputedStyle(this._terminal.element),s=i-(parseInt(n.getPropertyValue("padding-top"))+parseInt(n.getPropertyValue("padding-bottom"))),o=r-(parseInt(n.getPropertyValue("padding-right"))+parseInt(n.getPropertyValue("padding-left")))-e.viewport.scrollBarWidth;return{cols:Math.max(2,Math.floor(o/e._renderService.dimensions.actualCellWidth)),rows:Math.max(1,Math.floor(s/e._renderService.dimensions.actualCellHeight))}}}},e}();t.FitAddon=i}},t={};return function i(r){if(t[r])return t[r].exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}(775)})()},320:e=>{self,e.exports=(()=>{"use strict";var e={4567:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;var s=i(9042),o=i(6114),a=i(9924),l=i(3656),h=i(844),c=i(5596),u=i(9631),f=function(e){function t(t,i){var r=e.call(this)||this;r._terminal=t,r._renderService=i,r._liveRegionLineCount=0,r._charsToConsume=[],r._charsToAnnounce="",r._accessibilityTreeRoot=document.createElement("div"),r._accessibilityTreeRoot.setAttribute("role","document"),r._accessibilityTreeRoot.classList.add("xterm-accessibility"),r._rowContainer=document.createElement("div"),r._rowContainer.setAttribute("role","list"),r._rowContainer.classList.add("xterm-accessibility-tree"),r._rowElements=[];for(var n=0;n<r._terminal.rows;n++)r._rowElements[n]=r._createAccessibilityTreeNode(),r._rowContainer.appendChild(r._rowElements[n]);if(r._topBoundaryFocusListener=function(e){return r._onBoundaryFocus(e,0)},r._bottomBoundaryFocusListener=function(e){return r._onBoundaryFocus(e,1)},r._rowElements[0].addEventListener("focus",r._topBoundaryFocusListener),r._rowElements[r._rowElements.length-1].addEventListener("focus",r._bottomBoundaryFocusListener),r._refreshRowsDimensions(),r._accessibilityTreeRoot.appendChild(r._rowContainer),r._renderRowsDebouncer=new a.TimeBasedDebouncer(r._renderRows.bind(r)),r._refreshRows(),r._liveRegion=document.createElement("div"),r._liveRegion.classList.add("live-region"),r._liveRegion.setAttribute("aria-live","assertive"),r._accessibilityTreeRoot.appendChild(r._liveRegion),!r._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");return r._terminal.element.insertAdjacentElement("afterbegin",r._accessibilityTreeRoot),r.register(r._renderRowsDebouncer),r.register(r._terminal.onResize((function(e){return r._onResize(e.rows)}))),r.register(r._terminal.onRender((function(e){return r._refreshRows(e.start,e.end)}))),r.register(r._terminal.onScroll((function(){return r._refreshRows()}))),r.register(r._terminal.onA11yChar((function(e){return r._onChar(e)}))),r.register(r._terminal.onLineFeed((function(){return r._onChar("\n")}))),r.register(r._terminal.onA11yTab((function(e){return r._onTab(e)}))),r.register(r._terminal.onKey((function(e){return r._onKey(e.key)}))),r.register(r._terminal.onBlur((function(){return r._clearLiveRegion()}))),r.register(r._renderService.onDimensionsChange((function(){return r._refreshRowsDimensions()}))),r._screenDprMonitor=new c.ScreenDprMonitor,r.register(r._screenDprMonitor),r._screenDprMonitor.setListener((function(){return r._refreshRowsDimensions()})),r.register((0,l.addDisposableDomListener)(window,"resize",(function(){return r._refreshRowsDimensions()}))),r}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),(0,u.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0},t.prototype._onBoundaryFocus=function(e,t){var i=e.target,r=this._rowElements[0===t?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")!==(0===t?"1":""+this._terminal.buffer.lines.length)&&e.relatedTarget===r){var n,s;if(0===t?(n=i,s=this._rowElements.pop(),this._rowContainer.removeChild(s)):(n=this._rowElements.shift(),s=i,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),s.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){var o=this._createAccessibilityTreeNode();this._rowElements.unshift(o),this._rowContainer.insertAdjacentElement("afterbegin",o)}else o=this._createAccessibilityTreeNode(),this._rowElements.push(o),this._rowContainer.appendChild(o);this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}},t.prototype._onResize=function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},t.prototype._createAccessibilityTreeNode=function(){var e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e},t.prototype._onTab=function(e){for(var t=0;t<e;t++)this._onChar(" ")},t.prototype._onChar=function(e){var t=this;this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=s.tooMuchOutput)),o.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout((function(){t._accessibilityTreeRoot.appendChild(t._liveRegion)}),0))},t.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,o.isMac&&(0,u.removeElementFromParent)(this._liveRegion)},t.prototype._onKey=function(e){this._clearLiveRegion(),this._charsToConsume.push(e)},t.prototype._refreshRows=function(e,t){this._renderRowsDebouncer.refresh(e,t,this._terminal.rows)},t.prototype._renderRows=function(e,t){for(var i=this._terminal.buffer,r=i.lines.length.toString(),n=e;n<=t;n++){var s=i.translateBufferLineToString(i.ydisp+n,!0),o=(i.ydisp+n+1).toString(),a=this._rowElements[n];a&&(0===s.length?a.innerText="":a.textContent=s,a.setAttribute("aria-posinset",o),a.setAttribute("aria-setsize",r))}this._announceCharacters()},t.prototype._refreshRowsDimensions=function(){if(this._renderService.dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}},t.prototype._refreshRowDimensions=function(e){e.style.height=this._renderService.dimensions.actualCellHeight+"px"},t.prototype._announceCharacters=function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},t}(h.Disposable);t.AccessibilityManager=f},3614:(e,t)=>{function i(e){return e.replace(/\r?\n/g,"\r")}function r(e,t){return t?"[200~"+e+"[201~":e}function n(e,t,n){e=r(e=i(e),n.decPrivateModes.bracketedPasteMode),n.triggerDataEvent(e,!0),t.value=""}function s(e,t,i){var r=i.getBoundingClientRect(),n=e.clientX-r.left-10,s=e.clientY-r.top-10;t.style.width="20px",t.style.height="20px",t.style.left=n+"px",t.style.top=s+"px",t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=i,t.bracketTextForPaste=r,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,i){e.stopPropagation(),e.clipboardData&&n(e.clipboardData.getData("text/plain"),t,i)},t.paste=n,t.moveTextAreaUnderMouseCursor=s,t.rightClickHandler=function(e,t,i,r,n){s(e,t,i),n&&r.rightClickSelect(e),t.value=r.selectionText,t.select()}},4774:(e,t)=>{var i,r,n,s;function o(e){var t=e.toString(16);return t.length<2?"0"+t:t}function a(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=void 0,function(e){e.toCss=function(e,t,i,r){return void 0!==r?"#"+o(e)+o(t)+o(i)+o(r):"#"+o(e)+o(t)+o(i)},e.toRgba=function(e,t,i,r){return void 0===r&&(r=255),(e<<24|t<<16|i<<8|r)>>>0}}(i=t.channels||(t.channels={})),(r=t.color||(t.color={})).blend=function(e,t){var r=(255&t.rgba)/255;if(1===r)return{css:t.css,rgba:t.rgba};var n=t.rgba>>24&255,s=t.rgba>>16&255,o=t.rgba>>8&255,a=e.rgba>>24&255,l=e.rgba>>16&255,h=e.rgba>>8&255,c=a+Math.round((n-a)*r),u=l+Math.round((s-l)*r),f=h+Math.round((o-h)*r);return{css:i.toCss(c,u,f),rgba:i.toRgba(c,u,f)}},r.isOpaque=function(e){return 255==(255&e.rgba)},r.ensureContrastRatio=function(e,t,i){var r=s.ensureContrastRatio(e.rgba,t.rgba,i);if(r)return s.toColor(r>>24&255,r>>16&255,r>>8&255)},r.opaque=function(e){var t=(255|e.rgba)>>>0,r=s.toChannels(t),n=r[0],o=r[1],a=r[2];return{css:i.toCss(n,o,a),rgba:t}},r.opacity=function(e,t){var r=Math.round(255*t),n=s.toChannels(e.rgba),o=n[0],a=n[1],l=n[2];return{css:i.toCss(o,a,l,r),rgba:i.toRgba(o,a,l,r)}},(t.css||(t.css={})).toColor=function(e){switch(e.length){case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}throw new Error("css.toColor: Unsupported css format")},function(e){function t(e,t,i){var r=e/255,n=t/255,s=i/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(n=t.rgb||(t.rgb={})),function(e){function t(e,t,i){for(var r=e>>24&255,s=e>>16&255,o=e>>8&255,l=t>>24&255,h=t>>16&255,c=t>>8&255,u=a(n.relativeLuminance2(l,c,h),n.relativeLuminance2(r,s,o));u<i&&(l>0||h>0||c>0);)l-=Math.max(0,Math.ceil(.1*l)),h-=Math.max(0,Math.ceil(.1*h)),c-=Math.max(0,Math.ceil(.1*c)),u=a(n.relativeLuminance2(l,c,h),n.relativeLuminance2(r,s,o));return(l<<24|h<<16|c<<8|255)>>>0}function r(e,t,i){for(var r=e>>24&255,s=e>>16&255,o=e>>8&255,l=t>>24&255,h=t>>16&255,c=t>>8&255,u=a(n.relativeLuminance2(l,c,h),n.relativeLuminance2(r,s,o));u<i&&(l<255||h<255||c<255);)l=Math.min(255,l+Math.ceil(.1*(255-l))),h=Math.min(255,h+Math.ceil(.1*(255-h))),c=Math.min(255,c+Math.ceil(.1*(255-c))),u=a(n.relativeLuminance2(l,c,h),n.relativeLuminance2(r,s,o));return(l<<24|h<<16|c<<8|255)>>>0}e.ensureContrastRatio=function(e,i,s){var o=n.relativeLuminance(e>>8),l=n.relativeLuminance(i>>8);if(a(o,l)<s)return l<o?t(e,i,s):r(e,i,s)},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,r){return{css:i.toCss(e,t,r),rgba:i.toRgba(e,t,r)}}}(s=t.rgba||(t.rgba={})),t.toPaddedHex=o,t.contrastRatio=a},7239:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;var i=function(){function e(){this._color={},this._rgba={}}return e.prototype.clear=function(){this._color={},this._rgba={}},e.prototype.setCss=function(e,t,i){this._rgba[e]||(this._rgba[e]={}),this._rgba[e][t]=i},e.prototype.getCss=function(e,t){return this._rgba[e]?this._rgba[e][t]:void 0},e.prototype.setColor=function(e,t,i){this._color[e]||(this._color[e]={}),this._color[e][t]=i},e.prototype.getColor=function(e,t){return this._color[e]?this._color[e][t]:void 0},e}();t.ColorContrastCache=i},5680:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorManager=t.DEFAULT_ANSI_COLORS=void 0;var r=i(4774),n=i(7239),s=r.css.toColor("#ffffff"),o=r.css.toColor("#000000"),a=r.css.toColor("#ffffff"),l=r.css.toColor("#000000"),h={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var e=[r.css.toColor("#2e3436"),r.css.toColor("#cc0000"),r.css.toColor("#4e9a06"),r.css.toColor("#c4a000"),r.css.toColor("#3465a4"),r.css.toColor("#75507b"),r.css.toColor("#06989a"),r.css.toColor("#d3d7cf"),r.css.toColor("#555753"),r.css.toColor("#ef2929"),r.css.toColor("#8ae234"),r.css.toColor("#fce94f"),r.css.toColor("#729fcf"),r.css.toColor("#ad7fa8"),r.css.toColor("#34e2e2"),r.css.toColor("#eeeeec")],t=[0,95,135,175,215,255],i=0;i<216;i++){var n=t[i/36%6|0],s=t[i/6%6|0],o=t[i%6];e.push({css:r.channels.toCss(n,s,o),rgba:r.channels.toRgba(n,s,o)})}for(i=0;i<24;i++){var a=8+10*i;e.push({css:r.channels.toCss(a,a,a),rgba:r.channels.toRgba(a,a,a)})}return e}());var c=function(){function e(e,i){this.allowTransparency=i;var c=e.createElement("canvas");c.width=1,c.height=1;var u=c.getContext("2d");if(!u)throw new Error("Could not get rendering context");this._ctx=u,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this._contrastCache=new n.ColorContrastCache,this.colors={foreground:s,background:o,cursor:a,cursorAccent:l,selectionTransparent:h,selectionOpaque:r.color.blend(o,h),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache}}return e.prototype.onOptionsChange=function(e){"minimumContrastRatio"===e&&this._contrastCache.clear()},e.prototype.setTheme=function(e){void 0===e&&(e={}),this.colors.foreground=this._parseColor(e.foreground,s),this.colors.background=this._parseColor(e.background,o),this.colors.cursor=this._parseColor(e.cursor,a,!0),this.colors.cursorAccent=this._parseColor(e.cursorAccent,l,!0),this.colors.selectionTransparent=this._parseColor(e.selection,h,!0),this.colors.selectionOpaque=r.color.blend(this.colors.background,this.colors.selectionTransparent),r.color.isOpaque(this.colors.selectionTransparent)&&(this.colors.selectionTransparent=r.color.opacity(this.colors.selectionTransparent,.3)),this.colors.ansi[0]=this._parseColor(e.black,t.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(e.red,t.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(e.green,t.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(e.yellow,t.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(e.blue,t.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(e.magenta,t.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(e.cyan,t.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(e.white,t.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),this._contrastCache.clear()},e.prototype._parseColor=function(e,t,i){if(void 0===i&&(i=this.allowTransparency),void 0===e)return t;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=e,"string"!=typeof this._ctx.fillStyle)return console.warn("Color: "+e+" is invalid using fallback "+t.css),t;this._ctx.fillRect(0,0,1,1);var n=this._ctx.getImageData(0,0,1,1).data;if(255!==n[3]){if(!i)return console.warn("Color: "+e+" is using transparency, but allowTransparency is false. Using fallback "+t.css+"."),t;var s=this._ctx.fillStyle.substring(5,this._ctx.fillStyle.length-1).split(",").map((function(e){return Number(e)})),o=s[0],a=s[1],l=s[2],h=s[3],c=Math.round(255*h);return{rgba:r.channels.toRgba(o,a,l,c),css:e}}return{css:this._ctx.fillStyle,rgba:r.channels.toRgba(n[0],n[1],n[2],n[3])}},e}();t.ColorManager=c},9631:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeElementFromParent=void 0,t.removeElementFromParent=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var r=0,n=t;r<n.length;r++){var s=n[r];null===(e=null==s?void 0:s.parentElement)||void 0===e||e.removeChild(s)}}},3656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,r){e.addEventListener(t,i,r);var n=!1;return{dispose:function(){n||(n=!0,e.removeEventListener(t,i,r))}}}},3551:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseZone=t.Linkifier=void 0;var s=i(8460),o=i(2585),a=function(){function e(e,t,i){this._bufferService=e,this._logService=t,this._unicodeService=i,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onShowLinkUnderline=new s.EventEmitter,this._onHideLinkUnderline=new s.EventEmitter,this._onLinkTooltip=new s.EventEmitter,this._rowsToLinkify={start:void 0,end:void 0}}return Object.defineProperty(e.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!1,configurable:!0}),e.prototype.attachToDom=function(e,t){this._element=e,this._mouseZoneManager=t},e.prototype.linkifyRows=function(t,i){var r=this;this._mouseZoneManager&&(void 0===this._rowsToLinkify.start||void 0===this._rowsToLinkify.end?(this._rowsToLinkify.start=t,this._rowsToLinkify.end=i):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,t),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,i)),this._mouseZoneManager.clearAll(t,i),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout((function(){return r._linkifyRows()}),e._timeBeforeLatency))},e.prototype._linkifyRows=function(){this._rowsTimeoutId=void 0;var e=this._bufferService.buffer;if(void 0!==this._rowsToLinkify.start&&void 0!==this._rowsToLinkify.end){var t=e.ydisp+this._rowsToLinkify.start;if(!(t>=e.lines.length)){for(var i=e.ydisp+Math.min(this._rowsToLinkify.end,this._bufferService.rows)+1,r=Math.ceil(2e3/this._bufferService.cols),n=this._bufferService.buffer.iterator(!1,t,i,r,r);n.hasNext();)for(var s=n.next(),o=0;o<this._linkMatchers.length;o++)this._doLinkifyRow(s.range.first,s.content,this._linkMatchers[o]);this._rowsToLinkify.start=void 0,this._rowsToLinkify.end=void 0}}else this._logService.debug("_rowToLinkify was unset before _linkifyRows was called")},e.prototype.registerLinkMatcher=function(e,t,i){if(void 0===i&&(i={}),!t)throw new Error("handler must be defined");var r={id:this._nextLinkMatcherId++,regex:e,handler:t,matchIndex:i.matchIndex,validationCallback:i.validationCallback,hoverTooltipCallback:i.tooltipCallback,hoverLeaveCallback:i.leaveCallback,willLinkActivate:i.willLinkActivate,priority:i.priority||0};return this._addLinkMatcherToList(r),r.id},e.prototype._addLinkMatcherToList=function(e){if(0!==this._linkMatchers.length){for(var t=this._linkMatchers.length-1;t>=0;t--)if(e.priority<=this._linkMatchers[t].priority)return void this._linkMatchers.splice(t+1,0,e);this._linkMatchers.splice(0,0,e)}else this._linkMatchers.push(e)},e.prototype.deregisterLinkMatcher=function(e){for(var t=0;t<this._linkMatchers.length;t++)if(this._linkMatchers[t].id===e)return this._linkMatchers.splice(t,1),!0;return!1},e.prototype._doLinkifyRow=function(e,t,i){for(var r,n=this,s=new RegExp(i.regex.source,(i.regex.flags||"")+"g"),o=-1,a=function(){var a=r["number"!=typeof i.matchIndex?0:i.matchIndex];if(!a)return l._logService.debug("match found without corresponding matchIndex",r,i),"break";if(o=t.indexOf(a,o+1),s.lastIndex=o+a.length,o<0)return"break";var h=l._bufferService.buffer.stringIndexToBufferIndex(e,o);if(h[0]<0)return"break";var c=l._bufferService.buffer.lines.get(h[0]);if(!c)return"break";var u=c.getFg(h[1]),f=u?u>>9&511:void 0;i.validationCallback?i.validationCallback(a,(function(e){n._rowsTimeoutId||e&&n._addLink(h[1],h[0]-n._bufferService.buffer.ydisp,a,i,f)})):l._addLink(h[1],h[0]-l._bufferService.buffer.ydisp,a,i,f)},l=this;null!==(r=s.exec(t))&&"break"!==a(););},e.prototype._addLink=function(e,t,i,r,n){var s=this;if(this._mouseZoneManager&&this._element){var o=this._unicodeService.getStringCellWidth(i),a=e%this._bufferService.cols,h=t+Math.floor(e/this._bufferService.cols),c=(a+o)%this._bufferService.cols,u=h+Math.floor((a+o)/this._bufferService.cols);0===c&&(c=this._bufferService.cols,u--),this._mouseZoneManager.add(new l(a+1,h+1,c+1,u+1,(function(e){if(r.handler)return r.handler(e,i);var t=window.open();t?(t.opener=null,t.location.href=i):console.warn("Opening link blocked as opener could not be cleared")}),(function(){s._onShowLinkUnderline.fire(s._createLinkHoverEvent(a,h,c,u,n)),s._element.classList.add("xterm-cursor-pointer")}),(function(e){s._onLinkTooltip.fire(s._createLinkHoverEvent(a,h,c,u,n)),r.hoverTooltipCallback&&r.hoverTooltipCallback(e,i,{start:{x:a,y:h},end:{x:c,y:u}})}),(function(){s._onHideLinkUnderline.fire(s._createLinkHoverEvent(a,h,c,u,n)),s._element.classList.remove("xterm-cursor-pointer"),r.hoverLeaveCallback&&r.hoverLeaveCallback()}),(function(e){return!r.willLinkActivate||r.willLinkActivate(e,i)})))}},e.prototype._createLinkHoverEvent=function(e,t,i,r,n){return{x1:e,y1:t,x2:i,y2:r,cols:this._bufferService.cols,fg:n}},e._timeBeforeLatency=200,e=r([n(0,o.IBufferService),n(1,o.ILogService),n(2,o.IUnicodeService)],e)}();t.Linkifier=a;var l=function(e,t,i,r,n,s,o,a,l){this.x1=e,this.y1=t,this.x2=i,this.y2=r,this.clickCallback=n,this.hoverCallback=s,this.tooltipCallback=o,this.leaveCallback=a,this.willLinkActivate=l};t.MouseZone=l},6465:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;var a=i(2585),l=i(8460),h=i(844),c=i(3656),u=function(e){function t(t){var i=e.call(this)||this;return i._bufferService=t,i._linkProviders=[],i._linkCacheDisposables=[],i._isMouseOut=!0,i._activeLine=-1,i._onShowLinkUnderline=i.register(new l.EventEmitter),i._onHideLinkUnderline=i.register(new l.EventEmitter),i.register((0,h.getDisposeArrayDisposable)(i._linkCacheDisposables)),i}return n(t,e),Object.defineProperty(t.prototype,"currentLink",{get:function(){return this._currentLink},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),t.prototype.registerLinkProvider=function(e){var t=this;return this._linkProviders.push(e),{dispose:function(){var i=t._linkProviders.indexOf(e);-1!==i&&t._linkProviders.splice(i,1)}}},t.prototype.attachToDom=function(e,t,i){var r=this;this._element=e,this._mouseService=t,this._renderService=i,this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",(function(){r._isMouseOut=!0,r._clearCurrentLink()}))),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._onMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"click",this._onClick.bind(this)))},t.prototype._onMouseMove=function(e){if(this._lastMouseEvent=e,this._element&&this._mouseService){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(t){this._isMouseOut=!1;for(var i=e.composedPath(),r=0;r<i.length;r++){var n=i[r];if(n.classList.contains("xterm"))break;if(n.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._onHover(t),this._lastBufferCell=t)}}},t.prototype._onHover=function(e){if(this._activeLine!==e.y)return this._clearCurrentLink(),void this._askForLink(e,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))},t.prototype._askForLink=function(e,t){var i,r=this;this._activeProviderReplies&&t||(null===(i=this._activeProviderReplies)||void 0===i||i.forEach((function(e){null==e||e.forEach((function(e){e.link.dispose&&e.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=e.y);var n=!1;this._linkProviders.forEach((function(i,s){var o;t?(null===(o=r._activeProviderReplies)||void 0===o?void 0:o.get(s))&&(n=r._checkLinkProviderResult(s,e,n)):i.provideLinks(e.y,(function(t){var i,o;if(!r._isMouseOut){var a=null==t?void 0:t.map((function(e){return{link:e}}));null===(i=r._activeProviderReplies)||void 0===i||i.set(s,a),n=r._checkLinkProviderResult(s,e,n),(null===(o=r._activeProviderReplies)||void 0===o?void 0:o.size)===r._linkProviders.length&&r._removeIntersectingLinks(e.y,r._activeProviderReplies)}}))}))},t.prototype._removeIntersectingLinks=function(e,t){for(var i=new Set,r=0;r<t.size;r++){var n=t.get(r);if(n)for(var s=0;s<n.length;s++)for(var o=n[s],a=o.link.range.start.y<e?0:o.link.range.start.x,l=o.link.range.end.y>e?this._bufferService.cols:o.link.range.end.x,h=a;h<=l;h++){if(i.has(h)){n.splice(s--,1);break}i.add(h)}}},t.prototype._checkLinkProviderResult=function(e,t,i){var r,n=this;if(!this._activeProviderReplies)return i;for(var s=this._activeProviderReplies.get(e),o=!1,a=0;a<e;a++)this._activeProviderReplies.has(a)&&!this._activeProviderReplies.get(a)||(o=!0);if(!o&&s){var l=s.find((function(e){return n._linkAtPosition(e.link,t)}));l&&(i=!0,this._handleNewLink(l))}if(this._activeProviderReplies.size===this._linkProviders.length&&!i)for(a=0;a<this._activeProviderReplies.size;a++){var h=null===(r=this._activeProviderReplies.get(a))||void 0===r?void 0:r.find((function(e){return n._linkAtPosition(e.link,t)}));if(h){i=!0,this._handleNewLink(h);break}}return i},t.prototype._onClick=function(e){if(this._element&&this._mouseService&&this._currentLink){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}},t.prototype._clearCurrentLink=function(e,t){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,h.disposeArray)(this._linkCacheDisposables))},t.prototype._handleNewLink=function(e){var t=this;if(this._element&&this._lastMouseEvent&&this._mouseService){var i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(e.link,i)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:function(){var e,i;return null===(i=null===(e=t._currentLink)||void 0===e?void 0:e.state)||void 0===i?void 0:i.decorations.pointerCursor},set:function(e){var i,r;(null===(i=t._currentLink)||void 0===i?void 0:i.state)&&t._currentLink.state.decorations.pointerCursor!==e&&(t._currentLink.state.decorations.pointerCursor=e,t._currentLink.state.isHovered&&(null===(r=t._element)||void 0===r||r.classList.toggle("xterm-cursor-pointer",e)))}},underline:{get:function(){var e,i;return null===(i=null===(e=t._currentLink)||void 0===e?void 0:e.state)||void 0===i?void 0:i.decorations.underline},set:function(i){var r,n,s;(null===(r=t._currentLink)||void 0===r?void 0:r.state)&&(null===(s=null===(n=t._currentLink)||void 0===n?void 0:n.state)||void 0===s?void 0:s.decorations.underline)!==i&&(t._currentLink.state.decorations.underline=i,t._currentLink.state.isHovered&&t._fireUnderlineEvent(e.link,i))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedBufferChange((function(e){var i=0===e.start?0:e.start+1+t._bufferService.buffer.ydisp;t._clearCurrentLink(i,e.end+1+t._bufferService.buffer.ydisp)}))))}},t.prototype._linkHover=function(e,t,i){var r;(null===(r=this._currentLink)||void 0===r?void 0:r.state)&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)},t.prototype._fireUnderlineEvent=function(e,t){var i=e.range,r=this._bufferService.buffer.ydisp,n=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-r-1,i.end.x,i.end.y-r-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(n)},t.prototype._linkLeave=function(e,t,i){var r;(null===(r=this._currentLink)||void 0===r?void 0:r.state)&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)},t.prototype._linkAtPosition=function(e,t){var i=e.range.start.y===e.range.end.y,r=e.range.start.y<t.y,n=e.range.end.y>t.y;return(i&&e.range.start.x<=t.x&&e.range.end.x>=t.x||r&&e.range.end.x>=t.x||n&&e.range.start.x<=t.x||r&&n)&&e.range.start.y<=t.y&&e.range.end.y>=t.y},t.prototype._positionFromMouseEvent=function(e,t,i){var r=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}},t.prototype._createLinkUnderlineEvent=function(e,t,i,r,n){return{x1:e,y1:t,x2:i,y2:r,cols:this._bufferService.cols,fg:n}},s([o(0,a.IBufferService)],t)}(h.Disposable);t.Linkifier2=u},9042:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},6954:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseZoneManager=void 0;var a=i(844),l=i(3656),h=i(4725),c=i(2585),u=function(e){function t(t,i,r,n,s,o){var a=e.call(this)||this;return a._element=t,a._screenElement=i,a._bufferService=r,a._mouseService=n,a._selectionService=s,a._optionsService=o,a._zones=[],a._areZonesActive=!1,a._lastHoverCoords=[void 0,void 0],a._initialSelectionLength=0,a.register((0,l.addDisposableDomListener)(a._element,"mousedown",(function(e){return a._onMouseDown(e)}))),a._mouseMoveListener=function(e){return a._onMouseMove(e)},a._mouseLeaveListener=function(e){return a._onMouseLeave(e)},a._clickListener=function(e){return a._onClick(e)},a}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._deactivate()},t.prototype.add=function(e){this._zones.push(e),1===this._zones.length&&this._activate()},t.prototype.clearAll=function(e,t){if(0!==this._zones.length){e&&t||(e=0,t=this._bufferService.rows-1);for(var i=0;i<this._zones.length;i++){var r=this._zones[i];(r.y1>e&&r.y1<=t+1||r.y2>e&&r.y2<=t+1||r.y1<e&&r.y2>t+1)&&(this._currentZone&&this._currentZone===r&&(this._currentZone.leaveCallback(),this._currentZone=void 0),this._zones.splice(i--,1))}0===this._zones.length&&this._deactivate()}},t.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._element.addEventListener("mousemove",this._mouseMoveListener),this._element.addEventListener("mouseleave",this._mouseLeaveListener),this._element.addEventListener("click",this._clickListener))},t.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._element.removeEventListener("mousemove",this._mouseMoveListener),this._element.removeEventListener("mouseleave",this._mouseLeaveListener),this._element.removeEventListener("click",this._clickListener))},t.prototype._onMouseMove=function(e){this._lastHoverCoords[0]===e.pageX&&this._lastHoverCoords[1]===e.pageY||(this._onHover(e),this._lastHoverCoords=[e.pageX,e.pageY])},t.prototype._onHover=function(e){var t=this,i=this._findZoneEventAt(e);i!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),i&&(this._currentZone=i,i.hoverCallback&&i.hoverCallback(e),this._tooltipTimeout=window.setTimeout((function(){return t._onTooltip(e)}),this._optionsService.options.linkTooltipHoverDuration)))},t.prototype._onTooltip=function(e){this._tooltipTimeout=void 0;var t=this._findZoneEventAt(e);null==t||t.tooltipCallback(e)},t.prototype._onMouseDown=function(e){if(this._initialSelectionLength=this._getSelectionLength(),this._areZonesActive){var t=this._findZoneEventAt(e);(null==t?void 0:t.willLinkActivate(e))&&(e.preventDefault(),e.stopImmediatePropagation())}},t.prototype._onMouseLeave=function(e){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},t.prototype._onClick=function(e){var t=this._findZoneEventAt(e),i=this._getSelectionLength();t&&i===this._initialSelectionLength&&(t.clickCallback(e),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._getSelectionLength=function(){var e=this._selectionService.selectionText;return e?e.length:0},t.prototype._findZoneEventAt=function(e){var t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows);if(t)for(var i=t[0],r=t[1],n=0;n<this._zones.length;n++){var s=this._zones[n];if(s.y1===s.y2){if(r===s.y1&&i>=s.x1&&i<s.x2)return s}else if(r===s.y1&&i>=s.x1||r===s.y2&&i<s.x2||r>s.y1&&r<s.y2)return s}},s([o(2,c.IBufferService),o(3,h.IMouseService),o(4,h.ISelectionService),o(5,c.IOptionsService)],t)}(a.Disposable);t.MouseZoneManager=u},6193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0;var i=function(){function e(e){this._renderCallback=e}return e.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.refresh=function(e,t,i){var r=this;this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){return r._innerRefresh()})))},e.prototype._innerRefresh=function(){if(void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0,this._renderCallback(e,t)}},e}();t.RenderDebouncer=i},5596:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._currentDevicePixelRatio=window.devicePixelRatio,t}return n(t,e),t.prototype.setListener=function(e){var t=this;this._listener&&this.clearListener(),this._listener=e,this._outerListener=function(){t._listener&&(t._listener(window.devicePixelRatio,t._currentDevicePixelRatio),t._updateDpr())},this._updateDpr()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.clearListener()},t.prototype._updateDpr=function(){var e;this._outerListener&&(null===(e=this._resolutionMediaMatchList)||void 0===e||e.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},t.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},t}(i(844).Disposable);t.ScreenDprMonitor=s},3236:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var s=i(2950),o=i(1680),a=i(3614),l=i(2584),h=i(5435),c=i(3525),u=i(3551),f=i(9312),d=i(6114),p=i(3656),g=i(9042),m=i(357),_=i(6954),v=i(4567),y=i(1296),b=i(7399),O=i(8460),w=i(8437),S=i(5680),C=i(3230),k=i(4725),x=i(428),E=i(8934),A=i(6465),T=i(5114),P=i(8969),L=i(4774),R=i(4269),M="undefined"!=typeof window?window.document:null,D=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;return i.browser=d,i._keyDownHandled=!1,i._keyPressHandled=!1,i._unprocessedDeadKey=!1,i._onCursorMove=new O.EventEmitter,i._onKey=new O.EventEmitter,i._onRender=new O.EventEmitter,i._onSelectionChange=new O.EventEmitter,i._onTitleChange=new O.EventEmitter,i._onBell=new O.EventEmitter,i._onFocus=new O.EventEmitter,i._onBlur=new O.EventEmitter,i._onA11yCharEmitter=new O.EventEmitter,i._onA11yTabEmitter=new O.EventEmitter,i._setup(),i.linkifier=i._instantiationService.createInstance(u.Linkifier),i.linkifier2=i.register(i._instantiationService.createInstance(A.Linkifier2)),i.register(i._inputHandler.onRequestBell((function(){return i.bell()}))),i.register(i._inputHandler.onRequestRefreshRows((function(e,t){return i.refresh(e,t)}))),i.register(i._inputHandler.onRequestSendFocus((function(){return i._reportFocus()}))),i.register(i._inputHandler.onRequestReset((function(){return i.reset()}))),i.register(i._inputHandler.onRequestWindowsOptionsReport((function(e){return i._reportWindowsOptions(e)}))),i.register(i._inputHandler.onAnsiColorChange((function(e){return i._changeAnsiColor(e)}))),i.register((0,O.forwardEvent)(i._inputHandler.onCursorMove,i._onCursorMove)),i.register((0,O.forwardEvent)(i._inputHandler.onTitleChange,i._onTitleChange)),i.register((0,O.forwardEvent)(i._inputHandler.onA11yChar,i._onA11yCharEmitter)),i.register((0,O.forwardEvent)(i._inputHandler.onA11yTab,i._onA11yTabEmitter)),i.register(i._bufferService.onResize((function(e){return i._afterResize(e.cols,e.rows)}))),i}return n(t,e),Object.defineProperty(t.prototype,"options",{get:function(){return this.optionsService.options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBell",{get:function(){return this._onBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocus",{get:function(){return this._onFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBlur",{get:function(){return this._onBlur.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yChar",{get:function(){return this._onA11yCharEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yTab",{get:function(){return this._onA11yTabEmitter.event},enumerable:!1,configurable:!0}),t.prototype._changeAnsiColor=function(e){var t,i;if(this._colorManager){for(var r=0,n=e.colors;r<n.length;r++){var s=n[r],o=L.rgba.toColor(s.red,s.green,s.blue);this._colorManager.colors.ansi[s.colorIndex]=o}null===(t=this._renderService)||void 0===t||t.setColors(this._colorManager.colors),null===(i=this.viewport)||void 0===i||i.onThemeChange(this._colorManager.colors)}},t.prototype.dispose=function(){var t,i,r;this._isDisposed||(e.prototype.dispose.call(this),null===(t=this._renderService)||void 0===t||t.dispose(),this._customKeyEventHandler=void 0,this.write=function(){},null===(r=null===(i=this.element)||void 0===i?void 0:i.parentNode)||void 0===r||r.removeChild(this.element))},t.prototype._setup=function(){e.prototype._setup.call(this),this._customKeyEventHandler=void 0},Object.defineProperty(t.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),t.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},t.prototype._updateOptions=function(t){var i,r,n,s;switch(e.prototype._updateOptions.call(this,t),t){case"fontFamily":case"fontSize":null===(i=this._renderService)||void 0===i||i.clear(),null===(r=this._charSizeService)||void 0===r||r.measure();break;case"cursorBlink":case"cursorStyle":this.refresh(this.buffer.y,this.buffer.y);break;case"customGlyphs":case"drawBoldTextInBrightColors":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":case"minimumContrastRatio":this._renderService&&(this._renderService.clear(),this._renderService.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderService&&(this._renderService.setRenderer(this._createRenderer()),this._renderService.onResize(this.cols,this.rows));break;case"scrollback":null===(n=this.viewport)||void 0===n||n.syncScrollArea();break;case"screenReaderMode":this.optionsService.options.screenReaderMode?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new v.AccessibilityManager(this,this._renderService)):(null===(s=this._accessibilityManager)||void 0===s||s.dispose(),this._accessibilityManager=void 0);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"theme":this._setTheme(this.optionsService.options.theme)}},t.prototype._onTextAreaFocus=function(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(l.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()},t.prototype.blur=function(){var e;return null===(e=this.textarea)||void 0===e?void 0:e.blur()},t.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(l.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()},t.prototype._syncTextArea=function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(t){var i=Math.min(this.buffer.x,this.cols-1),r=this._renderService.dimensions.actualCellHeight,n=t.getWidth(i),s=this._renderService.dimensions.actualCellWidth*n,o=this.buffer.y*this._renderService.dimensions.actualCellHeight,a=i*this._renderService.dimensions.actualCellWidth;this.textarea.style.left=a+"px",this.textarea.style.top=o+"px",this.textarea.style.width=s+"px",this.textarea.style.height=r+"px",this.textarea.style.lineHeight=r+"px",this.textarea.style.zIndex="-5"}}},t.prototype._initGlobal=function(){var e=this;this._bindKeys(),this.register((0,p.addDisposableDomListener)(this.element,"copy",(function(t){e.hasSelection()&&(0,a.copyHandler)(t,e._selectionService)})));var t=function(t){return(0,a.handlePasteEvent)(t,e.textarea,e.coreService)};this.register((0,p.addDisposableDomListener)(this.textarea,"paste",t)),this.register((0,p.addDisposableDomListener)(this.element,"paste",t)),d.isFirefox?this.register((0,p.addDisposableDomListener)(this.element,"mousedown",(function(t){2===t.button&&(0,a.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)}))):this.register((0,p.addDisposableDomListener)(this.element,"contextmenu",(function(t){(0,a.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)}))),d.isLinux&&this.register((0,p.addDisposableDomListener)(this.element,"auxclick",(function(t){1===t.button&&(0,a.moveTextAreaUnderMouseCursor)(t,e.textarea,e.screenElement)})))},t.prototype._bindKeys=function(){var e=this;this.register((0,p.addDisposableDomListener)(this.textarea,"keyup",(function(t){return e._keyUp(t)}),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keydown",(function(t){return e._keyDown(t)}),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keypress",(function(t){return e._keyPress(t)}),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionstart",(function(){return e._compositionHelper.compositionstart()}))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionupdate",(function(t){return e._compositionHelper.compositionupdate(t)}))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionend",(function(){return e._compositionHelper.compositionend()}))),this.register((0,p.addDisposableDomListener)(this.textarea,"input",(function(t){return e._inputEvent(t)}),!0)),this.register(this.onRender((function(){return e._compositionHelper.updateCompositionElements()}))),this.register(this.onRender((function(t){return e._queueLinkification(t.start,t.end)})))},t.prototype.open=function(e){var t=this;if(!e)throw new Error("Terminal requires a parent element.");e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=e.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),e.appendChild(this.element);var i=M.createDocumentFragment();this._viewportElement=M.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),i.appendChild(this._viewportElement),this._viewportScrollArea=M.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=M.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=M.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),i.appendChild(this.screenElement),this.textarea=M.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",g.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register((0,p.addDisposableDomListener)(this.textarea,"focus",(function(e){return t._onTextAreaFocus(e)}))),this.register((0,p.addDisposableDomListener)(this.textarea,"blur",(function(){return t._onTextAreaBlur()}))),this._helperContainer.appendChild(this.textarea);var r=this._instantiationService.createInstance(T.CoreBrowserService,this.textarea);this._instantiationService.setService(k.ICoreBrowserService,r),this._charSizeService=this._instantiationService.createInstance(x.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._theme=this.options.theme||this._theme,this._colorManager=new S.ColorManager(M,this.options.allowTransparency),this.register(this.optionsService.onOptionChange((function(e){return t._colorManager.onOptionsChange(e)}))),this._colorManager.setTheme(this._theme),this._characterJoinerService=this._instantiationService.createInstance(R.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService);var n=this._createRenderer();this._renderService=this.register(this._instantiationService.createInstance(C.RenderService,n,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedBufferChange((function(e){return t._onRender.fire(e)}))),this.onResize((function(e){return t._renderService.resize(e.cols,e.rows)})),this._compositionView=M.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(s.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(i),this._soundService=this._instantiationService.createInstance(m.SoundService),this._instantiationService.setService(k.ISoundService,this._soundService),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(o.Viewport,(function(e){return t.scrollLines(e,!0,1)}),this._viewportElement,this._viewportScrollArea,this.element),this.viewport.onThemeChange(this._colorManager.colors),this.register(this._inputHandler.onRequestSyncScrollBar((function(){return t.viewport.syncScrollArea()}))),this.register(this.viewport),this.register(this.onCursorMove((function(){t._renderService.onCursorMove(),t._syncTextArea()}))),this.register(this.onResize((function(){return t._renderService.onResize(t.cols,t.rows)}))),this.register(this.onBlur((function(){return t._renderService.onBlur()}))),this.register(this.onFocus((function(){return t._renderService.onFocus()}))),this.register(this._renderService.onDimensionsChange((function(){return t.viewport.syncScrollArea()}))),this._selectionService=this.register(this._instantiationService.createInstance(f.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((function(e){return t.scrollLines(e.amount,e.suppressScrollEvent)}))),this.register(this._selectionService.onSelectionChange((function(){return t._onSelectionChange.fire()}))),this.register(this._selectionService.onRequestRedraw((function(e){return t._renderService.onSelectionChanged(e.start,e.end,e.columnSelectMode)}))),this.register(this._selectionService.onLinuxMouseSelection((function(e){t.textarea.value=e,t.textarea.focus(),t.textarea.select()}))),this.register(this._onScroll.event((function(e){t.viewport.syncScrollArea(),t._selectionService.refresh()}))),this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",(function(){return t._selectionService.refresh()}))),this._mouseZoneManager=this._instantiationService.createInstance(_.MouseZoneManager,this.element,this.screenElement),this.register(this._mouseZoneManager),this.register(this.onScroll((function(){return t._mouseZoneManager.clearAll()}))),this.linkifier.attachToDom(this.element,this._mouseZoneManager),this.linkifier2.attachToDom(this.element,this._mouseService,this._renderService),this.register((0,p.addDisposableDomListener)(this.element,"mousedown",(function(e){return t._selectionService.onMouseDown(e)}))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new v.AccessibilityManager(this,this._renderService)),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},t.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return this._instantiationService.createInstance(c.Renderer,this._colorManager.colors,this.screenElement,this.linkifier,this.linkifier2);case"dom":return this._instantiationService.createInstance(y.DomRenderer,this._colorManager.colors,this.element,this.screenElement,this._viewportElement,this.linkifier,this.linkifier2);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},t.prototype._setTheme=function(e){var t,i,r;this._theme=e,null===(t=this._colorManager)||void 0===t||t.setTheme(e),null===(i=this._renderService)||void 0===i||i.setColors(this._colorManager.colors),null===(r=this.viewport)||void 0===r||r.onThemeChange(this._colorManager.colors)},t.prototype.bindMouse=function(){var e=this,t=this,i=this.element;function r(e){var i,r,n=t._mouseService.getRawByteCoords(e,t.screenElement,t.cols,t.rows);if(!n)return!1;switch(e.overrideType||e.type){case"mousemove":r=32,void 0===e.buttons?(i=3,void 0!==e.button&&(i=e.button<3?e.button:3)):i=1&e.buttons?0:4&e.buttons?1:2&e.buttons?2:3;break;case"mouseup":r=0,i=e.button<3?e.button:3;break;case"mousedown":r=1,i=e.button<3?e.button:3;break;case"wheel":0!==e.deltaY&&(r=e.deltaY<0?0:1),i=4;break;default:return!1}return!(void 0===r||void 0===i||i>4)&&t.coreMouseService.triggerMouseEvent({col:n.x-33,row:n.y-33,button:i,action:r,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey})}var n={mouseup:null,wheel:null,mousedrag:null,mousemove:null},s=function(t){return r(t),t.buttons||(e._document.removeEventListener("mouseup",n.mouseup),n.mousedrag&&e._document.removeEventListener("mousemove",n.mousedrag)),e.cancel(t)},o=function(t){return r(t),e.cancel(t,!0)},a=function(e){e.buttons&&r(e)},h=function(e){e.buttons||r(e)};this.register(this.coreMouseService.onProtocolChange((function(t){t?("debug"===e.optionsService.options.logLevel&&e._logService.debug("Binding to mouse events:",e.coreMouseService.explainEvents(t)),e.element.classList.add("enable-mouse-events"),e._selectionService.disable()):(e._logService.debug("Unbinding from mouse events."),e.element.classList.remove("enable-mouse-events"),e._selectionService.enable()),8&t?n.mousemove||(i.addEventListener("mousemove",h),n.mousemove=h):(i.removeEventListener("mousemove",n.mousemove),n.mousemove=null),16&t?n.wheel||(i.addEventListener("wheel",o,{passive:!1}),n.wheel=o):(i.removeEventListener("wheel",n.wheel),n.wheel=null),2&t?n.mouseup||(n.mouseup=s):(e._document.removeEventListener("mouseup",n.mouseup),n.mouseup=null),4&t?n.mousedrag||(n.mousedrag=a):(e._document.removeEventListener("mousemove",n.mousedrag),n.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,p.addDisposableDomListener)(i,"mousedown",(function(t){if(t.preventDefault(),e.focus(),e.coreMouseService.areMouseEventsActive&&!e._selectionService.shouldForceSelection(t))return r(t),n.mouseup&&e._document.addEventListener("mouseup",n.mouseup),n.mousedrag&&e._document.addEventListener("mousemove",n.mousedrag),e.cancel(t)}))),this.register((0,p.addDisposableDomListener)(i,"wheel",(function(t){if(!n.wheel){if(!e.buffer.hasScrollback){var i=e.viewport.getLinesScrolled(t);if(0===i)return;for(var r=l.C0.ESC+(e.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(t.deltaY<0?"A":"B"),s="",o=0;o<Math.abs(i);o++)s+=r;return e.coreService.triggerDataEvent(s,!0),e.cancel(t,!0)}return e.viewport.onWheel(t)?void 0:e.cancel(t)}}),{passive:!1})),this.register((0,p.addDisposableDomListener)(i,"touchstart",(function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.onTouchStart(t),e.cancel(t)}),{passive:!0})),this.register((0,p.addDisposableDomListener)(i,"touchmove",(function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.onTouchMove(t)?void 0:e.cancel(t)}),{passive:!1}))},t.prototype.refresh=function(e,t){var i;null===(i=this._renderService)||void 0===i||i.refreshRows(e,t)},t.prototype._queueLinkification=function(e,t){var i;null===(i=this.linkifier)||void 0===i||i.linkifyRows(e,t)},t.prototype.updateCursorStyle=function(e){var t;(null===(t=this._selectionService)||void 0===t?void 0:t.shouldColumnSelect(e))?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},t.prototype._showCursor=function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))},t.prototype.scrollLines=function(t,i,r){void 0===r&&(r=0),e.prototype.scrollLines.call(this,t,i,r),this.refresh(0,this.rows-1)},t.prototype.paste=function(e){(0,a.paste)(e,this.textarea,this.coreService)},t.prototype.attachCustomKeyEventHandler=function(e){this._customKeyEventHandler=e},t.prototype.registerLinkMatcher=function(e,t,i){var r=this.linkifier.registerLinkMatcher(e,t,i);return this.refresh(0,this.rows-1),r},t.prototype.deregisterLinkMatcher=function(e){this.linkifier.deregisterLinkMatcher(e)&&this.refresh(0,this.rows-1)},t.prototype.registerLinkProvider=function(e){return this.linkifier2.registerLinkProvider(e)},t.prototype.registerCharacterJoiner=function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");var t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t},t.prototype.deregisterCharacterJoiner=function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)},Object.defineProperty(t.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!1,configurable:!0}),t.prototype.addMarker=function(e){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)},t.prototype.hasSelection=function(){return!!this._selectionService&&this._selectionService.hasSelection},t.prototype.select=function(e,t,i){this._selectionService.setSelection(e,t,i)},t.prototype.getSelection=function(){return this._selectionService?this._selectionService.selectionText:""},t.prototype.getSelectionPosition=function(){if(this._selectionService&&this._selectionService.hasSelection)return{startColumn:this._selectionService.selectionStart[0],startRow:this._selectionService.selectionStart[1],endColumn:this._selectionService.selectionEnd[0],endRow:this._selectionService.selectionEnd[1]}},t.prototype.clearSelection=function(){var e;null===(e=this._selectionService)||void 0===e||e.clearSelection()},t.prototype.selectAll=function(){var e;null===(e=this._selectionService)||void 0===e||e.selectAll()},t.prototype.selectLines=function(e,t){var i;null===(i=this._selectionService)||void 0===i||i.selectLines(e,t)},t.prototype._keyDown=function(e){if(this._keyDownHandled=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(!this._compositionHelper.keydown(e))return this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);var t=(0,b.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===t.type||2===t.type){var i=this.rows-1;return this.scrollLines(2===t.type?-i:i),this.cancel(e,!0)}return 1===t.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(t.cancel&&this.cancel(e,!0),!t.key||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(t.key!==l.C0.ETX&&t.key!==l.C0.CR||(this.textarea.value=""),this._onKey.fire({key:t.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t.key,!0),this.optionsService.options.screenReaderMode?void(this._keyDownHandled=!0):this.cancel(e,!0))))},t.prototype._isThirdLevelShift=function(e,t){var i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?i:i&&(!t.keyCode||t.keyCode>47)},t.prototype._keyUp=function(e){this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)},t.prototype._keyPress=function(e){var t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,0))},t.prototype._inputEvent=function(e){if(e.data&&"insertText"===e.inputType&&!this.optionsService.options.screenReaderMode){if(this._keyPressHandled)return!1;var t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1},t.prototype.bell=function(){var e;this._soundBell()&&(null===(e=this._soundService)||void 0===e||e.playBellSound()),this._onBell.fire()},t.prototype.resize=function(t,i){t!==this.cols||i!==this.rows?e.prototype.resize.call(this,t,i):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()},t.prototype._afterResize=function(e,t){var i,r;null===(i=this._charSizeService)||void 0===i||i.measure(),null===(r=this.viewport)||void 0===r||r.syncScrollArea(!0)},t.prototype.clear=function(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(w.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}},t.prototype.reset=function(){var t,i;this.options.rows=this.rows,this.options.cols=this.cols;var r=this._customKeyEventHandler;this._setup(),e.prototype.reset.call(this),null===(t=this._selectionService)||void 0===t||t.reset(),this._customKeyEventHandler=r,this.refresh(0,this.rows-1),null===(i=this.viewport)||void 0===i||i.syncScrollArea()},t.prototype.clearTextureAtlas=function(){var e;null===(e=this._renderService)||void 0===e||e.clearTextureAtlas()},t.prototype._reportFocus=function(){var e;(null===(e=this.element)||void 0===e?void 0:e.classList.contains("focus"))?this.coreService.triggerDataEvent(l.C0.ESC+"[I"):this.coreService.triggerDataEvent(l.C0.ESC+"[O")},t.prototype._reportWindowsOptions=function(e){if(this._renderService)switch(e){case h.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var t=this._renderService.dimensions.scaledCanvasWidth.toFixed(0),i=this._renderService.dimensions.scaledCanvasHeight.toFixed(0);this.coreService.triggerDataEvent(l.C0.ESC+"[4;"+i+";"+t+"t");break;case h.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var r=this._renderService.dimensions.scaledCellWidth.toFixed(0),n=this._renderService.dimensions.scaledCellHeight.toFixed(0);this.coreService.triggerDataEvent(l.C0.ESC+"[6;"+n+";"+r+"t")}},t.prototype.cancel=function(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1},t.prototype._visualBell=function(){return!1},t.prototype._soundBell=function(){return"sound"===this.options.bellStyle},t}(P.CoreTerminal);t.Terminal=D},9924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0;var i=function(){function e(e,t){void 0===t&&(t=1e3),this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return e.prototype.dispose=function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)},e.prototype.refresh=function(e,t,i){var r=this;this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;var n=Date.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){var s=n-this._lastRefreshMs,o=this._debounceThresholdMS-s;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((function(){r._lastRefreshMs=Date.now(),r._innerRefresh(),r._additionalRefreshRequested=!1,r._refreshTimeoutID=void 0}),o)}},e.prototype._innerRefresh=function(){if(void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}},e}();t.TimeBasedDebouncer=i},1680:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var a=i(844),l=i(3656),h=i(4725),c=i(2585),u=function(e){function t(t,i,r,n,s,o,a,h){var c=e.call(this)||this;return c._scrollLines=t,c._viewportElement=i,c._scrollArea=r,c._element=n,c._bufferService=s,c._optionsService=o,c._charSizeService=a,c._renderService=h,c.scrollBarWidth=0,c._currentRowHeight=0,c._currentScaledCellHeight=0,c._lastRecordedBufferLength=0,c._lastRecordedViewportHeight=0,c._lastRecordedBufferHeight=0,c._lastTouchY=0,c._lastScrollTop=0,c._lastHadScrollBar=!1,c._wheelPartialScroll=0,c._refreshAnimationFrame=null,c._ignoreNextScrollEvent=!1,c.scrollBarWidth=c._viewportElement.offsetWidth-c._scrollArea.offsetWidth||15,c._lastHadScrollBar=!0,c.register((0,l.addDisposableDomListener)(c._viewportElement,"scroll",c._onScroll.bind(c))),c._activeBuffer=c._bufferService.buffer,c.register(c._bufferService.buffers.onBufferActivate((function(e){return c._activeBuffer=e.activeBuffer}))),c._renderDimensions=c._renderService.dimensions,c.register(c._renderService.onDimensionsChange((function(e){return c._renderDimensions=e}))),setTimeout((function(){return c.syncScrollArea()}),0),c}return n(t,e),t.prototype.onThemeChange=function(e){this._viewportElement.style.backgroundColor=e.background.css},t.prototype._refresh=function(e){var t=this;if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=requestAnimationFrame((function(){return t._innerRefresh()})))},t.prototype._innerRefresh=function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.scaledCellHeight/window.devicePixelRatio,this._currentScaledCellHeight=this._renderService.dimensions.scaledCellHeight,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.canvasHeight);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),0===this._optionsService.options.scrollback?this.scrollBarWidth=0:this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this._lastHadScrollBar=this.scrollBarWidth>0;var i=window.getComputedStyle(this._element),r=parseInt(i.paddingLeft)+parseInt(i.paddingRight);this._viewportElement.style.width=(this._renderService.dimensions.actualCellWidth*this._bufferService.cols+this.scrollBarWidth+(this._lastHadScrollBar?r:0)).toString()+"px",this._refreshAnimationFrame=null},t.prototype.syncScrollArea=function(e){if(void 0===e&&(e=!1),this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.canvasHeight&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.scaledCellHeight===this._currentScaledCellHeight?this._lastHadScrollBar!==this._optionsService.options.scrollback>0&&this._refresh(e):this._refresh(e)},t.prototype._onScroll=function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);var t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(t)}},t.prototype._bubbleScroll=function(e,t){var i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&i<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)},t.prototype.onWheel=function(e){var t=this._getPixelsScrolled(e);return 0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))},t.prototype._getPixelsScrolled=function(e){if(0===e.deltaY)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t},t.prototype.getLinesScrolled=function(e){if(0===e.deltaY)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t},t.prototype._applyScrollModifier=function(e,t){var i=this._optionsService.options.fastScrollModifier;return"alt"===i&&t.altKey||"ctrl"===i&&t.ctrlKey||"shift"===i&&t.shiftKey?e*this._optionsService.options.fastScrollSensitivity*this._optionsService.options.scrollSensitivity:e*this._optionsService.options.scrollSensitivity},t.prototype.onTouchStart=function(e){this._lastTouchY=e.touches[0].pageY},t.prototype.onTouchMove=function(e){var t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))},s([o(4,c.IBufferService),o(5,c.IOptionsService),o(6,h.ICharSizeService),o(7,h.IRenderService)],t)}(a.Disposable);t.Viewport=u},2950:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;var s=i(4725),o=i(2585),a=function(){function e(e,t,i,r,n,s){this._textarea=e,this._compositionView=t,this._bufferService=i,this._optionsService=r,this._coreService=n,this._renderService=s,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return Object.defineProperty(e.prototype,"isComposing",{get:function(){return this._isComposing},enumerable:!1,configurable:!0}),e.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")},e.prototype.compositionupdate=function(e){var t=this;this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout((function(){t._compositionPosition.end=t._textarea.value.length}),0)},e.prototype.compositionend=function(){this._finalizeComposition(!0)},e.prototype.keydown=function(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)},e.prototype._finalizeComposition=function(e){var t=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){var i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((function(){var e;t._isSendingComposition&&(t._isSendingComposition=!1,i.start+=t._dataAlreadySent.length,(e=t._isComposing?t._textarea.value.substring(i.start,i.end):t._textarea.value.substring(i.start)).length>0&&t._coreService.triggerDataEvent(e,!0))}),0)}else{this._isSendingComposition=!1;var r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}},e.prototype._handleAnyTextareaChanges=function(){var e=this,t=this._textarea.value;setTimeout((function(){if(!e._isComposing){var i=e._textarea.value.replace(t,"");i.length>0&&(e._dataAlreadySent=i,e._coreService.triggerDataEvent(i,!0))}}),0)},e.prototype.updateCompositionElements=function(e){var t=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.actualCellHeight,n=this._bufferService.buffer.y*this._renderService.dimensions.actualCellHeight,s=i*this._renderService.dimensions.actualCellWidth;this._compositionView.style.left=s+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.options.fontFamily,this._compositionView.style.fontSize=this._optionsService.options.fontSize+"px";var o=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=n+"px",this._textarea.style.width=Math.max(o.width,1)+"px",this._textarea.style.height=Math.max(o.height,1)+"px",this._textarea.style.lineHeight=o.height+"px"}e||setTimeout((function(){return t.updateCompositionElements(!0)}),0)}},r([n(2,o.IBufferService),n(3,o.IOptionsService),n(4,o.ICoreService),n(5,s.IRenderService)],e)}();t.CompositionHelper=a},9806:(e,t)=>{function i(e,t){var i=t.getBoundingClientRect();return[e.clientX-i.left,e.clientY-i.top]}Object.defineProperty(t,"__esModule",{value:!0}),t.getRawByteCoords=t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=i,t.getCoords=function(e,t,r,n,s,o,a,l){if(s){var h=i(e,t);if(h)return h[0]=Math.ceil((h[0]+(l?o/2:0))/o),h[1]=Math.ceil(h[1]/a),h[0]=Math.min(Math.max(h[0],1),r+(l?1:0)),h[1]=Math.min(Math.max(h[1],1),n),h}},t.getRawByteCoords=function(e){if(e)return{x:e[0]+32,y:e[1]+32}}},9504:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;var r=i(2584);function n(e,t,i,r){var n=e-s(i,e),a=t-s(i,t),c=Math.abs(n-a)-function(e,t,i){for(var r=0,n=e-s(i,e),a=t-s(i,t),l=0;l<Math.abs(n-a);l++){var h="A"===o(e,t)?-1:1,c=i.buffer.lines.get(n+h*l);c&&c.isWrapped&&r++}return r}(e,t,i);return h(c,l(o(e,t),r))}function s(e,t){for(var i=0,r=e.buffer.lines.get(t),n=r&&r.isWrapped;n&&t>=0&&t<e.rows;)i++,n=(r=e.buffer.lines.get(--t))&&r.isWrapped;return i}function o(e,t){return e>t?"A":"B"}function a(e,t,i,r,n,s){for(var o=e,a=t,l="";o!==i||a!==r;)o+=n?1:-1,n&&o>s.cols-1?(l+=s.buffer.translateBufferLineToString(a,!1,e,o),o=0,e=0,a++):!n&&o<0&&(l+=s.buffer.translateBufferLineToString(a,!1,0,e+1),e=o=s.cols-1,a--);return l+s.buffer.translateBufferLineToString(a,!1,e,o)}function l(e,t){var i=t?"O":"[";return r.C0.ESC+i+e}function h(e,t){e=Math.floor(e);for(var i="",r=0;r<e;r++)i+=t;return i}t.moveToCellSequence=function(e,t,i,r){var o,c=i.buffer.x,u=i.buffer.y;if(!i.buffer.hasScrollback)return function(e,t,i,r,o,c){return 0===n(t,r,o,c).length?"":h(a(e,t,e,t-s(o,t),!1,o).length,l("D",c))}(c,u,0,t,i,r)+n(u,t,i,r)+function(e,t,i,r,o,c){var u;u=n(t,r,o,c).length>0?r-s(o,r):t;var f=r,d=function(e,t,i,r,o,a){var l;return l=n(i,r,o,a).length>0?r-s(o,r):t,e<i&&l<=r||e>=i&&l<r?"C":"D"}(e,t,i,r,o,c);return h(a(e,u,i,f,"C"===d,o).length,l(d,c))}(c,u,e,t,i,r);if(u===t)return o=c>e?"D":"C",h(Math.abs(c-e),l(o,r));o=u>t?"D":"C";var f=Math.abs(u-t);return h(function(e,t){return t.cols-e}(u>t?e:c,i)+(f-1)*i.cols+1+((u>t?c:e)-1),l(o,r))}},1546:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var r=i(643),n=i(8803),s=i(1420),o=i(3734),a=i(1752),l=i(4774),h=i(9631),c=i(8978),u=function(){function e(e,t,i,r,n,s,o,a){this._container=e,this._alpha=r,this._colors=n,this._rendererId=s,this._bufferService=o,this._optionsService=a,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+t+"-layer"),this._canvas.style.zIndex=i.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return e.prototype.dispose=function(){var e;(0,h.removeElementFromParent)(this._canvas),null===(e=this._charAtlas)||void 0===e||e.dispose()},e.prototype._initCanvas=function(){this._ctx=(0,a.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},e.prototype.onOptionsChanged=function(){},e.prototype.onBlur=function(){},e.prototype.onFocus=function(){},e.prototype.onCursorMove=function(){},e.prototype.onGridChanged=function(e,t){},e.prototype.onSelectionChanged=function(e,t,i){void 0===i&&(i=!1)},e.prototype.setColors=function(e){this._refreshCharAtlas(e)},e.prototype._setTransparency=function(e){if(e!==this._alpha){var t=this._canvas;this._alpha=e,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,t),this._refreshCharAtlas(this._colors),this.onGridChanged(0,this._bufferService.rows-1)}},e.prototype._refreshCharAtlas=function(e){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=(0,s.acquireCharAtlas)(this._optionsService.options,this._rendererId,e,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},e.prototype.resize=function(e){this._scaledCellWidth=e.scaledCellWidth,this._scaledCellHeight=e.scaledCellHeight,this._scaledCharWidth=e.scaledCharWidth,this._scaledCharHeight=e.scaledCharHeight,this._scaledCharLeft=e.scaledCharLeft,this._scaledCharTop=e.scaledCharTop,this._canvas.width=e.scaledCanvasWidth,this._canvas.height=e.scaledCanvasHeight,this._canvas.style.width=e.canvasWidth+"px",this._canvas.style.height=e.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(this._colors)},e.prototype.clearTextureAtlas=function(){var e;null===(e=this._charAtlas)||void 0===e||e.clear()},e.prototype._fillCells=function(e,t,i,r){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight)},e.prototype._fillMiddleLineAtCells=function(e,t,i){void 0===i&&(i=1);var r=Math.ceil(.5*this._scaledCellHeight);this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-r-window.devicePixelRatio,i*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillBottomLineAtCells=function(e,t,i){void 0===i&&(i=1),this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-window.devicePixelRatio-1,i*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillLeftLineAtCell=function(e,t,i){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,window.devicePixelRatio*i,this._scaledCellHeight)},e.prototype._strokeRectAtCell=function(e,t,i,r){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(e*this._scaledCellWidth+window.devicePixelRatio/2,t*this._scaledCellHeight+window.devicePixelRatio/2,i*this._scaledCellWidth-window.devicePixelRatio,r*this._scaledCellHeight-window.devicePixelRatio)},e.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},e.prototype._clearCells=function(e,t,i,r){this._alpha?this._ctx.clearRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight))},e.prototype._fillCharTrueColor=function(e,t,i){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=n.TEXT_BASELINE,this._clipRow(i);var r=!1;!1!==this._optionsService.options.customGlyphs&&(r=(0,c.tryDrawCustomChar)(this._ctx,e.getChars(),t*this._scaledCellWidth,i*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),r||this._ctx.fillText(e.getChars(),t*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},e.prototype._drawChars=function(e,t,i){var s,o,a=this._getContrastColor(e);a||e.isFgRGB()||e.isBgRGB()?this._drawUncachedChars(e,t,i,a):(e.isInverse()?(s=e.isBgDefault()?n.INVERTED_DEFAULT_COLOR:e.getBgColor(),o=e.isFgDefault()?n.INVERTED_DEFAULT_COLOR:e.getFgColor()):(o=e.isBgDefault()?r.DEFAULT_COLOR:e.getBgColor(),s=e.isFgDefault()?r.DEFAULT_COLOR:e.getFgColor()),s+=this._optionsService.options.drawBoldTextInBrightColors&&e.isBold()&&s<8?8:0,this._currentGlyphIdentifier.chars=e.getChars()||r.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=e.getCode()||r.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=o,this._currentGlyphIdentifier.fg=s,this._currentGlyphIdentifier.bold=!!e.isBold(),this._currentGlyphIdentifier.dim=!!e.isDim(),this._currentGlyphIdentifier.italic=!!e.isItalic(),this._charAtlas&&this._charAtlas.draw(this._ctx,this._currentGlyphIdentifier,t*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop)||this._drawUncachedChars(e,t,i))},e.prototype._drawUncachedChars=function(e,t,i,r){if(this._ctx.save(),this._ctx.font=this._getFont(!!e.isBold(),!!e.isItalic()),this._ctx.textBaseline=n.TEXT_BASELINE,e.isInverse())if(r)this._ctx.fillStyle=r.css;else if(e.isBgDefault())this._ctx.fillStyle=l.color.opaque(this._colors.background).css;else if(e.isBgRGB())this._ctx.fillStyle="rgb("+o.AttributeData.toColorRGB(e.getBgColor()).join(",")+")";else{var s=e.getBgColor();this._optionsService.options.drawBoldTextInBrightColors&&e.isBold()&&s<8&&(s+=8),this._ctx.fillStyle=this._colors.ansi[s].css}else if(r)this._ctx.fillStyle=r.css;else if(e.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(e.isFgRGB())this._ctx.fillStyle="rgb("+o.AttributeData.toColorRGB(e.getFgColor()).join(",")+")";else{var a=e.getFgColor();this._optionsService.options.drawBoldTextInBrightColors&&e.isBold()&&a<8&&(a+=8),this._ctx.fillStyle=this._colors.ansi[a].css}this._clipRow(i),e.isDim()&&(this._ctx.globalAlpha=n.DIM_OPACITY);var h=!1;!1!==this._optionsService.options.customGlyphs&&(h=(0,c.tryDrawCustomChar)(this._ctx,e.getChars(),t*this._scaledCellWidth,i*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),h||this._ctx.fillText(e.getChars(),t*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight),this._ctx.restore()},e.prototype._clipRow=function(e){this._ctx.beginPath(),this._ctx.rect(0,e*this._scaledCellHeight,this._bufferService.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},e.prototype._getFont=function(e,t){return(t?"italic":"")+" "+(e?this._optionsService.options.fontWeightBold:this._optionsService.options.fontWeight)+" "+this._optionsService.options.fontSize*window.devicePixelRatio+"px "+this._optionsService.options.fontFamily},e.prototype._getContrastColor=function(e){if(1!==this._optionsService.options.minimumContrastRatio){var t=this._colors.contrastCache.getColor(e.bg,e.fg);if(void 0!==t)return t||void 0;var i=e.getFgColor(),r=e.getFgColorMode(),n=e.getBgColor(),s=e.getBgColorMode(),o=!!e.isInverse(),a=!!e.isInverse();if(o){var h=i;i=n,n=h;var c=r;r=s,s=c}var u=this._resolveBackgroundRgba(s,n,o),f=this._resolveForegroundRgba(r,i,o,a),d=l.rgba.ensureContrastRatio(u,f,this._optionsService.options.minimumContrastRatio);if(d){var p={css:l.channels.toCss(d>>24&255,d>>16&255,d>>8&255),rgba:d};return this._colors.contrastCache.setColor(e.bg,e.fg,p),p}this._colors.contrastCache.setColor(e.bg,e.fg,null)}},e.prototype._resolveBackgroundRgba=function(e,t,i){switch(e){case 16777216:case 33554432:return this._colors.ansi[t].rgba;case 50331648:return t<<8;default:return i?this._colors.foreground.rgba:this._colors.background.rgba}},e.prototype._resolveForegroundRgba=function(e,t,i,r){switch(e){case 16777216:case 33554432:return this._optionsService.options.drawBoldTextInBrightColors&&r&&t<8&&(t+=8),this._colors.ansi[t].rgba;case 50331648:return t<<8;default:return i?this._colors.background.rgba:this._colors.foreground.rgba}},e}();t.BaseRenderLayer=u},2512:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CursorRenderLayer=void 0;var a=i(1546),l=i(511),h=i(2585),c=i(4725),u=600,f=function(e){function t(t,i,r,n,s,o,a,h,c){var u=e.call(this,t,"cursor",i,!0,r,n,o,a)||this;return u._onRequestRedraw=s,u._coreService=h,u._coreBrowserService=c,u._cell=new l.CellData,u._state={x:0,y:0,isFocused:!1,style:"",width:0},u._cursorRenderers={bar:u._renderBarCursor.bind(u),block:u._renderBlockCursor.bind(u),underline:u._renderUnderlineCursor.bind(u)},u}return n(t,e),t.prototype.dispose=function(){this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=void 0),e.prototype.dispose.call(this)},t.prototype.resize=function(t){e.prototype.resize.call(this,t),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},t.prototype.reset=function(){var e;this._clearCursor(),null===(e=this._cursorBlinkStateManager)||void 0===e||e.restartBlinkAnimation(),this.onOptionsChanged()},t.prototype.onBlur=function(){var e;null===(e=this._cursorBlinkStateManager)||void 0===e||e.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onFocus=function(){var e;null===(e=this._cursorBlinkStateManager)||void 0===e||e.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onOptionsChanged=function(){var e,t=this;this._optionsService.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new d(this._coreBrowserService.isFocused,(function(){t._render(!0)}))):(null===(e=this._cursorBlinkStateManager)||void 0===e||e.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onCursorMove=function(){var e;null===(e=this._cursorBlinkStateManager)||void 0===e||e.restartBlinkAnimation()},t.prototype.onGridChanged=function(e,t){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()},t.prototype._render=function(e){if(this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden){var t=this._bufferService.buffer.ybase+this._bufferService.buffer.y,i=t-this._bufferService.buffer.ydisp;if(i<0||i>=this._bufferService.rows)this._clearCursor();else{var r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(t).loadCell(r,this._cell),void 0!==this._cell.content){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var n=this._optionsService.options.cursorStyle;return n&&"block"!==n?this._cursorRenderers[n](r,i,this._cell):this._renderBlurCursor(r,i,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=i,this._state.isFocused=!1,this._state.style=n,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===r&&this._state.y===i&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.options.cursorStyle||"block"](r,i,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=i,this._state.isFocused=!1,this._state.style=this._optionsService.options.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}}else this._clearCursor()},t.prototype._clearCursor=function(){this._state&&(window.devicePixelRatio<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},t.prototype._renderBarCursor=function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(e,t,this._optionsService.options.cursorWidth),this._ctx.restore()},t.prototype._renderBlockCursor=function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(e,t,i.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(i,e,t),this._ctx.restore()},t.prototype._renderUnderlineCursor=function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(e,t),this._ctx.restore()},t.prototype._renderBlurCursor=function(e,t,i){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(e,t,i.getWidth(),1),this._ctx.restore()},s([o(5,h.IBufferService),o(6,h.IOptionsService),o(7,h.ICoreService),o(8,c.ICoreBrowserService)],t)}(a.BaseRenderLayer);t.CursorRenderLayer=f;var d=function(){function e(e,t){this._renderCallback=t,this.isCursorVisible=!0,e&&this._restartInterval()}return Object.defineProperty(e.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.restartBlinkAnimation=function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0}))))},e.prototype._restartInterval=function(e){var t=this;void 0===e&&(e=u),this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=window.setTimeout((function(){if(t._animationTimeRestarted){var e=u-(Date.now()-t._animationTimeRestarted);if(t._animationTimeRestarted=void 0,e>0)return void t._restartInterval(e)}t.isCursorVisible=!1,t._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0})),t._blinkInterval=window.setInterval((function(){if(t._animationTimeRestarted){var e=u-(Date.now()-t._animationTimeRestarted);return t._animationTimeRestarted=void 0,void t._restartInterval(e)}t.isCursorVisible=!t.isCursorVisible,t._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0}))}),u)}),e)},e.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.resume=function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()},e}()},8978:(e,t,i)=>{var r,n,s,o,a,l,h,c,u,f,d,p,g,m,_,v,y,b,O,w,S,C,k,x,E,A,T,P,L,R,M,D,B,I,Q,$,H,W,N,F,j,U,q,X,z,V,Y,G,Z,K,J,ee,te,ie,re,ne,se,oe,ae,le,he,ce,ue,fe,de,pe,ge,me,_e,ve,ye,be,Oe,we,Se,Ce,ke,xe,Ee,Ae,Te,Pe,Le,Re,Me,De,Be,Ie,Qe,$e,He,We,Ne,Fe,je,Ue,qe,Xe,ze,Ve,Ye,Ge,Ze,Ke,Je,et,tt,it,rt,nt,st,ot,at,lt,ht,ct,ut,ft,dt,pt,gt,mt,_t,vt,yt,bt,Ot,wt;Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var St=i(1752);t.blockElementDefinitions={"":[{x:0,y:0,w:8,h:4}],"":[{x:0,y:7,w:8,h:1}],"":[{x:0,y:6,w:8,h:2}],"":[{x:0,y:5,w:8,h:3}],"":[{x:0,y:4,w:8,h:4}],"":[{x:0,y:3,w:8,h:5}],"":[{x:0,y:2,w:8,h:6}],"":[{x:0,y:1,w:8,h:7}],"":[{x:0,y:0,w:8,h:8}],"":[{x:0,y:0,w:7,h:8}],"":[{x:0,y:0,w:6,h:8}],"":[{x:0,y:0,w:5,h:8}],"":[{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:3,h:8}],"":[{x:0,y:0,w:2,h:8}],"":[{x:0,y:0,w:1,h:8}],"":[{x:4,y:0,w:4,h:8}],"":[{x:0,y:0,w:9,h:1}],"":[{x:7,y:0,w:1,h:8}],"":[{x:0,y:4,w:4,h:4}],"":[{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"":[{x:4,y:0,w:4,h:4}],"":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:1,y:0,w:1,h:8}],"":[{x:2,y:0,w:1,h:8}],"":[{x:3,y:0,w:1,h:8}],"":[{x:4,y:0,w:1,h:8}],"":[{x:5,y:0,w:1,h:8}],"":[{x:6,y:0,w:1,h:8}],"":[{x:0,y:1,w:8,h:1}],"":[{x:0,y:2,w:8,h:1}],"":[{x:0,y:3,w:8,h:1}],"":[{x:0,y:4,w:8,h:1}],"":[{x:0,y:5,w:8,h:1}],"":[{x:0,y:6,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:2}],"":[{x:0,y:0,w:8,h:3}],"":[{x:0,y:0,w:8,h:5}],"":[{x:0,y:0,w:8,h:6}],"":[{x:0,y:0,w:8,h:7}],"":[{x:6,y:0,w:2,h:8}],"":[{x:5,y:0,w:3,h:8}],"":[{x:3,y:0,w:5,h:8}],"":[{x:2,y:0,w:6,h:8}],"":[{x:1,y:0,w:7,h:8}],"":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var Ct={"":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"":[[1,0],[0,0],[0,1],[0,0]],"":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"":(r={},r[1]="M0,.5 L1,.5",r),"":(n={},n[3]="M0,.5 L1,.5",n),"":(s={},s[1]="M.5,0 L.5,1",s),"":(o={},o[3]="M.5,0 L.5,1",o),"":(a={},a[1]="M0.5,1 L.5,.5 L1,.5",a),"":(l={},l[3]="M0.5,1 L.5,.5 L1,.5",l),"":(h={},h[1]="M0,.5 L.5,.5 L.5,1",h),"":(c={},c[3]="M0,.5 L.5,.5 L.5,1",c),"":(u={},u[1]="M.5,0 L.5,.5 L1,.5",u),"":(f={},f[3]="M.5,0 L.5,.5 L1,.5",f),"":(d={},d[1]="M.5,0 L.5,.5 L0,.5",d),"":(p={},p[3]="M.5,0 L.5,.5 L0,.5",p),"":(g={},g[1]="M.5,0 L.5,1 M.5,.5 L1,.5",g),"":(m={},m[3]="M.5,0 L.5,1 M.5,.5 L1,.5",m),"":(_={},_[1]="M.5,0 L.5,1 M.5,.5 L0,.5",_),"":(v={},v[3]="M.5,0 L.5,1 M.5,.5 L0,.5",v),"":(y={},y[1]="M0,.5 L1,.5 M.5,.5 L.5,1",y),"":(b={},b[3]="M0,.5 L1,.5 M.5,.5 L.5,1",b),"":(O={},O[1]="M0,.5 L1,.5 M.5,.5 L.5,0",O),"":(w={},w[3]="M0,.5 L1,.5 M.5,.5 L.5,0",w),"":(S={},S[1]="M0,.5 L1,.5 M.5,0 L.5,1",S),"":(C={},C[3]="M0,.5 L1,.5 M.5,0 L.5,1",C),"":(k={},k[1]="M.5,.5 L0,.5",k),"":(x={},x[3]="M.5,.5 L0,.5",x),"":(E={},E[1]="M.5,.5 L.5,0",E),"":(A={},A[3]="M.5,.5 L.5,0",A),"":(T={},T[1]="M.5,.5 L1,.5",T),"":(P={},P[3]="M.5,.5 L1,.5",P),"":(L={},L[1]="M.5,.5 L.5,1",L),"":(R={},R[3]="M.5,.5 L.5,1",R),"":(M={},M[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},M),"":(D={},D[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},D),"":(B={},B[1]=function(e,t){return"M.5,1 L.5,"+(.5-t)+" L1,"+(.5-t)+" M.5,"+(.5+t)+" L1,"+(.5+t)},B),"":(I={},I[1]=function(e,t){return"M"+(.5-e)+",1 L"+(.5-e)+",.5 L1,.5 M"+(.5+e)+",.5 L"+(.5+e)+",1"},I),"":(Q={},Q[1]=function(e,t){return"M1,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1"},Q),"":($={},$[1]=function(e,t){return"M0,"+(.5-t)+" L.5,"+(.5-t)+" L.5,1 M0,"+(.5+t)+" L.5,"+(.5+t)},$),"":(H={},H[1]=function(e,t){return"M"+(.5+e)+",1 L"+(.5+e)+",.5 L0,.5 M"+(.5-e)+",.5 L"+(.5-e)+",1"},H),"":(W={},W[1]=function(e,t){return"M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M0,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",1"},W),"":(N={},N[1]=function(e,t){return"M.5,0 L.5,"+(.5+t)+" L1,"+(.5+t)+" M.5,"+(.5-t)+" L1,"+(.5-t)},N),"":(F={},F[1]=function(e,t){return"M1,.5 L"+(.5-e)+",.5 L"+(.5-e)+",0 M"+(.5+e)+",.5 L"+(.5+e)+",0"},F),"":(j={},j[1]=function(e,t){return"M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0 M1,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",0"},j),"":(U={},U[1]=function(e,t){return"M0,"+(.5+t)+" L.5,"+(.5+t)+" L.5,0 M0,"+(.5-t)+" L.5,"+(.5-t)},U),"":(q={},q[1]=function(e,t){return"M0,.5 L"+(.5+e)+",.5 L"+(.5+e)+",0 M"+(.5-e)+",.5 L"+(.5-e)+",0"},q),"":(X={},X[1]=function(e,t){return"M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M0,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",0"},X),"":(z={},z[1]=function(e,t){return"M.5,0 L.5,1 M.5,"+(.5-t)+" L1,"+(.5-t)+" M.5,"+(.5+t)+" L1,"+(.5+t)},z),"":(V={},V[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1 M"+(.5+e)+",.5 L1,.5"},V),"":(Y={},Y[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},Y),"":(G={},G[1]=function(e,t){return"M.5,0 L.5,1 M0,"+(.5-t)+" L.5,"+(.5-t)+" M0,"+(.5+t)+" L.5,"+(.5+t)},G),"":(Z={},Z[1]=function(e,t){return"M0,.5 L"+(.5-e)+",.5 M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},Z),"":(K={},K[1]=function(e,t){return"M"+(.5+e)+",0 L"+(.5+e)+",1 M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0"},K),"":(J={},J[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)+" M.5,"+(.5+t)+" L.5,1"},J),"":(ee={},ee[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",.5 L"+(.5-e)+",1 M"+(.5+e)+",.5 L"+(.5+e)+",1"},ee),"":(te={},te[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1"},te),"":(ie={},ie[1]=function(e,t){return"M.5,0 L.5,"+(.5-t)+" M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},ie),"":(re={},re[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",.5 L"+(.5-e)+",0 M"+(.5+e)+",.5 L"+(.5+e)+",0"},re),"":(ne={},ne[1]=function(e,t){return"M0,"+(.5+t)+" L1,"+(.5+t)+" M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},ne),"":(se={},se[1]=function(e,t){return"M.5,0 L.5,1 M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},se),"":(oe={},oe[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},oe),"":(ae={},ae[1]=function(e,t){return"M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1 M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},ae),"":(le={},le[1]="M1,0 L0,1",le),"":(he={},he[1]="M0,0 L1,1",he),"":(ce={},ce[1]="M1,0 L0,1 M0,0 L1,1",ce),"":(ue={},ue[1]="M.5,.5 L0,.5",ue[3]="M.5,.5 L1,.5",ue),"":(fe={},fe[1]="M.5,.5 L.5,0",fe[3]="M.5,.5 L.5,1",fe),"":(de={},de[1]="M.5,.5 L1,.5",de[3]="M.5,.5 L0,.5",de),"":(pe={},pe[1]="M.5,.5 L.5,1",pe[3]="M.5,.5 L.5,0",pe),"":(ge={},ge[1]="M.5,.5 L.5,1",ge[3]="M.5,.5 L1,.5",ge),"":(me={},me[1]="M.5,.5 L1,.5",me[3]="M.5,.5 L.5,1",me),"":(_e={},_e[1]="M.5,.5 L.5,1",_e[3]="M.5,.5 L0,.5",_e),"":(ve={},ve[1]="M.5,.5 L0,.5",ve[3]="M.5,.5 L.5,1",ve),"":(ye={},ye[1]="M.5,.5 L.5,0",ye[3]="M.5,.5 L1,.5",ye),"":(be={},be[1]="M.5,.5 L1,.5",be[3]="M.5,.5 L.5,0",be),"":(Oe={},Oe[1]="M.5,.5 L.5,0",Oe[3]="M.5,.5 L0,.5",Oe),"":(we={},we[1]="M.5,.5 L0,.5",we[3]="M.5,.5 L.5,0",we),"":(Se={},Se[1]="M.5,0 L.5,1",Se[3]="M.5,.5 L1,.5",Se),"":(Ce={},Ce[1]="M0.5,1 L.5,.5 L1,.5",Ce[3]="M.5,.5 L.5,0",Ce),"":(ke={},ke[1]="M.5,0 L.5,.5 L1,.5",ke[3]="M.5,.5 L.5,1",ke),"":(xe={},xe[1]="M.5,.5 L1,.5",xe[3]="M.5,0 L.5,1",xe),"":(Ee={},Ee[1]="M.5,.5 L.5,1",Ee[3]="M.5,0 L.5,.5 L1,.5",Ee),"":(Ae={},Ae[1]="M.5,.5 L.5,0",Ae[3]="M0.5,1 L.5,.5 L1,.5",Ae),"":(Te={},Te[1]="M.5,0 L.5,1",Te[3]="M.5,.5 L0,.5",Te),"":(Pe={},Pe[1]="M0,.5 L.5,.5 L.5,1",Pe[3]="M.5,.5 L.5,0",Pe),"":(Le={},Le[1]="M.5,0 L.5,.5 L0,.5",Le[3]="M.5,.5 L.5,1",Le),"":(Re={},Re[1]="M.5,.5 L0,.5",Re[3]="M.5,0 L.5,1",Re),"":(Me={},Me[1]="M.5,.5 L.5,1",Me[3]="M.5,0 L.5,.5 L0,.5",Me),"":(De={},De[1]="M.5,.5 L.5,0",De[3]="M0,.5 L.5,.5 L.5,1",De),"":(Be={},Be[1]="M0.5,1 L.5,.5 L1,.5",Be[3]="M.5,.5 L0,.5",Be),"":(Ie={},Ie[1]="M0,.5 L.5,.5 L.5,1",Ie[3]="M.5,.5 L1,.5",Ie),"":(Qe={},Qe[1]="M.5,.5 L.5,1",Qe[3]="M0,.5 L1,.5",Qe),"":($e={},$e[1]="M0,.5 L1,.5",$e[3]="M.5,.5 L.5,1",$e),"":(He={},He[1]="M.5,.5 L1,.5",He[3]="M0,.5 L.5,.5 L.5,1",He),"":(We={},We[1]="M.5,.5 L0,.5",We[3]="M0.5,1 L.5,.5 L1,.5",We),"":(Ne={},Ne[1]="M.5,0 L.5,.5 L1,.5",Ne[3]="M.5,.5 L0,.5",Ne),"":(Fe={},Fe[1]="M.5,0 L.5,.5 L0,.5",Fe[3]="M.5,.5 L1,.5",Fe),"":(je={},je[1]="M.5,.5 L.5,0",je[3]="M0,.5 L1,.5",je),"":(Ue={},Ue[1]="M0,.5 L1,.5",Ue[3]="M.5,.5 L.5,0",Ue),"":(qe={},qe[1]="M.5,.5 L1,.5",qe[3]="M.5,0 L.5,.5 L0,.5",qe),"":(Xe={},Xe[1]="M.5,.5 L0,.5",Xe[3]="M.5,0 L.5,.5 L1,.5",Xe),"":(ze={},ze[1]="M.5,0 L.5,1 M.5,.5 L1,.5",ze[3]="M.5,.5 L0,.5",ze),"":(Ve={},Ve[1]="M.5,0 L.5,1 M.5,.5 L0,.5",Ve[3]="M.5,.5 L1,.5",Ve),"":(Ye={},Ye[1]="M.5,0 L.5,1",Ye[3]="M0,.5 L1,.5",Ye),"":(Ge={},Ge[1]="M0,.5 L1,.5 M.5,.5 L.5,1",Ge[3]="M.5,.5 L.5,0",Ge),"":(Ze={},Ze[1]="M.5,.5 L.5,0 M0,.5 L1,.5",Ze[3]="M.5,.5 L.5,1",Ze),"":(Ke={},Ke[1]="M0,.5 L1,.5",Ke[3]="M.5,0 L.5,1",Ke),"":(Je={},Je[1]="M0.5,1 L.5,.5 L1,.5",Je[3]="M.5,0 L.5,.5 L0,.5",Je),"":(et={},et[1]="M0,.5 L.5,.5 L.5,1",et[3]="M.5,0 L.5,.5 L1,.5",et),"":(tt={},tt[1]="M.5,0 L.5,.5 L1,.5",tt[3]="M0,.5 L.5,.5 L.5,1",tt),"":(it={},it[1]="M.5,0 L.5,.5 L0,.5",it[3]="M0.5,1 L.5,.5 L1,.5",it),"":(rt={},rt[1]="M.5,.5 L.5,1",rt[3]="M.5,.5 L.5,0 M0,.5 L1,.5",rt),"":(nt={},nt[1]="M.5,.5 L.5,0",nt[3]="M0,.5 L1,.5 M.5,.5 L.5,1",nt),"":(st={},st[1]="M.5,.5 L1,.5",st[3]="M.5,0 L.5,1 M.5,.5 L0,.5",st),"":(ot={},ot[1]="M.5,.5 L0,.5",ot[3]="M.5,0 L.5,1 M.5,.5 L1,.5",ot),"":(at={},at[1]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",at),"":(lt={},lt[3]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",lt),"":(ht={},ht[1]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",ht),"":(ct={},ct[3]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",ct),"":(ut={},ut[1]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",ut),"":(ft={},ft[3]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",ft),"":(dt={},dt[1]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",dt),"":(pt={},pt[3]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",pt),"":(gt={},gt[1]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",gt),"":(mt={},mt[3]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",mt),"":(_t={},_t[1]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",_t),"":(vt={},vt[3]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",vt),"":(yt={},yt[1]="C.5,1,.5,.5,1,.5",yt),"":(bt={},bt[1]="C.5,1,.5,.5,0,.5",bt),"":(Ot={},Ot[1]="C.5,0,.5,.5,0,.5",Ot),"":(wt={},wt[1]="C.5,0,.5,.5,1,.5",wt)},t.tryDrawCustomChar=function(e,i,r,n,s,o){var a=t.blockElementDefinitions[i];if(a)return function(e,t,i,r,n,s){for(var o=0;o<t.length;o++){var a=t[o],l=n/8,h=s/8;e.fillRect(i+a.x*l,r+a.y*h,a.w*l,a.h*h)}}(e,a,r,n,s,o),!0;var l=Ct[i];if(l)return function(e,t,i,r,n,s){var o,a=kt.get(t);a||(a=new Map,kt.set(t,a));var l=e.fillStyle;if("string"!=typeof l)throw new Error('Unexpected fillStyle type "'+l+'"');var h=a.get(l);if(!h){var c=t[0].length,u=t.length,f=document.createElement("canvas");f.width=c,f.height=u;var d=(0,St.throwIfFalsy)(f.getContext("2d")),p=new ImageData(c,u),g=void 0,m=void 0,_=void 0,v=void 0;if(l.startsWith("#"))g=parseInt(l.substr(1,2),16),m=parseInt(l.substr(3,2),16),_=parseInt(l.substr(5,2),16),v=l.length>7&&parseInt(l.substr(7,2),16)||1;else{if(!l.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'+l+'" when drawing pattern glyph');g=(o=l.substring(5,l.length-1).split(",").map((function(e){return parseFloat(e)})))[0],m=o[1],_=o[2],v=o[3]}for(var y=0;y<u;y++)for(var b=0;b<c;b++)p.data[4*(y*c+b)]=g,p.data[4*(y*c+b)+1]=m,p.data[4*(y*c+b)+2]=_,p.data[4*(y*c+b)+3]=t[y][b]*(255*v);d.putImageData(p,0,0),h=(0,St.throwIfFalsy)(e.createPattern(f,null)),a.set(l,h)}e.fillStyle=h,e.fillRect(i,r,n,s)}(e,l,r,n,s,o),!0;var h=t.boxDrawingDefinitions[i];return!!h&&(function(e,t,i,r,n,s){e.strokeStyle=e.fillStyle;for(var o=0,a=Object.entries(t);o<a.length;o++){var l=a[o],h=l[0],c=l[1];e.beginPath(),e.lineWidth=window.devicePixelRatio*Number.parseInt(h);for(var u=0,f=("function"==typeof c?c(.15,.15/s*n):c).split(" ");u<f.length;u++){var d=f[u],p=d[0],g=Et[p];if(g){var m=d.substring(1).split(",");m[0]&&m[1]&&g(e,At(m,n,s,i,r))}else console.error('Could not find drawing instructions for "'+p+'"')}e.stroke(),e.closePath()}}(e,h,r,n,s,o),!0)};var kt=new Map;function xt(e,t,i){return void 0===i&&(i=0),Math.max(Math.min(e,t),i)}var Et={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function At(e,t,i,r,n){var s=e.map((function(e){return parseFloat(e)||parseInt(e)}));if(s.length<2)throw new Error("Too few arguments for instruction");for(var o=0;o<s.length;o+=2)s[o]*=t,0!==s[o]&&(s[o]=xt(Math.round(s[o]+.5)-.5,t,0)),s[o]+=r;for(var a=1;a<s.length;a+=2)s[a]*=i,0!==s[a]&&(s[a]=xt(Math.round(s[a]+.5)-.5,i,0)),s[a]+=n;return s}},3700:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GridCache=void 0;var i=function(){function e(){this.cache=[]}return e.prototype.resize=function(e,t){for(var i=0;i<e;i++){this.cache.length<=i&&this.cache.push([]);for(var r=this.cache[i].length;r<t;r++)this.cache[i].push(void 0);this.cache[i].length=t}this.cache.length=e},e.prototype.clear=function(){for(var e=0;e<this.cache.length;e++)for(var t=0;t<this.cache[e].length;t++)this.cache[e][t]=void 0},e}();t.GridCache=i},5098:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var a=i(1546),l=i(8803),h=i(2040),c=i(2585),u=function(e){function t(t,i,r,n,s,o,a,l){var h=e.call(this,t,"link",i,!0,r,n,a,l)||this;return s.onShowLinkUnderline((function(e){return h._onShowLinkUnderline(e)})),s.onHideLinkUnderline((function(e){return h._onHideLinkUnderline(e)})),o.onShowLinkUnderline((function(e){return h._onShowLinkUnderline(e)})),o.onHideLinkUnderline((function(e){return h._onHideLinkUnderline(e)})),h}return n(t,e),t.prototype.resize=function(t){e.prototype.resize.call(this,t),this._state=void 0},t.prototype.reset=function(){this._clearCurrentLink()},t.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},t.prototype._onShowLinkUnderline=function(e){if(e.fg===l.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:e.fg&&(0,h.is256Color)(e.fg)?this._ctx.fillStyle=this._colors.ansi[e.fg].css:this._ctx.fillStyle=this._colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e},t.prototype._onHideLinkUnderline=function(e){this._clearCurrentLink()},s([o(6,c.IBufferService),o(7,c.IOptionsService)],t)}(a.BaseRenderLayer);t.LinkRenderLayer=u},3525:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var a=i(9596),l=i(4149),h=i(2512),c=i(5098),u=i(844),f=i(4725),d=i(2585),p=i(1420),g=i(8460),m=1,_=function(e){function t(t,i,r,n,s,o,u,f){var d=e.call(this)||this;d._colors=t,d._screenElement=i,d._bufferService=o,d._charSizeService=u,d._optionsService=f,d._id=m++,d._onRequestRedraw=new g.EventEmitter;var p=d._optionsService.options.allowTransparency;return d._renderLayers=[s.createInstance(a.TextRenderLayer,d._screenElement,0,d._colors,p,d._id),s.createInstance(l.SelectionRenderLayer,d._screenElement,1,d._colors,d._id),s.createInstance(c.LinkRenderLayer,d._screenElement,2,d._colors,d._id,r,n),s.createInstance(h.CursorRenderLayer,d._screenElement,3,d._colors,d._id,d._onRequestRedraw)],d.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},d._devicePixelRatio=window.devicePixelRatio,d._updateDimensions(),d.onOptionsChanged(),d}return n(t,e),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){for(var t=0,i=this._renderLayers;t<i.length;t++)i[t].dispose();e.prototype.dispose.call(this),(0,p.removeTerminalFromCache)(this._id)},t.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._bufferService.cols,this._bufferService.rows))},t.prototype.setColors=function(e){this._colors=e;for(var t=0,i=this._renderLayers;t<i.length;t++){var r=i[t];r.setColors(this._colors),r.reset()}},t.prototype.onResize=function(e,t){this._updateDimensions();for(var i=0,r=this._renderLayers;i<r.length;i++)r[i].resize(this.dimensions);this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.onCharSizeChanged=function(){this.onResize(this._bufferService.cols,this._bufferService.rows)},t.prototype.onBlur=function(){this._runOperation((function(e){return e.onBlur()}))},t.prototype.onFocus=function(){this._runOperation((function(e){return e.onFocus()}))},t.prototype.onSelectionChanged=function(e,t,i){void 0===i&&(i=!1),this._runOperation((function(r){return r.onSelectionChanged(e,t,i)}))},t.prototype.onCursorMove=function(){this._runOperation((function(e){return e.onCursorMove()}))},t.prototype.onOptionsChanged=function(){this._runOperation((function(e){return e.onOptionsChanged()}))},t.prototype.clear=function(){this._runOperation((function(e){return e.reset()}))},t.prototype._runOperation=function(e){for(var t=0,i=this._renderLayers;t<i.length;t++)e(i[t])},t.prototype.renderRows=function(e,t){for(var i=0,r=this._renderLayers;i<r.length;i++)r[i].onGridChanged(e,t)},t.prototype.clearTextureAtlas=function(){for(var e=0,t=this._renderLayers;e<t.length;e++)t[e].clearTextureAtlas()},t.prototype._updateDimensions=function(){this._charSizeService.hasValidSize&&(this.dimensions.scaledCharWidth=Math.floor(this._charSizeService.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.options.lineHeight),this.dimensions.scaledCharTop=1===this._optionsService.options.lineHeight?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.options.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._optionsService.options.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._bufferService.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._bufferService.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols)},s([o(4,d.IInstantiationService),o(5,d.IBufferService),o(6,f.ICharSizeService),o(7,d.IOptionsService)],t)}(u.Disposable);t.Renderer=_},1752:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e}},4149:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRenderLayer=void 0;var a=i(1546),l=i(2585),h=function(e){function t(t,i,r,n,s,o){var a=e.call(this,t,"selection",i,!0,r,n,s,o)||this;return a._clearState(),a}return n(t,e),t.prototype._clearState=function(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}},t.prototype.resize=function(t){e.prototype.resize.call(this,t),this._clearState()},t.prototype.reset=function(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())},t.prototype.onSelectionChanged=function(e,t,i){if(this._didStateChange(e,t,i,this._bufferService.buffer.ydisp))if(this._clearAll(),e&&t){var r=e[1]-this._bufferService.buffer.ydisp,n=t[1]-this._bufferService.buffer.ydisp,s=Math.max(r,0),o=Math.min(n,this._bufferService.rows-1);if(s>=this._bufferService.rows||o<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=this._colors.selectionTransparent.css,i){var a=e[0],l=t[0]-a,h=o-s+1;this._fillCells(a,s,l,h)}else{a=r===s?e[0]:0;var c=s===n?t[0]:this._bufferService.cols;this._fillCells(a,s,c-a,1);var u=Math.max(o-s-1,0);if(this._fillCells(0,s+1,this._bufferService.cols,u),s!==o){var f=n===o?t[0]:this._bufferService.cols;this._fillCells(0,o,f,1)}}this._state.start=[e[0],e[1]],this._state.end=[t[0],t[1]],this._state.columnSelectMode=i,this._state.ydisp=this._bufferService.buffer.ydisp}}else this._clearState()},t.prototype._didStateChange=function(e,t,i,r){return!this._areCoordinatesEqual(e,this._state.start)||!this._areCoordinatesEqual(t,this._state.end)||i!==this._state.columnSelectMode||r!==this._state.ydisp},t.prototype._areCoordinatesEqual=function(e,t){return!(!e||!t)&&e[0]===t[0]&&e[1]===t[1]},s([o(4,l.IBufferService),o(5,l.IOptionsService)],t)}(a.BaseRenderLayer);t.SelectionRenderLayer=h},9596:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TextRenderLayer=void 0;var a=i(3700),l=i(1546),h=i(3734),c=i(643),u=i(511),f=i(2585),d=i(4725),p=i(4269),g=function(e){function t(t,i,r,n,s,o,l,h){var c=e.call(this,t,"text",i,n,r,s,o,l)||this;return c._characterJoinerService=h,c._characterWidth=0,c._characterFont="",c._characterOverlapCache={},c._workCell=new u.CellData,c._state=new a.GridCache,c}return n(t,e),t.prototype.resize=function(t){e.prototype.resize.call(this,t);var i=this._getFont(!1,!1);this._characterWidth===t.scaledCharWidth&&this._characterFont===i||(this._characterWidth=t.scaledCharWidth,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)},t.prototype.reset=function(){this._state.clear(),this._clearAll()},t.prototype._forEachCell=function(e,t,i){for(var r=e;r<=t;r++)for(var n=r+this._bufferService.buffer.ydisp,s=this._bufferService.buffer.lines.get(n),o=this._characterJoinerService.getJoinedCharacters(n),a=0;a<this._bufferService.cols;a++){s.loadCell(a,this._workCell);var l=this._workCell,h=!1,u=a;if(0!==l.getWidth()){if(o.length>0&&a===o[0][0]){h=!0;var f=o.shift();l=new p.JoinedCellData(this._workCell,s.translateToString(!0,f[0],f[1]),f[1]-f[0]),u=f[1]-1}!h&&this._isOverlapping(l)&&u<s.length-1&&s.getCodePoint(u+1)===c.NULL_CELL_CODE&&(l.content&=-12582913,l.content|=2<<22),i(l,a,r),a=u}}},t.prototype._drawBackground=function(e,t){var i=this,r=this._ctx,n=this._bufferService.cols,s=0,o=0,a=null;r.save(),this._forEachCell(e,t,(function(e,t,l){var c=null;e.isInverse()?c=e.isFgDefault()?i._colors.foreground.css:e.isFgRGB()?"rgb("+h.AttributeData.toColorRGB(e.getFgColor()).join(",")+")":i._colors.ansi[e.getFgColor()].css:e.isBgRGB()?c="rgb("+h.AttributeData.toColorRGB(e.getBgColor()).join(",")+")":e.isBgPalette()&&(c=i._colors.ansi[e.getBgColor()].css),null===a&&(s=t,o=l),l!==o?(r.fillStyle=a||"",i._fillCells(s,o,n-s,1),s=t,o=l):a!==c&&(r.fillStyle=a||"",i._fillCells(s,o,t-s,1),s=t,o=l),a=c})),null!==a&&(r.fillStyle=a,this._fillCells(s,o,n-s,1)),r.restore()},t.prototype._drawForeground=function(e,t){var i=this;this._forEachCell(e,t,(function(e,t,r){if(!e.isInvisible()&&(i._drawChars(e,t,r),e.isUnderline()||e.isStrikethrough())){if(i._ctx.save(),e.isInverse())if(e.isBgDefault())i._ctx.fillStyle=i._colors.background.css;else if(e.isBgRGB())i._ctx.fillStyle="rgb("+h.AttributeData.toColorRGB(e.getBgColor()).join(",")+")";else{var n=e.getBgColor();i._optionsService.options.drawBoldTextInBrightColors&&e.isBold()&&n<8&&(n+=8),i._ctx.fillStyle=i._colors.ansi[n].css}else if(e.isFgDefault())i._ctx.fillStyle=i._colors.foreground.css;else if(e.isFgRGB())i._ctx.fillStyle="rgb("+h.AttributeData.toColorRGB(e.getFgColor()).join(",")+")";else{var s=e.getFgColor();i._optionsService.options.drawBoldTextInBrightColors&&e.isBold()&&s<8&&(s+=8),i._ctx.fillStyle=i._colors.ansi[s].css}e.isStrikethrough()&&i._fillMiddleLineAtCells(t,r,e.getWidth()),e.isUnderline()&&i._fillBottomLineAtCells(t,r,e.getWidth()),i._ctx.restore()}}))},t.prototype.onGridChanged=function(e,t){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,e,this._bufferService.cols,t-e+1),this._drawBackground(e,t),this._drawForeground(e,t))},t.prototype.onOptionsChanged=function(){this._setTransparency(this._optionsService.options.allowTransparency)},t.prototype._isOverlapping=function(e){if(1!==e.getWidth())return!1;if(e.getCode()<256)return!1;var t=e.getChars();if(this._characterOverlapCache.hasOwnProperty(t))return this._characterOverlapCache[t];this._ctx.save(),this._ctx.font=this._characterFont;var i=Math.floor(this._ctx.measureText(t).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[t]=i,i},s([o(5,f.IBufferService),o(6,f.IOptionsService),o(7,d.ICharacterJoinerService)],t)}(l.BaseRenderLayer);t.TextRenderLayer=g},9616:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseCharAtlas=void 0;var i=function(){function e(){this._didWarmUp=!1}return e.prototype.dispose=function(){},e.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},e.prototype._doWarmUp=function(){},e.prototype.clear=function(){},e.prototype.beginFrame=function(){},e}();t.BaseCharAtlas=i},1420:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireCharAtlas=void 0;var r=i(2040),n=i(1906),s=[];t.acquireCharAtlas=function(e,t,i,o,a){for(var l=(0,r.generateConfig)(o,a,e,i),h=0;h<s.length;h++){var c=(u=s[h]).ownedBy.indexOf(t);if(c>=0){if((0,r.configEquals)(u.config,l))return u.atlas;1===u.ownedBy.length?(u.atlas.dispose(),s.splice(h,1)):u.ownedBy.splice(c,1);break}}for(h=0;h<s.length;h++){var u=s[h];if((0,r.configEquals)(u.config,l))return u.ownedBy.push(t),u.atlas}var f={atlas:new n.DynamicCharAtlas(document,l),config:l,ownedBy:[t]};return s.push(f),f.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<s.length;t++){var i=s[t].ownedBy.indexOf(e);if(-1!==i){1===s[t].ownedBy.length?(s[t].atlas.dispose(),s.splice(t,1)):s[t].ownedBy.splice(i,1);break}}}},2040:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var r=i(643);t.generateConfig=function(e,t,i,r){var n={foreground:r.foreground,background:r.background,cursor:void 0,cursorAccent:void 0,selection:void 0,ansi:r.ansi};return{devicePixelRatio:window.devicePixelRatio,scaledCharWidth:e,scaledCharHeight:t,fontFamily:i.fontFamily,fontSize:i.fontSize,fontWeight:i.fontWeight,fontWeightBold:i.fontWeightBold,allowTransparency:i.allowTransparency,colors:n}},t.configEquals=function(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.scaledCharWidth===t.scaledCharWidth&&e.scaledCharHeight===t.scaledCharHeight&&e.colors.foreground===t.colors.foreground&&e.colors.background===t.colors.background},t.is256Color=function(e){return e<r.DEFAULT_COLOR}},8803:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CHAR_ATLAS_CELL_SPACING=t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox?"bottom":"ideographic",t.CHAR_ATLAS_CELL_SPACING=1},1906:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.NoneCharAtlas=t.DynamicCharAtlas=t.getGlyphCacheKey=void 0;var s=i(8803),o=i(9616),a=i(5680),l=i(7001),h=i(6114),c=i(1752),u=i(4774),f=1024,d=1024,p={css:"rgba(0, 0, 0, 0)",rgba:0};function g(e){return e.code<<21|e.bg<<12|e.fg<<3|(e.bold?0:4)+(e.dim?0:2)+(e.italic?0:1)}t.getGlyphCacheKey=g;var m=function(e){function t(t,i){var r=e.call(this)||this;r._config=i,r._drawToCacheCount=0,r._glyphsWaitingOnBitmap=[],r._bitmapCommitTimeout=null,r._bitmap=null,r._cacheCanvas=t.createElement("canvas"),r._cacheCanvas.width=f,r._cacheCanvas.height=d,r._cacheCtx=(0,c.throwIfFalsy)(r._cacheCanvas.getContext("2d",{alpha:!0}));var n=t.createElement("canvas");n.width=r._config.scaledCharWidth,n.height=r._config.scaledCharHeight,r._tmpCtx=(0,c.throwIfFalsy)(n.getContext("2d",{alpha:r._config.allowTransparency})),r._width=Math.floor(f/r._config.scaledCharWidth),r._height=Math.floor(d/r._config.scaledCharHeight);var s=r._width*r._height;return r._cacheMap=new l.LRUMap(s),r._cacheMap.prealloc(s),r}return n(t,e),t.prototype.dispose=function(){null!==this._bitmapCommitTimeout&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},t.prototype.beginFrame=function(){this._drawToCacheCount=0},t.prototype.clear=function(){if(this._cacheMap.size>0){var e=this._width*this._height;this._cacheMap=new l.LRUMap(e),this._cacheMap.prealloc(e)}this._cacheCtx.clearRect(0,0,f,d),this._tmpCtx.clearRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight)},t.prototype.draw=function(e,t,i,r){if(32===t.code)return!0;if(!this._canCache(t))return!1;var n=g(t),s=this._cacheMap.get(n);if(null!=s)return this._drawFromCache(e,s,i,r),!0;if(this._drawToCacheCount<100){var o;o=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var a=this._drawToCache(t,o);return this._cacheMap.set(n,a),this._drawFromCache(e,a,i,r),!0}return!1},t.prototype._canCache=function(e){return e.code<256},t.prototype._toCoordinateX=function(e){return e%this._width*this._config.scaledCharWidth},t.prototype._toCoordinateY=function(e){return Math.floor(e/this._width)*this._config.scaledCharHeight},t.prototype._drawFromCache=function(e,t,i,r){if(!t.isEmpty){var n=this._toCoordinateX(t.index),s=this._toCoordinateY(t.index);e.drawImage(t.inBitmap?this._bitmap:this._cacheCanvas,n,s,this._config.scaledCharWidth,this._config.scaledCharHeight,i,r,this._config.scaledCharWidth,this._config.scaledCharHeight)}},t.prototype._getColorFromAnsiIndex=function(e){return e<this._config.colors.ansi.length?this._config.colors.ansi[e]:a.DEFAULT_ANSI_COLORS[e]},t.prototype._getBackgroundColor=function(e){return this._config.allowTransparency?p:e.bg===s.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:e.bg<256?this._getColorFromAnsiIndex(e.bg):this._config.colors.background},t.prototype._getForegroundColor=function(e){return e.fg===s.INVERTED_DEFAULT_COLOR?u.color.opaque(this._config.colors.background):e.fg<256?this._getColorFromAnsiIndex(e.fg):this._config.colors.foreground},t.prototype._drawToCache=function(e,t){this._drawToCacheCount++,this._tmpCtx.save();var i=this._getBackgroundColor(e);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=i.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var r=e.bold?this._config.fontWeightBold:this._config.fontWeight,n=e.italic?"italic":"";this._tmpCtx.font=n+" "+r+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline=s.TEXT_BASELINE,this._tmpCtx.fillStyle=this._getForegroundColor(e).css,e.dim&&(this._tmpCtx.globalAlpha=s.DIM_OPACITY),this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight);var o=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),a=!1;if(this._config.allowTransparency||(a=v(o,i)),a&&"_"===e.chars&&!this._config.allowTransparency)for(var l=1;l<=5&&(this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight-l),a=v(o=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),i));l++);this._tmpCtx.restore();var h=this._toCoordinateX(t),c=this._toCoordinateY(t);this._cacheCtx.putImageData(o,h,c);var u={index:t,isEmpty:a,inBitmap:!1};return this._addGlyphToBitmap(u),u},t.prototype._addGlyphToBitmap=function(e){var t=this;!("createImageBitmap"in window)||h.isFirefox||h.isSafari||(this._glyphsWaitingOnBitmap.push(e),null===this._bitmapCommitTimeout&&(this._bitmapCommitTimeout=window.setTimeout((function(){return t._generateBitmap()}),100)))},t.prototype._generateBitmap=function(){var e=this,t=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then((function(i){e._bitmap=i;for(var r=0;r<t.length;r++)t[r].inBitmap=!0})),this._bitmapCommitTimeout=null},t}(o.BaseCharAtlas);t.DynamicCharAtlas=m;var _=function(e){function t(t,i){return e.call(this)||this}return n(t,e),t.prototype.draw=function(e,t,i,r){return!1},t}(o.BaseCharAtlas);function v(e,t){for(var i=!0,r=t.rgba>>>24,n=t.rgba>>>16&255,s=t.rgba>>>8&255,o=0;o<e.data.length;o+=4)e.data[o]===r&&e.data[o+1]===n&&e.data[o+2]===s?e.data[o+3]=0:i=!1;return i}t.NoneCharAtlas=_},7001:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LRUMap=void 0;var i=function(){function e(e){this.capacity=e,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return e.prototype._unlinkNode=function(e){var t=e.prev,i=e.next;e===this._head&&(this._head=i),e===this._tail&&(this._tail=t),null!==t&&(t.next=i),null!==i&&(i.prev=t)},e.prototype._appendNode=function(e){var t=this._tail;null!==t&&(t.next=e),e.prev=t,e.next=null,this._tail=e,null===this._head&&(this._head=e)},e.prototype.prealloc=function(e){for(var t=this._nodePool,i=0;i<e;i++)t.push({prev:null,next:null,key:null,value:null})},e.prototype.get=function(e){var t=this._map[e];return void 0!==t?(this._unlinkNode(t),this._appendNode(t),t.value):null},e.prototype.peekValue=function(e){var t=this._map[e];return void 0!==t?t.value:null},e.prototype.peek=function(){var e=this._head;return null===e?null:e.value},e.prototype.set=function(e,t){var i=this._map[e];if(void 0!==i)i=this._map[e],this._unlinkNode(i),i.value=t;else if(this.size>=this.capacity)i=this._head,this._unlinkNode(i),delete this._map[i.key],i.key=e,i.value=t,this._map[e]=i;else{var r=this._nodePool;r.length>0?((i=r.pop()).key=e,i.value=t):i={prev:null,next:null,key:e,value:t},this._map[e]=i,this.size++}this._appendNode(i)},e}();t.LRUMap=i},1296:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;var a=i(3787),l=i(8803),h=i(844),c=i(4725),u=i(2585),f=i(8460),d=i(4774),p=i(9631),g="xterm-dom-renderer-owner-",m="xterm-fg-",_="xterm-bg-",v="xterm-focus",y=1,b=function(e){function t(t,i,r,n,s,o,l,h,c,u){var f=e.call(this)||this;return f._colors=t,f._element=i,f._screenElement=r,f._viewportElement=n,f._linkifier=s,f._linkifier2=o,f._charSizeService=h,f._optionsService=c,f._bufferService=u,f._terminalClass=y++,f._rowElements=[],f._rowContainer=document.createElement("div"),f._rowContainer.classList.add("xterm-rows"),f._rowContainer.style.lineHeight="normal",f._rowContainer.setAttribute("aria-hidden","true"),f._refreshRowElements(f._bufferService.cols,f._bufferService.rows),f._selectionContainer=document.createElement("div"),f._selectionContainer.classList.add("xterm-selection"),f._selectionContainer.setAttribute("aria-hidden","true"),f.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},f._updateDimensions(),f._injectCss(),f._rowFactory=l.createInstance(a.DomRendererRowFactory,document,f._colors),f._element.classList.add(g+f._terminalClass),f._screenElement.appendChild(f._rowContainer),f._screenElement.appendChild(f._selectionContainer),f._linkifier.onShowLinkUnderline((function(e){return f._onLinkHover(e)})),f._linkifier.onHideLinkUnderline((function(e){return f._onLinkLeave(e)})),f._linkifier2.onShowLinkUnderline((function(e){return f._onLinkHover(e)})),f._linkifier2.onHideLinkUnderline((function(e){return f._onLinkLeave(e)})),f}return n(t,e),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return(new f.EventEmitter).event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._element.classList.remove(g+this._terminalClass),(0,p.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement),e.prototype.dispose.call(this)},t.prototype._updateDimensions=function(){this.dimensions.scaledCharWidth=this._charSizeService.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.options.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.options.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._bufferService.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._bufferService.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows;for(var e=0,t=this._rowElements;e<t.length;e++){var i=t[e];i.style.width=this.dimensions.canvasWidth+"px",i.style.height=this.dimensions.actualCellHeight+"px",i.style.lineHeight=this.dimensions.actualCellHeight+"px",i.style.overflow="hidden"}this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var r=this._terminalSelector+" .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.textContent=r,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.setColors=function(e){this._colors=e,this._injectCss()},t.prototype._injectCss=function(){var e=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var t=this._terminalSelector+" .xterm-rows { color: "+this._colors.foreground.css+"; font-family: "+this._optionsService.options.fontFamily+"; font-size: "+this._optionsService.options.fontSize+"px;}";t+=this._terminalSelector+" span:not(."+a.BOLD_CLASS+") { font-weight: "+this._optionsService.options.fontWeight+";}"+this._terminalSelector+" span."+a.BOLD_CLASS+" { font-weight: "+this._optionsService.options.fontWeightBold+";}"+this._terminalSelector+" span."+a.ITALIC_CLASS+" { font-style: italic;}",t+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",t+="@keyframes blink_block_"+this._terminalClass+" { 0% {  background-color: "+this._colors.cursor.css+";  color: "+this._colors.cursorAccent.css+"; } 50% {  background-color: "+this._colors.cursorAccent.css+";  color: "+this._colors.cursor.css+"; }}",t+=this._terminalSelector+" .xterm-rows:not(.xterm-focus) ."+a.CURSOR_CLASS+"."+a.CURSOR_STYLE_BLOCK_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+a.CURSOR_CLASS+"."+a.CURSOR_BLINK_CLASS+":not(."+a.CURSOR_STYLE_BLOCK_CLASS+") { animation: blink_box_shadow_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+a.CURSOR_CLASS+"."+a.CURSOR_BLINK_CLASS+"."+a.CURSOR_STYLE_BLOCK_CLASS+" { animation: blink_block_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+a.CURSOR_CLASS+"."+a.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" .xterm-rows ."+a.CURSOR_CLASS+"."+a.CURSOR_STYLE_BAR_CLASS+" { box-shadow: "+this._optionsService.options.cursorWidth+"px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" .xterm-rows ."+a.CURSOR_CLASS+"."+a.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",t+=this._terminalSelector+" .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" .xterm-selection div { position: absolute; background-color: "+this._colors.selectionTransparent.css+";}",this._colors.ansi.forEach((function(i,r){t+=e._terminalSelector+" ."+m+r+" { color: "+i.css+"; }"+e._terminalSelector+" ."+_+r+" { background-color: "+i.css+"; }"})),t+=this._terminalSelector+" ."+m+l.INVERTED_DEFAULT_COLOR+" { color: "+d.color.opaque(this._colors.background).css+"; }"+this._terminalSelector+" ."+_+l.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.textContent=t},t.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},t.prototype._refreshRowElements=function(e,t){for(var i=this._rowElements.length;i<=t;i++){var r=document.createElement("div");this._rowContainer.appendChild(r),this._rowElements.push(r)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())},t.prototype.onResize=function(e,t){this._refreshRowElements(e,t),this._updateDimensions()},t.prototype.onCharSizeChanged=function(){this._updateDimensions()},t.prototype.onBlur=function(){this._rowContainer.classList.remove(v)},t.prototype.onFocus=function(){this._rowContainer.classList.add(v)},t.prototype.onSelectionChanged=function(e,t,i){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(e&&t){var r=e[1]-this._bufferService.buffer.ydisp,n=t[1]-this._bufferService.buffer.ydisp,s=Math.max(r,0),o=Math.min(n,this._bufferService.rows-1);if(!(s>=this._bufferService.rows||o<0)){var a=document.createDocumentFragment();if(i)a.appendChild(this._createSelectionElement(s,e[0],t[0],o-s+1));else{var l=r===s?e[0]:0,h=s===n?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(s,l,h));var c=o-s-1;if(a.appendChild(this._createSelectionElement(s+1,0,this._bufferService.cols,c)),s!==o){var u=n===o?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,0,u))}}this._selectionContainer.appendChild(a)}}},t.prototype._createSelectionElement=function(e,t,i,r){void 0===r&&(r=1);var n=document.createElement("div");return n.style.height=r*this.dimensions.actualCellHeight+"px",n.style.top=e*this.dimensions.actualCellHeight+"px",n.style.left=t*this.dimensions.actualCellWidth+"px",n.style.width=this.dimensions.actualCellWidth*(i-t)+"px",n},t.prototype.onCursorMove=function(){},t.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss()},t.prototype.clear=function(){for(var e=0,t=this._rowElements;e<t.length;e++)t[e].innerText=""},t.prototype.renderRows=function(e,t){for(var i=this._bufferService.buffer.ybase+this._bufferService.buffer.y,r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),n=this._optionsService.options.cursorBlink,s=e;s<=t;s++){var o=this._rowElements[s];o.innerText="";var a=s+this._bufferService.buffer.ydisp,l=this._bufferService.buffer.lines.get(a),h=this._optionsService.options.cursorStyle;o.appendChild(this._rowFactory.createRow(l,a,a===i,h,r,n,this.dimensions.actualCellWidth,this._bufferService.cols))}},Object.defineProperty(t.prototype,"_terminalSelector",{get:function(){return"."+g+this._terminalClass},enumerable:!1,configurable:!0}),t.prototype._onLinkHover=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)},t.prototype._onLinkLeave=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)},t.prototype._setCellUnderline=function(e,t,i,r,n,s){for(;e!==t||i!==r;){var o=this._rowElements[i];if(!o)return;var a=o.children[e];a&&(a.style.textDecoration=s?"underline":"none"),++e>=n&&(e=0,i++)}},s([o(6,u.IInstantiationService),o(7,c.ICharSizeService),o(8,u.IOptionsService),o(9,u.IBufferService)],t)}(h.Disposable);t.DomRenderer=b},3787:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;var s=i(8803),o=i(643),a=i(511),l=i(2585),h=i(4774),c=i(4725),u=i(4269);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var f=function(){function e(e,t,i,r,n){this._document=e,this._colors=t,this._characterJoinerService=i,this._optionsService=r,this._coreService=n,this._workCell=new a.CellData}return e.prototype.setColors=function(e){this._colors=e},e.prototype.createRow=function(e,i,r,n,a,l,c,f){for(var p=this._document.createDocumentFragment(),g=this._characterJoinerService.getJoinedCharacters(i),m=0,_=Math.min(e.length,f)-1;_>=0;_--)if(e.loadCell(_,this._workCell).getCode()!==o.NULL_CELL_CODE||r&&_===a){m=_+1;break}for(_=0;_<m;_++){e.loadCell(_,this._workCell);var v=this._workCell.getWidth();if(0!==v){var y=!1,b=_,O=this._workCell;if(g.length>0&&_===g[0][0]){y=!0;var w=g.shift();O=new u.JoinedCellData(this._workCell,e.translateToString(!0,w[0],w[1]),w[1]-w[0]),b=w[1]-1,v=O.getWidth()}var S=this._document.createElement("span");if(v>1&&(S.style.width=c*v+"px"),y&&(S.style.display="inline",a>=_&&a<=b&&(a=_)),!this._coreService.isCursorHidden&&r&&_===a)switch(S.classList.add(t.CURSOR_CLASS),l&&S.classList.add(t.CURSOR_BLINK_CLASS),n){case"bar":S.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":S.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:S.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}O.isBold()&&S.classList.add(t.BOLD_CLASS),O.isItalic()&&S.classList.add(t.ITALIC_CLASS),O.isDim()&&S.classList.add(t.DIM_CLASS),O.isUnderline()&&S.classList.add(t.UNDERLINE_CLASS),O.isInvisible()?S.textContent=o.WHITESPACE_CELL_CHAR:S.textContent=O.getChars()||o.WHITESPACE_CELL_CHAR,O.isStrikethrough()&&S.classList.add(t.STRIKETHROUGH_CLASS);var C=O.getFgColor(),k=O.getFgColorMode(),x=O.getBgColor(),E=O.getBgColorMode(),A=!!O.isInverse();if(A){var T=C;C=x,x=T;var P=k;k=E,E=P}switch(k){case 16777216:case 33554432:O.isBold()&&C<8&&this._optionsService.options.drawBoldTextInBrightColors&&(C+=8),this._applyMinimumContrast(S,this._colors.background,this._colors.ansi[C])||S.classList.add("xterm-fg-"+C);break;case 50331648:var L=h.rgba.toColor(C>>16&255,C>>8&255,255&C);this._applyMinimumContrast(S,this._colors.background,L)||this._addStyle(S,"color:#"+d(C.toString(16),"0",6));break;default:this._applyMinimumContrast(S,this._colors.background,this._colors.foreground)||A&&S.classList.add("xterm-fg-"+s.INVERTED_DEFAULT_COLOR)}switch(E){case 16777216:case 33554432:S.classList.add("xterm-bg-"+x);break;case 50331648:this._addStyle(S,"background-color:#"+d(x.toString(16),"0",6));break;default:A&&S.classList.add("xterm-bg-"+s.INVERTED_DEFAULT_COLOR)}p.appendChild(S),_=b}}return p},e.prototype._applyMinimumContrast=function(e,t,i){if(1===this._optionsService.options.minimumContrastRatio)return!1;var r=this._colors.contrastCache.getColor(this._workCell.bg,this._workCell.fg);return void 0===r&&(r=h.color.ensureContrastRatio(t,i,this._optionsService.options.minimumContrastRatio),this._colors.contrastCache.setColor(this._workCell.bg,this._workCell.fg,null!=r?r:null)),!!r&&(this._addStyle(e,"color:"+r.css),!0)},e.prototype._addStyle=function(e,t){e.setAttribute("style",""+(e.getAttribute("style")||"")+t+";")},r([n(2,c.ICharacterJoinerService),n(3,l.IOptionsService),n(4,l.ICoreService)],e)}();function d(e,t,i){for(;e.length<i;)e=t+e;return e}t.DomRendererRowFactory=f},456:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0;var i=function(){function e(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}return e.prototype.clearSelection=function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(e.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){var e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd}},enumerable:!1,configurable:!0}),e.prototype.areSelectionValuesReversed=function(){var e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])},e.prototype.onTrim=function(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},e}();t.SelectionModel=i},428:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;var s=i(2585),o=i(8460),a=function(){function e(e,t,i){this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=new o.EventEmitter,this._measureStrategy=new l(e,t,this._optionsService)}return Object.defineProperty(e.prototype,"hasValidSize",{get:function(){return this.width>0&&this.height>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCharSizeChange",{get:function(){return this._onCharSizeChange.event},enumerable:!1,configurable:!0}),e.prototype.measure=function(){var e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())},r([n(2,s.IOptionsService)],e)}();t.CharSizeService=a;var l=function(){function e(e,t,i){this._document=e,this._parentElement=t,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return e.prototype.measure=function(){this._measureElement.style.fontFamily=this._optionsService.options.fontFamily,this._measureElement.style.fontSize=this._optionsService.options.fontSize+"px";var e=this._measureElement.getBoundingClientRect();return 0!==e.width&&0!==e.height&&(this._result.width=e.width,this._result.height=Math.ceil(e.height)),this._result},e}()},4269:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;var a=i(3734),l=i(643),h=i(511),c=i(2585),u=function(e){function t(t,i,r){var n=e.call(this)||this;return n.content=0,n.combinedData="",n.fg=t.fg,n.bg=t.bg,n.combinedData=i,n._width=r,n}return n(t,e),t.prototype.isCombined=function(){return 2097152},t.prototype.getWidth=function(){return this._width},t.prototype.getChars=function(){return this.combinedData},t.prototype.getCode=function(){return 2097151},t.prototype.setFromCharData=function(e){throw new Error("not implemented")},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(a.AttributeData);t.JoinedCellData=u;var f=function(){function e(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new h.CellData}return e.prototype.register=function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id},e.prototype.deregister=function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1},e.prototype.getJoinedCharacters=function(e){if(0===this._characterJoiners.length)return[];var t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];for(var i=[],r=t.translateToString(!0),n=0,s=0,o=0,a=t.getFg(0),h=t.getBg(0),c=0;c<t.getTrimmedLength();c++)if(t.loadCell(c,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==a||this._workCell.bg!==h){if(c-n>1)for(var u=this._getJoinedRanges(r,o,s,t,n),f=0;f<u.length;f++)i.push(u[f]);n=c,o=s,a=this._workCell.fg,h=this._workCell.bg}s+=this._workCell.getChars().length||l.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-n>1)for(u=this._getJoinedRanges(r,o,s,t,n),f=0;f<u.length;f++)i.push(u[f]);return i},e.prototype._getJoinedRanges=function(t,i,r,n,s){for(var o=t.substring(i,r),a=this._characterJoiners[0].handler(o),l=1;l<this._characterJoiners.length;l++)for(var h=this._characterJoiners[l].handler(o),c=0;c<h.length;c++)e._mergeRanges(a,h[c]);return this._stringRangesToCellRanges(a,n,s),a},e.prototype._stringRangesToCellRanges=function(e,t,i){var r=0,n=!1,s=0,o=e[r];if(o){for(var a=i;a<this._bufferService.cols;a++){var h=t.getWidth(a),c=t.getString(a).length||l.WHITESPACE_CELL_CHAR.length;if(0!==h){if(!n&&o[0]<=s&&(o[0]=a,n=!0),o[1]<=s){if(o[1]=a,!(o=e[++r]))break;o[0]<=s?(o[0]=a,n=!0):n=!1}s+=c}}o&&(o[1]=this._bufferService.cols)}},e._mergeRanges=function(e,t){for(var i=!1,r=0;r<e.length;r++){var n=e[r];if(i){if(t[1]<=n[0])return e[r-1][1]=t[1],e;if(t[1]<=n[1])return e[r-1][1]=Math.max(t[1],n[1]),e.splice(r,1),e;e.splice(r,1),r--}else{if(t[1]<=n[0])return e.splice(r,0,t),e;if(t[1]<=n[1])return n[0]=Math.min(t[0],n[0]),e;t[0]<n[1]&&(n[0]=Math.min(t[0],n[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e},e=s([o(0,c.IBufferService)],e)}();t.CharacterJoinerService=f},5114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;var i=function(){function e(e){this._textarea=e}return Object.defineProperty(e.prototype,"isFocused",{get:function(){return(this._textarea.getRootNode?this._textarea.getRootNode():document).activeElement===this._textarea&&document.hasFocus()},enumerable:!1,configurable:!0}),e}();t.CoreBrowserService=i},8934:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;var s=i(4725),o=i(9806),a=function(){function e(e,t){this._renderService=e,this._charSizeService=t}return e.prototype.getCoords=function(e,t,i,r,n){return(0,o.getCoords)(e,t,i,r,this._charSizeService.hasValidSize,this._renderService.dimensions.actualCellWidth,this._renderService.dimensions.actualCellHeight,n)},e.prototype.getRawByteCoords=function(e,t,i,r){var n=this.getCoords(e,t,i,r);return(0,o.getRawByteCoords)(n)},r([n(0,s.IRenderService),n(1,s.ICharSizeService)],e)}();t.MouseService=a},3230:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;var a=i(6193),l=i(8460),h=i(844),c=i(5596),u=i(3656),f=i(2585),d=i(4725),p=function(e){function t(t,i,r,n,s,o){var h=e.call(this)||this;if(h._renderer=t,h._rowCount=i,h._charSizeService=s,h._isPaused=!1,h._needsFullRefresh=!1,h._isNextRenderRedrawOnly=!0,h._needsSelectionRefresh=!1,h._canvasWidth=0,h._canvasHeight=0,h._selectionState={start:void 0,end:void 0,columnSelectMode:!1},h._onDimensionsChange=new l.EventEmitter,h._onRender=new l.EventEmitter,h._onRefreshRequest=new l.EventEmitter,h.register({dispose:function(){return h._renderer.dispose()}}),h._renderDebouncer=new a.RenderDebouncer((function(e,t){return h._renderRows(e,t)})),h.register(h._renderDebouncer),h._screenDprMonitor=new c.ScreenDprMonitor,h._screenDprMonitor.setListener((function(){return h.onDevicePixelRatioChange()})),h.register(h._screenDprMonitor),h.register(o.onResize((function(e){return h._fullRefresh()}))),h.register(n.onOptionChange((function(){return h._renderer.onOptionsChanged()}))),h.register(h._charSizeService.onCharSizeChange((function(){return h.onCharSizeChanged()}))),h._renderer.onRequestRedraw((function(e){return h.refreshRows(e.start,e.end,!0)})),h.register((0,u.addDisposableDomListener)(window,"resize",(function(){return h.onDevicePixelRatioChange()}))),"IntersectionObserver"in window){var f=new IntersectionObserver((function(e){return h._onIntersectionChange(e[e.length-1])}),{threshold:0});f.observe(r),h.register({dispose:function(){return f.disconnect()}})}return h}return n(t,e),Object.defineProperty(t.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRenderedBufferChange",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!1,configurable:!0}),t.prototype._onIntersectionChange=function(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},t.prototype.refreshRows=function(e,t,i){void 0===i&&(i=!1),this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))},t.prototype._renderRows=function(e,t){this._renderer.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.onSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0},t.prototype.resize=function(e,t){this._rowCount=t,this._fireOnCanvasResize()},t.prototype.changeOptions=function(){this._renderer.onOptionsChanged(),this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize()},t.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.setRenderer=function(e){var t=this;this._renderer.dispose(),this._renderer=e,this._renderer.onRequestRedraw((function(e){return t.refreshRows(e.start,e.end,!0)})),this._needsSelectionRefresh=!0,this._fullRefresh()},t.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)},t.prototype.clearTextureAtlas=function(){var e,t;null===(t=null===(e=this._renderer)||void 0===e?void 0:e.clearTextureAtlas)||void 0===t||t.call(e),this._fullRefresh()},t.prototype.setColors=function(e){this._renderer.setColors(e),this._fullRefresh()},t.prototype.onDevicePixelRatioChange=function(){this._charSizeService.measure(),this._renderer.onDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1)},t.prototype.onResize=function(e,t){this._renderer.onResize(e,t),this._fullRefresh()},t.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},t.prototype.onBlur=function(){this._renderer.onBlur()},t.prototype.onFocus=function(){this._renderer.onFocus()},t.prototype.onSelectionChanged=function(e,t,i){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,this._renderer.onSelectionChanged(e,t,i)},t.prototype.onCursorMove=function(){this._renderer.onCursorMove()},t.prototype.clear=function(){this._renderer.clear()},s([o(3,f.IOptionsService),o(4,d.ICharSizeService),o(5,f.IBufferService)],t)}(h.Disposable);t.RenderService=p},9312:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;var a=i(6114),l=i(456),h=i(511),c=i(8460),u=i(4725),f=i(2585),d=i(9806),p=i(9504),g=i(844),m=i(4841),_=String.fromCharCode(160),v=new RegExp(_,"g"),y=function(e){function t(t,i,r,n,s,o,a,u){var f=e.call(this)||this;return f._element=t,f._screenElement=i,f._linkifier=r,f._bufferService=n,f._coreService=s,f._mouseService=o,f._optionsService=a,f._renderService=u,f._dragScrollAmount=0,f._enabled=!0,f._workCell=new h.CellData,f._mouseDownTimeStamp=0,f._oldHasSelection=!1,f._oldSelectionStart=void 0,f._oldSelectionEnd=void 0,f._onLinuxMouseSelection=f.register(new c.EventEmitter),f._onRedrawRequest=f.register(new c.EventEmitter),f._onSelectionChange=f.register(new c.EventEmitter),f._onRequestScrollLines=f.register(new c.EventEmitter),f._mouseMoveListener=function(e){return f._onMouseMove(e)},f._mouseUpListener=function(e){return f._onMouseUp(e)},f._coreService.onUserInput((function(){f.hasSelection&&f.clearSelection()})),f._trimListener=f._bufferService.buffer.lines.onTrim((function(e){return f._onTrim(e)})),f.register(f._bufferService.buffers.onBufferActivate((function(e){return f._onBufferActivate(e)}))),f.enable(),f._model=new l.SelectionModel(f._bufferService),f._activeSelectionMode=0,f}return n(t,e),Object.defineProperty(t.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRedrawRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestScrollLines",{get:function(){return this._onRequestScrollLines.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._removeMouseDownListeners()},t.prototype.reset=function(){this.clearSelection()},t.prototype.disable=function(){this.clearSelection(),this._enabled=!1},t.prototype.enable=function(){this._enabled=!0},Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSelection",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionText",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";var i=this._bufferService.buffer,r=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";for(var n=e[1];n<=t[1];n++){var s=i.translateBufferLineToString(n,!0,e[0],t[0]);r.push(s)}}else{var o=e[1]===t[1]?t[0]:void 0;for(r.push(i.translateBufferLineToString(e[1],!0,e[0],o)),n=e[1]+1;n<=t[1]-1;n++){var l=i.lines.get(n);s=i.translateBufferLineToString(n,!0),l&&l.isWrapped?r[r.length-1]+=s:r.push(s)}e[1]!==t[1]&&(l=i.lines.get(t[1]),s=i.translateBufferLineToString(t[1],!0,0,t[0]),l&&l.isWrapped?r[r.length-1]+=s:r.push(s))}return r.map((function(e){return e.replace(v," ")})).join(a.isWindows?"\r\n":"\n")},enumerable:!1,configurable:!0}),t.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},t.prototype.refresh=function(e){var t=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame((function(){return t._refresh()}))),a.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},t.prototype._refresh=function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})},t.prototype._isClickInSelection=function(e){var t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!!(i&&r&&t)&&this._areCoordsInSelection(t,i,r)},t.prototype._areCoordsInSelection=function(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]},t.prototype._selectWordAtCursor=function(e,t){var i,r,n=null===(r=null===(i=this._linkifier.currentLink)||void 0===i?void 0:i.link)||void 0===r?void 0:r.range;if(n)return this._model.selectionStart=[n.start.x-1,n.start.y-1],this._model.selectionStartLength=(0,m.getRangeLength)(n,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var s=this._getMouseBufferCoords(e);return!!s&&(this._selectWordAt(s,t),this._model.selectionEnd=void 0,!0)},t.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},t.prototype.selectLines=function(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()},t.prototype._onTrim=function(e){this._model.onTrim(e)&&this.refresh()},t.prototype._getMouseBufferCoords=function(e){var t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t},t.prototype._getMouseEventScrollAmount=function(e){var t=(0,d.getCoordsRelativeToElement)(e,this._screenElement)[1],i=this._renderService.dimensions.canvasHeight;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-50),50),(t/=50)/Math.abs(t)+Math.round(14*t))},t.prototype.shouldForceSelection=function(e){return a.isMac?e.altKey&&this._optionsService.options.macOptionClickForcesSelection:e.shiftKey},t.prototype.onMouseDown=function(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._onIncrementalClick(e):1===e.detail?this._onSingleClick(e):2===e.detail?this._onDoubleClick(e):3===e.detail&&this._onTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}},t.prototype._addMouseDownListeners=function(){var e=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=window.setInterval((function(){return e._dragScroll()}),50)},t.prototype._removeMouseDownListeners=function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0},t.prototype._onIncrementalClick=function(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))},t.prototype._onSingleClick=function(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),this._model.selectionStart){this._model.selectionEnd=void 0;var t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}},t.prototype._onDoubleClick=function(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)},t.prototype._onTripleClick=function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))},t.prototype.shouldColumnSelect=function(e){return e.altKey&&!(a.isMac&&this._optionsService.options.macOptionClickForcesSelection)},t.prototype._onMouseMove=function(e){if(e.stopImmediatePropagation(),this._model.selectionStart){var t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),this._model.selectionEnd){2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){var r=i.lines.get(this._model.selectionEnd[1]);r&&0===r.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}},t.prototype._dragScroll=function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}},t.prototype._onMouseUp=function(e){var t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.getOption("altClickMovesCursor")){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var i=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(i&&void 0!==i[0]&&void 0!==i[1]){var r=(0,p.moveToCellSequence)(i[0]-1,i[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(r,!0)}}}else this._fireEventIfSelectionChanged()},t.prototype._fireEventIfSelectionChanged=function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);i?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,i)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,i)},t.prototype._fireOnSelectionChange=function(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()},t.prototype._onBufferActivate=function(e){var t=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim((function(e){return t._onTrim(e)}))},t.prototype._convertViewportColToCharacterIndex=function(e,t){for(var i=t[0],r=0;t[0]>=r;r++){var n=e.loadCell(r,this._workCell).getChars().length;0===this._workCell.getWidth()?i--:n>1&&t[0]!==r&&(i+=n-1)}return i},t.prototype.setSelection=function(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh()},t.prototype.rightClickSelect=function(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())},t.prototype._getWordAt=function(e,t,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),!(e[0]>=this._bufferService.cols)){var n=this._bufferService.buffer,s=n.lines.get(e[1]);if(s){var o=n.translateBufferLineToString(e[1],!1),a=this._convertViewportColToCharacterIndex(s,e),l=a,h=e[0]-a,c=0,u=0,f=0,d=0;if(" "===o.charAt(a)){for(;a>0&&" "===o.charAt(a-1);)a--;for(;l<o.length&&" "===o.charAt(l+1);)l++}else{var p=e[0],g=e[0];0===s.getWidth(p)&&(c++,p--),2===s.getWidth(g)&&(u++,g++);var m=s.getString(g).length;for(m>1&&(d+=m-1,l+=m-1);p>0&&a>0&&!this._isCharWordSeparator(s.loadCell(p-1,this._workCell));){s.loadCell(p-1,this._workCell);var _=this._workCell.getChars().length;0===this._workCell.getWidth()?(c++,p--):_>1&&(f+=_-1,a-=_-1),a--,p--}for(;g<s.length&&l+1<o.length&&!this._isCharWordSeparator(s.loadCell(g+1,this._workCell));){s.loadCell(g+1,this._workCell);var v=this._workCell.getChars().length;2===this._workCell.getWidth()?(u++,g++):v>1&&(d+=v-1,l+=v-1),l++,g++}}l++;var y=a+h-c+f,b=Math.min(this._bufferService.cols,l-a+c+u-f-d);if(t||""!==o.slice(a,l).trim()){if(i&&0===y&&32!==s.getCodePoint(0)){var O=n.lines.get(e[1]-1);if(O&&s.isWrapped&&32!==O.getCodePoint(this._bufferService.cols-1)){var w=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(w){var S=this._bufferService.cols-w.start;y-=S,b+=S}}}if(r&&y+b===this._bufferService.cols&&32!==s.getCodePoint(this._bufferService.cols-1)){var C=n.lines.get(e[1]+1);if(C&&C.isWrapped&&32!==C.getCodePoint(0)){var k=this._getWordAt([0,e[1]+1],!1,!1,!0);k&&(b+=k.length)}}return{start:y,length:b}}}}},t.prototype._selectWordAt=function(e,t){var i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}},t.prototype._selectToWordAt=function(e){var t=this._getWordAt(e,!0);if(t){for(var i=e[1];t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}},t.prototype._isCharWordSeparator=function(e){return 0!==e.getWidth()&&this._optionsService.options.wordSeparator.indexOf(e.getChars())>=0},t.prototype._selectLineAt=function(e){var t=this._bufferService.buffer.getWrappedRangeForLine(e);this._model.selectionStart=[0,t.first],this._model.selectionEnd=[this._bufferService.cols,t.last],this._model.selectionStartLength=0},s([o(3,f.IBufferService),o(4,f.ICoreService),o(5,u.IMouseService),o(6,f.IOptionsService),o(7,u.IRenderService)],t)}(g.Disposable);t.SelectionService=y},4725:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ICharacterJoinerService=t.ISoundService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;var r=i(8343);t.ICharSizeService=(0,r.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,r.createDecorator)("CoreBrowserService"),t.IMouseService=(0,r.createDecorator)("MouseService"),t.IRenderService=(0,r.createDecorator)("RenderService"),t.ISelectionService=(0,r.createDecorator)("SelectionService"),t.ISoundService=(0,r.createDecorator)("SoundService"),t.ICharacterJoinerService=(0,r.createDecorator)("CharacterJoinerService")},357:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SoundService=void 0;var s=i(2585),o=function(){function e(e){this._optionsService=e}return Object.defineProperty(e,"audioContext",{get:function(){if(!e._audioContext){var t=window.AudioContext||window.webkitAudioContext;if(!t)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;e._audioContext=new t}return e._audioContext},enumerable:!1,configurable:!0}),e.prototype.playBellSound=function(){var t=e.audioContext;if(t){var i=t.createBufferSource();t.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._optionsService.options.bellSound)),(function(e){i.buffer=e,i.connect(t.destination),i.start(0)}))}},e.prototype._base64ToArrayBuffer=function(e){for(var t=window.atob(e),i=t.length,r=new Uint8Array(i),n=0;n<i;n++)r[n]=t.charCodeAt(n);return r.buffer},e.prototype._removeMimeType=function(e){return e.split(",")[1]},e=r([n(0,s.IOptionsService)],e)}();t.SoundService=o},6349:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;var r=i(8460),n=function(){function e(e){this._maxLength=e,this.onDeleteEmitter=new r.EventEmitter,this.onInsertEmitter=new r.EventEmitter,this.onTrimEmitter=new r.EventEmitter,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(e.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this._maxLength},set:function(e){if(this._maxLength!==e){for(var t=new Array(e),i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(e){if(e>this._length)for(var t=this._length;t<e;t++)this._array[t]=void 0;this._length=e},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this._array[this._getCyclicIndex(e)]},e.prototype.set=function(e,t){this._array[this._getCyclicIndex(e)]=t},e.prototype.push=function(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},e.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!1,configurable:!0}),e.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},e.prototype.splice=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(t){for(var n=e;n<this._length-t;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(n=this._length-1;n>=e;n--)this._array[this._getCyclicIndex(n+i.length)]=this._array[this._getCyclicIndex(n)];for(n=0;n<i.length;n++)this._array[this._getCyclicIndex(e+n)]=i[n];if(i.length&&this.onInsertEmitter.fire({index:e,amount:i.length}),this._length+i.length>this._maxLength){var s=this._length+i.length-this._maxLength;this._startIndex+=s,this._length=this._maxLength,this.onTrimEmitter.fire(s)}else this._length+=i.length},e.prototype.trimStart=function(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)},e.prototype.shiftElements=function(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(var r=t-1;r>=0;r--)this.set(e+r+i,this.get(e+r));var n=e+t+i-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(r=0;r<t;r++)this.set(e+r+i,this.get(e+r))}},e.prototype._getCyclicIndex=function(e){return(this._startIndex+e)%this._maxLength},e}();t.CircularList=n},1439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t,i){if(void 0===i&&(i=5),"object"!=typeof t)return t;var r=Array.isArray(t)?[]:{};for(var n in t)r[n]=i<=1?t[n]:t[n]&&e(t[n],i-1);return r}},8969:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;var s=i(844),o=i(2585),a=i(4348),l=i(7866),h=i(744),c=i(7302),u=i(6975),f=i(8460),d=i(1753),p=i(3730),g=i(1480),m=i(7994),_=i(9282),v=i(5435),y=i(5981),b=!1,O=function(e){function t(t){var i=e.call(this)||this;return i._onBinary=new f.EventEmitter,i._onData=new f.EventEmitter,i._onLineFeed=new f.EventEmitter,i._onResize=new f.EventEmitter,i._onScroll=new f.EventEmitter,i._instantiationService=new a.InstantiationService,i.optionsService=new c.OptionsService(t),i._instantiationService.setService(o.IOptionsService,i.optionsService),i._bufferService=i.register(i._instantiationService.createInstance(h.BufferService)),i._instantiationService.setService(o.IBufferService,i._bufferService),i._logService=i._instantiationService.createInstance(l.LogService),i._instantiationService.setService(o.ILogService,i._logService),i.coreService=i.register(i._instantiationService.createInstance(u.CoreService,(function(){return i.scrollToBottom()}))),i._instantiationService.setService(o.ICoreService,i.coreService),i.coreMouseService=i._instantiationService.createInstance(d.CoreMouseService),i._instantiationService.setService(o.ICoreMouseService,i.coreMouseService),i._dirtyRowService=i._instantiationService.createInstance(p.DirtyRowService),i._instantiationService.setService(o.IDirtyRowService,i._dirtyRowService),i.unicodeService=i._instantiationService.createInstance(g.UnicodeService),i._instantiationService.setService(o.IUnicodeService,i.unicodeService),i._charsetService=i._instantiationService.createInstance(m.CharsetService),i._instantiationService.setService(o.ICharsetService,i._charsetService),i._inputHandler=new v.InputHandler(i._bufferService,i._charsetService,i.coreService,i._dirtyRowService,i._logService,i.optionsService,i.coreMouseService,i.unicodeService),i.register((0,f.forwardEvent)(i._inputHandler.onLineFeed,i._onLineFeed)),i.register(i._inputHandler),i.register((0,f.forwardEvent)(i._bufferService.onResize,i._onResize)),i.register((0,f.forwardEvent)(i.coreService.onData,i._onData)),i.register((0,f.forwardEvent)(i.coreService.onBinary,i._onBinary)),i.register(i.optionsService.onOptionChange((function(e){return i._updateOptions(e)}))),i.register(i._bufferService.onScroll((function(e){i._onScroll.fire({position:i._bufferService.buffer.ydisp,source:0}),i._dirtyRowService.markRangeDirty(i._bufferService.buffer.scrollTop,i._bufferService.buffer.scrollBottom)}))),i.register(i._inputHandler.onScroll((function(e){i._onScroll.fire({position:i._bufferService.buffer.ydisp,source:0}),i._dirtyRowService.markRangeDirty(i._bufferService.buffer.scrollTop,i._bufferService.buffer.scrollBottom)}))),i._writeBuffer=new y.WriteBuffer((function(e,t){return i._inputHandler.parse(e,t)})),i}return n(t,e),Object.defineProperty(t.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){var e=this;return this._onScrollApi||(this._onScrollApi=new f.EventEmitter,this.register(this._onScroll.event((function(t){var i;null===(i=e._onScrollApi)||void 0===i||i.fire(t.position)})))),this._onScrollApi.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cols",{get:function(){return this._bufferService.cols},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._bufferService.rows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buffers",{get:function(){return this._bufferService.buffers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.optionsService.publicOptions},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var t;this._isDisposed||(e.prototype.dispose.call(this),null===(t=this._windowsMode)||void 0===t||t.dispose(),this._windowsMode=void 0)},t.prototype.write=function(e,t){this._writeBuffer.write(e,t)},t.prototype.writeSync=function(e,t){this._logService.logLevel<=o.LogLevelEnum.WARN&&!b&&(this._logService.warn("writeSync is unreliable and will be removed soon."),b=!0),this._writeBuffer.writeSync(e,t)},t.prototype.resize=function(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,h.MINIMUM_COLS),t=Math.max(t,h.MINIMUM_ROWS),this._bufferService.resize(e,t))},t.prototype.scroll=function(e,t){void 0===t&&(t=!1),this._bufferService.scroll(e,t)},t.prototype.scrollLines=function(e,t,i){this._bufferService.scrollLines(e,t,i)},t.prototype.scrollPages=function(e){this._bufferService.scrollPages(e)},t.prototype.scrollToTop=function(){this._bufferService.scrollToTop()},t.prototype.scrollToBottom=function(){this._bufferService.scrollToBottom()},t.prototype.scrollToLine=function(e){this._bufferService.scrollToLine(e)},t.prototype.registerEscHandler=function(e,t){return this._inputHandler.registerEscHandler(e,t)},t.prototype.registerDcsHandler=function(e,t){return this._inputHandler.registerDcsHandler(e,t)},t.prototype.registerCsiHandler=function(e,t){return this._inputHandler.registerCsiHandler(e,t)},t.prototype.registerOscHandler=function(e,t){return this._inputHandler.registerOscHandler(e,t)},t.prototype._setup=function(){this.optionsService.options.windowsMode&&this._enableWindowsMode()},t.prototype.reset=function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()},t.prototype._updateOptions=function(e){var t;switch(e){case"scrollback":this.buffers.resize(this.cols,this.rows);break;case"windowsMode":this.optionsService.options.windowsMode?this._enableWindowsMode():(null===(t=this._windowsMode)||void 0===t||t.dispose(),this._windowsMode=void 0)}},t.prototype._enableWindowsMode=function(){var e=this;if(!this._windowsMode){var t=[];t.push(this.onLineFeed(_.updateWindowsModeWrappedState.bind(null,this._bufferService))),t.push(this.registerCsiHandler({final:"H"},(function(){return(0,_.updateWindowsModeWrappedState)(e._bufferService),!1}))),this._windowsMode={dispose:function(){for(var e=0,i=t;e<i.length;e++)i[e].dispose()}}}},t}(s.Disposable);t.CoreTerminal=O},8460:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0;var i=function(){function e(){this._listeners=[],this._disposed=!1}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}),this._event},enumerable:!1,configurable:!0}),e.prototype.fire=function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(r=0;r<i.length;r++)i[r].call(void 0,e,t)},e.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},e}();t.EventEmitter=i,t.forwardEvent=function(e,t){return e((function(e){return t.fire(e)}))}},5435:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;var s,o=i(2584),a=i(7116),l=i(2015),h=i(844),c=i(8273),u=i(482),f=i(8437),d=i(8460),p=i(643),g=i(511),m=i(3734),_=i(2585),v=i(6242),y=i(6351),b={"(":0,")":1,"*":2,"+":3,"-":1,".":2},O=131072;function w(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(s=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));var S=function(){function e(e,t,i,r){this._bufferService=e,this._coreService=t,this._logService=i,this._optionsService=r,this._data=new Uint32Array(0)}return e.prototype.hook=function(e){this._data=new Uint32Array(0)},e.prototype.put=function(e,t,i){this._data=(0,c.concat)(this._data,e.subarray(t,i))},e.prototype.unhook=function(e){if(!e)return this._data=new Uint32Array(0),!0;var t=(0,u.utf32ToString)(this._data);switch(this._data=new Uint32Array(0),t){case'"q':this._coreService.triggerDataEvent(o.C0.ESC+'P1$r0"q'+o.C0.ESC+"\\");break;case'"p':this._coreService.triggerDataEvent(o.C0.ESC+'P1$r61;1"p'+o.C0.ESC+"\\");break;case"r":var i=this._bufferService.buffer.scrollTop+1+";"+(this._bufferService.buffer.scrollBottom+1)+"r";this._coreService.triggerDataEvent(o.C0.ESC+"P1$r"+i+o.C0.ESC+"\\");break;case"m":this._coreService.triggerDataEvent(o.C0.ESC+"P1$r0m"+o.C0.ESC+"\\");break;case" q":var r={block:2,underline:4,bar:6}[this._optionsService.options.cursorStyle];r-=this._optionsService.options.cursorBlink?1:0,this._coreService.triggerDataEvent(o.C0.ESC+"P1$r"+r+" q"+o.C0.ESC+"\\");break;default:this._logService.debug("Unknown DCS $q %s",t),this._coreService.triggerDataEvent(o.C0.ESC+"P0$r"+o.C0.ESC+"\\")}return!0},e}(),C=function(e){function t(t,i,r,n,s,h,c,p,m){void 0===m&&(m=new l.EscapeSequenceParser);var _=e.call(this)||this;_._bufferService=t,_._charsetService=i,_._coreService=r,_._dirtyRowService=n,_._logService=s,_._optionsService=h,_._coreMouseService=c,_._unicodeService=p,_._parser=m,_._parseBuffer=new Uint32Array(4096),_._stringDecoder=new u.StringToUtf32,_._utf8Decoder=new u.Utf8ToUtf32,_._workCell=new g.CellData,_._windowTitle="",_._iconName="",_._windowTitleStack=[],_._iconNameStack=[],_._curAttrData=f.DEFAULT_ATTR_DATA.clone(),_._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone(),_._onRequestBell=new d.EventEmitter,_._onRequestRefreshRows=new d.EventEmitter,_._onRequestReset=new d.EventEmitter,_._onRequestSendFocus=new d.EventEmitter,_._onRequestSyncScrollBar=new d.EventEmitter,_._onRequestWindowsOptionsReport=new d.EventEmitter,_._onA11yChar=new d.EventEmitter,_._onA11yTab=new d.EventEmitter,_._onCursorMove=new d.EventEmitter,_._onLineFeed=new d.EventEmitter,_._onScroll=new d.EventEmitter,_._onTitleChange=new d.EventEmitter,_._onAnsiColorChange=new d.EventEmitter,_._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},_.register(_._parser),_._activeBuffer=_._bufferService.buffer,_.register(_._bufferService.buffers.onBufferActivate((function(e){return _._activeBuffer=e.activeBuffer}))),_._parser.setCsiHandlerFallback((function(e,t){_._logService.debug("Unknown CSI code: ",{identifier:_._parser.identToString(e),params:t.toArray()})})),_._parser.setEscHandlerFallback((function(e){_._logService.debug("Unknown ESC code: ",{identifier:_._parser.identToString(e)})})),_._parser.setExecuteHandlerFallback((function(e){_._logService.debug("Unknown EXECUTE code: ",{code:e})})),_._parser.setOscHandlerFallback((function(e,t,i){_._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:i})})),_._parser.setDcsHandlerFallback((function(e,t,i){"HOOK"===t&&(i=i.toArray()),_._logService.debug("Unknown DCS code: ",{identifier:_._parser.identToString(e),action:t,payload:i})})),_._parser.setPrintHandler((function(e,t,i){return _.print(e,t,i)})),_._parser.registerCsiHandler({final:"@"},(function(e){return _.insertChars(e)})),_._parser.registerCsiHandler({intermediates:" ",final:"@"},(function(e){return _.scrollLeft(e)})),_._parser.registerCsiHandler({final:"A"},(function(e){return _.cursorUp(e)})),_._parser.registerCsiHandler({intermediates:" ",final:"A"},(function(e){return _.scrollRight(e)})),_._parser.registerCsiHandler({final:"B"},(function(e){return _.cursorDown(e)})),_._parser.registerCsiHandler({final:"C"},(function(e){return _.cursorForward(e)})),_._parser.registerCsiHandler({final:"D"},(function(e){return _.cursorBackward(e)})),_._parser.registerCsiHandler({final:"E"},(function(e){return _.cursorNextLine(e)})),_._parser.registerCsiHandler({final:"F"},(function(e){return _.cursorPrecedingLine(e)})),_._parser.registerCsiHandler({final:"G"},(function(e){return _.cursorCharAbsolute(e)})),_._parser.registerCsiHandler({final:"H"},(function(e){return _.cursorPosition(e)})),_._parser.registerCsiHandler({final:"I"},(function(e){return _.cursorForwardTab(e)})),_._parser.registerCsiHandler({final:"J"},(function(e){return _.eraseInDisplay(e)})),_._parser.registerCsiHandler({prefix:"?",final:"J"},(function(e){return _.eraseInDisplay(e)})),_._parser.registerCsiHandler({final:"K"},(function(e){return _.eraseInLine(e)})),_._parser.registerCsiHandler({prefix:"?",final:"K"},(function(e){return _.eraseInLine(e)})),_._parser.registerCsiHandler({final:"L"},(function(e){return _.insertLines(e)})),_._parser.registerCsiHandler({final:"M"},(function(e){return _.deleteLines(e)})),_._parser.registerCsiHandler({final:"P"},(function(e){return _.deleteChars(e)})),_._parser.registerCsiHandler({final:"S"},(function(e){return _.scrollUp(e)})),_._parser.registerCsiHandler({final:"T"},(function(e){return _.scrollDown(e)})),_._parser.registerCsiHandler({final:"X"},(function(e){return _.eraseChars(e)})),_._parser.registerCsiHandler({final:"Z"},(function(e){return _.cursorBackwardTab(e)})),_._parser.registerCsiHandler({final:"`"},(function(e){return _.charPosAbsolute(e)})),_._parser.registerCsiHandler({final:"a"},(function(e){return _.hPositionRelative(e)})),_._parser.registerCsiHandler({final:"b"},(function(e){return _.repeatPrecedingCharacter(e)})),_._parser.registerCsiHandler({final:"c"},(function(e){return _.sendDeviceAttributesPrimary(e)})),_._parser.registerCsiHandler({prefix:">",final:"c"},(function(e){return _.sendDeviceAttributesSecondary(e)})),_._parser.registerCsiHandler({final:"d"},(function(e){return _.linePosAbsolute(e)})),_._parser.registerCsiHandler({final:"e"},(function(e){return _.vPositionRelative(e)})),_._parser.registerCsiHandler({final:"f"},(function(e){return _.hVPosition(e)})),_._parser.registerCsiHandler({final:"g"},(function(e){return _.tabClear(e)})),_._parser.registerCsiHandler({final:"h"},(function(e){return _.setMode(e)})),_._parser.registerCsiHandler({prefix:"?",final:"h"},(function(e){return _.setModePrivate(e)})),_._parser.registerCsiHandler({final:"l"},(function(e){return _.resetMode(e)})),_._parser.registerCsiHandler({prefix:"?",final:"l"},(function(e){return _.resetModePrivate(e)})),_._parser.registerCsiHandler({final:"m"},(function(e){return _.charAttributes(e)})),_._parser.registerCsiHandler({final:"n"},(function(e){return _.deviceStatus(e)})),_._parser.registerCsiHandler({prefix:"?",final:"n"},(function(e){return _.deviceStatusPrivate(e)})),_._parser.registerCsiHandler({intermediates:"!",final:"p"},(function(e){return _.softReset(e)})),_._parser.registerCsiHandler({intermediates:" ",final:"q"},(function(e){return _.setCursorStyle(e)})),_._parser.registerCsiHandler({final:"r"},(function(e){return _.setScrollRegion(e)})),_._parser.registerCsiHandler({final:"s"},(function(e){return _.saveCursor(e)})),_._parser.registerCsiHandler({final:"t"},(function(e){return _.windowOptions(e)})),_._parser.registerCsiHandler({final:"u"},(function(e){return _.restoreCursor(e)})),_._parser.registerCsiHandler({intermediates:"'",final:"}"},(function(e){return _.insertColumns(e)})),_._parser.registerCsiHandler({intermediates:"'",final:"~"},(function(e){return _.deleteColumns(e)})),_._parser.setExecuteHandler(o.C0.BEL,(function(){return _.bell()})),_._parser.setExecuteHandler(o.C0.LF,(function(){return _.lineFeed()})),_._parser.setExecuteHandler(o.C0.VT,(function(){return _.lineFeed()})),_._parser.setExecuteHandler(o.C0.FF,(function(){return _.lineFeed()})),_._parser.setExecuteHandler(o.C0.CR,(function(){return _.carriageReturn()})),_._parser.setExecuteHandler(o.C0.BS,(function(){return _.backspace()})),_._parser.setExecuteHandler(o.C0.HT,(function(){return _.tab()})),_._parser.setExecuteHandler(o.C0.SO,(function(){return _.shiftOut()})),_._parser.setExecuteHandler(o.C0.SI,(function(){return _.shiftIn()})),_._parser.setExecuteHandler(o.C1.IND,(function(){return _.index()})),_._parser.setExecuteHandler(o.C1.NEL,(function(){return _.nextLine()})),_._parser.setExecuteHandler(o.C1.HTS,(function(){return _.tabSet()})),_._parser.registerOscHandler(0,new v.OscHandler((function(e){return _.setTitle(e),_.setIconName(e),!0}))),_._parser.registerOscHandler(1,new v.OscHandler((function(e){return _.setIconName(e)}))),_._parser.registerOscHandler(2,new v.OscHandler((function(e){return _.setTitle(e)}))),_._parser.registerOscHandler(4,new v.OscHandler((function(e){return _.setAnsiColor(e)}))),_._parser.registerEscHandler({final:"7"},(function(){return _.saveCursor()})),_._parser.registerEscHandler({final:"8"},(function(){return _.restoreCursor()})),_._parser.registerEscHandler({final:"D"},(function(){return _.index()})),_._parser.registerEscHandler({final:"E"},(function(){return _.nextLine()})),_._parser.registerEscHandler({final:"H"},(function(){return _.tabSet()})),_._parser.registerEscHandler({final:"M"},(function(){return _.reverseIndex()})),_._parser.registerEscHandler({final:"="},(function(){return _.keypadApplicationMode()})),_._parser.registerEscHandler({final:">"},(function(){return _.keypadNumericMode()})),_._parser.registerEscHandler({final:"c"},(function(){return _.fullReset()})),_._parser.registerEscHandler({final:"n"},(function(){return _.setgLevel(2)})),_._parser.registerEscHandler({final:"o"},(function(){return _.setgLevel(3)})),_._parser.registerEscHandler({final:"|"},(function(){return _.setgLevel(3)})),_._parser.registerEscHandler({final:"}"},(function(){return _.setgLevel(2)})),_._parser.registerEscHandler({final:"~"},(function(){return _.setgLevel(1)})),_._parser.registerEscHandler({intermediates:"%",final:"@"},(function(){return _.selectDefaultCharset()})),_._parser.registerEscHandler({intermediates:"%",final:"G"},(function(){return _.selectDefaultCharset()}));var y=function(e){b._parser.registerEscHandler({intermediates:"(",final:e},(function(){return _.selectCharset("("+e)})),b._parser.registerEscHandler({intermediates:")",final:e},(function(){return _.selectCharset(")"+e)})),b._parser.registerEscHandler({intermediates:"*",final:e},(function(){return _.selectCharset("*"+e)})),b._parser.registerEscHandler({intermediates:"+",final:e},(function(){return _.selectCharset("+"+e)})),b._parser.registerEscHandler({intermediates:"-",final:e},(function(){return _.selectCharset("-"+e)})),b._parser.registerEscHandler({intermediates:".",final:e},(function(){return _.selectCharset("."+e)})),b._parser.registerEscHandler({intermediates:"/",final:e},(function(){return _.selectCharset("/"+e)}))},b=this;for(var O in a.CHARSETS)y(O);return _._parser.registerEscHandler({intermediates:"#",final:"8"},(function(){return _.screenAlignmentPattern()})),_._parser.setErrorHandler((function(e){return _._logService.error("Parsing error: ",e),e})),_._parser.registerDcsHandler({intermediates:"$",final:"q"},new S(_._bufferService,_._coreService,_._logService,_._optionsService)),_}return n(t,e),Object.defineProperty(t.prototype,"onRequestBell",{get:function(){return this._onRequestBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestRefreshRows",{get:function(){return this._onRequestRefreshRows.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestReset",{get:function(){return this._onRequestReset.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestSendFocus",{get:function(){return this._onRequestSendFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestSyncScrollBar",{get:function(){return this._onRequestSyncScrollBar.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestWindowsOptionsReport",{get:function(){return this._onRequestWindowsOptionsReport.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yChar",{get:function(){return this._onA11yChar.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yTab",{get:function(){return this._onA11yTab.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onAnsiColorChange",{get:function(){return this._onAnsiColorChange.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype._preserveStack=function(e,t,i,r){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=r},t.prototype._logSlowResolvingAsync=function(e){this._logService.logLevel<=_.LogLevelEnum.WARN&&Promise.race([e,new Promise((function(e,t){return setTimeout((function(){return t("#SLOW_TIMEOUT")}),5e3)}))]).catch((function(e){if("#SLOW_TIMEOUT"!==e)throw e;console.warn("async parser handler taking longer than 5000 ms")}))},t.prototype.parse=function(e,t){var i,r=this._activeBuffer.x,n=this._activeBuffer.y,s=0,o=this._parseStack.paused;if(o){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;r=this._parseStack.cursorStartX,n=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>O&&(s=this._parseStack.position+O)}if(this._logService.debug("parsing data",e),this._parseBuffer.length<e.length&&this._parseBuffer.length<O&&(this._parseBuffer=new Uint32Array(Math.min(e.length,O))),o||this._dirtyRowService.clearRange(),e.length>O)for(var a=s;a<e.length;a+=O){var l=a+O<e.length?a+O:e.length,h="string"==typeof e?this._stringDecoder.decode(e.substring(a,l),this._parseBuffer):this._utf8Decoder.decode(e.subarray(a,l),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,h))return this._preserveStack(r,n,h,a),this._logSlowResolvingAsync(i),i}else if(!o&&(h="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer),i=this._parser.parse(this._parseBuffer,h)))return this._preserveStack(r,n,h,0),this._logSlowResolvingAsync(i),i;this._activeBuffer.x===r&&this._activeBuffer.y===n||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowService.start,this._dirtyRowService.end)},t.prototype.print=function(e,t,i){var r,n,s=this._charsetService.charset,o=this._optionsService.options.screenReaderMode,a=this._bufferService.cols,l=this._coreService.decPrivateModes.wraparound,h=this._coreService.modes.insertMode,c=this._curAttrData,f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowService.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&2===f.getWidth(this._activeBuffer.x-1)&&f.setCellFromCodePoint(this._activeBuffer.x-1,0,1,c.fg,c.bg,c.extended);for(var d=t;d<i;++d){if(r=e[d],n=this._unicodeService.wcwidth(r),r<127&&s){var g=s[String.fromCharCode(r)];g&&(r=g.charCodeAt(0))}if(o&&this._onA11yChar.fire((0,u.stringFromCodePoint)(r)),n||!this._activeBuffer.x){if(this._activeBuffer.x+n-1>=a)if(l){for(;this._activeBuffer.x<a;)f.setCellFromCodePoint(this._activeBuffer.x++,0,1,c.fg,c.bg,c.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=a-1,2===n)continue;if(h&&(f.insertCells(this._activeBuffer.x,n,this._activeBuffer.getNullCell(c),c),2===f.getWidth(a-1)&&f.setCellFromCodePoint(a-1,p.NULL_CELL_CODE,p.NULL_CELL_WIDTH,c.fg,c.bg,c.extended)),f.setCellFromCodePoint(this._activeBuffer.x++,r,n,c.fg,c.bg,c.extended),n>0)for(;--n;)f.setCellFromCodePoint(this._activeBuffer.x++,0,0,c.fg,c.bg,c.extended)}else f.getWidth(this._activeBuffer.x-1)?f.addCodepointToCell(this._activeBuffer.x-1,r):f.addCodepointToCell(this._activeBuffer.x-2,r)}i-t>0&&(f.loadCell(this._activeBuffer.x-1,this._workCell),2===this._workCell.getWidth()||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<a&&i-t>0&&0===f.getWidth(this._activeBuffer.x)&&!f.hasContent(this._activeBuffer.x)&&f.setCellFromCodePoint(this._activeBuffer.x,0,1,c.fg,c.bg,c.extended),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype.registerCsiHandler=function(e,t){var i=this;return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,(function(e){return!w(e.params[0],i._optionsService.options.windowOptions)||t(e)}))},t.prototype.registerDcsHandler=function(e,t){return this._parser.registerDcsHandler(e,new y.DcsHandler(t))},t.prototype.registerEscHandler=function(e,t){return this._parser.registerEscHandler(e,t)},t.prototype.registerOscHandler=function(e,t){return this._parser.registerOscHandler(e,new v.OscHandler(t))},t.prototype.bell=function(){return this._onRequestBell.fire(),!0},t.prototype.lineFeed=function(){return this._dirtyRowService.markDirty(this._activeBuffer.y),this._optionsService.options.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowService.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0},t.prototype.carriageReturn=function(){return this._activeBuffer.x=0,!0},t.prototype.backspace=function(){var e;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(null===(e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))||void 0===e?void 0:e.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);t.hasWidth(this._activeBuffer.x)&&!t.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0},t.prototype.tab=function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.options.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0},t.prototype.shiftOut=function(){return this._charsetService.setgLevel(1),!0},t.prototype.shiftIn=function(){return this._charsetService.setgLevel(0),!0},t.prototype._restrictCursor=function(e){void 0===e&&(e=this._bufferService.cols-1),this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype._setCursor=function(e,t){this._dirtyRowService.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype._moveCursor=function(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)},t.prototype.cursorUp=function(e){var t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0},t.prototype.cursorDown=function(e){var t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0},t.prototype.cursorForward=function(e){return this._moveCursor(e.params[0]||1,0),!0},t.prototype.cursorBackward=function(e){return this._moveCursor(-(e.params[0]||1),0),!0},t.prototype.cursorNextLine=function(e){return this.cursorDown(e),this._activeBuffer.x=0,!0},t.prototype.cursorPrecedingLine=function(e){return this.cursorUp(e),this._activeBuffer.x=0,!0},t.prototype.cursorCharAbsolute=function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0},t.prototype.cursorPosition=function(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0},t.prototype.charPosAbsolute=function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0},t.prototype.hPositionRelative=function(e){return this._moveCursor(e.params[0]||1,0),!0},t.prototype.linePosAbsolute=function(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0},t.prototype.vPositionRelative=function(e){return this._moveCursor(0,e.params[0]||1),!0},t.prototype.hVPosition=function(e){return this.cursorPosition(e),!0},t.prototype.tabClear=function(e){var t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0},t.prototype.cursorForwardTab=function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0},t.prototype.cursorBackwardTab=function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0},t.prototype._eraseInBufferLine=function(e,t,i,r){void 0===r&&(r=!1);var n=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);n.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r&&(n.isWrapped=!1)},t.prototype._resetBufferLine=function(e){var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);t.fill(this._activeBuffer.getNullCell(this._eraseAttrData())),t.isWrapped=!1},t.prototype.eraseInDisplay=function(e){var t;switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(t=this._activeBuffer.y,this._dirtyRowService.markDirty(t),this._eraseInBufferLine(t++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x);t<this._bufferService.rows;t++)this._resetBufferLine(t);this._dirtyRowService.markDirty(t);break;case 1:for(t=this._activeBuffer.y,this._dirtyRowService.markDirty(t),this._eraseInBufferLine(t,0,this._activeBuffer.x+1,!0),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(t+1).isWrapped=!1);t--;)this._resetBufferLine(t);this._dirtyRowService.markDirty(0);break;case 2:for(t=this._bufferService.rows,this._dirtyRowService.markDirty(t-1);t--;)this._resetBufferLine(t);this._dirtyRowService.markDirty(0);break;case 3:var i=this._activeBuffer.lines.length-this._bufferService.rows;i>0&&(this._activeBuffer.lines.trimStart(i),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-i,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-i,0),this._onScroll.fire(0))}return!0},t.prototype.eraseInLine=function(e){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols)}return this._dirtyRowService.markDirty(this._activeBuffer.y),!0},t.prototype.insertLines=function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var i=this._activeBuffer.ybase+this._activeBuffer.y,r=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-r+1;t--;)this._activeBuffer.lines.splice(n-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},t.prototype.deleteLines=function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var i,r=this._activeBuffer.ybase+this._activeBuffer.y;for(i=this._bufferService.rows-1-this._activeBuffer.scrollBottom,i=this._bufferService.rows-1+this._activeBuffer.ybase-i;t--;)this._activeBuffer.lines.splice(r,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},t.prototype.insertChars=function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.deleteChars=function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.scrollUp=function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollDown=function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(f.DEFAULT_ATTR_DATA));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollLeft=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollRight=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.insertColumns=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.deleteColumns=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.eraseChars=function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.repeatPrecedingCharacter=function(e){if(!this._parser.precedingCodepoint)return!0;for(var t=e.params[0]||1,i=new Uint32Array(t),r=0;r<t;++r)i[r]=this._parser.precedingCodepoint;return this.print(i,0,i.length),!0},t.prototype.sendDeviceAttributesPrimary=function(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(o.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(o.C0.ESC+"[?6c")),!0},t.prototype.sendDeviceAttributesSecondary=function(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(o.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(o.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(o.C0.ESC+"[>83;40003;0c")),!0},t.prototype._is=function(e){return 0===(this._optionsService.options.termName+"").indexOf(e)},t.prototype.setMode=function(e){for(var t=0;t<e.length;t++)4===e.params[t]&&(this._coreService.modes.insertMode=!0);return!0},t.prototype.setModePrivate=function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),this._charsetService.setgCharset(1,a.DEFAULT_CHARSET),this._charsetService.setgCharset(2,a.DEFAULT_CHARSET),this._charsetService.setgCharset(3,a.DEFAULT_CHARSET);break;case 3:this._optionsService.options.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0},t.prototype.resetMode=function(e){for(var t=0;t<e.length;t++)4===e.params[t]&&(this._coreService.modes.insertMode=!1);return!0},t.prototype.resetModePrivate=function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.options.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0},t.prototype._updateAttrColor=function(e,t,i,r,n){return 2===t?(e|=50331648,e&=-16777216,e|=m.AttributeData.fromColorRGB([i,r,n])):5===t&&(e&=-50331904,e|=33554432|255&i),e},t.prototype._extractColor=function(e,t,i){var r=[0,0,-1,0,0,0],n=0,s=0;do{if(r[s+n]=e.params[t+s],e.hasSubParams(t+s)){var o=e.getSubParams(t+s),a=0;do{5===r[1]&&(n=1),r[s+a+1+n]=o[a]}while(++a<o.length&&a+s+1+n<r.length);break}if(5===r[1]&&s+n>=2||2===r[1]&&s+n>=5)break;r[1]&&(n=1)}while(++s+t<e.length&&s+n<r.length);for(a=2;a<r.length;++a)-1===r[a]&&(r[a]=0);switch(r[0]){case 38:i.fg=this._updateAttrColor(i.fg,r[1],r[3],r[4],r[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,r[1],r[3],r[4],r[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,r[1],r[3],r[4],r[5])}return s},t.prototype._processUnderline=function(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()},t.prototype.charAttributes=function(e){if(1===e.length&&0===e.params[0])return this._curAttrData.fg=f.DEFAULT_ATTR_DATA.fg,this._curAttrData.bg=f.DEFAULT_ATTR_DATA.bg,!0;for(var t,i=e.length,r=this._curAttrData,n=0;n<i;n++)(t=e.params[n])>=30&&t<=37?(r.fg&=-50331904,r.fg|=16777216|t-30):t>=40&&t<=47?(r.bg&=-50331904,r.bg|=16777216|t-40):t>=90&&t<=97?(r.fg&=-50331904,r.fg|=16777224|t-90):t>=100&&t<=107?(r.bg&=-50331904,r.bg|=16777224|t-100):0===t?(r.fg=f.DEFAULT_ATTR_DATA.fg,r.bg=f.DEFAULT_ATTR_DATA.bg):1===t?r.fg|=134217728:3===t?r.bg|=67108864:4===t?(r.fg|=268435456,this._processUnderline(e.hasSubParams(n)?e.getSubParams(n)[0]:1,r)):5===t?r.fg|=536870912:7===t?r.fg|=67108864:8===t?r.fg|=1073741824:9===t?r.fg|=2147483648:2===t?r.bg|=134217728:21===t?this._processUnderline(2,r):22===t?(r.fg&=-134217729,r.bg&=-134217729):23===t?r.bg&=-67108865:24===t?r.fg&=-268435457:25===t?r.fg&=-536870913:27===t?r.fg&=-67108865:28===t?r.fg&=-1073741825:29===t?r.fg&=2147483647:39===t?(r.fg&=-67108864,r.fg|=16777215&f.DEFAULT_ATTR_DATA.fg):49===t?(r.bg&=-67108864,r.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):38===t||48===t||58===t?n+=this._extractColor(e,n,r):59===t?(r.extended=r.extended.clone(),r.extended.underlineColor=-1,r.updateExtended()):100===t?(r.fg&=-67108864,r.fg|=16777215&f.DEFAULT_ATTR_DATA.fg,r.bg&=-67108864,r.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",t);return!0},t.prototype.deviceStatus=function(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(o.C0.ESC+"[0n");break;case 6:var t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent(o.C0.ESC+"["+t+";"+i+"R")}return!0},t.prototype.deviceStatusPrivate=function(e){if(6===e.params[0]){var t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent(o.C0.ESC+"[?"+t+";"+i+"R")}return!0},t.prototype.softReset=function(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0},t.prototype.setCursorStyle=function(e){var t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var i=t%2==1;return this._optionsService.options.cursorBlink=i,!0},t.prototype.setScrollRegion=function(e){var t,i=e.params[0]||1;return(e.length<2||(t=e.params[1])>this._bufferService.rows||0===t)&&(t=this._bufferService.rows),t>i&&(this._activeBuffer.scrollTop=i-1,this._activeBuffer.scrollBottom=t-1,this._setCursor(0,0)),!0},t.prototype.windowOptions=function(e){if(!w(e.params[0],this._optionsService.options.windowOptions))return!0;var t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(s.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(s.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(o.C0.ESC+"[8;"+this._bufferService.rows+";"+this._bufferService.cols+"t");break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0},t.prototype.saveCursor=function(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0},t.prototype.restoreCursor=function(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0},t.prototype.setTitle=function(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0},t.prototype.setIconName=function(e){return this._iconName=e,!0},t.prototype._parseAnsiColorChange=function(e){for(var t,i={colors:[]},r=/(\d+);rgb:([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})/gi;null!==(t=r.exec(e));)i.colors.push({colorIndex:parseInt(t[1]),red:parseInt(t[2],16),green:parseInt(t[3],16),blue:parseInt(t[4],16)});return 0===i.colors.length?null:i},t.prototype.setAnsiColor=function(e){var t=this._parseAnsiColorChange(e);return t?this._onAnsiColorChange.fire(t):this._logService.warn("Expected format <num>;rgb:<rr>/<gg>/<bb> but got data: "+e),!0},t.prototype.nextLine=function(){return this._activeBuffer.x=0,this.index(),!0},t.prototype.keypadApplicationMode=function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0},t.prototype.keypadNumericMode=function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0},t.prototype.selectDefaultCharset=function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),!0},t.prototype.selectCharset=function(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(b[e[0]],a.CHARSETS[e[1]]||a.DEFAULT_CHARSET),!0)},t.prototype.index=function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0},t.prototype.tabSet=function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0},t.prototype.reverseIndex=function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0},t.prototype.fullReset=function(){return this._parser.reset(),this._onRequestReset.fire(),!0},t.prototype.reset=function(){this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone()},t.prototype._eraseAttrData=function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal},t.prototype.setgLevel=function(e){return this._charsetService.setgLevel(e),!0},t.prototype.screenAlignmentPattern=function(){var e=new g.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(var t=0;t<this._bufferService.rows;++t){var i=this._activeBuffer.ybase+this._activeBuffer.y+t,r=this._activeBuffer.lines.get(i);r&&(r.fill(e),r.isWrapped=!1)}return this._dirtyRowService.markAllDirty(),this._setCursor(0,0),!0},t}(h.Disposable);t.InputHandler=C},844:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.Disposable=void 0;var i=function(){function e(){this._disposables=[],this._isDisposed=!1}return e.prototype.dispose=function(){this._isDisposed=!0;for(var e=0,t=this._disposables;e<t.length;e++)t[e].dispose();this._disposables.length=0},e.prototype.register=function(e){return this._disposables.push(e),e},e.prototype.unregister=function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)},e}();function r(e){for(var t=0,i=e;t<i.length;t++)i[t].dispose();e.length=0}t.Disposable=i,t.disposeArray=r,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return r(e)}}}},6114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.isSafari=t.isFirefox=void 0;var i="undefined"==typeof navigator,r=i?"node":navigator.userAgent,n=i?"node":navigator.platform;t.isFirefox=r.includes("Firefox"),t.isSafari=/^((?!chrome|android).)*safari/i.test(r),t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0},8273:(e,t)=>{function i(e,t,i,r){if(void 0===i&&(i=0),void 0===r&&(r=e.length),i>=e.length)return e;i=(e.length+i)%e.length,r=r>=e.length?e.length:(e.length+r)%e.length;for(var n=i;n<r;++n)e[n]=t;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.fillFallback=t.fill=void 0,t.fill=function(e,t,r,n){return e.fill?e.fill(t,r,n):i(e,t,r,n)},t.fillFallback=i,t.concat=function(e,t){var i=new e.constructor(e.length+t.length);return i.set(e),i.set(t,e.length),i}},9282:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;var r=i(643);t.updateWindowsModeWrappedState=function(e){var t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),i=null==t?void 0:t.get(e.cols-1),n=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);n&&i&&(n.isWrapped=i[r.CHAR_DATA_CODE_INDEX]!==r.NULL_CELL_CODE&&i[r.CHAR_DATA_CODE_INDEX]!==r.WHITESPACE_CELL_CODE)}},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var i=function(){function e(){this.fg=0,this.bg=0,this.extended=new r}return e.toColorRGB=function(e){return[e>>>16&255,e>>>8&255,255&e]},e.fromColorRGB=function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},e.prototype.clone=function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t},e.prototype.isInverse=function(){return 67108864&this.fg},e.prototype.isBold=function(){return 134217728&this.fg},e.prototype.isUnderline=function(){return 268435456&this.fg},e.prototype.isBlink=function(){return 536870912&this.fg},e.prototype.isInvisible=function(){return 1073741824&this.fg},e.prototype.isItalic=function(){return 67108864&this.bg},e.prototype.isDim=function(){return 134217728&this.bg},e.prototype.isStrikethrough=function(){return 2147483648&this.fg},e.prototype.getFgColorMode=function(){return 50331648&this.fg},e.prototype.getBgColorMode=function(){return 50331648&this.bg},e.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},e.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},e.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},e.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},e.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},e.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},e.prototype.isAttributeDefault=function(){return 0===this.fg&&0===this.bg},e.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},e.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},e.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},e.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},e.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},e.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},e.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()},e.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()},e.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()},e.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},e}();t.AttributeData=i;var r=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=-1),this.underlineStyle=e,this.underlineColor=t}return e.prototype.clone=function(){return new e(this.underlineStyle,this.underlineColor)},e.prototype.isEmpty=function(){return 0===this.underlineStyle},e}();t.ExtendedAttrs=r},9092:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferStringIterator=t.Buffer=t.MAX_BUFFER_SIZE=void 0;var r=i(6349),n=i(8437),s=i(511),o=i(643),a=i(4634),l=i(4863),h=i(7116),c=i(3734);t.MAX_BUFFER_SIZE=4294967295;var u=function(){function e(e,t,i){this._hasScrollback=e,this._optionsService=t,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.savedY=0,this.savedX=0,this.savedCurAttrData=n.DEFAULT_ATTR_DATA.clone(),this.savedCharset=h.DEFAULT_CHARSET,this.markers=[],this._nullCell=s.CellData.fromCharData([0,o.NULL_CELL_CHAR,o.NULL_CELL_WIDTH,o.NULL_CELL_CODE]),this._whitespaceCell=s.CellData.fromCharData([0,o.WHITESPACE_CELL_CHAR,o.WHITESPACE_CELL_WIDTH,o.WHITESPACE_CELL_CODE]),this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new r.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return e.prototype.getNullCell=function(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell},e.prototype.getWhitespaceCell=function(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell},e.prototype.getBlankLine=function(e,t){return new n.BufferLine(this._bufferService.cols,this.getNullCell(e),t)},Object.defineProperty(e.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCursorInViewport",{get:function(){var e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows},enumerable:!1,configurable:!0}),e.prototype._getCorrectBufferLength=function(e){if(!this._hasScrollback)return e;var i=e+this._optionsService.options.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i},e.prototype.fillViewportRows=function(e){if(0===this.lines.length){void 0===e&&(e=n.DEFAULT_ATTR_DATA);for(var t=this._rows;t--;)this.lines.push(this.getBlankLine(e))}},e.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new r.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},e.prototype.resize=function(e,t){var i=this.getNullCell(n.DEFAULT_ATTR_DATA),r=this._getCorrectBufferLength(t);if(r>this.lines.maxLength&&(this.lines.maxLength=r),this.lines.length>0){if(this._cols<e)for(var s=0;s<this.lines.length;s++)this.lines.get(s).resize(e,i);var o=0;if(this._rows<t)for(var a=this._rows;a<t;a++)this.lines.length<t+this.ybase&&(this._optionsService.options.windowsMode?this.lines.push(new n.BufferLine(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+o+1?(this.ybase--,o++,this.ydisp>0&&this.ydisp--):this.lines.push(new n.BufferLine(e,i)));else for(a=this._rows;a>t;a--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(r<this.lines.maxLength){var l=this.lines.length-r;l>0&&(this.lines.trimStart(l),this.ybase=Math.max(this.ybase-l,0),this.ydisp=Math.max(this.ydisp-l,0),this.savedY=Math.max(this.savedY-l,0)),this.lines.maxLength=r}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),o&&(this.y+=o),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(s=0;s<this.lines.length;s++)this.lines.get(s).resize(e,i);this._cols=e,this._rows=t},Object.defineProperty(e.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._optionsService.options.windowsMode},enumerable:!1,configurable:!0}),e.prototype._reflow=function(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))},e.prototype._reflowLarger=function(e,t){var i=(0,a.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(n.DEFAULT_ATTR_DATA));if(i.length>0){var r=(0,a.reflowLargerCreateNewLayout)(this.lines,i);(0,a.reflowLargerApplyNewLayout)(this.lines,r.layout),this._reflowLargerAdjustViewport(e,t,r.countRemoved)}},e.prototype._reflowLargerAdjustViewport=function(e,t,i){for(var r=this.getNullCell(n.DEFAULT_ATTR_DATA),s=i;s-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new n.BufferLine(e,r))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)},e.prototype._reflowSmaller=function(e,t){for(var i=this.getNullCell(n.DEFAULT_ATTR_DATA),r=[],s=0,o=this.lines.length-1;o>=0;o--){var l=this.lines.get(o);if(!(!l||!l.isWrapped&&l.getTrimmedLength()<=e)){for(var h=[l];l.isWrapped&&o>0;)l=this.lines.get(--o),h.unshift(l);var c=this.ybase+this.y;if(!(c>=o&&c<o+h.length)){var u,f=h[h.length-1].getTrimmedLength(),d=(0,a.reflowSmallerGetNewLineLengths)(h,this._cols,e),p=d.length-h.length;u=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+p):Math.max(0,this.lines.length-this.lines.maxLength+p);for(var g=[],m=0;m<p;m++){var _=this.getBlankLine(n.DEFAULT_ATTR_DATA,!0);g.push(_)}g.length>0&&(r.push({start:o+h.length+s,newLines:g}),s+=g.length),h.push.apply(h,g);var v=d.length-1,y=d[v];0===y&&(y=d[--v]);for(var b=h.length-p-1,O=f;b>=0;){var w=Math.min(O,y);if(h[v].copyCellsFrom(h[b],O-w,y-w,w,!0),0==(y-=w)&&(y=d[--v]),0==(O-=w)){b--;var S=Math.max(b,0);O=(0,a.getWrappedLineTrimmedLength)(h,S,this._cols)}}for(m=0;m<h.length;m++)d[m]<e&&h[m].setCell(d[m],i);for(var C=p-u;C-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+s)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+p,this.ybase+t-1)}}}if(r.length>0){var k=[],x=[];for(m=0;m<this.lines.length;m++)x.push(this.lines.get(m));var E=this.lines.length,A=E-1,T=0,P=r[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+s);var L=0;for(m=Math.min(this.lines.maxLength-1,E+s-1);m>=0;m--)if(P&&P.start>A+L){for(var R=P.newLines.length-1;R>=0;R--)this.lines.set(m--,P.newLines[R]);m++,k.push({index:A+1,amount:P.newLines.length}),L+=P.newLines.length,P=r[++T]}else this.lines.set(m,x[A--]);var M=0;for(m=k.length-1;m>=0;m--)k[m].index+=M,this.lines.onInsertEmitter.fire(k[m]),M+=k[m].amount;var D=Math.max(0,E+s-this.lines.maxLength);D>0&&this.lines.onTrimEmitter.fire(D)}},e.prototype.stringIndexToBufferIndex=function(e,t,i){for(void 0===i&&(i=!1);t;){var r=this.lines.get(e);if(!r)return[-1,-1];for(var n=i?r.getTrimmedLength():r.length,s=0;s<n;++s)if(r.get(s)[o.CHAR_DATA_WIDTH_INDEX]&&(t-=r.get(s)[o.CHAR_DATA_CHAR_INDEX].length||1),t<0)return[e,s];e++}return[e,0]},e.prototype.translateBufferLineToString=function(e,t,i,r){void 0===i&&(i=0);var n=this.lines.get(e);return n?n.translateToString(t,i,r):""},e.prototype.getWrappedRangeForLine=function(e){for(var t=e,i=e;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}},e.prototype.setupTabStops=function(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.options.tabStopWidth)this.tabs[e]=!0},e.prototype.prevStop=function(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e},e.prototype.nextStop=function(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e},e.prototype.addMarker=function(e){var t=this,i=new l.Marker(e);return this.markers.push(i),i.register(this.lines.onTrim((function(e){i.line-=e,i.line<0&&i.dispose()}))),i.register(this.lines.onInsert((function(e){i.line>=e.index&&(i.line+=e.amount)}))),i.register(this.lines.onDelete((function(e){i.line>=e.index&&i.line<e.index+e.amount&&i.dispose(),i.line>e.index&&(i.line-=e.amount)}))),i.register(i.onDispose((function(){return t._removeMarker(i)}))),i},e.prototype._removeMarker=function(e){this.markers.splice(this.markers.indexOf(e),1)},e.prototype.iterator=function(e,t,i,r,n){return new f(this,e,t,i,r,n)},e}();t.Buffer=u;var f=function(){function e(e,t,i,r,n,s){void 0===i&&(i=0),void 0===r&&(r=e.lines.length),void 0===n&&(n=0),void 0===s&&(s=0),this._buffer=e,this._trimRight=t,this._startIndex=i,this._endIndex=r,this._startOverscan=n,this._endOverscan=s,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return e.prototype.hasNext=function(){return this._current<this._endIndex},e.prototype.next=function(){var e=this._buffer.getWrappedRangeForLine(this._current);e.first<this._startIndex-this._startOverscan&&(e.first=this._startIndex-this._startOverscan),e.last>this._endIndex+this._endOverscan&&(e.last=this._endIndex+this._endOverscan),e.first=Math.max(e.first,0),e.last=Math.min(e.last,this._buffer.lines.length);for(var t="",i=e.first;i<=e.last;++i)t+=this._buffer.translateBufferLineToString(i,this._trimRight);return this._current=e.last+1,{range:e,content:t}},e}();t.BufferStringIterator=f},8437:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;var r=i(482),n=i(643),s=i(511),o=i(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new o.AttributeData);var a=function(){function e(e,t,i){void 0===i&&(i=!1),this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);for(var r=t||s.CellData.fromCharData([0,n.NULL_CELL_CHAR,n.NULL_CELL_WIDTH,n.NULL_CELL_CODE]),o=0;o<e;++o)this.setCell(o,r);this.length=e}return e.prototype.get=function(e){var t=this._data[3*e+0],i=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:i?(0,r.stringFromCodePoint)(i):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):i]},e.prototype.set=function(e,t){this._data[3*e+1]=t[n.CHAR_DATA_ATTR_INDEX],t[n.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[n.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[n.CHAR_DATA_WIDTH_INDEX]<<22},e.prototype.getWidth=function(e){return this._data[3*e+0]>>22},e.prototype.hasWidth=function(e){return 12582912&this._data[3*e+0]},e.prototype.getFg=function(e){return this._data[3*e+1]},e.prototype.getBg=function(e){return this._data[3*e+2]},e.prototype.hasContent=function(e){return 4194303&this._data[3*e+0]},e.prototype.getCodePoint=function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t},e.prototype.isCombined=function(e){return 2097152&this._data[3*e+0]},e.prototype.getString=function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,r.stringFromCodePoint)(2097151&t):""},e.prototype.loadCell=function(e,t){var i=3*e;return t.content=this._data[i+0],t.fg=this._data[i+1],t.bg=this._data[i+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t},e.prototype.setCell=function(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg},e.prototype.setCellFromCodePoint=function(e,t,i,r,n,s){268435456&n&&(this._extendedAttrs[e]=s),this._data[3*e+0]=t|i<<22,this._data[3*e+1]=r,this._data[3*e+2]=n},e.prototype.addCodepointToCell=function(e,t){var i=this._data[3*e+0];2097152&i?this._combined[e]+=(0,r.stringFromCodePoint)(t):(2097151&i?(this._combined[e]=(0,r.stringFromCodePoint)(2097151&i)+(0,r.stringFromCodePoint)(t),i&=-2097152,i|=2097152):i=t|1<<22,this._data[3*e+0]=i)},e.prototype.insertCells=function(e,t,i,r){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new o.ExtendedAttrs),t<this.length-e){for(var n=new s.CellData,a=this.length-e-t-1;a>=0;--a)this.setCell(e+t+a,this.loadCell(e+a,n));for(a=0;a<t;++a)this.setCell(e+a,i)}else for(a=e;a<this.length;++a)this.setCell(a,i);2===this.getWidth(this.length-1)&&this.setCellFromCodePoint(this.length-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new o.ExtendedAttrs)},e.prototype.deleteCells=function(e,t,i,r){if(e%=this.length,t<this.length-e){for(var n=new s.CellData,a=0;a<this.length-e-t;++a)this.setCell(e+a,this.loadCell(e+t+a,n));for(a=this.length-t;a<this.length;++a)this.setCell(a,i)}else for(a=e;a<this.length;++a)this.setCell(a,i);e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new o.ExtendedAttrs),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new o.ExtendedAttrs)},e.prototype.replaceCells=function(e,t,i,r){for(e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new o.ExtendedAttrs),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodePoint(t,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new o.ExtendedAttrs);e<t&&e<this.length;)this.setCell(e++,i)},e.prototype.resize=function(e,t){if(e!==this.length){if(e>this.length){var i=new Uint32Array(3*e);this.length&&(3*e<this._data.length?i.set(this._data.subarray(0,3*e)):i.set(this._data)),this._data=i;for(var r=this.length;r<e;++r)this.setCell(r,t)}else if(e){(i=new Uint32Array(3*e)).set(this._data.subarray(0,3*e)),this._data=i;var n=Object.keys(this._combined);for(r=0;r<n.length;r++){var s=parseInt(n[r],10);s>=e&&delete this._combined[s]}}else this._data=new Uint32Array(0),this._combined={};this.length=e}},e.prototype.fill=function(e){this._combined={},this._extendedAttrs={};for(var t=0;t<this.length;++t)this.setCell(t,e)},e.prototype.copyFrom=function(e){for(var t in this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={},e._combined)this._combined[t]=e._combined[t];for(var t in this._extendedAttrs={},e._extendedAttrs)this._extendedAttrs[t]=e._extendedAttrs[t];this.isWrapped=e.isWrapped},e.prototype.clone=function(){var t=new e(0);for(var i in t._data=new Uint32Array(this._data),t.length=this.length,this._combined)t._combined[i]=this._combined[i];for(var i in this._extendedAttrs)t._extendedAttrs[i]=this._extendedAttrs[i];return t.isWrapped=this.isWrapped,t},e.prototype.getTrimmedLength=function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0},e.prototype.copyCellsFrom=function(e,t,i,r,n){var s=e._data;if(n)for(var o=r-1;o>=0;o--)for(var a=0;a<3;a++)this._data[3*(i+o)+a]=s[3*(t+o)+a];else for(o=0;o<r;o++)for(a=0;a<3;a++)this._data[3*(i+o)+a]=s[3*(t+o)+a];var l=Object.keys(e._combined);for(a=0;a<l.length;a++){var h=parseInt(l[a],10);h>=t&&(this._combined[h-t+i]=e._combined[h])}},e.prototype.translateToString=function(e,t,i){void 0===e&&(e=!1),void 0===t&&(t=0),void 0===i&&(i=this.length),e&&(i=Math.min(i,this.getTrimmedLength()));for(var s="";t<i;){var o=this._data[3*t+0],a=2097151&o;s+=2097152&o?this._combined[t]:a?(0,r.stringFromCodePoint)(a):n.WHITESPACE_CELL_CHAR,t+=o>>22||1}return s},e}();t.BufferLine=a},4841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error("Buffer range end ("+e.end.x+", "+e.end.y+") cannot be before start ("+e.start.x+", "+e.start.y+")");return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:(e,t)=>{function i(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();var r=!e[t].hasContent(i-1)&&1===e[t].getWidth(i-1),n=2===e[t+1].getWidth(0);return r&&n?i-1:i}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,r,n,s){for(var o=[],a=0;a<e.length-1;a++){var l=a,h=e.get(++l);if(h.isWrapped){for(var c=[e.get(a)];l<e.length&&h.isWrapped;)c.push(h),h=e.get(++l);if(n>=a&&n<l)a+=c.length-1;else{for(var u=0,f=i(c,u,t),d=1,p=0;d<c.length;){var g=i(c,d,t),m=g-p,_=r-f,v=Math.min(m,_);c[u].copyCellsFrom(c[d],p,f,v,!1),(f+=v)===r&&(u++,f=0),(p+=v)===g&&(d++,p=0),0===f&&0!==u&&2===c[u-1].getWidth(r-1)&&(c[u].copyCellsFrom(c[u-1],r-1,f++,1,!1),c[u-1].setCell(r-1,s))}c[u].replaceCells(f,r,s);for(var y=0,b=c.length-1;b>0&&(b>u||0===c[b].getTrimmedLength());b--)y++;y>0&&(o.push(a+c.length-y),o.push(y)),a+=c.length-1}}}return o},t.reflowLargerCreateNewLayout=function(e,t){for(var i=[],r=0,n=t[r],s=0,o=0;o<e.length;o++)if(n===o){var a=t[++r];e.onDeleteEmitter.fire({index:o-s,amount:a}),o+=a-1,s+=a,n=t[++r]}else i.push(o);return{layout:i,countRemoved:s}},t.reflowLargerApplyNewLayout=function(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.get(t[r]));for(r=0;r<i.length;r++)e.set(r,i[r]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,r){for(var n=[],s=e.map((function(r,n){return i(e,n,t)})).reduce((function(e,t){return e+t})),o=0,a=0,l=0;l<s;){if(s-l<r){n.push(s-l);break}o+=r;var h=i(e,a,t);o>h&&(o-=h,a++);var c=2===e[a].getWidth(o-1);c&&o--;var u=c?r-1:r;n.push(u),l+=u}return n},t.getWrappedLineTrimmedLength=i},5295:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;var s=i(9092),o=i(8460),a=function(e){function t(t,i){var r=e.call(this)||this;return r._optionsService=t,r._bufferService=i,r._onBufferActivate=r.register(new o.EventEmitter),r.reset(),r}return n(t,e),Object.defineProperty(t.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._normal=new s.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new s.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()},Object.defineProperty(t.prototype,"alt",{get:function(){return this._alt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),t.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},t.prototype.activateAltBuffer=function(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},t.prototype.resize=function(e,t){this._normal.resize(e,t),this._alt.resize(e,t)},t.prototype.setupTabStops=function(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)},t}(i(844).Disposable);t.BufferSet=a},511:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var s=i(482),o=i(643),a=i(3734),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=0,t.fg=0,t.bg=0,t.extended=new a.ExtendedAttrs,t.combinedData="",t}return n(t,e),t.fromCharData=function(e){var i=new t;return i.setFromCharData(e),i},t.prototype.isCombined=function(){return 2097152&this.content},t.prototype.getWidth=function(){return this.content>>22},t.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,s.stringFromCodePoint)(2097151&this.content):""},t.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},t.prototype.setFromCharData=function(e){this.fg=e[o.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[o.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[o.CHAR_DATA_CHAR_INDEX].length){var i=e[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[o.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[o.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[o.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[o.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[o.CHAR_DATA_WIDTH_INDEX]<<22)},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(a.AttributeData);t.CellData=l},643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=256,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;var s=i(8460),o=function(e){function t(i){var r=e.call(this)||this;return r.line=i,r._id=t._nextId++,r.isDisposed=!1,r._onDispose=new s.EventEmitter,r}return n(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),e.prototype.dispose.call(this))},t._nextId=1,t}(i(844).Disposable);t.Marker=o},7116:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},t.CHARSETS.A={"#":""},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},t.CHARSETS.C=t.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},t.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},t.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.E=t.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},t.CHARSETS.H=t.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(e,t)=>{var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.C1=t.C0=void 0,(r=t.C0||(t.C0={})).NUL="\0",r.SOH="",r.STX="",r.ETX="",r.EOT="",r.ENQ="",r.ACK="",r.BEL="",r.BS="\b",r.HT="\t",r.LF="\n",r.VT="\v",r.FF="\f",r.CR="\r",r.SO="",r.SI="",r.DLE="",r.DC1="",r.DC2="",r.DC3="",r.DC4="",r.NAK="",r.SYN="",r.ETB="",r.CAN="",r.EM="",r.SUB="",r.ESC="",r.FS="",r.GS="",r.RS="",r.US="",r.SP=" ",r.DEL="",(i=t.C1||(t.C1={})).PAD="",i.HOP="",i.BPH="",i.NBH="",i.IND="",i.NEL="",i.SSA="",i.ESA="",i.HTS="",i.HTJ="",i.VTS="",i.PLD="",i.PLU="",i.RI="",i.SS2="",i.SS3="",i.DCS="",i.PU1="",i.PU2="",i.STS="",i.CCH="",i.MW="",i.SPA="",i.EPA="",i.SOS="",i.SGCI="",i.SCI="",i.CSI="",i.ST="",i.OSC="",i.PM="",i.APC=""},7399:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;var r=i(2584),n={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,i,s){var o={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?o.key=t?r.C0.ESC+"OA":r.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?o.key=t?r.C0.ESC+"OD":r.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?o.key=t?r.C0.ESC+"OC":r.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(o.key=t?r.C0.ESC+"OB":r.C0.ESC+"[B");break;case 8:if(e.shiftKey){o.key=r.C0.BS;break}if(e.altKey){o.key=r.C0.ESC+r.C0.DEL;break}o.key=r.C0.DEL;break;case 9:if(e.shiftKey){o.key=r.C0.ESC+"[Z";break}o.key=r.C0.HT,o.cancel=!0;break;case 13:o.key=e.altKey?r.C0.ESC+r.C0.CR:r.C0.CR,o.cancel=!0;break;case 27:o.key=r.C0.ESC,e.altKey&&(o.key=r.C0.ESC+r.C0.ESC),o.cancel=!0;break;case 37:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"D",o.key===r.C0.ESC+"[1;3D"&&(o.key=r.C0.ESC+(i?"b":"[1;5D"))):o.key=t?r.C0.ESC+"OD":r.C0.ESC+"[D";break;case 39:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"C",o.key===r.C0.ESC+"[1;3C"&&(o.key=r.C0.ESC+(i?"f":"[1;5C"))):o.key=t?r.C0.ESC+"OC":r.C0.ESC+"[C";break;case 38:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"A",i||o.key!==r.C0.ESC+"[1;3A"||(o.key=r.C0.ESC+"[1;5A")):o.key=t?r.C0.ESC+"OA":r.C0.ESC+"[A";break;case 40:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"B",i||o.key!==r.C0.ESC+"[1;3B"||(o.key=r.C0.ESC+"[1;5B")):o.key=t?r.C0.ESC+"OB":r.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(o.key=r.C0.ESC+"[2~");break;case 46:o.key=a?r.C0.ESC+"[3;"+(a+1)+"~":r.C0.ESC+"[3~";break;case 36:o.key=a?r.C0.ESC+"[1;"+(a+1)+"H":t?r.C0.ESC+"OH":r.C0.ESC+"[H";break;case 35:o.key=a?r.C0.ESC+"[1;"+(a+1)+"F":t?r.C0.ESC+"OF":r.C0.ESC+"[F";break;case 33:e.shiftKey?o.type=2:o.key=r.C0.ESC+"[5~";break;case 34:e.shiftKey?o.type=3:o.key=r.C0.ESC+"[6~";break;case 112:o.key=a?r.C0.ESC+"[1;"+(a+1)+"P":r.C0.ESC+"OP";break;case 113:o.key=a?r.C0.ESC+"[1;"+(a+1)+"Q":r.C0.ESC+"OQ";break;case 114:o.key=a?r.C0.ESC+"[1;"+(a+1)+"R":r.C0.ESC+"OR";break;case 115:o.key=a?r.C0.ESC+"[1;"+(a+1)+"S":r.C0.ESC+"OS";break;case 116:o.key=a?r.C0.ESC+"[15;"+(a+1)+"~":r.C0.ESC+"[15~";break;case 117:o.key=a?r.C0.ESC+"[17;"+(a+1)+"~":r.C0.ESC+"[17~";break;case 118:o.key=a?r.C0.ESC+"[18;"+(a+1)+"~":r.C0.ESC+"[18~";break;case 119:o.key=a?r.C0.ESC+"[19;"+(a+1)+"~":r.C0.ESC+"[19~";break;case 120:o.key=a?r.C0.ESC+"[20;"+(a+1)+"~":r.C0.ESC+"[20~";break;case 121:o.key=a?r.C0.ESC+"[21;"+(a+1)+"~":r.C0.ESC+"[21~";break;case 122:o.key=a?r.C0.ESC+"[23;"+(a+1)+"~":r.C0.ESC+"[23~";break;case 123:o.key=a?r.C0.ESC+"[24;"+(a+1)+"~":r.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(i&&!s||!e.altKey||e.metaKey)!i||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?o.key=e.key:e.key&&e.ctrlKey&&"_"===e.key&&(o.key=r.C0.US):65===e.keyCode&&(o.type=1);else{var l=n[e.keyCode],h=l&&l[e.shiftKey?1:0];if(h)o.key=r.C0.ESC+h;else if(e.keyCode>=65&&e.keyCode<=90){var c=e.ctrlKey?e.keyCode-64:e.keyCode+32;o.key=r.C0.ESC+String.fromCharCode(c)}}else e.keyCode>=65&&e.keyCode<=90?o.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?o.key=r.C0.NUL:e.keyCode>=51&&e.keyCode<=55?o.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?o.key=r.C0.DEL:219===e.keyCode?o.key=r.C0.ESC:220===e.keyCode?o.key=r.C0.FS:221===e.keyCode&&(o.key=r.C0.GS)}return o}},482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=e.length);for(var r="",n=t;n<i;++n){var s=e[n];s>65535?(s-=65536,r+=String.fromCharCode(55296+(s>>10))+String.fromCharCode(s%1024+56320)):r+=String.fromCharCode(s)}return r};var i=function(){function e(){this._interim=0}return e.prototype.clear=function(){this._interim=0},e.prototype.decode=function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;this._interim&&(56320<=(a=e.charCodeAt(n++))&&a<=57343?t[r++]=1024*(this._interim-55296)+a-56320+65536:(t[r++]=this._interim,t[r++]=a),this._interim=0);for(var s=n;s<i;++s){var o=e.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=i)return this._interim=o,r;var a;56320<=(a=e.charCodeAt(s))&&a<=57343?t[r++]=1024*(o-55296)+a-56320+65536:(t[r++]=o,t[r++]=a)}else 65279!==o&&(t[r++]=o)}return r},e}();t.StringToUtf32=i;var r=function(){function e(){this.interim=new Uint8Array(3)}return e.prototype.clear=function(){this.interim.fill(0)},e.prototype.decode=function(e,t){var i=e.length;if(!i)return 0;var r,n,s,o,a=0,l=0,h=0;if(this.interim[0]){var c=!1,u=this.interim[0];u&=192==(224&u)?31:224==(240&u)?15:7;for(var f=0,d=void 0;(d=63&this.interim[++f])&&f<4;)u<<=6,u|=d;for(var p=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,g=p-f;h<g;){if(h>=i)return 0;if(128!=(192&(d=e[h++]))){h--,c=!0;break}this.interim[f++]=d,u<<=6,u|=63&d}c||(2===p?u<128?h--:t[a++]=u:3===p?u<2048||u>=55296&&u<=57343||65279===u||(t[a++]=u):u<65536||u>1114111||(t[a++]=u)),this.interim.fill(0)}for(var m=i-4,_=h;_<i;){for(;!(!(_<m)||128&(r=e[_])||128&(n=e[_+1])||128&(s=e[_+2])||128&(o=e[_+3]));)t[a++]=r,t[a++]=n,t[a++]=s,t[a++]=o,_+=4;if((r=e[_++])<128)t[a++]=r;else if(192==(224&r)){if(_>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[_++]))){_--;continue}if((l=(31&r)<<6|63&n)<128){_--;continue}t[a++]=l}else if(224==(240&r)){if(_>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[_++]))){_--;continue}if(_>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(s=e[_++]))){_--;continue}if((l=(15&r)<<12|(63&n)<<6|63&s)<2048||l>=55296&&l<=57343||65279===l)continue;t[a++]=l}else if(240==(248&r)){if(_>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[_++]))){_--;continue}if(_>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(s=e[_++]))){_--;continue}if(_>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=s,a;if(128!=(192&(o=e[_++]))){_--;continue}if((l=(7&r)<<18|(63&n)<<12|(63&s)<<6|63&o)<65536||l>1114111)continue;t[a++]=l}}return a},e}();t.Utf8ToUtf32=r},225:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;var r,n=i(8273),s=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],o=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],a=function(){function e(){if(this.version="6",!r){r=new Uint8Array(65536),(0,n.fill)(r,1),r[0]=0,(0,n.fill)(r,0,1,32),(0,n.fill)(r,0,127,160),(0,n.fill)(r,2,4352,4448),r[9001]=2,r[9002]=2,(0,n.fill)(r,2,11904,42192),r[12351]=1,(0,n.fill)(r,2,44032,55204),(0,n.fill)(r,2,63744,64256),(0,n.fill)(r,2,65040,65050),(0,n.fill)(r,2,65072,65136),(0,n.fill)(r,2,65280,65377),(0,n.fill)(r,2,65504,65511);for(var e=0;e<s.length;++e)(0,n.fill)(r,0,s[e][0],s[e][1]+1)}}return e.prototype.wcwidth=function(e){return e<32?0:e<127?1:e<65536?r[e]:function(e,t){var i,r=0,n=t.length-1;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=r;)if(e>t[i=r+n>>1][1])r=i+1;else{if(!(e<t[i][0]))return!0;n=i-1}return!1}(e,o)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1},e}();t.UnicodeV6=a},5981:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;var i="undefined"==typeof queueMicrotask?function(e){Promise.resolve().then(e)}:queueMicrotask,r=function(){function e(e){this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0}return e.prototype.writeSync=function(e,t){if(void 0!==t&&this._syncCalls>t)this._syncCalls=0;else if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);var r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}},e.prototype.write=function(e,t){var i=this;if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");this._writeBuffer.length||(this._bufferOffset=0,setTimeout((function(){return i._innerWrite()}))),this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)},e.prototype._innerWrite=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=!0);for(var n=e||Date.now();this._writeBuffer.length>this._bufferOffset;){var s=this._writeBuffer[this._bufferOffset],o=this._action(s,t);if(o)return void o.catch((function(e){return i((function(){throw e})),Promise.resolve(!1)})).then((function(e){return Date.now()-n>=12?setTimeout((function(){return r._innerWrite(0,e)})):r._innerWrite(n,e)}));var a=this._callbacks[this._bufferOffset];if(a&&a(),this._bufferOffset++,this._pendingData-=s.length,Date.now()-n>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((function(){return r._innerWrite()}))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0)},e}();t.WriteBuffer=r},5770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;var r=i(482),n=i(8742),s=i(5770),o=[],a=function(){function e(){this._handlers=Object.create(null),this._active=o,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return e.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=o},e.prototype.registerHandler=function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var i=this._handlers[e];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}},e.prototype.clearHandler=function(e){this._handlers[e]&&delete this._handlers[e]},e.prototype.setHandlerFallback=function(e){this._handlerFb=e},e.prototype.reset=function(){if(this._active.length)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=o,this._ident=0},e.prototype.hook=function(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||o,this._active.length)for(var i=this._active.length-1;i>=0;i--)this._active[i].hook(t);else this._handlerFb(this._ident,"HOOK",t)},e.prototype.put=function(e,t,i){if(this._active.length)for(var n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._ident,"PUT",(0,r.utf32ToString)(e,t,i))},e.prototype.unhook=function(e,t){if(void 0===t&&(t=!0),this._active.length){var i=!1,r=this._active.length-1,n=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;r>=0&&!0!==(i=this._active[r].unhook(e));r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if((i=this._active[r].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",e);this._active=o,this._ident=0},e}();t.DcsParser=a;var l=new n.Params;l.addParam(0);var h=function(){function e(e){this._handler=e,this._data="",this._params=l,this._hitLimit=!1}return e.prototype.hook=function(e){this._params=e.length>1||e.params[0]?e.clone():l,this._data="",this._hitLimit=!1},e.prototype.put=function(e,t,i){this._hitLimit||(this._data+=(0,r.utf32ToString)(e,t,i),this._data.length>s.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},e.prototype.unhook=function(e){var t=this,i=!1;if(this._hitLimit)i=!1;else if(e&&(i=this._handler(this._data,this._params))instanceof Promise)return i.then((function(e){return t._params=l,t._data="",t._hitLimit=!1,e}));return this._params=l,this._data="",this._hitLimit=!1,i},e}();t.DcsHandler=h},2015:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;var s=i(844),o=i(8273),a=i(8742),l=i(6242),h=i(6351),c=function(){function e(e){this.table=new Uint8Array(e)}return e.prototype.setDefault=function(e,t){(0,o.fill)(this.table,e<<4|t)},e.prototype.add=function(e,t,i,r){this.table[t<<8|e]=i<<4|r},e.prototype.addMany=function(e,t,i,r){for(var n=0;n<e.length;n++)this.table[t<<8|e[n]]=i<<4|r},e}();t.TransitionTable=c;var u=160;t.VT500_TRANSITION_TABLE=function(){var e=new c(4095),t=Array.apply(null,Array(256)).map((function(e,t){return t})),i=function(e,i){return t.slice(e,i)},r=i(32,127),n=i(0,24);n.push(25),n.push.apply(n,i(28,32));var s,o=i(0,14);for(s in e.setDefault(1,0),e.addMany(r,0,2,0),o)e.addMany([24,26,153,154],s,3,0),e.addMany(i(128,144),s,3,0),e.addMany(i(144,152),s,3,0),e.add(156,s,0,0),e.add(27,s,11,1),e.add(157,s,4,8),e.addMany([152,158,159],s,0,7),e.add(155,s,11,3),e.add(144,s,11,9);return e.addMany(n,0,3,0),e.addMany(n,1,3,1),e.add(127,1,0,1),e.addMany(n,8,0,8),e.addMany(n,3,3,3),e.add(127,3,0,3),e.addMany(n,4,3,4),e.add(127,4,0,4),e.addMany(n,6,3,6),e.addMany(n,5,3,5),e.add(127,5,0,5),e.addMany(n,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(r,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(r,7,0,7),e.addMany(n,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(n,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(n,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(n,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(n,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(n,13,13,13),e.addMany(r,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(u,0,2,0),e.add(u,8,5,8),e.add(u,6,0,6),e.add(u,11,0,11),e.add(u,13,13,13),e}();var f=function(e){function i(i){void 0===i&&(i=t.VT500_TRANSITION_TABLE);var r=e.call(this)||this;return r._transitions=i,r._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},r.initialState=0,r.currentState=r.initialState,r._params=new a.Params,r._params.addParam(0),r._collect=0,r.precedingCodepoint=0,r._printHandlerFb=function(e,t,i){},r._executeHandlerFb=function(e){},r._csiHandlerFb=function(e,t){},r._escHandlerFb=function(e){},r._errorHandlerFb=function(e){return e},r._printHandler=r._printHandlerFb,r._executeHandlers=Object.create(null),r._csiHandlers=Object.create(null),r._escHandlers=Object.create(null),r._oscParser=new l.OscParser,r._dcsParser=new h.DcsParser,r._errorHandler=r._errorHandlerFb,r.registerEscHandler({final:"\\"},(function(){return!0})),r}return n(i,e),i.prototype._identifier=function(e,t){void 0===t&&(t=[64,126]);var i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if((i=e.prefix.charCodeAt(0))&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(var r=0;r<e.intermediates.length;++r){var n=e.intermediates.charCodeAt(r);if(32>n||n>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=n}}if(1!==e.final.length)throw new Error("final must be a single byte");var s=e.final.charCodeAt(0);if(t[0]>s||s>t[1])throw new Error("final must be in range "+t[0]+" .. "+t[1]);return(i<<=8)|s},i.prototype.identToString=function(e){for(var t=[];e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")},i.prototype.dispose=function(){this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null),this._oscParser.dispose(),this._dcsParser.dispose()},i.prototype.setPrintHandler=function(e){this._printHandler=e},i.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},i.prototype.registerEscHandler=function(e,t){var i=this._identifier(e,[48,126]);void 0===this._escHandlers[i]&&(this._escHandlers[i]=[]);var r=this._escHandlers[i];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}},i.prototype.clearEscHandler=function(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]},i.prototype.setEscHandlerFallback=function(e){this._escHandlerFb=e},i.prototype.setExecuteHandler=function(e,t){this._executeHandlers[e.charCodeAt(0)]=t},i.prototype.clearExecuteHandler=function(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]},i.prototype.setExecuteHandlerFallback=function(e){this._executeHandlerFb=e},i.prototype.registerCsiHandler=function(e,t){var i=this._identifier(e);void 0===this._csiHandlers[i]&&(this._csiHandlers[i]=[]);var r=this._csiHandlers[i];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}},i.prototype.clearCsiHandler=function(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]},i.prototype.setCsiHandlerFallback=function(e){this._csiHandlerFb=e},i.prototype.registerDcsHandler=function(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)},i.prototype.clearDcsHandler=function(e){this._dcsParser.clearHandler(this._identifier(e))},i.prototype.setDcsHandlerFallback=function(e){this._dcsParser.setHandlerFallback(e)},i.prototype.registerOscHandler=function(e,t){return this._oscParser.registerHandler(e,t)},i.prototype.clearOscHandler=function(e){this._oscParser.clearHandler(e)},i.prototype.setOscHandlerFallback=function(e){this._oscParser.setHandlerFallback(e)},i.prototype.setErrorHandler=function(e){this._errorHandler=e},i.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},i.prototype.reset=function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])},i.prototype._preserveStack=function(e,t,i,r,n){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=r,this._parseStack.chunkPos=n},i.prototype.parse=function(e,t,i){var r,n=0,s=0,o=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,o=this._parseStack.chunkPos+1;else{if(void 0===i||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");var a=this._parseStack.handlers,l=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===i&&l>-1)for(;l>=0&&!0!==(r=a[l](this._params));l--)if(r instanceof Promise)return this._parseStack.handlerPos=l,r;this._parseStack.handlers=[];break;case 4:if(!1===i&&l>-1)for(;l>=0&&!0!==(r=a[l]());l--)if(r instanceof Promise)return this._parseStack.handlerPos=l,r;this._parseStack.handlers=[];break;case 6:if(n=e[this._parseStack.chunkPos],r=this._dcsParser.unhook(24!==n&&26!==n,i))return r;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(n=e[this._parseStack.chunkPos],r=this._oscParser.end(24!==n&&26!==n,i))return r;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,o=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(var h=o;h<t;++h){switch(n=e[h],(s=this._transitions.table[this.currentState<<8|(n<160?n:u)])>>4){case 2:for(var c=h+1;;++c){if(c>=t||(n=e[c])<32||n>126&&n<u){this._printHandler(e,h,c),h=c-1;break}if(++c>=t||(n=e[c])<32||n>126&&n<u){this._printHandler(e,h,c),h=c-1;break}if(++c>=t||(n=e[c])<32||n>126&&n<u){this._printHandler(e,h,c),h=c-1;break}if(++c>=t||(n=e[c])<32||n>126&&n<u){this._printHandler(e,h,c),h=c-1;break}}break;case 3:this._executeHandlers[n]?this._executeHandlers[n]():this._executeHandlerFb(n),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:h,code:n,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var f=(a=this._csiHandlers[this._collect<<8|n])?a.length-1:-1;f>=0&&!0!==(r=a[f](this._params));f--)if(r instanceof Promise)return this._preserveStack(3,a,f,s,h),r;f<0&&this._csiHandlerFb(this._collect<<8|n,this._params),this.precedingCodepoint=0;break;case 8:do{switch(n){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(n-48)}}while(++h<t&&(n=e[h])>47&&n<60);h--;break;case 9:this._collect<<=8,this._collect|=n;break;case 10:for(var d=this._escHandlers[this._collect<<8|n],p=d?d.length-1:-1;p>=0&&!0!==(r=d[p]());p--)if(r instanceof Promise)return this._preserveStack(4,d,p,s,h),r;p<0&&this._escHandlerFb(this._collect<<8|n),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|n,this._params);break;case 13:for(var g=h+1;;++g)if(g>=t||24===(n=e[g])||26===n||27===n||n>127&&n<u){this._dcsParser.put(e,h,g),h=g-1;break}break;case 14:if(r=this._dcsParser.unhook(24!==n&&26!==n))return this._preserveStack(6,[],0,s,h),r;27===n&&(s|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(var m=h+1;;m++)if(m>=t||(n=e[m])<32||n>127&&n<u){this._oscParser.put(e,h,m),h=m-1;break}break;case 6:if(r=this._oscParser.end(24!==n&&26!==n))return this._preserveStack(5,[],0,s,h),r;27===n&&(s|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&s}},i}(s.Disposable);t.EscapeSequenceParser=f},6242:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;var r=i(5770),n=i(482),s=[],o=function(){function e(){this._state=0,this._active=s,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return e.prototype.registerHandler=function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var i=this._handlers[e];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}},e.prototype.clearHandler=function(e){this._handlers[e]&&delete this._handlers[e]},e.prototype.setHandlerFallback=function(e){this._handlerFb=e},e.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=s},e.prototype.reset=function(){if(2===this._state)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=s,this._id=-1,this._state=0},e.prototype._start=function(){if(this._active=this._handlers[this._id]||s,this._active.length)for(var e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")},e.prototype._put=function(e,t,i){if(this._active.length)for(var r=this._active.length-1;r>=0;r--)this._active[r].put(e,t,i);else this._handlerFb(this._id,"PUT",(0,n.utf32ToString)(e,t,i))},e.prototype.start=function(){this.reset(),this._state=1},e.prototype.put=function(e,t,i){if(3!==this._state){if(1===this._state)for(;t<i;){var r=e[t++];if(59===r){this._state=2,this._start();break}if(r<48||57<r)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+r-48}2===this._state&&i-t>0&&this._put(e,t,i)}},e.prototype.end=function(e,t){if(void 0===t&&(t=!0),0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){var i=!1,r=this._active.length-1,n=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;r>=0&&!0!==(i=this._active[r].end(e));r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if((i=this._active[r].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}else this._handlerFb(this._id,"END",e);this._active=s,this._id=-1,this._state=0}},e}();t.OscParser=o;var a=function(){function e(e){this._handler=e,this._data="",this._hitLimit=!1}return e.prototype.start=function(){this._data="",this._hitLimit=!1},e.prototype.put=function(e,t,i){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,i),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},e.prototype.end=function(e){var t=this,i=!1;if(this._hitLimit)i=!1;else if(e&&(i=this._handler(this._data))instanceof Promise)return i.then((function(e){return t._data="",t._hitLimit=!1,e}));return this._data="",this._hitLimit=!1,i},e}();t.OscHandler=a},8742:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;var i=2147483647,r=function(){function e(e,t){if(void 0===e&&(e=32),void 0===t&&(t=32),this.maxLength=e,this.maxSubParamsLength=t,t>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(e),this.length=0,this._subParams=new Int32Array(t),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(e),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return e.fromArray=function(t){var i=new e;if(!t.length)return i;for(var r=t[0]instanceof Array?1:0;r<t.length;++r){var n=t[r];if(n instanceof Array)for(var s=0;s<n.length;++s)i.addSubParam(n[s]);else i.addParam(n)}return i},e.prototype.clone=function(){var t=new e(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t},e.prototype.toArray=function(){for(var e=[],t=0;t<this.length;++t){e.push(this.params[t]);var i=this._subParamsIdx[t]>>8,r=255&this._subParamsIdx[t];r-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,r))}return e},e.prototype.reset=function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1},e.prototype.addParam=function(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>i?i:e}},e.prototype.addSubParam=function(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>i?i:e,this._subParamsIdx[this.length-1]++}},e.prototype.hasSubParams=function(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0},e.prototype.getSubParams=function(e){var t=this._subParamsIdx[e]>>8,i=255&this._subParamsIdx[e];return i-t>0?this._subParams.subarray(t,i):null},e.prototype.getSubParamsAll=function(){for(var e={},t=0;t<this.length;++t){var i=this._subParamsIdx[t]>>8,r=255&this._subParamsIdx[t];r-i>0&&(e[t]=this._subParams.slice(i,r))}return e},e.prototype.addDigit=function(e){var t;if(!(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var r=this._digitIsSub?this._subParams:this.params,n=r[t-1];r[t-1]=~n?Math.min(10*n+e,i):e}},e}();t.Params=r},5741:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0;var i=function(){function e(){this._addons=[]}return e.prototype.dispose=function(){for(var e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()},e.prototype.loadAddon=function(e,t){var i=this,r={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(r),t.dispose=function(){return i._wrappedAddonDispose(r)},t.activate(e)},e.prototype._wrappedAddonDispose=function(e){if(!e.isDisposed){for(var t=-1,i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},e}();t.AddonManager=i},8771:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;var r=i(3785),n=i(511),s=function(){function e(e,t){this._buffer=e,this.type=t}return e.prototype.init=function(e){return this._buffer=e,this},Object.defineProperty(e.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!1,configurable:!0}),e.prototype.getLine=function(e){var t=this._buffer.lines.get(e);if(t)return new r.BufferLineApiView(t)},e.prototype.getNullCell=function(){return new n.CellData},e}();t.BufferApiView=s},3785:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;var r=i(511),n=function(){function e(e){this._line=e}return Object.defineProperty(e.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._line.length},enumerable:!1,configurable:!0}),e.prototype.getCell=function(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new r.CellData)},e.prototype.translateToString=function(e,t,i){return this._line.translateToString(e,t,i)},e}();t.BufferLineApiView=n},8285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;var r=i(8771),n=i(8460),s=function(){function e(e){var t=this;this._core=e,this._onBufferChange=new n.EventEmitter,this._normal=new r.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new r.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((function(){return t._onBufferChange.fire(t.active)}))}return Object.defineProperty(e.prototype,"onBufferChange",{get:function(){return this._onBufferChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normal",{get:function(){return this._normal.init(this._core.buffers.normal)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alternate",{get:function(){return this._alternate.init(this._core.buffers.alt)},enumerable:!1,configurable:!0}),e}();t.BufferNamespaceApi=s},7975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0;var i=function(){function e(e){this._core=e}return e.prototype.registerCsiHandler=function(e,t){return this._core.registerCsiHandler(e,(function(e){return t(e.toArray())}))},e.prototype.addCsiHandler=function(e,t){return this.registerCsiHandler(e,t)},e.prototype.registerDcsHandler=function(e,t){return this._core.registerDcsHandler(e,(function(e,i){return t(e,i.toArray())}))},e.prototype.addDcsHandler=function(e,t){return this.registerDcsHandler(e,t)},e.prototype.registerEscHandler=function(e,t){return this._core.registerEscHandler(e,t)},e.prototype.addEscHandler=function(e,t){return this.registerEscHandler(e,t)},e.prototype.registerOscHandler=function(e,t){return this._core.registerOscHandler(e,t)},e.prototype.addOscHandler=function(e,t){return this.registerOscHandler(e,t)},e}();t.ParserApi=i},7090:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0;var i=function(){function e(e){this._core=e}return e.prototype.register=function(e){this._core.unicodeService.register(e)},Object.defineProperty(e.prototype,"versions",{get:function(){return this._core.unicodeService.versions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeVersion",{get:function(){return this._core.unicodeService.activeVersion},set:function(e){this._core.unicodeService.activeVersion=e},enumerable:!1,configurable:!0}),e}();t.UnicodeApi=i},744:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;var a=i(2585),l=i(5295),h=i(8460),c=i(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;var u=function(e){function i(i){var r=e.call(this)||this;return r._optionsService=i,r.isUserScrolling=!1,r._onResize=new h.EventEmitter,r._onScroll=new h.EventEmitter,r.cols=Math.max(i.options.cols||0,t.MINIMUM_COLS),r.rows=Math.max(i.options.rows||0,t.MINIMUM_ROWS),r.buffers=new l.BufferSet(i,r),r}return n(i,e),Object.defineProperty(i.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){e.prototype.dispose.call(this),this.buffers.dispose()},i.prototype.resize=function(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this.buffers.setupTabStops(this.cols),this._onResize.fire({cols:e,rows:t})},i.prototype.reset=function(){this.buffers.reset(),this.isUserScrolling=!1},i.prototype.scroll=function(e,t){void 0===t&&(t=!1);var i,r=this.buffer;(i=this._cachedBlankLine)&&i.length===this.cols&&i.getFg(0)===e.fg&&i.getBg(0)===e.bg||(i=r.getBlankLine(e,t),this._cachedBlankLine=i),i.isWrapped=t;var n=r.ybase+r.scrollTop,s=r.ybase+r.scrollBottom;if(0===r.scrollTop){var o=r.lines.isFull;s===r.lines.length-1?o?r.lines.recycle().copyFrom(i):r.lines.push(i.clone()):r.lines.splice(s+1,0,i.clone()),o?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{var a=s-n+1;r.lines.shiftElements(n+1,a-1,-1),r.lines.set(s,i.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)},i.prototype.scrollLines=function(e,t,i){var r=this.buffer;if(e<0){if(0===r.ydisp)return;this.isUserScrolling=!0}else e+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);var n=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+e,r.ybase),0),n!==r.ydisp&&(t||this._onScroll.fire(r.ydisp))},i.prototype.scrollPages=function(e){this.scrollLines(e*(this.rows-1))},i.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},i.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},i.prototype.scrollToLine=function(e){var t=e-this.buffer.ydisp;0!==t&&this.scrollLines(t)},s([o(0,a.IOptionsService)],i)}(c.Disposable);t.BufferService=u},7994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0;var i=function(){function e(){this.glevel=0,this._charsets=[]}return e.prototype.reset=function(){this.charset=void 0,this._charsets=[],this.glevel=0},e.prototype.setgLevel=function(e){this.glevel=e,this.charset=this._charsets[e]},e.prototype.setgCharset=function(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)},e}();t.CharsetService=i},1753:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;var s=i(2585),o=i(8460),a={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(e){return 4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)}},VT200:{events:19,restrict:function(e){return 32!==e.action}},DRAG:{events:23,restrict:function(e){return 32!==e.action||3!==e.button}},ANY:{events:31,restrict:function(e){return!0}}};function l(e,t){var i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(i|=64,i|=e.action):(i|=3&e.button,4&e.button&&(i|=64),8&e.button&&(i|=128),32===e.action?i|=32:0!==e.action||t||(i|=3)),i}var h=String.fromCharCode,c={DEFAULT:function(e){var t=[l(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":"[M"+h(t[0])+h(t[1])+h(t[2])},SGR:function(e){var t=0===e.action&&4!==e.button?"m":"M";return"[<"+l(e,!0)+";"+e.col+";"+e.row+t}},u=function(){function e(e,t){this._bufferService=e,this._coreService=t,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._onProtocolChange=new o.EventEmitter,this._lastEvent=null;for(var i=0,r=Object.keys(a);i<r.length;i++){var n=r[i];this.addProtocol(n,a[n])}for(var s=0,l=Object.keys(c);s<l.length;s++){var h=l[s];this.addEncoding(h,c[h])}this.reset()}return e.prototype.addProtocol=function(e,t){this._protocols[e]=t},e.prototype.addEncoding=function(e,t){this._encodings[e]=t},Object.defineProperty(e.prototype,"activeProtocol",{get:function(){return this._activeProtocol},set:function(e){if(!this._protocols[e])throw new Error('unknown protocol "'+e+'"');this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"areMouseEventsActive",{get:function(){return 0!==this._protocols[this._activeProtocol].events},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeEncoding",{get:function(){return this._activeEncoding},set:function(e){if(!this._encodings[e])throw new Error('unknown encoding "'+e+'"');this._activeEncoding=e},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null},Object.defineProperty(e.prototype,"onProtocolChange",{get:function(){return this._onProtocolChange.event},enumerable:!1,configurable:!0}),e.prototype.triggerMouseEvent=function(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._compareEvents(this._lastEvent,e))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;var t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0},e.prototype.explainEvents=function(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}},e.prototype._compareEvents=function(e,t){return e.col===t.col&&e.row===t.row&&e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift},r([n(0,s.IBufferService),n(1,s.ICoreService)],e)}();t.CoreMouseService=u},6975:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;var a=i(2585),l=i(8460),h=i(1439),c=i(844),u=Object.freeze({insertMode:!1}),f=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),d=function(e){function t(t,i,r,n){var s=e.call(this)||this;return s._bufferService=i,s._logService=r,s._optionsService=n,s.isCursorInitialized=!1,s.isCursorHidden=!1,s._onData=s.register(new l.EventEmitter),s._onUserInput=s.register(new l.EventEmitter),s._onBinary=s.register(new l.EventEmitter),s._scrollToBottom=t,s.register({dispose:function(){return s._scrollToBottom=void 0}}),s.modes=(0,h.clone)(u),s.decPrivateModes=(0,h.clone)(f),s}return n(t,e),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUserInput",{get:function(){return this._onUserInput.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.modes=(0,h.clone)(u),this.decPrivateModes=(0,h.clone)(f)},t.prototype.triggerDataEvent=function(e,t){if(void 0===t&&(t=!1),!this._optionsService.options.disableStdin){var i=this._bufferService.buffer;i.ybase!==i.ydisp&&this._scrollToBottom(),t&&this._onUserInput.fire(),this._logService.debug('sending data "'+e+'"',(function(){return e.split("").map((function(e){return e.charCodeAt(0)}))})),this._onData.fire(e)}},t.prototype.triggerBinaryEvent=function(e){this._optionsService.options.disableStdin||(this._logService.debug('sending binary "'+e+'"',(function(){return e.split("").map((function(e){return e.charCodeAt(0)}))})),this._onBinary.fire(e))},s([o(1,a.IBufferService),o(2,a.ILogService),o(3,a.IOptionsService)],t)}(c.Disposable);t.CoreService=d},3730:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DirtyRowService=void 0;var s=i(2585),o=function(){function e(e){this._bufferService=e,this.clearRange()}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!1,configurable:!0}),e.prototype.clearRange=function(){this._start=this._bufferService.buffer.y,this._end=this._bufferService.buffer.y},e.prototype.markDirty=function(e){e<this._start?this._start=e:e>this._end&&(this._end=e)},e.prototype.markRangeDirty=function(e,t){if(e>t){var i=e;e=t,t=i}e<this._start&&(this._start=e),t>this._end&&(this._end=t)},e.prototype.markAllDirty=function(){this.markRangeDirty(0,this._bufferService.rows-1)},r([n(0,s.IBufferService)],e)}();t.DirtyRowService=o},4348:function(e,t,i){var r=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;var n=i(2585),s=i(8343),o=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._entries=new Map;for(var i=0,r=e;i<r.length;i++){var n=r[i],s=n[0],o=n[1];this.set(s,o)}}return e.prototype.set=function(e,t){var i=this._entries.get(e);return this._entries.set(e,t),i},e.prototype.forEach=function(e){this._entries.forEach((function(t,i){return e(i,t)}))},e.prototype.has=function(e){return this._entries.has(e)},e.prototype.get=function(e){return this._entries.get(e)},e}();t.ServiceCollection=o;var a=function(){function e(){this._services=new o,this._services.set(n.IInstantiationService,this)}return e.prototype.setService=function(e,t){this._services.set(e,t)},e.prototype.getService=function(e){return this._services.get(e)},e.prototype.createInstance=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var n=(0,s.getServiceDependencies)(e).sort((function(e,t){return e.index-t.index})),o=[],a=0,l=n;a<l.length;a++){var h=l[a],c=this._services.get(h.id);if(!c)throw new Error("[createInstance] "+e.name+" depends on UNKNOWN service "+h.id+".");o.push(c)}var u=n.length>0?n[0].index:t.length;if(t.length!==u)throw new Error("[createInstance] First service dependency of "+e.name+" at position "+(u+1)+" conflicts with "+t.length+" static arguments");return new(e.bind.apply(e,r([void 0],r(r([],t,!0),o,!0),!1)))},e}();t.InstantiationService=a},7866:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},s=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;var o=i(2585),a={debug:o.LogLevelEnum.DEBUG,info:o.LogLevelEnum.INFO,warn:o.LogLevelEnum.WARN,error:o.LogLevelEnum.ERROR,off:o.LogLevelEnum.OFF},l=function(){function e(e){var t=this;this._optionsService=e,this.logLevel=o.LogLevelEnum.OFF,this._updateLogLevel(),this._optionsService.onOptionChange((function(e){"logLevel"===e&&t._updateLogLevel()}))}return e.prototype._updateLogLevel=function(){this.logLevel=a[this._optionsService.options.logLevel]},e.prototype._evalLazyOptionalParams=function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())},e.prototype._log=function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,s([console,"xterm.js: "+t],i,!1))},e.prototype.debug=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=o.LogLevelEnum.DEBUG&&this._log(console.log,e,t)},e.prototype.info=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=o.LogLevelEnum.INFO&&this._log(console.info,e,t)},e.prototype.warn=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=o.LogLevelEnum.WARN&&this._log(console.warn,e,t)},e.prototype.error=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=o.LogLevelEnum.ERROR&&this._log(console.error,e,t)},r([n(0,o.IOptionsService)],e)}();t.LogService=l},7302:function(e,t,i){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=t.DEFAULT_BELL_SOUND=void 0;var n=i(8460),s=i(6114);t.DEFAULT_BELL_SOUND="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjMyLjEwNAAAAAAAAAAAAAAA//tQxAADB8AhSmxhIIEVCSiJrDCQBTcu3UrAIwUdkRgQbFAZC1CQEwTJ9mjRvBA4UOLD8nKVOWfh+UlK3z/177OXrfOdKl7pyn3Xf//WreyTRUoAWgBgkOAGbZHBgG1OF6zM82DWbZaUmMBptgQhGjsyYqc9ae9XFz280948NMBWInljyzsNRFLPWdnZGWrddDsjK1unuSrVN9jJsK8KuQtQCtMBjCEtImISdNKJOopIpBFpNSMbIHCSRpRR5iakjTiyzLhchUUBwCgyKiweBv/7UsQbg8isVNoMPMjAAAA0gAAABEVFGmgqK////9bP/6XCykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,bellSound:t.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,linkTooltipHoverDuration:500,letterSpacing:0,logLevel:"info",scrollback:1e3,scrollSensitivity:1,screenReaderMode:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!0,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:s.isMac,rendererType:"canvas",windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1};var o=["normal","bold","100","200","300","400","500","600","700","800","900"],a=["cols","rows"],l=function(){function e(e){for(var i in this._onOptionChange=new n.EventEmitter,this._options=r({},t.DEFAULT_OPTIONS),e)if(i in this._options)try{var s=e[i];this._options[i]=this._sanitizeAndValidateOption(i,s)}catch(e){console.error(e)}this.options=this._setupOptions(this._options,!1),this.publicOptions=this._setupOptions(this._options,!0)}return Object.defineProperty(e.prototype,"onOptionChange",{get:function(){return this._onOptionChange.event},enumerable:!1,configurable:!0}),e.prototype._setupOptions=function(e,i){var n=this,s=r({},e),o=function(e){Object.defineProperty(s,e,{get:function(){if(!(e in t.DEFAULT_OPTIONS))throw new Error('No option with key "'+e+'"');return n._options[e]},set:function(r){if(!(e in t.DEFAULT_OPTIONS))throw new Error('No option with key "'+e+'"');if(i&&a.includes(e))throw new Error('Option "'+e+'" can only be set in the constructor');r=n._sanitizeAndValidateOption(e,r),n._options[e]!==r&&(n._options[e]=r,n._onOptionChange.fire(e))}})};for(var l in s)o(l);return s},e.prototype.setOption=function(e,t){this.publicOptions[e]=t},e.prototype._sanitizeAndValidateOption=function(e,i){switch(e){case"bellStyle":case"cursorStyle":case"rendererType":case"wordSeparator":i||(i=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=o.includes(i)?i:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(e+" cannot be less than 1, value: "+i);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(e+" cannot be less than 0, value: "+i);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(e+" cannot be less than or equal to 0, value: "+i);case"rows":case"cols":if(!i&&0!==i)throw new Error(e+" must be numeric, value: "+i)}return i},e.prototype.getOption=function(e){return this.publicOptions[e]},e}();t.OptionsService=l},8343:(e,t)=>{function i(e,t,i){t.di$target===t?t.di$dependencies.push({id:e,index:i}):(t.di$dependencies=[{id:e,index:i}],t.di$target=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e.di$dependencies||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var r=function(e,t,n){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");i(r,e,n)};return r.toString=function(){return e},t.serviceRegistry.set(e,r),r}},2585:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IUnicodeService=t.LogLevelEnum=t.IOptionsService=t.ILogService=t.IInstantiationService=t.IDirtyRowService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var r,n=i(8343);t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IDirtyRowService=(0,n.createDecorator)("DirtyRowService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),(r=t.LogLevelEnum||(t.LogLevelEnum={}))[r.DEBUG=0]="DEBUG",r[r.INFO=1]="INFO",r[r.WARN=2]="WARN",r[r.ERROR=3]="ERROR",r[r.OFF=4]="OFF",t.IUnicodeService=(0,n.createDecorator)("UnicodeService")},1480:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;var r=i(8460),n=i(225),s=function(){function e(){this._providers=Object.create(null),this._active="",this._onChange=new r.EventEmitter;var e=new n.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}return Object.defineProperty(e.prototype,"onChange",{get:function(){return this._onChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"versions",{get:function(){return Object.keys(this._providers)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeVersion",{get:function(){return this._active},set:function(e){if(!this._providers[e])throw new Error('unknown Unicode version "'+e+'"');this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)},enumerable:!1,configurable:!0}),e.prototype.register=function(e){this._providers[e.version]=e},e.prototype.wcwidth=function(e){return this._activeProvider.wcwidth(e)},e.prototype.getStringCellWidth=function(e){for(var t=0,i=e.length,r=0;r<i;++r){var n=e.charCodeAt(r);if(55296<=n&&n<=56319){if(++r>=i)return t+this.wcwidth(n);var s=e.charCodeAt(r);56320<=s&&s<=57343?n=1024*(n-55296)+s-56320+65536:t+=this.wcwidth(s)}t+=this.wcwidth(n)}return t},e}();t.UnicodeService=s}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;var t=i(3236),n=i(9042),s=i(7975),o=i(7090),a=i(5741),l=i(8285),h=function(){function e(e){this._core=new t.Terminal(e),this._addonManager=new a.AddonManager}return e.prototype._checkProposedApi=function(){if(!this._core.optionsService.options.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")},Object.defineProperty(e.prototype,"onBell",{get:function(){return this._core.onBell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBinary",{get:function(){return this._core.onBinary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onData",{get:function(){return this._core.onData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._core.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parser",{get:function(){return this._checkProposedApi(),this._parser||(this._parser=new s.ParserApi(this._core)),this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unicode",{get:function(){return this._checkProposedApi(),new o.UnicodeApi(this._core)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._core.rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cols",{get:function(){return this._core.cols},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._checkProposedApi(),this._buffer||(this._buffer=new l.BufferNamespaceApi(this._core)),this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"markers",{get:function(){return this._checkProposedApi(),this._core.markers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modes",{get:function(){var e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._core.options},enumerable:!1,configurable:!0}),e.prototype.blur=function(){this._core.blur()},e.prototype.focus=function(){this._core.focus()},e.prototype.resize=function(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)},e.prototype.open=function(e){this._core.open(e)},e.prototype.attachCustomKeyEventHandler=function(e){this._core.attachCustomKeyEventHandler(e)},e.prototype.registerLinkMatcher=function(e,t,i){return this._checkProposedApi(),this._core.registerLinkMatcher(e,t,i)},e.prototype.deregisterLinkMatcher=function(e){this._checkProposedApi(),this._core.deregisterLinkMatcher(e)},e.prototype.registerLinkProvider=function(e){return this._checkProposedApi(),this._core.registerLinkProvider(e)},e.prototype.registerCharacterJoiner=function(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)},e.prototype.deregisterCharacterJoiner=function(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)},e.prototype.registerMarker=function(e){return this._checkProposedApi(),this._verifyIntegers(e),this._core.addMarker(e)},e.prototype.addMarker=function(e){return this.registerMarker(e)},e.prototype.hasSelection=function(){return this._core.hasSelection()},e.prototype.select=function(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)},e.prototype.getSelection=function(){return this._core.getSelection()},e.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},e.prototype.clearSelection=function(){this._core.clearSelection()},e.prototype.selectAll=function(){this._core.selectAll()},e.prototype.selectLines=function(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)},e.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},e.prototype.scrollLines=function(e){this._verifyIntegers(e),this._core.scrollLines(e)},e.prototype.scrollPages=function(e){this._verifyIntegers(e),this._core.scrollPages(e)},e.prototype.scrollToTop=function(){this._core.scrollToTop()},e.prototype.scrollToBottom=function(){this._core.scrollToBottom()},e.prototype.scrollToLine=function(e){this._verifyIntegers(e),this._core.scrollToLine(e)},e.prototype.clear=function(){this._core.clear()},e.prototype.write=function(e,t){this._core.write(e,t)},e.prototype.writeUtf8=function(e,t){this._core.write(e,t)},e.prototype.writeln=function(e,t){this._core.write(e),this._core.write("\r\n",t)},e.prototype.paste=function(e){this._core.paste(e)},e.prototype.getOption=function(e){return this._core.optionsService.getOption(e)},e.prototype.setOption=function(e,t){this._core.optionsService.setOption(e,t)},e.prototype.refresh=function(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)},e.prototype.reset=function(){this._core.reset()},e.prototype.clearTextureAtlas=function(){this._core.clearTextureAtlas()},e.prototype.loadAddon=function(e){return this._addonManager.loadAddon(this,e)},Object.defineProperty(e,"strings",{get:function(){return n},enumerable:!1,configurable:!0}),e.prototype._verifyIntegers=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n===1/0||isNaN(n)||n%1!=0)throw new Error("This API only accepts integers")}},e}();e.Terminal=h})(),r})()}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,i),s.exports}i.m=e,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i.b=document.baseURI||self.location.href,(()=>{"use strict";const e=()=>new Map,t=t=>{const i=e();return t.forEach(((e,t)=>{i.set(t,e)})),i},r=(e,t,i)=>{let r=e.get(t);return void 0===r&&e.set(t,r=i()),r},n=()=>new Set,s=e=>e[e.length-1],o=(e,t)=>{for(let i=0;i<t.length;i++)e.push(t[i])},a=Array.from;class l{constructor(){this._observers=e()}on(e,t){r(this._observers,e,n).add(t)}once(e,t){const i=(...r)=>{this.off(e,i),t(...r)};this.on(e,i)}off(e,t){const i=this._observers.get(e);void 0!==i&&(i.delete(t),0===i.size&&this._observers.delete(e))}emit(t,i){return a((this._observers.get(t)||e()).values()).forEach((e=>e(...i)))}destroy(){this._observers=e()}}const h=Math.floor,c=(Math.ceil,Math.abs),u=(Math.imul,Math.round,Math.log10),f=(Math.log2,Math.log,Math.sqrt,(e,t)=>e<t?e:t),d=(e,t)=>e>t?e:t,p=(Number.isNaN,Math.pow,Math.sign,e=>0!==e?e<0:1/e<0),g=String.fromCharCode,m=(String.fromCodePoint,/^\s*/g),_=/([A-Z])/g,v=(e,t)=>(e=>e.replace(m,""))(e.replace(_,(e=>`${t}${(e=>e.toLowerCase())(e)}`))),y="undefined"!=typeof TextEncoder?new TextEncoder:null,b=y?e=>y.encode(e):e=>{const t=unescape(encodeURIComponent(e)),i=t.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=t.codePointAt(e);return r};let O="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});O&&1===O.decode(new Uint8Array).length&&(O=null);let w=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},S=!0;try{"undefined"!=typeof localStorage&&(w=localStorage,S=!1)}catch(e){}const C=w,k="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name),x="undefined"!=typeof window&&!k;let E;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);const A=[],T=e=>{return void 0===(t=k?process.env[e.toUpperCase()]:C.getItem(e))?null:t;var t};(t=>(()=>{if(void 0===E)if(k){E=e();const t=process.argv;let i=null;for(let e=0;e<t.length;e++){const r=t[e];"-"===r[0]?(null!==i&&E.set(i,""),i=r):null!==i?(E.set(i,r),i=null):A.push(r)}null!==i&&E.set(i,"")}else"object"==typeof location?(E=e(),(location.search||"?").slice(1).split("&").forEach((e=>{if(0!==e.length){const[t,i]=e.split("=");E.set(`--${v(t,"-")}`,i),E.set(`-${v(t,"-")}`,i)}}))):E=e();return E})().has(t))("--"+"production")||T("production");const P=e=>new Uint8Array(e),L=(e,t,i)=>new Uint8Array(e,t,i),R=x?e=>{let t="";for(let i=0;i<e.byteLength;i++)t+=g(e[i]);return btoa(t)}:e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),M=x?e=>{const t=atob(e),i=P(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);return i}:e=>{const t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},D=64,B=128,I=127,Q=(Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&h(e)===e));Number.isNaN,Number.parseInt;class ${constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const H=()=>new $,W=e=>{const t=new Uint8Array((e=>{let t=e.cpos;for(let i=0;i<e.bufs.length;i++)t+=e.bufs[i].length;return t})(e));let i=0;for(let r=0;r<e.bufs.length;r++){const n=e.bufs[r];t.set(n,i),i+=n.length}return t.set(L(e.cbuf.buffer,0,e.cpos),i),t},N=(e,t)=>{const i=e.cbuf.length;e.cpos===i&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*i),e.cpos=0),e.cbuf[e.cpos++]=t},F=N,j=(e,t)=>{for(;t>I;)N(e,B|I&t),t>>>=7;N(e,I&t)},U=(e,t)=>{const i=p(t);for(i&&(t=-t),N(e,(t>63?B:0)|(i?D:0)|63&t),t>>>=6;t>0;)N(e,(t>I?B:0)|I&t),t>>>=7},q=(e,t)=>{const i=unescape(encodeURIComponent(t)),r=i.length;j(e,r);for(let t=0;t<r;t++)N(e,i.codePointAt(t))},X=(e,t)=>{const i=e.cbuf.length,r=e.cpos,n=f(i-r,t.length),s=t.length-n;e.cbuf.set(t.subarray(0,n),r),e.cpos+=n,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(d(2*i,s)),e.cbuf.set(t.subarray(n)),e.cpos=s)},z=(e,t)=>{j(e,t.byteLength),X(e,t)},V=(e,t)=>{((e,t)=>{const i=e.cbuf.length;i-e.cpos<t&&(e.bufs.push(L(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*d(i,t)),e.cpos=0)})(e,t);const i=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,i},Y=new DataView(new ArrayBuffer(4)),G=(e,t)=>{switch(typeof t){case"string":N(e,119),q(e,t);break;case"number":Q(t)&&t<=2147483647?(N(e,125),U(e,t)):(i=t,Y.setFloat32(0,i),Y.getFloat32(0)===i?(N(e,124),((e,t)=>{V(e,4).setFloat32(0,t,!1)})(e,t)):(N(e,123),((e,t)=>{V(e,8).setFloat64(0,t,!1)})(e,t)));break;case"bigint":N(e,122),((e,t)=>{V(e,8).setBigInt64(0,t,!1)})(e,t);break;case"object":if(null===t)N(e,126);else if(t instanceof Array){N(e,117),j(e,t.length);for(let i=0;i<t.length;i++)G(e,t[i])}else if(t instanceof Uint8Array)N(e,116),z(e,t);else{N(e,118);const i=Object.keys(t);j(e,i.length);for(let r=0;r<i.length;r++){const n=i[r];q(e,n),G(e,t[n])}}break;case"boolean":N(e,t?120:121);break;default:N(e,127)}var i};class Z extends ${constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&j(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const K=e=>{e.count>0&&(U(e.encoder,1===e.count?e.s:-e.s),e.count>1&&j(e.encoder,e.count-2))};class J{constructor(){this.encoder=new $,this.s=0,this.count=0}write(e){this.s===e?this.count++:(K(this),this.count=1,this.s=e)}toUint8Array(){return K(this),W(this.encoder)}}const ee=e=>{if(e.count>0){const t=e.diff<<1|(1===e.count?0:1);U(e.encoder,t),e.count>1&&j(e.encoder,e.count-2)}};class te{constructor(){this.encoder=new $,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(ee(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return ee(this),W(this.encoder)}}class ie{constructor(){this.sarr=[],this.s="",this.lensE=new J}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new $;return this.sarr.push(this.s),this.s="",q(e,this.sarr.join("")),X(e,this.lensE.toUint8Array()),W(e)}}class re{constructor(e){this.arr=e,this.pos=0}}const ne=e=>new re(e),se=e=>((e,t)=>{const i=L(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,i})(e,ae(e)),oe=e=>e.arr[e.pos++],ae=e=>{let t=0,i=0;for(;;){const r=e.arr[e.pos++];if(t|=(r&I)<<i,i+=7,r<B)return t>>>0;if(i>35)throw new Error("Integer out of range!")}},le=e=>{let t=e.arr[e.pos++],i=63&t,r=6;const n=(t&D)>0?-1:1;if(0==(t&B))return n*i;for(;;){if(t=e.arr[e.pos++],i|=(t&I)<<r,r+=7,t<B)return n*(i>>>0);if(r>41)throw new Error("Integer out of range!")}},he=e=>{let t=ae(e);if(0===t)return"";{let i=String.fromCodePoint(oe(e));if(--t<100)for(;t--;)i+=String.fromCodePoint(oe(e));else for(;t>0;){const r=t<1e4?t:1e4,n=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,i+=String.fromCodePoint.apply(null,n),t-=r}return decodeURIComponent(escape(i))}},ce=(e,t)=>{const i=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,i},ue=[e=>{},e=>null,le,e=>ce(e,4).getFloat32(0,!1),e=>ce(e,8).getFloat64(0,!1),e=>ce(e,8).getBigInt64(0,!1),e=>!1,e=>!0,he,e=>{const t=ae(e),i={};for(let r=0;r<t;r++)i[he(e)]=fe(e);return i},e=>{const t=ae(e),i=[];for(let r=0;r<t;r++)i.push(fe(e));return i},se],fe=e=>ue[127-oe(e)](e);class de extends re{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),(e=this).pos!==e.arr.length?this.count=ae(this)+1:this.count=-1),this.count--,this.s;var e}}class pe extends re{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=le(this);const e=p(this.s);this.count=1,e&&(this.s=-this.s,this.count=ae(this)+2)}return this.count--,this.s}}class ge extends re{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const e=le(this),t=1&e;this.diff=e>>1,this.count=1,t&&(this.count=ae(this)+2)}return this.s+=this.diff,this.count--,this.s}}class me{constructor(e){this.decoder=new pe(e),this.str=he(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}"undefined"==typeof window||void 0!==window.performance&&window.performance;const _e="undefined"==typeof crypto?null:crypto,ve=null!==_e?e=>{const t=new ArrayBuffer(e),i=new Uint8Array(t);return _e.getRandomValues(i),t}:e=>{const t=new ArrayBuffer(e),i=new Uint8Array(t);for(let t=0;t<e;t++)i[t]=Math.ceil(4294967295*Math.random()>>>0);return t},ye=Math.random,be=()=>new Uint32Array(ve(4))[0],Oe=[1e7]+-1e3+-4e3+-8e3+-1e11,we=()=>Oe.replace(/[018]/g,(e=>(e^be()&15>>e/4).toString(16))),Se=e=>Promise.resolve(e),Ce=e=>new Error(e),ke=()=>{throw Ce("Method unimplemented")},xe=()=>{throw Ce("Unexpected case")},Ee=(Object.assign,Object.keys),Ae=e=>Ee(e).length,Te=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Pe=(e,t,i=0)=>{try{for(;i<e.length;i++)e[i](...t)}finally{i<e.length&&Pe(e,t,i+1)}},Le=()=>{},Re=(e,t)=>{if(null==e||null==t)return((e,t)=>e===t)(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;break;case Set:if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;break;case Map:if(e.size!==t.size)return!1;for(const i of e.keys())if(!t.has(i)||!Re(e.get(i),t.get(i)))return!1;break;case Object:if(Ae(e)!==Ae(t))return!1;for(const i in e)if(!Te(e,i)||!Re(e[i],t[i]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Re(e[i],t[i]))return!1;break;default:return!1}return!0},Me=Symbol;class De{constructor(e,t){this.left=e,this.right=t}}const Be=(e,t)=>new De(e,t),Ie="undefined"!=typeof document?document:{},Qe=("undefined"!=typeof DOMParser&&new DOMParser,e=>{const t=Ie.createDocumentFragment();for(let i=0;i<e.length;i++)He(t,e[i]);return t}),$e=(e,t=[],i=[])=>{return r=((e,t)=>{var i;return i=(t,i)=>{!1===i?e.removeAttribute(t):!0===i?e.setAttribute(t,""):e.setAttribute(t,i)},t.forEach((e=>i(e.left,e.right))),e})((e=>Ie.createElement(e))(e),t),He(r,Qe(i)),r;var r},He=(e,t)=>e.appendChild(t),We=(Ie.ELEMENT_NODE,Ie.TEXT_NODE,Ie.CDATA_SECTION_NODE,Ie.COMMENT_NODE,Ie.DOCUMENT_NODE,Ie.DOCUMENT_TYPE_NODE,Ie.DOCUMENT_FRAGMENT_NODE,Date.now),Ne=Me(),Fe=Me(),je=Me(),Ue=Me(),qe=Me(),Xe=Me(),ze=Me(),Ve=Me(),Ye=Me(),Ge={[Ne]:Be("font-weight","bold"),[Fe]:Be("font-weight","normal"),[je]:Be("color","blue"),[qe]:Be("color","green"),[Ue]:Be("color","grey"),[Xe]:Be("color","red"),[ze]:Be("color","purple"),[Ve]:Be("color","orange"),[Ye]:Be("color","black")},Ze={[Ne]:"[1m",[Fe]:"[2m",[je]:"[34m",[qe]:"[32m",[Ue]:"[37m",[Xe]:"[31m",[ze]:"[35m",[Ve]:"[38;5;208m",[Ye]:"[0m"},Ke=k?e=>{const t=[],i=[];let r=0;for(;r<e.length;r++){const i=e[r],n=Ze[i];if(void 0!==n)t.push(n);else{if(i.constructor!==String&&i.constructor!==Number)break;t.push(i)}}for(r>0&&(t.push("[0m"),i.push(t.join("")));r<e.length;r++){const t=e[r];t instanceof Symbol||i.push(t)}return i}:t=>{const i=[],r=[],n=e();let s=[],o=0;for(;o<t.length;o++){const e=t[o],s=Ge[e];if(void 0!==s)n.set(s.left,s.right);else{if(e.constructor!==String&&e.constructor!==Number)break;{const t=((e,t)=>{const i=[];for(const[r,n]of e)i.push(t(n,r));return i})(n,((e,t)=>`${t}:${e};`)).join("");o>0||t.length>0?(i.push("%c"+e),r.push(t)):i.push(e)}}}for(o>0&&(s=r,s.unshift(i.join("")));o<t.length;o++){const e=t[o];e instanceof Symbol||s.push(e)}return s},Je=(...e)=>{console.log(...Ke(e)),et.forEach((t=>t.print(e)))},et=new Set,tt=[qe,ze,Ve,je];let it=0,rt=We();const nt=e=>({[Symbol.iterator](){return this},next:e}),st=(e,t)=>nt((()=>{const{done:i,value:r}=e.next();return{done:i,value:i?void 0:t(r)}}));class ot{constructor(e,t){this.clock=e,this.len=t}}class at{constructor(){this.clients=new Map}}const lt=(e,t,i)=>t.clients.forEach(((t,r)=>{const n=e.doc.store.clients.get(r);for(let r=0;r<t.length;r++){const s=t[r];hi(e,n,s.clock,s.len,i)}})),ht=(e,t)=>{const i=e.clients.get(t.client);return void 0!==i&&null!==((e,t)=>{let i=0,r=e.length-1;for(;i<=r;){const n=h((i+r)/2),s=e[n],o=s.clock;if(o<=t){if(t<o+s.len)return n;i=n+1}else r=n-1}return null})(i,t.clock)},ct=e=>{e.clients.forEach((e=>{let t,i;for(e.sort(((e,t)=>e.clock-t.clock)),t=1,i=1;t<e.length;t++){const r=e[i-1],n=e[t];r.clock+r.len>=n.clock?r.len=d(r.len,n.clock+n.len-r.clock):(i<t&&(e[i]=n),i++)}e.length=i}))},ut=e=>{const t=new at;for(let i=0;i<e.length;i++)e[i].clients.forEach(((r,n)=>{if(!t.clients.has(n)){const s=r.slice();for(let t=i+1;t<e.length;t++)o(s,e[t].clients.get(n)||[]);t.clients.set(n,s)}}));return ct(t),t},ft=(e,t,i,n)=>{r(e.clients,t,(()=>[])).push(new ot(i,n))},dt=()=>new at,pt=(e,t)=>{j(e.restEncoder,t.clients.size),t.clients.forEach(((t,i)=>{e.resetDsCurVal(),j(e.restEncoder,i);const r=t.length;j(e.restEncoder,r);for(let i=0;i<r;i++){const r=t[i];e.writeDsClock(r.clock),e.writeDsLen(r.len)}}))},gt=e=>{const t=new at,i=ae(e.restDecoder);for(let n=0;n<i;n++){e.resetDsCurVal();const i=ae(e.restDecoder),n=ae(e.restDecoder);if(n>0){const s=r(t.clients,i,(()=>[]));for(let t=0;t<n;t++)s.push(new ot(e.readDsClock(),e.readDsLen()))}}return t},mt=(e,t,i)=>{const r=new at,n=ae(e.restDecoder);for(let s=0;s<n;s++){e.resetDsCurVal();const n=ae(e.restDecoder),s=ae(e.restDecoder),o=i.clients.get(n)||[],a=ii(i,n);for(let i=0;i<s;i++){const i=e.readDsClock(),s=i+e.readDsLen();if(i<a){a<s&&ft(r,n,a,s-a);let e=ni(o,i),l=o[e];for(!l.deleted&&l.id.clock<i&&(o.splice(e+1,0,Xr(t,l,i-l.id.clock)),e++);e<o.length&&(l=o[e++],l.id.clock<s);)l.deleted||(s<l.id.clock+l.length&&o.splice(e,0,Xr(t,l,s-l.id.clock)),l.delete(t))}else ft(r,n,i,s-i)}}if(r.clients.size>0){const e=new kt;return j(e.restEncoder,0),pt(e,r),e.toUint8Array()}return null},_t=be;class vt extends l{constructor({guid:e=we(),collectionid:t=null,gc:i=!0,gcFilter:r=(()=>!0),meta:n=null,autoLoad:s=!1,shouldLoad:o=!0}={}){var a;super(),this.gc=i,this.gcFilter=r,this.clientID=_t(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new ei,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=s,this.meta=n,this.isLoaded=!1,this.whenLoaded=(a=e=>{this.on("load",(()=>{this.isLoaded=!0,e(this)}))},new Promise(a))}load(){const e=this._item;null===e||this.shouldLoad||gi(e.parent.doc,(e=>{e.subdocsLoaded.add(this)}),null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map((e=>e.guid)))}transact(e,t=null){gi(this,e,t)}get(e,t=Qi){const i=r(this.share,e,(()=>{const e=new t;return e._integrate(this,null),e})),n=i.constructor;if(t!==Qi&&n!==t){if(n===Qi){const r=new t;r._map=i._map,i._map.forEach((e=>{for(;null!==e;e=e.left)e.parent=r})),r._start=i._start;for(let e=r._start;null!==e;e=e.right)e.parent=r;return r._length=i._length,this.share.set(e,r),r._integrate(this,null),r}throw new Error(`Type with the name ${e} has already been defined with a different constructor`)}return i}getArray(e=""){return this.get(e,tr)}getText(e=""){return this.get(e,_r)}getMap(e=""){return this.get(e,rr)}getXmlFragment(e=""){return this.get(e,yr)}toJSON(){const e={};return this.share.forEach(((t,i)=>{e[i]=t.toJSON()})),e}destroy(){a(this.subdocs).forEach((e=>e.destroy()));const e=this._item;if(null!==e){this._item=null;const t=e.content;t.doc=new vt({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,gi(e.parent.doc,(i=>{const r=t.doc;e.deleted||i.subdocsAdded.add(r),i.subdocsRemoved.add(this)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(e,t){super.on(e,t)}off(e,t){super.off(e,t)}}class yt{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return ae(this.restDecoder)}readDsLen(){return ae(this.restDecoder)}}class bt extends yt{readLeftID(){return $t(ae(this.restDecoder),ae(this.restDecoder))}readRightID(){return $t(ae(this.restDecoder),ae(this.restDecoder))}readClient(){return ae(this.restDecoder)}readInfo(){return oe(this.restDecoder)}readString(){return he(this.restDecoder)}readParentInfo(){return 1===ae(this.restDecoder)}readTypeRef(){return ae(this.restDecoder)}readLen(){return ae(this.restDecoder)}readAny(){return fe(this.restDecoder)}readBuf(){return(e=>{const t=P(e.byteLength);return t.set(e),t})(se(this.restDecoder))}readJSON(){return JSON.parse(he(this.restDecoder))}readKey(){return he(this.restDecoder)}}class Ot extends class{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=ae(this.restDecoder),this.dsCurrVal}readDsLen(){const e=ae(this.restDecoder)+1;return this.dsCurrVal+=e,e}}{constructor(e){super(e),this.keys=[],ae(e),this.keyClockDecoder=new ge(se(e)),this.clientDecoder=new pe(se(e)),this.leftClockDecoder=new ge(se(e)),this.rightClockDecoder=new ge(se(e)),this.infoDecoder=new de(se(e),oe),this.stringDecoder=new me(se(e)),this.parentInfoDecoder=new de(se(e),oe),this.typeRefDecoder=new pe(se(e)),this.lenDecoder=new pe(se(e))}readLeftID(){return new It(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new It(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return fe(this.restDecoder)}readBuf(){return se(this.restDecoder)}readJSON(){return fe(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class wt{constructor(){this.restEncoder=H()}toUint8Array(){return W(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){j(this.restEncoder,e)}writeDsLen(e){j(this.restEncoder,e)}}class St extends wt{writeLeftID(e){j(this.restEncoder,e.client),j(this.restEncoder,e.clock)}writeRightID(e){j(this.restEncoder,e.client),j(this.restEncoder,e.clock)}writeClient(e){j(this.restEncoder,e)}writeInfo(e){F(this.restEncoder,e)}writeString(e){q(this.restEncoder,e)}writeParentInfo(e){j(this.restEncoder,e?1:0)}writeTypeRef(e){j(this.restEncoder,e)}writeLen(e){j(this.restEncoder,e)}writeAny(e){G(this.restEncoder,e)}writeBuf(e){z(this.restEncoder,e)}writeJSON(e){q(this.restEncoder,JSON.stringify(e))}writeKey(e){q(this.restEncoder,e)}}class Ct{constructor(){this.restEncoder=H(),this.dsCurrVal=0}toUint8Array(){return W(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,j(this.restEncoder,t)}writeDsLen(e){0===e&&xe(),j(this.restEncoder,e-1),this.dsCurrVal+=e}}class kt extends Ct{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new te,this.clientEncoder=new J,this.leftClockEncoder=new te,this.rightClockEncoder=new te,this.infoEncoder=new Z(F),this.stringEncoder=new ie,this.parentInfoEncoder=new Z(F),this.typeRefEncoder=new J,this.lenEncoder=new J}toUint8Array(){const e=H();return j(e,0),z(e,this.keyClockEncoder.toUint8Array()),z(e,this.clientEncoder.toUint8Array()),z(e,this.leftClockEncoder.toUint8Array()),z(e,this.rightClockEncoder.toUint8Array()),z(e,W(this.infoEncoder)),z(e,this.stringEncoder.toUint8Array()),z(e,W(this.parentInfoEncoder)),z(e,this.typeRefEncoder.toUint8Array()),z(e,this.lenEncoder.toUint8Array()),X(e,W(this.restEncoder)),W(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){G(this.restEncoder,e)}writeBuf(e){z(this.restEncoder,e)}writeJSON(e){G(this.restEncoder,e)}writeKey(e){void 0===this.keyMap.get(e)?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(this.keyClock++)}}const xt=(e,t,i)=>{const r=new Map;i.forEach(((e,i)=>{ii(t,i)>e&&r.set(i,e)})),ti(t).forEach(((e,t)=>{i.has(t)||r.set(t,0)})),j(e.restEncoder,r.size),Array.from(r.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([i,r])=>{((e,t,i,r)=>{r=d(r,t[0].id.clock);const n=ni(t,r);j(e.restEncoder,t.length-n),e.writeClient(i),j(e.restEncoder,r);const s=t[n];s.write(e,r-s.id.clock);for(let i=n+1;i<t.length;i++)t[i].write(e,0)})(e,t.clients.get(i),i,r)}))},Et=(t,i,n,s=Ot)=>{const o=ne(i);((t,i,n,s=new Ot(t))=>{gi(i,(t=>{t.local=!1;let i=!1;const n=t.doc,o=n.store,a=((t,i)=>{const r=e(),n=ae(t.restDecoder);for(let e=0;e<n;e++){const e=ae(t.restDecoder),n=new Array(e),s=t.readClient();let o=ae(t.restDecoder);r.set(s,{i:0,refs:n});for(let r=0;r<e;r++){const e=t.readInfo();switch(31&e){case 0:{const e=t.readLen();n[r]=new kr($t(s,o),e),o+=e;break}case 10:{const e=ae(t.restDecoder);n[r]=new Zr($t(s,o),e),o+=e;break}default:{const a=0==(192&e),l=new Vr($t(s,o),null,(e&B)===B?t.readLeftID():null,null,(e&D)===D?t.readRightID():null,a?t.readParentInfo()?i.get(t.readString()):t.readLeftID():null,a&&32==(32&e)?t.readString():null,Yr(t,e));n[r]=l,o+=l.length}}}}return r})(s,n),l=((e,t,i)=>{const n=[];let s=Array.from(i.keys()).sort(((e,t)=>e-t));if(0===s.length)return null;const o=()=>{if(0===s.length)return null;let e=i.get(s[s.length-1]);for(;e.refs.length===e.i;){if(s.pop(),!(s.length>0))return null;e=i.get(s[s.length-1])}return e};let a=o();if(null===a&&0===n.length)return null;const l=new ei,h=new Map,c=(e,t)=>{const i=h.get(e);(null==i||i>t)&&h.set(e,t)};let u=a.refs[a.i++];const f=new Map,d=()=>{for(const e of n){const t=e.id.client,r=i.get(t);r?(r.i--,l.clients.set(t,r.refs.slice(r.i)),i.delete(t),r.i=0,r.refs=[]):l.clients.set(t,[e]),s=s.filter((e=>e!==t))}n.length=0};for(;;){if(u.constructor!==Zr){const s=r(f,u.id.client,(()=>ii(t,u.id.client)))-u.id.clock;if(s<0)n.push(u),c(u.id.client,u.id.clock-1),d();else{const r=u.getMissing(e,t);if(null!==r){n.push(u);const e=i.get(r)||{refs:[],i:0};if(e.refs.length!==e.i){u=e.refs[e.i++];continue}c(r,ii(t,r)),d()}else(0===s||s<u.length)&&(u.integrate(e,s),f.set(u.id.client,u.id.clock+u.length))}}if(n.length>0)u=n.pop();else if(null!==a&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=o(),null===a)break;u=a.refs[a.i++]}}if(l.clients.size>0){const e=new kt;return xt(e,l,new Map),j(e.restEncoder,0),{missing:h,update:e.toUint8Array()}}return null})(t,o,a),h=o.pendingStructs;if(h){for(const[e,t]of h.missing)if(t<ii(o,e)){i=!0;break}if(l){for(const[e,t]of l.missing){const i=h.missing.get(e);(null==i||i>t)&&h.missing.set(e,t)}h.update=Si([h.update,l.update])}}else o.pendingStructs=l;const c=mt(s,t,o);if(o.pendingDs){const e=new Ot(ne(o.pendingDs));ae(e.restDecoder);const i=mt(e,t,o);o.pendingDs=c&&i?Si([c,i]):c||i}else o.pendingDs=c;if(i){const e=o.pendingStructs.update;o.pendingStructs=null,Et(t.doc,e)}}),n,!1)})(o,t,n,new s(o))},At=(e,t=new Uint8Array([0]),i=new kt)=>{((e,t,i=new Map)=>{xt(e,t.store,i),pt(e,(e=>{const t=dt();return e.clients.forEach(((e,i)=>{const r=[];for(let t=0;t<e.length;t++){const i=e[t];if(i.deleted){const n=i.id.clock;let s=i.length;if(t+1<e.length)for(let i=e[t+1];t+1<e.length&&i.deleted;i=e[1+ ++t])s+=i.length;r.push(new ot(n,s))}}r.length>0&&t.clients.set(i,r)})),t})(t.store))})(i,e,Tt(t));const r=[i.toUint8Array()];if(e.store.pendingDs&&r.push(e.store.pendingDs),e.store.pendingStructs&&r.push(Ci(e.store.pendingStructs.update,t)),r.length>1){if(i.constructor===St)return Oi(r.map(((e,t)=>0===t?e:Ai(e))));if(i.constructor===kt)return Si(r)}return r[0]},Tt=e=>(e=>{const t=new Map,i=ae(e.restDecoder);for(let r=0;r<i;r++){const i=ae(e.restDecoder),r=ae(e.restDecoder);t.set(i,r)}return t})(new yt(ne(e))),Pt=(e,t)=>(j(e.restEncoder,t.size),Array.from(t.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([t,i])=>{j(e.restEncoder,t),j(e.restEncoder,i)})),e);class Lt{constructor(){this.l=[]}}const Rt=()=>new Lt,Mt=(e,t)=>e.l.push(t),Dt=(e,t)=>{const i=e.l,r=i.length;e.l=i.filter((e=>t!==e)),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Bt=(e,t,i)=>Pe(e.l,[t,i]);class It{constructor(e,t){this.client=e,this.clock=t}}const Qt=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,$t=(e,t)=>new It(e,t),Ht=e=>{for(const[t,i]of e.doc.share.entries())if(i===e)return t;throw xe()},Wt=(e,t)=>{for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1};class Nt{constructor(e,t,i,r=0){this.type=e,this.tname=t,this.item=i,this.assoc=r}}const Ft=e=>{const t={};return e.type&&(t.type=e.type),e.tname&&(t.tname=e.tname),e.item&&(t.item=e.item),null!=e.assoc&&(t.assoc=e.assoc),t},jt=e=>new Nt(null==e.type?null:$t(e.type.client,e.type.clock),e.tname||null,null==e.item?null:$t(e.item.client,e.item.clock),null==e.assoc?0:e.assoc);class Ut{constructor(e,t,i=0){this.type=e,this.index=t,this.assoc=i}}const qt=(e,t,i)=>{let r=null,n=null;return null===e._item?n=Ht(e):r=$t(e._item.id.client,e._item.id.clock),new Nt(r,n,t,i)},Xt=(e,t,i=0)=>{let r=e._start;if(i<0){if(0===t)return qt(e,null,i);t--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>t)return qt(e,$t(r.id.client,r.id.clock+t),i);t-=r.length}if(null===r.right&&i<0)return qt(e,r.lastId,i);r=r.right}return qt(e,null,i)},zt=(e,t)=>{const i=t.store,r=e.item,n=e.type,s=e.tname,o=e.assoc;let a=null,l=0;if(null!==r){if(ii(i,r.client)<=r.clock)return null;const e=Ur(i,r),t=e.item;if(!(t instanceof Vr))return null;if(a=t.parent,null===a._item||!a._item.deleted){l=t.deleted||!t.countable?0:e.diff+(o>=0?0:1);let i=t.left;for(;null!==i;)!i.deleted&&i.countable&&(l+=i.length),i=i.left}}else{if(null!==s)a=t.get(s);else{if(null===n)throw xe();{if(ii(i,n.client)<=n.clock)return null;const{item:e}=Ur(i,n);if(!(e instanceof Vr&&e.content instanceof jr))return null;a=e.content.type}}l=o>=0?a._length:0}return((e,t,i=0)=>new Ut(e,t,i))(a,l,e.assoc)},Vt=(e,t)=>e===t||null!==e&&null!==t&&e.tname===t.tname&&Qt(e.item,t.item)&&Qt(e.type,t.type)&&e.assoc===t.assoc;class Yt{constructor(e,t){this.ds=e,this.sv=t}}const Gt=(Kt=dt(),Jt=new Map,new Yt(Kt,Jt),(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!ht(t.ds,e.id)),Zt=(e,t)=>{const i=r(e.meta,Zt,n),s=e.doc.store;i.has(t)||(t.sv.forEach(((t,i)=>{t<ii(s,i)&&ai(e,$t(i,t))})),lt(e,t.ds,(e=>{})),i.add(t))};var Kt,Jt;class ei{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const ti=e=>{const t=new Map;return e.clients.forEach(((e,i)=>{const r=e[e.length-1];t.set(i,r.id.clock+r.length)})),t},ii=(e,t)=>{const i=e.clients.get(t);if(void 0===i)return 0;const r=i[i.length-1];return r.id.clock+r.length},ri=(e,t)=>{let i=e.clients.get(t.id.client);if(void 0===i)i=[],e.clients.set(t.id.client,i);else{const e=i[i.length-1];if(e.id.clock+e.length!==t.id.clock)throw xe()}i.push(t)},ni=(e,t)=>{let i=0,r=e.length-1,n=e[r],s=n.id.clock;if(s===t)return r;let o=h(t/(s+n.length-1)*r);for(;i<=r;){if(n=e[o],s=n.id.clock,s<=t){if(t<s+n.length)return o;i=o+1}else r=o-1;o=h((i+r)/2)}throw xe()},si=(e,t)=>{const i=e.clients.get(t.client);return i[ni(i,t.clock)]},oi=(e,t,i)=>{const r=ni(t,i),n=t[r];return n.id.clock<i&&n instanceof Vr?(t.splice(r+1,0,Xr(e,n,i-n.id.clock)),r+1):r},ai=(e,t)=>{const i=e.doc.store.clients.get(t.client);return i[oi(e,i,t.clock)]},li=(e,t,i)=>{const r=t.clients.get(i.client),n=ni(r,i.clock),s=r[n];return i.clock!==s.id.clock+s.length-1&&s.constructor!==kr&&r.splice(n+1,0,Xr(e,s,i.clock-s.id.clock+1)),s},hi=(e,t,i,r,n)=>{if(0===r)return;const s=i+r;let o,a=oi(e,t,i);do{o=t[a++],s<o.id.clock+o.length&&oi(e,t,s),n(o)}while(a<t.length&&t[a].id.clock<s)};class ci{constructor(e,t,i){this.doc=e,this.deleteSet=new at,this.beforeState=ti(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const ui=(e,t)=>!(0===t.deleteSet.clients.size&&!((e,i)=>{for(const[i,s]of e)if(r=s,n=i,t.beforeState.get(n)!==r)return!0;var r,n;return!1})(t.afterState)||(ct(t.deleteSet),((e,t)=>{xt(e,t.doc.store,t.beforeState)})(e,t),pt(e,t.deleteSet),0)),fi=(e,t,i)=>{const s=t._item;(null===s||s.id.clock<(e.beforeState.get(s.id.client)||0)&&!s.deleted)&&r(e.changed,t,n).add(i)},di=(e,t)=>{const i=e[t-1],r=e[t];i.deleted===r.deleted&&i.constructor===r.constructor&&i.mergeWith(r)&&(e.splice(t,1),r instanceof Vr&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,i))},pi=(e,t)=>{if(t<e.length){const i=e[t],r=i.doc,n=r.store,s=i.deleteSet,o=i._mergeStructs;try{ct(s),i.afterState=ti(i.doc.store),r._transaction=null,r.emit("beforeObserverCalls",[i,r]);const a=[];i.changed.forEach(((e,t)=>a.push((()=>{null!==t._item&&t._item.deleted||t._callObserver(i,e)})))),a.push((()=>{i.changedParentTypes.forEach(((e,t)=>a.push((()=>{null!==t._item&&t._item.deleted||((e=e.filter((e=>null===e.target._item||!e.target._item.deleted))).forEach((e=>{e.currentTarget=t})),e.sort(((e,t)=>e.path.length-t.path.length)),Bt(t._dEH,e,i))})))),a.push((()=>r.emit("afterTransaction",[i,r])))})),Pe(a,[])}finally{r.gc&&((e,t,i)=>{for(const[r,n]of e.clients.entries()){const e=t.clients.get(r);for(let r=n.length-1;r>=0;r--){const s=n[r],o=s.clock+s.len;for(let r=ni(e,s.clock),n=e[r];r<e.length&&n.id.clock<o;n=e[++r]){const n=e[r];if(s.clock+s.len<=n.id.clock)break;n instanceof Vr&&n.deleted&&!n.keep&&i(n)&&n.gc(t,!1)}}}})(s,n,r.gcFilter),((e,t)=>{e.clients.forEach(((e,i)=>{const r=t.clients.get(i);for(let t=e.length-1;t>=0;t--){const i=e[t];for(let e=f(r.length-1,1+ni(r,i.clock+i.len-1)),t=r[e];e>0&&t.id.clock>=i.clock;t=r[--e])di(r,e)}}))})(s,n),i.afterState.forEach(((e,t)=>{const r=i.beforeState.get(t)||0;if(r!==e){const e=n.clients.get(t),i=d(ni(e,r),1);for(let t=e.length-1;t>=i;t--)di(e,t)}}));for(let e=0;e<o.length;e++){const{client:t,clock:i}=o[e].id,r=n.clients.get(t),s=ni(r,i);s+1<r.length&&di(r,s+1),s>0&&di(r,s)}if(i.local||i.afterState.get(r.clientID)===i.beforeState.get(r.clientID)||(Je(Ve,Ne,"[yjs] ",Fe,Xe,"Changed the client-id because another client seems to be using it."),r.clientID=_t()),r.emit("afterTransactionCleanup",[i,r]),r._observers.has("update")){const e=new St;ui(e,i)&&r.emit("update",[e.toUint8Array(),i.origin,r,i])}if(r._observers.has("updateV2")){const e=new kt;ui(e,i)&&r.emit("updateV2",[e.toUint8Array(),i.origin,r,i])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:h}=i;(a.size>0||h.size>0||l.size>0)&&(a.forEach((e=>{e.clientID=r.clientID,null==e.collectionid&&(e.collectionid=r.collectionid),r.subdocs.add(e)})),h.forEach((e=>r.subdocs.delete(e))),r.emit("subdocs",[{loaded:l,added:a,removed:h},r,i]),h.forEach((e=>e.destroy()))),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):pi(e,t+1)}}},gi=(e,t,i=null,r=!0)=>{const n=e._transactionCleanups;let s=!1;null===e._transaction&&(s=!0,e._transaction=new ci(e,i,r),n.push(e._transaction),1===n.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{t(e._transaction)}finally{s&&n[0]===e._transaction&&pi(n,0)}};class mi{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const _i=(e,t,i)=>{let r=null,n=null;const s=e.doc,o=e.scope;if(gi(s,(i=>{for(;t.length>0&&null===r;){const n=s.store,a=t.pop(),l=new Set,h=[];let c=!1;lt(i,a.insertions,(e=>{if(e instanceof Vr){if(null!==e.redone){let{item:t,diff:r}=Ur(n,e.id);r>0&&(t=ai(i,$t(t.id.client,t.id.clock+r))),e=t}!e.deleted&&o.some((t=>Wt(t,e)))&&h.push(e)}})),lt(i,a.deletions,(e=>{e instanceof Vr&&o.some((t=>Wt(t,e)))&&!ht(a.insertions,e.id)&&l.add(e)})),l.forEach((e=>{c=null!==zr(i,e,l,h)||c}));for(let t=h.length-1;t>=0;t--){const r=h[t];e.deleteFilter(r)&&(r.delete(i),c=!0)}r=c?a:null}i.changed.forEach(((e,t)=>{e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)})),n=i}),e),null!=r){const t=n.changedParentTypes;e.emit("stack-item-popped",[{stackItem:r,type:i,changedParentTypes:t},e])}return r};class vi extends l{constructor(e,{captureTimeout:t=500,deleteFilter:i=(()=>!0),trackedOrigins:r=new Set([null])}={}){super(),this.scope=e instanceof Array?e:[e],this.deleteFilter=i,r.add(this),this.trackedOrigins=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=this.scope[0].doc,this.lastChange=0,this.doc.on("afterTransaction",(e=>{if(!this.scope.some((t=>e.changedParentTypes.has(t)))||!(this.trackedOrigins.has(e.origin)||e.origin&&this.trackedOrigins.has(e.origin.constructor)))return;const i=this.undoing,r=this.redoing,n=i?this.redoStack:this.undoStack;i?this.stopCapturing():r||(this.redoStack=[]);const s=new at;e.afterState.forEach(((t,i)=>{const r=e.beforeState.get(i)||0,n=t-r;n>0&&ft(s,i,r,n)}));const o=We();if(o-this.lastChange<t&&n.length>0&&!i&&!r){const t=n[n.length-1];t.deletions=ut([t.deletions,e.deleteSet]),t.insertions=ut([t.insertions,s])}else n.push(new mi(e.deleteSet,s));i||r||(this.lastChange=o),lt(e,e.deleteSet,(e=>{e instanceof Vr&&this.scope.some((t=>Wt(t,e)))&&qr(e,!0)})),this.emit("stack-item-added",[{stackItem:n[n.length-1],origin:e.origin,type:i?"redo":"undo",changedParentTypes:e.changedParentTypes},this])}))}clear(){this.doc.transact((e=>{const t=t=>{lt(e,t.deletions,(e=>{e instanceof Vr&&this.scope.some((t=>Wt(t,e)))&&qr(e,!1)}))};this.undoStack.forEach(t),this.redoStack.forEach(t)})),this.undoStack=[],this.redoStack=[]}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=_i(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=_i(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}}class yi{constructor(e,t){this.gen=function*(e){const t=ae(e.restDecoder);for(let i=0;i<t;i++){const t=ae(e.restDecoder),i=e.readClient();let r=ae(e.restDecoder);for(let n=0;n<t;n++){const t=e.readInfo();if(10===t){const t=ae(e.restDecoder);yield new Zr($t(i,r),t),r+=t}else if(0!=(31&t)){const n=0==(192&t),s=new Vr($t(i,r),null,(t&B)===B?e.readLeftID():null,null,(t&D)===D?e.readRightID():null,n?e.readParentInfo()?e.readString():e.readLeftID():null,n&&32==(32&t)?e.readString():null,Yr(e,t));yield s,r+=s.length}else{const t=e.readLen();yield new kr($t(i,r),t),r+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===Zr);return this.curr}}class bi{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const Oi=e=>Si(e,bt,St),wi=(e,t)=>{if(e.constructor===kr){const{client:i,clock:r}=e.id;return new kr($t(i,r+t),e.length-t)}if(e.constructor===Zr){const{client:i,clock:r}=e.id;return new Zr($t(i,r+t),e.length-t)}{const i=e,{client:r,clock:n}=i.id;return new Vr($t(r,n+t),null,$t(r,n+t-1),null,i.rightOrigin,i.parent,i.parentSub,i.content.splice(t))}},Si=(e,t=Ot,i=kt)=>{if(1===e.length)return e[0];const r=e.map((e=>new t(ne(e))));let n=r.map((e=>new yi(e,!0))),s=null;const o=new i,a=new bi(o);for(;n=n.filter((e=>null!==e.curr)),n.sort(((e,t)=>{if(e.curr.id.client===t.curr.id.client){const i=e.curr.id.clock-t.curr.id.clock;return 0===i?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===Zr?1:-1:i}return t.curr.id.client-e.curr.id.client})),0!==n.length;){const e=n[0],t=e.curr.id.client;if(null!==s){let i=e.curr,r=!1;for(;null!==i&&i.id.clock+i.length<=s.struct.id.clock+s.struct.length&&i.id.client>=s.struct.id.client;)i=e.next(),r=!0;if(null===i||i.id.client!==t||r&&i.id.clock>s.struct.id.clock+s.struct.length)continue;if(t!==s.struct.id.client)xi(a,s.struct,s.offset),s={struct:i,offset:0},e.next();else if(s.struct.id.clock+s.struct.length<i.id.clock)if(s.struct.constructor===Zr)s.struct.length=i.id.clock+i.length-s.struct.id.clock;else{xi(a,s.struct,s.offset);const e=i.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Zr($t(t,s.struct.id.clock+s.struct.length),e),offset:0}}else{const t=s.struct.id.clock+s.struct.length-i.id.clock;t>0&&(s.struct.constructor===Zr?s.struct.length-=t:i=wi(i,t)),s.struct.mergeWith(i)||(xi(a,s.struct,s.offset),s={struct:i,offset:0},e.next())}}else s={struct:e.curr,offset:0},e.next();for(let i=e.curr;null!==i&&i.id.client===t&&i.id.clock===s.struct.id.clock+s.struct.length&&i.constructor!==Zr;i=e.next())xi(a,s.struct,s.offset),s={struct:i,offset:0}}null!==s&&(xi(a,s.struct,s.offset),s=null),Ei(a);const l=r.map((e=>gt(e))),h=ut(l);return pt(o,h),o.toUint8Array()},Ci=(e,t,i=Ot,r=kt)=>{const n=Tt(t),s=new r,o=new bi(s),a=new i(ne(e)),l=new yi(a,!1);for(;l.curr;){const e=l.curr,t=e.id.client,i=n.get(t)||0;if(l.curr.constructor!==Zr)if(e.id.clock+e.length>i)for(xi(o,e,d(i-e.id.clock,0)),l.next();l.curr&&l.curr.id.client===t;)xi(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===t&&l.curr.id.clock+l.curr.length<=i;)l.next();else l.next()}Ei(o);const h=gt(a);return pt(s,h),s.toUint8Array()},ki=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:W(e.encoder.restEncoder)}),e.encoder.restEncoder=H(),e.written=0)},xi=(e,t,i)=>{e.written>0&&e.currClient!==t.id.client&&ki(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),j(e.encoder.restEncoder,t.id.clock+i)),t.write(e.encoder,i),e.written++},Ei=e=>{ki(e);const t=e.encoder.restEncoder;j(t,e.clientStructs.length);for(let i=0;i<e.clientStructs.length;i++){const r=e.clientStructs[i];j(t,r.written),X(t,r.restEncoder)}},Ai=e=>((e,t,i)=>{const r=new t(ne(e)),n=new yi(r,!1),s=new i,o=new bi(s);for(let e=n.curr;null!==e;e=n.next())xi(o,e,0);Ei(o);const a=gt(r);return pt(s,a),s.toUint8Array()})(e,Ot,St);class Ti{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null}get path(){return Pi(this.currentTarget,this.target)}deletes(e){return ht(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){const e=new Map,t=this.target;this.transaction.changed.get(t).forEach((i=>{if(null!==i){const r=t._map.get(i);let n,o;if(this.adds(r)){let e=r.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(r)){if(null===e||!this.deletes(e))return;n="delete",o=s(e.content.getContent())}else null!==e&&this.deletes(e)?(n="update",o=s(e.content.getContent())):(n="add",o=void 0)}else{if(!this.deletes(r))return;n="delete",o=s(r.content.getContent())}e.set(i,{action:n,oldValue:o})}})),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){const t=this.target,i=n(),r=n(),s=[];if(e={added:i,deleted:r,delta:s,keys:this.keys},this.transaction.changed.get(t).has(null)){let e=null;const n=()=>{e&&s.push(e)};for(let s=t._start;null!==s;s=s.right)s.deleted?this.deletes(s)&&!this.adds(s)&&(null!==e&&void 0!==e.delete||(n(),e={delete:0}),e.delete+=s.length,r.add(s)):this.adds(s)?(null!==e&&void 0!==e.insert||(n(),e={insert:[]}),e.insert=e.insert.concat(s.content.getContent()),i.add(s)):(null!==e&&void 0!==e.retain||(n(),e={retain:0}),e.retain+=s.length);null!==e&&void 0===e.retain&&n()}this._changes=e}return e}}const Pi=(e,t)=>{const i=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)i.unshift(t._item.parentSub);else{let e=0,r=t._item.parent._start;for(;r!==t._item&&null!==r;)r.deleted||e++,r=r.right;i.unshift(e)}t=t._item.parent}return i};let Li=0;class Ri{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Li++}}const Mi=(e,t,i)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=i,e.timestamp=Li++},Di=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;const i=0===e._searchMarker.length?null:e._searchMarker.reduce(((e,i)=>c(t-e.index)<c(t-i.index)?e:i));let r=e._start,n=0;for(null!==i&&(r=i.p,n=i.index,(e=>{e.timestamp=Li++})(i));null!==r.right&&n<t;){if(!r.deleted&&r.countable){if(t<n+r.length)break;n+=r.length}r=r.right}for(;null!==r.left&&n>t;)r=r.left,!r.deleted&&r.countable&&(n-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(n-=r.length);return null!==i&&c(i.index-n)<r.parent.length/80?(Mi(i,r,n),i):((e,t,i)=>{if(e.length>=80){const r=e.reduce(((e,t)=>e.timestamp<t.timestamp?e:t));return Mi(r,t,i),r}{const r=new Ri(t,i);return e.push(r),r}})(e._searchMarker,r,n)},Bi=(e,t,i)=>{for(let r=e.length-1;r>=0;r--){const n=e[r];if(i>0){let t=n.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)t=t.left,t&&!t.deleted&&t.countable&&(n.index-=t.length);if(null===t||!0===t.marker){e.splice(r,1);continue}n.p=t,t.marker=!0}(t<n.index||i>0&&t===n.index)&&(n.index=d(t,n.index+i))}},Ii=(e,t,i)=>{const n=e,s=t.changedParentTypes;for(;r(s,e,(()=>[])).push(i),null!==e._item;)e=e._item.parent;Bt(n._eH,i,t)};class Qi{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Rt(),this._dEH=Rt(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw ke()}clone(){throw ke()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Mt(this._eH,e)}observeDeep(e){Mt(this._dEH,e)}unobserve(e){Dt(this._eH,e)}unobserveDeep(e){Dt(this._dEH,e)}toJSON(){}}const $i=(e,t,i)=>{t<0&&(t=e._length+t),i<0&&(i=e._length+i);let r=i-t;const n=[];let s=e._start;for(;null!==s&&r>0;){if(s.countable&&!s.deleted){const e=s.content.getContent();if(e.length<=t)t-=e.length;else{for(let i=t;i<e.length&&r>0;i++)n.push(e[i]),r--;t=0}}s=s.right}return n},Hi=e=>{const t=[];let i=e._start;for(;null!==i;){if(i.countable&&!i.deleted){const e=i.content.getContent();for(let i=0;i<e.length;i++)t.push(e[i])}i=i.right}return t},Wi=(e,t)=>{let i=0,r=e._start;for(;null!==r;){if(r.countable&&!r.deleted){const n=r.content.getContent();for(let r=0;r<n.length;r++)t(n[r],i++,e)}r=r.right}},Ni=(e,t)=>{const i=[];return Wi(e,((r,n)=>{i.push(t(r,n,e))})),i},Fi=e=>{let t=e._start,i=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===i){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};i=t.content.getContent(),r=0,t=t.right}const e=i[r++];return i.length<=r&&(i=null),{done:!1,value:e}}}},ji=(e,t)=>{const i=Di(e,t);let r=e._start;for(null!==i&&(r=i.p,t-=i.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Ui=(e,t,i,r)=>{let n=i;const s=e.doc,o=s.clientID,a=s.store,l=null===i?t._start:i.right;let h=[];const c=()=>{h.length>0&&(n=new Vr($t(o,ii(a,o)),n,n&&n.lastId,l,l&&l.id,t,null,new Mr(h)),n.integrate(e,0),h=[])};r.forEach((i=>{if(null===i)h.push(i);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:h.push(i);break;default:switch(c(),i.constructor){case Uint8Array:case ArrayBuffer:n=new Vr($t(o,ii(a,o)),n,n&&n.lastId,l,l&&l.id,t,null,new xr(new Uint8Array(i))),n.integrate(e,0);break;case vt:n=new Vr($t(o,ii(a,o)),n,n&&n.lastId,l,l&&l.id,t,null,new Tr(i)),n.integrate(e,0);break;default:if(!(i instanceof Qi))throw new Error("Unexpected content type in insert operation");n=new Vr($t(o,ii(a,o)),n,n&&n.lastId,l,l&&l.id,t,null,new jr(i)),n.integrate(e,0)}}})),c()},qi=Ce("Length exceeded!"),Xi=(e,t,i,r)=>{if(i>t._length)throw qi;if(0===i)return t._searchMarker&&Bi(t._searchMarker,i,r.length),Ui(e,t,null,r);const n=i,s=Di(t,i);let o=t._start;for(null!==s&&(o=s.p,0==(i-=s.index)&&(o=o.prev,i+=o&&o.countable&&!o.deleted?o.length:0));null!==o;o=o.right)if(!o.deleted&&o.countable){if(i<=o.length){i<o.length&&ai(e,$t(o.id.client,o.id.clock+i));break}i-=o.length}return t._searchMarker&&Bi(t._searchMarker,n,r.length),Ui(e,t,o,r)},zi=(e,t,i,r)=>{if(0===r)return;const n=i,s=r,o=Di(t,i);let a=t._start;for(null!==o&&(a=o.p,i-=o.index);null!==a&&i>0;a=a.right)!a.deleted&&a.countable&&(i<a.length&&ai(e,$t(a.id.client,a.id.clock+i)),i-=a.length);for(;r>0&&null!==a;)a.deleted||(r<a.length&&ai(e,$t(a.id.client,a.id.clock+r)),a.delete(e),r-=a.length),a=a.right;if(r>0)throw qi;t._searchMarker&&Bi(t._searchMarker,n,-s+r)},Vi=(e,t,i)=>{const r=t._map.get(i);void 0!==r&&r.delete(e)},Yi=(e,t,i,r)=>{const n=t._map.get(i)||null,s=e.doc,o=s.clientID;let a;if(null==r)a=new Mr([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new Mr([r]);break;case Uint8Array:a=new xr(r);break;case vt:a=new Tr(r);break;default:if(!(r instanceof Qi))throw new Error("Unexpected content type");a=new jr(r)}new Vr($t(o,ii(s.store,o)),n,n&&n.lastId,null,null,t,i,a).integrate(e,0)},Gi=(e,t)=>{const i=e._map.get(t);return void 0===i||i.deleted?void 0:i.content.getContent()[i.length-1]},Zi=e=>{const t={};return e._map.forEach(((e,i)=>{e.deleted||(t[i]=e.content.getContent()[e.length-1])})),t},Ki=(e,t)=>{const i=e._map.get(t);return void 0!==i&&!i.deleted},Ji=e=>{return t=e.entries(),i=e=>!e[1].deleted,nt((()=>{let e;do{e=t.next()}while(!e.done&&!i(e.value));return e}));var t,i};class er extends Ti{constructor(e,t){super(e,t),this._transaction=t}}class tr extends Qi{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new tr;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new tr}clone(){const e=new tr;return e.insert(0,this.toArray().map((e=>e instanceof Qi?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),Ii(this,e,new er(this,e))}insert(e,t){null!==this.doc?gi(this.doc,(i=>{Xi(i,this,e,t)})):this._prelimContent.splice(e,0,...t)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?gi(this.doc,(i=>{zi(i,this,e,t)})):this._prelimContent.splice(e,t)}get(e){return ji(this,e)}toArray(){return Hi(this)}slice(e=0,t=this.length){return $i(this,e,t)}toJSON(){return this.map((e=>e instanceof Qi?e.toJSON():e))}map(e){return Ni(this,e)}forEach(e){Wi(this,e)}[Symbol.iterator](){return Fi(this)}_write(e){e.writeTypeRef(Ir)}}class ir extends Ti{constructor(e,t,i){super(e,t),this.keysChanged=i}}class rr extends Qi{constructor(e){super(),this._prelimContent=null,this._prelimContent=void 0===e?new Map:new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach(((e,t)=>{this.set(t,e)})),this._prelimContent=null}_copy(){return new rr}clone(){const e=new rr;return this.forEach(((t,i)=>{e.set(i,t instanceof Qi?t.clone():t)})),e}_callObserver(e,t){Ii(this,e,new ir(this,e,t))}toJSON(){const e={};return this._map.forEach(((t,i)=>{if(!t.deleted){const r=t.content.getContent()[t.length-1];e[i]=r instanceof Qi?r.toJSON():r}})),e}get size(){return[...Ji(this._map)].length}keys(){return st(Ji(this._map),(e=>e[0]))}values(){return st(Ji(this._map),(e=>e[1].content.getContent()[e[1].length-1]))}entries(){return st(Ji(this._map),(e=>[e[0],e[1].content.getContent()[e[1].length-1]]))}forEach(e){return this._map.forEach(((t,i)=>{t.deleted||e(t.content.getContent()[t.length-1],i,this)})),{}}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?gi(this.doc,(t=>{Vi(t,this,e)})):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?gi(this.doc,(i=>{Yi(i,this,e,t)})):this._prelimContent.set(e,t),t}get(e){return Gi(this,e)}has(e){return Ki(this,e)}clear(){null!==this.doc?gi(this.doc,(e=>{this.forEach((function(t,i,r){Vi(e,r,i)}))})):this._prelimContent.clear()}_write(e){e.writeTypeRef(Qr)}}const nr=(e,t)=>e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&((e,t)=>e===t||Ae(e)===Ae(t)&&((e,t)=>{for(const i in e)if(!t(e[i],i))return!1;return!0})(e,((e,i)=>(void 0!==e||Te(t,i))&&t[i]===e)))(e,t);class sr{constructor(e,t,i,r){this.left=e,this.right=t,this.index=i,this.currentAttributes=r}forward(){null===this.right&&xe(),this.right.content.constructor===Lr?this.right.deleted||hr(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}const or=(e,t,i)=>{for(;null!==t.right&&i>0;)t.right.content.constructor===Lr?t.right.deleted||hr(t.currentAttributes,t.right.content):t.right.deleted||(i<t.right.length&&ai(e,$t(t.right.id.client,t.right.id.clock+i)),t.index+=t.right.length,i-=t.right.length),t.left=t.right,t.right=t.right.right;return t},ar=(e,t,i)=>{const r=new Map,n=Di(t,i);if(n){const t=new sr(n.p.left,n.p,n.index,r);return or(e,t,i-n.index)}{const n=new sr(null,t._start,0,r);return or(e,n,i)}},lr=(e,t,i,r)=>{for(;null!==i.right&&(!0===i.right.deleted||i.right.content.constructor===Lr&&nr(r.get(i.right.content.key),i.right.content.value));)i.right.deleted||r.delete(i.right.content.key),i.forward();const n=e.doc,s=n.clientID;r.forEach(((r,o)=>{const a=i.left,l=i.right,h=new Vr($t(s,ii(n.store,s)),a,a&&a.lastId,l,l&&l.id,t,null,new Lr(o,r));h.integrate(e,0),i.right=h,i.forward()}))},hr=(e,t)=>{const{key:i,value:r}=t;null===r?e.delete(i):e.set(i,r)},cr=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===Lr&&nr(t[e.right.content.key]||null,e.right.content.value));)e.forward()},ur=(e,t,i,r)=>{const n=e.doc,s=n.clientID,o=new Map;for(const a in r){const l=r[a],h=i.currentAttributes.get(a)||null;if(!nr(h,l)){o.set(a,h);const{left:r,right:c}=i;i.right=new Vr($t(s,ii(n.store,s)),r,r&&r.lastId,c,c&&c.id,t,null,new Lr(a,l)),i.right.integrate(e,0),i.forward()}}return o},fr=(e,t,i,r,n)=>{i.currentAttributes.forEach(((e,t)=>{void 0===n[t]&&(n[t]=null)}));const s=e.doc,o=s.clientID;cr(i,n);const a=ur(e,t,i,n),l=r.constructor===String?new Dr(r):r instanceof Qi?new jr(r):new Pr(r);let{left:h,right:c,index:u}=i;t._searchMarker&&Bi(t._searchMarker,i.index,l.getLength()),c=new Vr($t(o,ii(s.store,o)),h,h&&h.lastId,c,c&&c.id,t,null,l),c.integrate(e,0),i.right=c,i.index=u,i.forward(),lr(e,t,i,a)},dr=(e,t,i,r,n)=>{const s=e.doc,o=s.clientID;cr(i,n);const a=ur(e,t,i,n);for(;r>0&&null!==i.right;){if(!i.right.deleted)switch(i.right.content.constructor){case Lr:{const{key:t,value:r}=i.right.content,s=n[t];void 0!==s&&(nr(s,r)?a.delete(t):a.set(t,r),i.right.delete(e));break}default:r<i.right.length&&ai(e,$t(i.right.id.client,i.right.id.clock+r)),r-=i.right.length}i.forward()}if(r>0){let n="";for(;r>0;r--)n+="\n";i.right=new Vr($t(o,ii(s.store,o)),i.left,i.left&&i.left.lastId,i.right,i.right&&i.right.id,t,null,new Dr(n)),i.right.integrate(e,0),i.forward()}lr(e,t,i,a)},pr=(e,t,i,r,n)=>{for(;i&&(!i.countable||i.deleted);)i.deleted||i.content.constructor!==Lr||hr(n,i.content),i=i.right;let s=0;for(;t!==i;){if(!t.deleted){const i=t.content;switch(i.constructor){case Lr:{const{key:o,value:a}=i;(n.get(o)||null)===a&&(r.get(o)||null)!==a||(t.delete(e),s++);break}}}t=t.right}return s},gr=(e,i,r)=>{const n=r,s=t(i.currentAttributes),o=i.right;for(;r>0&&null!==i.right;){if(!1===i.right.deleted)switch(i.right.content.constructor){case jr:case Pr:case Dr:r<i.right.length&&ai(e,$t(i.right.id.client,i.right.id.clock+r)),r-=i.right.length,i.right.delete(e)}i.forward()}o&&pr(e,o,i.right,s,t(i.currentAttributes));const a=(i.left||i.right).parent;return a._searchMarker&&Bi(a._searchMarker,i.index,-n+r),i};class mr extends Ti{constructor(e,t,i){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,i.forEach((e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)}))}get changes(){if(null===this._changes){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){const e=this.target.doc,t=[];gi(e,(e=>{const i=new Map,r=new Map;let n=this.target._start,s=null;const o={};let a="",l=0,h=0;const c=()=>{if(null!==s){let e;switch(s){case"delete":e={delete:h},h=0;break;case"insert":e={insert:a},i.size>0&&(e.attributes={},i.forEach(((t,i)=>{null!==t&&(e.attributes[i]=t)}))),a="";break;case"retain":if(e={retain:l},Object.keys(o).length>0){e.attributes={};for(const t in o)e.attributes[t]=o[t]}l=0}t.push(e),s=null}};for(;null!==n;){switch(n.content.constructor){case jr:case Pr:this.adds(n)?this.deletes(n)||(c(),s="insert",a=n.content.getContent()[0],c()):this.deletes(n)?("delete"!==s&&(c(),s="delete"),h+=1):n.deleted||("retain"!==s&&(c(),s="retain"),l+=1);break;case Dr:this.adds(n)?this.deletes(n)||("insert"!==s&&(c(),s="insert"),a+=n.content.str):this.deletes(n)?("delete"!==s&&(c(),s="delete"),h+=n.length):n.deleted||("retain"!==s&&(c(),s="retain"),l+=n.length);break;case Lr:{const{key:t,value:a}=n.content;if(this.adds(n)){if(!this.deletes(n)){const l=i.get(t)||null;nr(l,a)?n.delete(e):("retain"===s&&c(),nr(a,r.get(t)||null)?delete o[t]:o[t]=a)}}else if(this.deletes(n)){r.set(t,a);const e=i.get(t)||null;nr(e,a)||("retain"===s&&c(),o[t]=e)}else if(!n.deleted){r.set(t,a);const i=o[t];void 0!==i&&(nr(i,a)?n.delete(e):("retain"===s&&c(),null===a?delete o[t]:o[t]=a))}n.deleted||("insert"===s&&c(),hr(i,n.content));break}}n=n.right}for(c();t.length>0;){const e=t[t.length-1];if(void 0===e.retain||void 0!==e.attributes)break;t.pop()}})),this._delta=t}return this._delta}}class _r extends Qi{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach((e=>e()))}catch(e){console.error(e)}this._pending=null}_copy(){return new _r}clone(){const e=new _r;return e.applyDelta(this.toDelta()),e}_callObserver(i,r){super._callObserver(i,r);const n=new mr(this,i,r),s=i.doc;if(Ii(this,i,n),!i.local){let r=!1;for(const[e,t]of i.afterState.entries()){const n=i.beforeState.get(e)||0;if(t!==n&&(hi(i,s.store.clients.get(e),n,t,(e=>{e.deleted||e.content.constructor!==Lr||(r=!0)})),r))break}r||lt(i,i.deleteSet,(e=>{e instanceof kr||r||e.parent===this&&e.content.constructor===Lr&&(r=!0)})),gi(s,(i=>{r?(i=>{let r=0;gi(i.doc,(n=>{let s=i._start,o=i._start,a=e();const l=t(a);for(;o;)!1===o.deleted&&(o.content.constructor===Lr?hr(l,o.content):(r+=pr(n,s,o,a,l),a=t(l),s=o)),o=o.right}))})(this):lt(i,i.deleteSet,(e=>{e instanceof kr||e.parent===this&&((e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const i=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===Lr){const r=t.content.key;i.has(r)?t.delete(e):i.add(r)}t=t.left}})(i,e)}))}))}}toString(){let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===Dr&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?gi(this.doc,(i=>{const r=new sr(null,this._start,0,new Map);for(let n=0;n<e.length;n++){const s=e[n];if(void 0!==s.insert){const o=t||"string"!=typeof s.insert||n!==e.length-1||null!==r.right||"\n"!==s.insert.slice(-1)?s.insert:s.insert.slice(0,-1);("string"!=typeof o||o.length>0)&&fr(i,this,r,o,s.attributes||{})}else void 0!==s.retain?dr(i,this,r,s.retain,s.attributes||{}):void 0!==s.delete&&gr(i,r,s.delete)}})):this._pending.push((()=>this.applyDelta(e)))}toDelta(e,t,i){const r=[],n=new Map,s=this.doc;let o="",a=this._start;function l(){if(o.length>0){const e={};let t=!1;n.forEach(((i,r)=>{t=!0,e[r]=i}));const i={insert:o};t&&(i.attributes=e),r.push(i),o=""}}return gi(s,(s=>{for(e&&Zt(s,e),t&&Zt(s,t);null!==a;){if(Gt(a,e)||void 0!==t&&Gt(a,t))switch(a.content.constructor){case Dr:{const r=n.get("ychange");void 0===e||Gt(a,e)?void 0===t||Gt(a,t)?void 0!==r&&(l(),n.delete("ychange")):void 0!==r&&r.user===a.id.client&&"added"===r.state||(l(),n.set("ychange",i?i("added",a.id):{type:"added"})):void 0!==r&&r.user===a.id.client&&"removed"===r.state||(l(),n.set("ychange",i?i("removed",a.id):{type:"removed"})),o+=a.content.str;break}case jr:case Pr:{l();const e={insert:a.content.getContent()[0]};if(n.size>0){const t={};e.attributes=t,n.forEach(((e,i)=>{t[i]=e}))}r.push(e);break}case Lr:Gt(a,e)&&(l(),hr(n,a.content))}a=a.right}l()}),Zt),r}insert(e,t,i){if(t.length<=0)return;const r=this.doc;null!==r?gi(r,(r=>{const n=ar(r,this,e);i||(i={},n.currentAttributes.forEach(((e,t)=>{i[t]=e}))),fr(r,this,n,t,i)})):this._pending.push((()=>this.insert(e,t,i)))}insertEmbed(e,t,i={}){const r=this.doc;null!==r?gi(r,(r=>{const n=ar(r,this,e);fr(r,this,n,t,i)})):this._pending.push((()=>this.insertEmbed(e,t,i)))}delete(e,t){if(0===t)return;const i=this.doc;null!==i?gi(i,(i=>{gr(i,ar(i,this,e),t)})):this._pending.push((()=>this.delete(e,t)))}format(e,t,i){if(0===t)return;const r=this.doc;null!==r?gi(r,(r=>{const n=ar(r,this,e);null!==n.right&&dr(r,this,n,t,i)})):this._pending.push((()=>this.format(e,t,i)))}removeAttribute(e){null!==this.doc?gi(this.doc,(t=>{Vi(t,this,e)})):this._pending.push((()=>this.removeAttribute(e)))}setAttribute(e,t){null!==this.doc?gi(this.doc,(i=>{Yi(i,this,e,t)})):this._pending.push((()=>this.setAttribute(e,t)))}getAttribute(e){return Gi(this,e)}getAttributes(e){return Zi(this)}_write(e){e.writeTypeRef($r)}}class vr{constructor(e,t=(()=>!0)){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==br&&t.constructor!==yr||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class yr extends Qi{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new yr}clone(){const e=new yr;return e.insert(0,this.toArray().map((e=>e instanceof Qi?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new vr(this,e)}querySelector(e){e=e.toUpperCase();const t=new vr(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),Array.from(new vr(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)))}_callObserver(e,t){Ii(this,e,new Or(this,t,e))}toString(){return Ni(this,(e=>e.toString())).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},i){const r=e.createDocumentFragment();return void 0!==i&&i._createAssociation(r,this),Wi(this,(n=>{r.insertBefore(n.toDOM(e,t,i),null)})),r}insert(e,t){null!==this.doc?gi(this.doc,(i=>{Xi(i,this,e,t)})):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)gi(this.doc,(i=>{const r=e&&e instanceof Qi?e._item:e;Ui(i,this,r,t)}));else{const i=this._prelimContent,r=null===e?0:i.findIndex((t=>t===e))+1;if(0===r&&null!==e)throw Ce("Reference item not found");i.splice(r,0,...t)}}delete(e,t=1){null!==this.doc?gi(this.doc,(i=>{zi(i,this,e,t)})):this._prelimContent.splice(e,t)}toArray(){return Hi(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return ji(this,e)}slice(e=0,t=this.length){return $i(this,e,t)}_write(e){e.writeTypeRef(Wr)}}class br extends yr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach(((e,t)=>{this.setAttribute(t,e)})),this._prelimAttrs=null}_copy(){return new br(this.nodeName)}clone(){const e=new br(this.nodeName),t=this.getAttributes();for(const i in t)e.setAttribute(i,t[i]);return e.insert(0,this.toArray().map((e=>e instanceof Qi?e.clone():e))),e}toString(){const e=this.getAttributes(),t=[],i=[];for(const t in e)i.push(t);i.sort();const r=i.length;for(let n=0;n<r;n++){const r=i[n];t.push(r+'="'+e[r]+'"')}const n=this.nodeName.toLocaleLowerCase();return`<${n}${t.length>0?" "+t.join(" "):""}>${super.toString()}</${n}>`}removeAttribute(e){null!==this.doc?gi(this.doc,(t=>{Vi(t,this,e)})):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?gi(this.doc,(i=>{Yi(i,this,e,t)})):this._prelimAttrs.set(e,t)}getAttribute(e){return Gi(this,e)}hasAttribute(e){return Ki(this,e)}getAttributes(e){return Zi(this)}toDOM(e=document,t={},i){const r=e.createElement(this.nodeName),n=this.getAttributes();for(const e in n)r.setAttribute(e,n[e]);return Wi(this,(n=>{r.appendChild(n.toDOM(e,t,i))})),void 0!==i&&i._createAssociation(r,this),r}_write(e){e.writeTypeRef(Hr),e.writeKey(this.nodeName)}}class Or extends Ti{constructor(e,t,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach((e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)}))}}class wr extends rr{constructor(e){super(),this.hookName=e}_copy(){return new wr(this.hookName)}clone(){const e=new wr(this.hookName);return this.forEach(((t,i)=>{e.set(i,t)})),e}toDOM(e=document,t={},i){const r=t[this.hookName];let n;return n=void 0!==r?r.createDom(this):document.createElement(this.hookName),n.setAttribute("data-yjs-hook",this.hookName),void 0!==i&&i._createAssociation(n,this),n}_write(e){e.writeTypeRef(Nr),e.writeKey(this.hookName)}}class Sr extends _r{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Sr}clone(){const e=new Sr;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,i){const r=e.createTextNode(this.toString());return void 0!==i&&i._createAssociation(r,this),r}toString(){return this.toDelta().map((e=>{const t=[];for(const i in e.attributes){const r=[];for(const t in e.attributes[i])r.push({key:t,value:e.attributes[i][t]});r.sort(((e,t)=>e.key<t.key?-1:1)),t.push({nodeName:i,attrs:r})}t.sort(((e,t)=>e.nodeName<t.nodeName?-1:1));let i="";for(let e=0;e<t.length;e++){const r=t[e];i+=`<${r.nodeName}`;for(let e=0;e<r.attrs.length;e++){const t=r.attrs[e];i+=` ${t.key}="${t.value}"`}i+=">"}i+=e.insert;for(let e=t.length-1;e>=0;e--)i+=`</${t[e].nodeName}>`;return i})).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Fr)}}class Cr{constructor(e,t){this.id=e,this.length=t}get deleted(){throw ke()}mergeWith(e){return!1}write(e,t,i){throw ke()}integrate(e,t){throw ke()}}class kr extends Cr{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),ri(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class xr{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new xr(this.content)}splice(e){throw ke()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class Er{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Er(this.len)}splice(e){const t=new Er(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){ft(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const Ar=(e,t)=>new vt({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Tr{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Tr(Ar(this.doc.guid,this.opts))}splice(e){throw ke()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class Pr{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Pr(this.embed)}splice(e){throw ke()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class Lr{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Lr(this.key,this.value)}splice(e){throw ke()}mergeWith(e){return!1}integrate(e,t){t.parent._searchMarker=null}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class Rr{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Rr(this.arr)}splice(e){const t=new Rr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let r=t;r<i;r++){const t=this.arr[r];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}class Mr{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Mr(this.arr)}splice(e){const t=new Mr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let r=t;r<i;r++){const t=this.arr[r];e.writeAny(t)}}getRef(){return 8}}class Dr{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Dr(this.str)}splice(e){const t=new Dr(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}const Br=[e=>new tr,e=>new rr,e=>new _r,e=>new br(e.readKey()),e=>new yr,e=>new wr(e.readKey()),e=>new Sr],Ir=0,Qr=1,$r=2,Hr=3,Wr=4,Nr=5,Fr=6;class jr{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new jr(this.type._copy())}splice(e){throw ke()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach((t=>{t.deleted?e._mergeStructs.push(t):t.delete(e)})),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach((t=>{for(;null!==t;)t.gc(e,!0),t=t.left})),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const Ur=(e,t)=>{let i,r=t,n=0;do{n>0&&(r=$t(r.client,r.clock+n)),i=si(e,r),n=r.clock-i.id.clock,r=i.redone}while(null!==r&&i instanceof Vr);return{item:i,diff:n}},qr=(e,t)=>{for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},Xr=(e,t,i)=>{const{client:r,clock:n}=t.id,s=new Vr($t(r,n+i),t,$t(r,n+i-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(i));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),null!==t.redone&&(s.redone=$t(t.redone.client,t.redone.clock+i)),t.right=s,null!==s.right&&(s.right.left=s),e._mergeStructs.push(s),null!==s.parentSub&&null===s.right&&s.parent._map.set(s.parentSub,s),t.length=i,s},zr=(e,t,i,r)=>{const n=e.doc,s=n.store,o=n.clientID,a=t.redone;if(null!==a)return ai(e,a);let l,h,c=t.parent._item;if(null===t.parentSub)l=t.left,h=t;else{for(l=t;null!==l.right;)if(l=l.right,l.id.client!==o)return null;null!==l.right&&(l=t.parent._map.get(t.parentSub)),h=null}if(null!==c&&!0===c.deleted&&null===c.redone&&(!i.has(c)||null===zr(e,c,i,r)))return null;if(null!==c&&null!==c.redone){for(;null!==c.redone;)c=ai(e,c.redone);for(;null!==l;){let t=l;for(;null!==t&&t.parent._item!==c;)t=null===t.redone?null:ai(e,t.redone);if(null!==t&&t.parent._item===c){l=t;break}l=l.left}for(;null!==h;){let t=h;for(;null!==t&&t.parent._item!==c;)t=null===t.redone?null:ai(e,t.redone);if(null!==t&&t.parent._item===c){h=t;break}h=h.right}for(;null!==l&&null!==l.right&&l.right!==h&&r.findIndex((e=>e===l.right))>=0;)l=l.right}const u=ii(s,o),f=$t(o,u),d=new Vr(f,l,l&&l.lastId,h,h&&h.id,null===c?t.parent:c.content.type,t.parentSub,t.content.copy());return t.redone=f,qr(d,!0),d.integrate(e,0),d};class Vr extends Cr{constructor(e,t,i,r,n,s,o,a){super(e,a.getLength()),this.origin=i,this.left=t,this.right=r,this.rightOrigin=n,this.parent=s,this.parentSub=o,this.redone=null,this.content=a,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ii(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ii(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===It&&this.id.client!==this.parent.client&&this.parent.clock>=ii(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=li(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=ai(e,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===kr||this.right&&this.right.constructor===kr)&&(this.parent=null),this.parent){if(this.parent.constructor===It){const e=si(t,this.parent);e.constructor===kr?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===Vr&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Vr&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=li(e,e.doc.store,$t(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,i=this.left;if(null!==i)t=i.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;const r=new Set,n=new Set;for(;null!==t&&t!==this.right;){if(n.add(t),r.add(t),Qt(this.origin,t.origin)){if(t.id.client<this.id.client)i=t,r.clear();else if(Qt(this.rightOrigin,t.rightOrigin))break}else{if(null===t.origin||!n.has(si(e.doc.store,t.origin)))break;r.has(si(e.doc.store,t.origin))||(i=t,r.clear())}t=t.right}this.left=i}if(null!==this.left){const e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),ri(e.doc.store,this),this.content.integrate(e,this),fi(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new kr(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:$t(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&Qt(e.origin,this.lastId)&&this.right===e&&Qt(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach((t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))})),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),ft(e.deleteSet,this.id.client,this.id.clock,this.length),fi(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw xe();this.content.gc(e),t?((e,t,i)=>{const r=e.clients.get(t.id.client);r[ni(r,t.id.clock)]=i})(e,this,new kr(this.id,this.length)):this.content=new Er(this.length)}write(e,t){const i=t>0?$t(this.id.client,this.id.clock+t-1):this.origin,r=this.rightOrigin,n=this.parentSub,s=31&this.content.getRef()|(null===i?0:B)|(null===r?0:D)|(null===n?0:32);if(e.writeInfo(s),null!==i&&e.writeLeftID(i),null!==r&&e.writeRightID(r),null===i&&null===r){const t=this.parent;if(void 0!==t._item){const i=t._item;if(null===i){const i=Ht(t);e.writeParentInfo(!0),e.writeString(i)}else e.writeParentInfo(!1),e.writeLeftID(i.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===It?(e.writeParentInfo(!1),e.writeLeftID(t)):xe();null!==n&&e.writeString(n)}this.content.write(e,t)}}const Yr=(e,t)=>Gr[31&t](e),Gr=[()=>{xe()},e=>new Er(e.readLen()),e=>{const t=e.readLen(),i=[];for(let r=0;r<t;r++){const t=e.readString();"undefined"===t?i.push(void 0):i.push(JSON.parse(t))}return new Rr(i)},e=>new xr(e.readBuf()),e=>new Dr(e.readString()),e=>new Pr(e.readJSON()),e=>new Lr(e.readString(),e.readJSON()),e=>new jr(Br[e.readTypeRef()](e)),e=>{const t=e.readLen(),i=[];for(let r=0;r<t;r++)i.push(e.readAny());return new Mr(i)},e=>new Tr(Ar(e.readString(),e.readAny())),()=>{xe()}];class Zr extends Cr{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){xe()}write(e,t){e.writeInfo(10),j(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const Kr="undefined"!=typeof window?window:"undefined"!=typeof global?global:{};!0===Kr["__ $YJS$ __"]&&console.warn("Yjs was already imported. Importing different versions of Yjs often leads to issues."),Kr["__ $YJS$ __"]=!0;let Jr="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((e=>e?parseInt(e,36):1));for(let e=1;e<Jr.length;e++)Jr[e]+=Jr[e-1];function en(e){for(let t=1;t<Jr.length;t+=2)if(Jr[t]>e)return Jr[t-1]<=e;return!1}function tn(e){return e>=127462&&e<=127487}function rn(e,t,i=!0){return(i?nn:sn)(e,t)}function nn(e,t){if(t==e.length)return t;t&&on(e.charCodeAt(t))&&an(e.charCodeAt(t-1))&&t--;let i=ln(e,t);for(t+=cn(i);t<e.length;){let r=ln(e,t);if(8205==i||8205==r||en(r))t+=cn(r),i=r;else{if(!tn(r))break;{let i=0,r=t-2;for(;r>=0&&tn(ln(e,r));)i++,r-=2;if(i%2==0)break;t+=2}}}return t}function sn(e,t){for(;t>0;){let i=nn(e,t-2);if(i<t)return i;t--}return 0}function on(e){return e>=56320&&e<57344}function an(e){return e>=55296&&e<56320}function ln(e,t){let i=e.charCodeAt(t);if(!an(i)||t+1==e.length)return i;let r=e.charCodeAt(t+1);return on(r)?r-56320+(i-55296<<10)+65536:i}function hn(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function cn(e){return e<65536?1:2}function un(e,t,i=e.length){let r=0;for(let n=0;n<i;)9==e.charCodeAt(n)?(r+=t-r%t,n++):(r++,n=rn(e,n));return r}function fn(e,t,i,r){for(let r=0,n=0;;){if(n>=t)return r;if(r==e.length)break;n+=9==e.charCodeAt(r)?i-n%i:1,r=rn(e,r)}return!0===r?-1:e.length}class dn{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(t,this.length,r,1),gn.from(r,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];return this.decompose(e,t,i,0),gn.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new vn(this),n=new vn(e);for(let e=t,s=t;;){if(r.next(e),n.next(e),e=0,r.lineBreak!=n.lineBreak||r.done!=n.done||r.value!=n.value)return!1;if(s+=r.value.length,r.done||s>=i)return!0}}iter(e=1){return new vn(this,e)}iterRange(e,t=this.length){return new yn(this,e,t)}iterLines(e,t){let i;if(null==e)i=this.iter();else{null==t&&(t=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new bn(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new pn(e):gn.from(pn.split(e,[])):dn.empty}}class pn extends dn{constructor(e,t=function(e){let t=-1;for(let i of e)t+=i.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,r){for(let n=0;;n++){let s=this.text[n],o=r+s.length;if((t?i:o)>=e)return new On(r,o,i,s);r=o+1,i++}}decompose(e,t,i,r){let n=e<=0&&t>=this.length?this:new pn(_n(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&r){let e=i.pop(),t=mn(n.text,e.text.slice(),0,n.length);if(t.length<=32)i.push(new pn(t,e.length+n.length));else{let e=t.length>>1;i.push(new pn(t.slice(0,e)),new pn(t.slice(e)))}}else i.push(n)}replace(e,t,i){if(!(i instanceof pn))return super.replace(e,t,i);let r=mn(this.text,mn(i.text,_n(this.text,0,e)),t),n=this.length+i.length-(t-e);return r.length<=32?new pn(r,n):gn.from(pn.split(r,[]),n)}sliceString(e,t=this.length,i="\n"){let r="";for(let n=0,s=0;n<=t&&s<this.text.length;s++){let o=this.text[s],a=n+o.length;n>e&&s&&(r+=i),e<a&&t>n&&(r+=o.slice(Math.max(0,e-n),t-n)),n=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],r=-1;for(let n of e)i.push(n),r+=n.length+1,32==i.length&&(t.push(new pn(i,r)),i=[],r=-1);return r>-1&&t.push(new pn(i,r)),t}}class gn extends dn{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let t of e)this.lines+=t.lines}lineInner(e,t,i,r){for(let n=0;;n++){let s=this.children[n],o=r+s.length,a=i+s.lines-1;if((t?a:o)>=e)return s.lineInner(e,t,i,r);r=o+1,i=a+1}}decompose(e,t,i,r){for(let n=0,s=0;s<=t&&n<this.children.length;n++){let o=this.children[n],a=s+o.length;if(e<=a&&t>=s){let n=r&((s<=e?1:0)|(a>=t?2:0));s>=e&&a<=t&&!n?i.push(o):o.decompose(e-s,t-s,i,n)}s=a+1}}replace(e,t,i){if(i.lines<this.lines)for(let r=0,n=0;r<this.children.length;r++){let s=this.children[r],o=n+s.length;if(e>=n&&t<=o){let a=s.replace(e-n,t-n,i),l=this.lines-s.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let n=this.children.slice();return n[r]=a,new gn(n,this.length-(t-e)+i.length)}return super.replace(n,o,a)}n=o+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i="\n"){let r="";for(let n=0,s=0;n<this.children.length&&s<=t;n++){let o=this.children[n],a=s+o.length;s>e&&n&&(r+=i),e<a&&t>s&&(r+=o.sliceString(e-s,t-s,i)),s=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof gn))return 0;let i=0,[r,n,s,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,n+=t){if(r==s||n==o)return i;let a=this.children[r],l=e.children[n];if(a!=l)return i+a.scanIdentical(l,t);i+=a.length+1}}static from(e,t=e.reduce(((e,t)=>e+t.length+1),-1)){let i=0;for(let t of e)i+=t.lines;if(i<32){let i=[];for(let t of e)t.flatten(i);return new pn(i,t)}let r=Math.max(32,i>>5),n=r<<1,s=r>>1,o=[],a=0,l=-1,h=[];function c(e){let t;if(e.lines>n&&e instanceof gn)for(let t of e.children)c(t);else e.lines>s&&(a>s||!a)?(u(),o.push(e)):e instanceof pn&&a&&(t=h[h.length-1])instanceof pn&&e.lines+t.lines<=32?(a+=e.lines,l+=e.length+1,h[h.length-1]=new pn(t.text.concat(e.text),t.length+1+e.length)):(a+e.lines>r&&u(),a+=e.lines,l+=e.length+1,h.push(e))}function u(){0!=a&&(o.push(1==h.length?h[0]:gn.from(h,l)),l=-1,a=h.length=0)}for(let t of e)c(t);return u(),1==o.length?o[0]:new gn(o,t)}}function mn(e,t,i=0,r=1e9){for(let n=0,s=0,o=!0;s<e.length&&n<=r;s++){let a=e[s],l=n+a.length;l>=i&&(l>r&&(a=a.slice(0,r-n)),n<i&&(a=a.slice(i-n)),o?(t[t.length-1]+=a,o=!1):t.push(a)),n=l+1}return t}function _n(e,t,i){return mn(e,[""],t,i)}dn.empty=new pn([""],0);class vn{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof pn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],n=this.offsets[i],s=n>>1,o=r instanceof pn?r.text.length:r.children.length;if(s==(t>0?o:0)){if(0==i)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&n)==(t>0?0:1)){if(this.offsets[i]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(r instanceof pn){let n=r.text[s+(t<0?-1:0)];if(this.offsets[i]+=t,n.length>Math.max(0,e))return this.value=0==e?n:t>0?n.slice(e):n.slice(0,n.length-e),this;e-=n.length}else{let n=r.children[s+(t<0?-1:0)];e>n.length?(e-=n.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(n),this.offsets.push(t>0?1:(n instanceof pn?n.text.length:n.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class yn{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new vn(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=i?r:t<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class bn{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:r}=this.inner.next(e);return t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(dn.prototype[Symbol.iterator]=function(){return this.iter()},vn.prototype[Symbol.iterator]=yn.prototype[Symbol.iterator]=bn.prototype[Symbol.iterator]=function(){return this});class On{constructor(e,t,i,r){this.from=e,this.to=t,this.number=i,this.text=r}get length(){return this.to-this.from}}const wn=/\r\n?|\n/;var Sn=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(Sn||(Sn={}));class Cn{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,r=0;t<this.sections.length;){let n=this.sections[t++],s=this.sections[t++];s<0?(e(i,r,n),r+=n):r+=s,i+=n}}iterChangedRanges(e,t=!1){An(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];r<0?e.push(i,r):e.push(r,i)}return new Cn(e)}composeDesc(e){return this.empty?e:e.empty?this:Pn(this,e)}mapDesc(e,t=!1){return e.empty?this:Tn(this,e,t)}mapPos(e,t=-1,i=Sn.Simple){let r=0,n=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],a=this.sections[s++],l=r+o;if(a<0){if(l>e)return n+(e-r);n+=o}else{if(i!=Sn.Simple&&l>=e&&(i==Sn.TrackDel&&r<e&&l>e||i==Sn.TrackBefore&&r<e||i==Sn.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!o)return e==r||t<0?n:n+a;n+=a}r=l}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return n}touchesRange(e,t=e){for(let i=0,r=0;i<this.sections.length&&r<=t;){let n=r+this.sections[i++];if(this.sections[i++]>=0&&r<=t&&n>=e)return!(r<e&&n>t)||"cover";r=n}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some((e=>"number"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Cn(e)}}class kn extends Cn{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return An(this,((t,i,r,n,s)=>e=e.replace(r,r+(i-t),s)),!1),e}mapDesc(e,t=!1){return Tn(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let r=0,n=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o>=0){t[r]=o,t[r+1]=s;let a=r>>1;for(;i.length<a;)i.push(dn.empty);i.push(s?e.slice(n,n+s):dn.empty)}n+=s}return new kn(t,i)}compose(e){return this.empty?e:e.empty?this:Pn(this,e,!0)}map(e,t=!1){return e.empty?this:Tn(this,e,t,!0)}iterChanges(e,t=!1){An(this,e,t)}get desc(){return new Cn(this.sections)}filter(e){let t=[],i=[],r=[],n=new Ln(this);e:for(let s=0,o=0;;){let a=s==e.length?1e9:e[s++];for(;o<a||o==a&&0==n.len;){if(n.done)break e;let e=Math.min(n.len,a-o);xn(r,e,-1);let s=-1==n.ins?-1:0==n.off?n.ins:0;xn(t,e,s),s>0&&En(i,t,n.text),n.forward(e),o+=e}let l=e[s++];for(;o<l;){if(n.done)break e;let e=Math.min(n.len,l-o);xn(t,e,-1),xn(r,e,-1==n.ins?-1:0==n.off?n.ins:0),n.forward(e),o+=e}}return{changes:new kn(t,i),filtered:new Cn(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],r=this.sections[t+1];r<0?e.push(i):0==r?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let r=[],n=[],s=0,o=null;function a(e=!1){if(!e&&!r.length)return;s<t&&xn(r,t-s,-1);let i=new kn(r,n);o=o?o.compose(i.map(o)):i,r=[],n=[],s=0}return function e(l){if(Array.isArray(l))for(let t of l)e(t);else if(l instanceof kn){if(l.length!=t)throw new RangeError(`Mismatched change set length (got ${l.length}, expected ${t})`);a(),o=o?o.compose(l.map(o)):l}else{let{from:e,to:o=e,insert:h}=l;if(e>o||e<0||o>t)throw new RangeError(`Invalid change range ${e} to ${o} (in doc of length ${t})`);let c=h?"string"==typeof h?dn.of(h.split(i||wn)):h:dn.empty,u=c.length;if(e==o&&0==u)return;e<s&&a(),e>s&&xn(r,e-s,-1),xn(r,o-e,u),En(n,r,c),s=o}}(e),a(!o),o}static empty(e){return new kn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let r=0;r<e.length;r++){let n=e[r];if("number"==typeof n)t.push(n,-1);else{if(!Array.isArray(n)||"number"!=typeof n[0]||n.some(((e,t)=>t&&"string"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==n.length)t.push(n[0],0);else{for(;i.length<r;)i.push(dn.empty);i[r]=dn.of(n.slice(1)),t.push(n[0],i[r].length)}}}return new kn(t,i)}}function xn(e,t,i,r=!1){if(0==t&&i<=0)return;let n=e.length-2;n>=0&&i<=0&&i==e[n+1]?e[n]+=t:0==t&&0==e[n]?e[n+1]+=i:r?(e[n]+=t,e[n+1]+=i):e.push(t,i)}function En(e,t,i){if(0==i.length)return;let r=t.length-2>>1;if(r<e.length)e[e.length-1]=e[e.length-1].append(i);else{for(;e.length<r;)e.push(dn.empty);e.push(i)}}function An(e,t,i){let r=e.inserted;for(let n=0,s=0,o=0;o<e.sections.length;){let a=e.sections[o++],l=e.sections[o++];if(l<0)n+=a,s+=a;else{let h=n,c=s,u=dn.empty;for(;h+=a,c+=l,l&&r&&(u=u.append(r[o-2>>1])),!(i||o==e.sections.length||e.sections[o+1]<0);)a=e.sections[o++],l=e.sections[o++];t(n,h,s,c,u),n=h,s=c}}}function Tn(e,t,i,r=!1){let n=[],s=r?[]:null,o=new Ln(e),a=new Ln(t);for(let e=0,t=0;;)if(-1==o.ins)e+=o.len,o.next();else if(-1==a.ins&&t<e){let i=Math.min(a.len,e-t);a.forward(i),xn(n,i,-1),t+=i}else if(a.ins>=0&&(o.done||t<e||t==e&&(a.len<o.len||a.len==o.len&&!i))){for(xn(n,a.ins,-1);e>t&&!o.done&&e+o.len<t+a.len;)e+=o.len,o.next();t+=a.len,a.next()}else{if(!(o.ins>=0)){if(o.done&&a.done)return s?new kn(n,s):new Cn(n);throw new Error("Mismatched change set lengths")}{let i=0,r=e+o.len;for(;;)if(a.ins>=0&&t>e&&t+a.len<r)i+=a.ins,t+=a.len,a.next();else{if(!(-1==a.ins&&t<r))break;{let e=Math.min(a.len,r-t);i+=e,a.forward(e),t+=e}}xn(n,i,o.ins),s&&En(s,n,o.text),e=r,o.next()}}}function Pn(e,t,i=!1){let r=[],n=i?[]:null,s=new Ln(e),o=new Ln(t);for(let e=!1;;){if(s.done&&o.done)return n?new kn(r,n):new Cn(r);if(0==s.ins)xn(r,s.len,0,e),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let t=Math.min(s.len2,o.len),i=r.length;if(-1==s.ins){let i=-1==o.ins?-1:o.off?0:o.ins;xn(r,t,i,e),n&&i&&En(n,r,o.text)}else-1==o.ins?(xn(r,s.off?0:s.len,t,e),n&&En(n,r,s.textBit(t))):(xn(r,s.off?0:s.len,o.off?0:o.ins,e),n&&!o.off&&En(n,r,o.text));e=(s.ins>t||o.ins>=0&&o.len>t)&&(e||r.length>i),s.forward2(t),o.forward(t)}}else xn(r,0,o.ins,e),n&&En(n,r,o.text),o.next()}}class Ln{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?dn.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?dn.empty:t[i].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Rn{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let e=3&this.flags;return 3==e?null:e}get goalColumn(){let e=this.flags>>5;return 33554431==e?void 0:e}map(e,t=-1){let i=e.mapPos(this.from,t),r=e.mapPos(this.to,t);return i==this.from&&r==this.to?this:new Rn(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Mn.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Mn.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return Mn.range(e.anchor,e.head)}}class Mn{constructor(e,t=0){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Mn.create(this.ranges.map((i=>i.map(e,t))),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new Mn([this.main])}addRange(e,t=!0){return Mn.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,Mn.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((e=>e.toJSON())),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Mn(e.ranges.map((e=>Rn.fromJSON(e))),e.main)}static single(e,t=e){return new Mn([Mn.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let n=e[r];if(n.empty?n.from<=i:n.from<i)return Dn(e.slice(),t);i=n.to}return new Mn(e,t)}static cursor(e,t=0,i,r){return new Rn(e,e,(0==t?0:t<0?4:8)|(null==i?3:Math.min(2,i))|(null!=r?r:33554431)<<5)}static range(e,t,i){let r=(null!=i?i:33554431)<<5;return t<e?new Rn(t,e,16|r):new Rn(e,t,r)}}function Dn(e,t=0){let i=e[t];e.sort(((e,t)=>e.from-t.from)),t=e.indexOf(i);for(let i=1;i<e.length;i++){let r=e[i],n=e[i-1];if(r.empty?r.from<=n.to:r.from<n.to){let s=n.from,o=Math.max(r.to,n.to);i<=t&&t--,e.splice(--i,2,r.anchor>r.head?Mn.range(o,s):Mn.range(s,o))}}return new Mn(e,t)}function Bn(e,t){for(let i of e.ranges)if(i.to>t)throw new RangeError("Selection points outside of document")}let In=0;class Qn{constructor(e,t,i,r,n){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=r,this.extensions=n,this.id=In++,this.default=e([])}static define(e={}){return new Qn(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(e.combine?(e,t)=>e===t:$n),!!e.static,e.enables)}of(e){return new Hn([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Hn(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Hn(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],(i=>t(i.field(e))))}}function $n(e,t){return e==t||e.length==t.length&&e.every(((e,i)=>e===t[i]))}class Hn{constructor(e,t,i,r){this.dependencies=e,this.facet=t,this.type=i,this.value=r,this.id=In++}dynamicSlot(e){var t;let i=this.value,r=this.facet.compareInput,n=e[this.id]>>1,s=2==this.type,o=!1,a=!1,l=[];for(let i of this.dependencies)"doc"==i?o=!0:"selection"==i?a=!0:0==(1&(null!==(t=e[i.id])&&void 0!==t?t:1))&&l.push(e[i.id]);return(e,t)=>{let h=e.values[n];if(h===Yn)return e.values[n]=i(e),1;if(t&&(o&&t.docChanged||a&&(t.docChanged||t.selection)||l.some((t=>(1&Gn(e,t))>0)))){let t=i(e);if(s?!function(e,t,i){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}(t,h,r):!r(t,h))return e.values[n]=t,1}return 0}}}function Wn(e,t,i){let r=i.map((t=>e[t.id])),n=i.map((e=>e.type)),s=r.filter((e=>!(1&e))),o=e[t.id]>>1;return(e,i)=>{let a=e.values[o],l=a===Yn||!i;for(let t of s)1&Gn(e,t)&&(l=!0);if(!l)return 0;let h=[];for(let t=0;t<r.length;t++){let i=Zn(e,r[t]);if(2==n[t])for(let e of i)h.push(e);else h.push(i)}let c=t.combine(h);return a!==Yn&&t.compare(c,a)?0:(e.values[o]=c,1)}}const Nn=Qn.define({static:!0});class Fn{constructor(e,t,i,r,n){this.id=e,this.createF=t,this.updateF=i,this.compareF=r,this.spec=n,this.provides=void 0}static define(e){let t=new Fn(In++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Nn).find((e=>e.field==this));return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return(e,i)=>{let r=e.values[t];if(r===Yn)return e.values[t]=this.create(e),1;if(i){let n=this.updateF(r,i);if(!this.compareF(r,n))return e.values[t]=n,1}return 0}}init(e){return[this,Nn.of({field:this,create:e})]}get extension(){return this}}function jn(e){return t=>new qn(t,e)}const Un={lowest:jn(4),low:jn(3),default:jn(2),high:jn(1),highest:jn(0),fallback:jn(4),extend:jn(1),override:jn(0)};class qn{constructor(e,t){this.inner=e,this.prec=t}}class Xn{of(e){return new zn(this,e)}reconfigure(e){return Xn.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class zn{constructor(e,t){this.compartment=e,this.inner=t}}class Vn{constructor(e,t,i,r,n){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=r,this.staticValues=n,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let r=[],n=Object.create(null),s=new Map;for(let i of function(e,t,i){let r=[[],[],[],[],[]],n=new Map;return function e(s,o){let a=n.get(s);if(null!=a){if(a>=o)return;let e=r[a].indexOf(s);e>-1&&r[a].splice(e,1),s instanceof zn&&i.delete(s.compartment)}if(n.set(s,o),Array.isArray(s))for(let t of s)e(t,o);else if(s instanceof zn){if(i.has(s.compartment))throw new RangeError("Duplicate use of compartment in extensions");let r=t.get(s.compartment)||s.inner;i.set(s.compartment,r),e(r,o)}else if(s instanceof qn)e(s.inner,s.prec);else if(s instanceof Fn)r[o].push(s),s.provides&&e(s.provides,o);else if(s instanceof Hn)r[o].push(s),s.facet.extensions&&e(s.facet.extensions,o);else{let t=s.extension;if(!t)throw new Error(`Unrecognized extension value in extension set (${s}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);e(t,o)}}(e,2),r.reduce(((e,t)=>e.concat(t)))}(e,t,s))i instanceof Fn?r.push(i):(n[i.facet.id]||(n[i.facet.id]=[])).push(i);let o=Object.create(null),a=[],l=[],h=[];for(let e of r)o[e.id]=l.length<<1,l.push((t=>e.slot(t))),h.push([]);for(let e in n){let t=n[e],r=t[0].facet;if(t.every((e=>0==e.type))){o[r.id]=a.length<<1|1;let e=r.combine(t.map((e=>e.value))),n=i?i.config.address[r.id]:null;if(null!=n){let t=Zn(i,n);r.compare(e,t)&&(e=t)}a.push(e)}else{for(let e of t)0==e.type?(o[e.id]=a.length<<1|1,a.push(e.value)):(o[e.id]=l.length<<1,l.push((t=>e.dynamicSlot(t))),h.push(e.dependencies.filter((e=>"string"!=typeof e)).map((e=>e.id))));o[r.id]=l.length<<1,l.push((e=>Wn(e,r,t))),h.push(t.filter((e=>0!=e.type)).map((e=>e.id)))}}let c=l.map((e=>Yn));if(i){let e=(t,r)=>{if(r>7)return!1;let n=o[t];if(!(1&n))return h[n>>1].every((t=>e(t,r+1)));let s=i.config.address[t];return null!=s&&Zn(i,s)==a[n>>1]};for(let t in o){let r=o[t],n=i.config.address[t];null!=n&&0==(1&r)&&e(+t,0)&&(c[r>>1]=Zn(i,n))}}return{configuration:new Vn(e,s,l.map((e=>e(o))),o,a),values:c}}}const Yn={};function Gn(e,t){if(1&t)return 2;let i=t>>1,r=e.status[i];if(4==r)throw new Error("Cyclic dependency between fields and/or facets");if(2&r)return r;e.status[i]=4;let n=e.config.dynamicSlots[i](e,e.applying);return e.status[i]=2|n}function Zn(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}const Kn=Qn.define(),Jn=Qn.define({combine:e=>e.some((e=>e)),static:!0}),es=Qn.define({combine:e=>e.length?e[0]:void 0,static:!0}),ts=Qn.define(),is=Qn.define(),rs=Qn.define(),ns=Qn.define({combine:e=>!!e.length&&e[0]});class ss{constructor(e,t){this.type=e,this.value=t}static define(){return new os}}class os{of(e){return new ss(this,e)}}class as{constructor(e){this.map=e}of(e){return new ls(this,e)}}class ls{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new ls(this.type,t)}is(e){return this.type==e}static define(e={}){return new as(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let r of e){let e=r.map(t);e&&i.push(e)}return i}}ls.reconfigure=ls.define(),ls.appendConfig=ls.define();class hs{constructor(e,t,i,r,n,s){this.startState=e,this.changes=t,this.selection=i,this.effects=r,this.annotations=n,this.scrollIntoView=s,this._doc=null,this._state=null,i&&Bn(i,t.newLength),n.some((e=>e.type==hs.time))||(this.annotations=n.concat(hs.time.of(Date.now())))}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(hs.userEvent);return!(!t||!(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}function cs(e,t){let i=[];for(let r=0,n=0;;){let s,o;if(r<e.length&&(n==t.length||t[n]>=e[r]))s=e[r++],o=e[r++];else{if(!(n<t.length))return i;s=t[n++],o=t[n++]}!i.length||i[i.length-1]<s?i.push(s,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function us(e,t,i){var r;let n,s,o;return i?(n=t.changes,s=kn.empty(t.changes.length),o=e.changes.compose(t.changes)):(n=t.changes.map(e.changes),s=e.changes.mapDesc(t.changes,!0),o=e.changes.compose(n)),{changes:o,selection:t.selection?t.selection.map(s):null===(r=e.selection)||void 0===r?void 0:r.map(n),effects:ls.mapEffects(e.effects,n).concat(ls.mapEffects(t.effects,s)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function fs(e,t,i){let r=t.selection,n=gs(t.annotations);return t.userEvent&&(n=n.concat(hs.userEvent.of(t.userEvent))),{changes:t.changes instanceof kn?t.changes:kn.of(t.changes||[],i,e.facet(es)),selection:r&&(r instanceof Mn?r:Mn.single(r.anchor,r.head)),effects:gs(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function ds(e,t,i){let r=fs(e,t.length?t[0]:{},e.doc.length);t.length&&!1===t[0].filter&&(i=!1);for(let n=1;n<t.length;n++){!1===t[n].filter&&(i=!1);let s=!!t[n].sequential;r=us(r,fs(e,t[n],s?r.changes.newLength:e.doc.length),s)}let n=new hs(e,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return function(e){let t=e.startState,i=t.facet(rs),r=e;for(let n=i.length-1;n>=0;n--){let s=i[n](e);s&&Object.keys(s).length&&(r=us(e,fs(t,s,e.changes.newLength),!0))}return r==e?e:new hs(t,e.changes,e.selection,r.effects,r.annotations,r.scrollIntoView)}(i?function(e){let t=e.startState,i=!0;for(let r of t.facet(ts)){let t=r(e);if(!1===t){i=!1;break}Array.isArray(t)&&(i=!0===i?t:cs(i,t))}if(!0!==i){let r,n;if(!1===i)n=e.changes.invertedDesc,r=kn.empty(t.doc.length);else{let t=e.changes.filter(i);r=t.changes,n=t.filtered.invertedDesc}e=new hs(t,r,e.selection&&e.selection.map(n),ls.mapEffects(e.effects,n),e.annotations,e.scrollIntoView)}let r=t.facet(is);for(let i=r.length-1;i>=0;i--){let n=r[i](e);e=n instanceof hs?n:Array.isArray(n)&&1==n.length&&n[0]instanceof hs?n[0]:ds(t,gs(n),!1)}return e}(n):n)}hs.time=ss.define(),hs.userEvent=ss.define(),hs.addToHistory=ss.define(),hs.remote=ss.define();const ps=[];function gs(e){return null==e?ps:Array.isArray(e)?e:[e]}var ms=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(ms||(ms={}));const _s=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let vs;try{vs=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(e){}class ys{constructor(e,t,i,r,n=null){this.config=e,this.doc=t,this.selection=i,this.values=r,this.applying=null,this.status=e.statusTemplate.slice(),this.applying=n,n&&(n._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)Gn(this,e<<1);this.applying=null}field(e,t=!0){let i=this.config.address[e.id];if(null!=i)return Gn(this,i),Zn(this,i);if(t)throw new RangeError("Field is not present in this state")}update(...e){return ds(this,e,!0)}applyTransaction(e){let t,i=this.config,{base:r,compartments:n}=i;for(let t of e.effects)t.is(Xn.reconfigure)?(i&&(n=new Map,i.compartments.forEach(((e,t)=>n.set(t,e))),i=null),n.set(t.value.compartment,t.value.extension)):t.is(ls.reconfigure)?(i=null,r=t.value):t.is(ls.appendConfig)&&(i=null,r=gs(r).concat(t.value));if(i)t=e.startState.values.slice();else{let e=Vn.resolve(r,n,this);i=e.configuration,t=new ys(i,this.doc,this.selection,e.values,null).values}new ys(i,e.newDoc,e.newSelection,t,e)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:e},range:Mn.cursor(t.from+e.length)})))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),r=this.changes(i.changes),n=[i.range],s=gs(i.effects);for(let i=1;i<t.ranges.length;i++){let o=e(t.ranges[i]),a=this.changes(o.changes),l=a.map(r);for(let e=0;e<i;e++)n[e]=n[e].map(l);let h=r.mapDesc(a,!0);n.push(o.range.map(h)),r=r.compose(l),s=ls.mapEffects(s,l).concat(ls.mapEffects(gs(o.effects),h))}return{changes:r,selection:Mn.create(n,t.mainIndex),effects:s}}changes(e=[]){return e instanceof kn?e:kn.of(e,this.doc.length,this.facet(ys.lineSeparator))}toText(e){return dn.of(e.split(this.facet(ys.lineSeparator)||wn))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(Gn(this,t),Zn(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof Fn&&(t[i]=r.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i)for(let t in i){let n=i[t],s=e[t];r.push(n.init((e=>n.spec.fromJSON(s,e))))}return ys.create({doc:e.doc,selection:Mn.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let{configuration:t,values:i}=Vn.resolve(e.extensions||[],new Map),r=e.doc instanceof dn?e.doc:dn.of((e.doc||"").split(t.staticFacet(ys.lineSeparator)||wn)),n=e.selection?e.selection instanceof Mn?e.selection:Mn.single(e.selection.anchor,e.selection.head):Mn.single(0);return Bn(n,r.length),t.staticFacet(Jn)||(n=n.asSingle()),new ys(t,r,n,i)}get tabSize(){return this.facet(ys.tabSize)}get lineBreak(){return this.facet(ys.lineSeparator)||"\n"}get readOnly(){return this.facet(ns)}phrase(e){for(let t of this.facet(ys.phrases))if(Object.prototype.hasOwnProperty.call(t,e))return t[e];return e}languageDataAt(e,t,i=-1){let r=[];for(let n of this.facet(Kn))for(let s of n(this,t,i))Object.prototype.hasOwnProperty.call(s,e)&&r.push(s[e]);return r}charCategorizer(e){return t=this.languageDataAt("wordChars",e).join(""),e=>{if(!/\S/.test(e))return ms.Space;if(function(e){if(vs)return vs.test(e);for(let t=0;t<e.length;t++){let i=e[t];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||_s.test(i)))return!0}return!1}(e))return ms.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return ms.Word;return ms.Other};var t}wordAt(e){let{text:t,from:i,length:r}=this.doc.lineAt(e),n=this.charCategorizer(e),s=e-i,o=e-i;for(;s>0;){let e=rn(t,s,!1);if(n(t.slice(e,s))!=ms.Word)break;s=e}for(;o<r;){let e=rn(t,o);if(n(t.slice(o,e))!=ms.Word)break;o=e}return s==o?null:Mn.range(s+i,o+i)}}function bs(e,t,i={}){let r={};for(let t of e)for(let e of Object.keys(t)){let n=t[e],s=r[e];if(void 0===s)r[e]=n;else if(s===n||void 0===n);else{if(!Object.hasOwnProperty.call(i,e))throw new Error("Config merge conflict for field "+e);r[e]=i[e](s,n)}}for(let e in t)void 0===r[e]&&(r[e]=t[e]);return r}ys.allowMultipleSelections=Jn,ys.tabSize=Qn.define({combine:e=>e.length?e[0]:4}),ys.lineSeparator=es,ys.readOnly=ns,ys.phrases=Qn.define(),ys.languageData=Kn,ys.changeFilter=ts,ys.transactionFilter=is,ys.transactionExtender=rs,Xn.reconfigure=ls.define();const Os="undefined"==typeof Symbol?"__":Symbol.for(""),ws="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Ss="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class Cs{constructor(e,t){this.rules=[];let{finish:i}=t||{};function r(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}function n(e,t,s,o){let a=[],l=/^@(\w+)\b/.exec(e[0]),h=l&&"keyframes"==l[1];if(l&&null==t)return s.push(e[0]+";");for(let i in t){let o=t[i];if(/&/.test(i))n(i.split(/,\s*/).map((t=>e.map((e=>t.replace(/&/,e))))).reduce(((e,t)=>e.concat(t))),o,s);else if(o&&"object"==typeof o){if(!l)throw new RangeError("The value of a property ("+i+") should be a primitive value.");n(r(i),o,a,h)}else null!=o&&a.push(i.replace(/_.*/,"").replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+": "+o+";")}(a.length||h)&&s.push((!i||l||o?e:e.map(i)).join(", ")+" {"+a.join(" ")+"}")}for(let t in e)n(r(t),e[t],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=Ss[Os]||1;return Ss[Os]=e+1,""+e.toString(36)}static mount(e,t){(e[ws]||new xs(e)).mount(Array.isArray(t)?t:[t])}}let ks=null;class xs{constructor(e){if(!e.head&&e.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if(ks)return e.adoptedStyleSheets=[ks.sheet].concat(e.adoptedStyleSheets),e[ws]=ks;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),ks=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[ws]=this}mount(e){let t=this.sheet,i=0,r=0;for(let n=0;n<e.length;n++){let s=e[n],o=this.modules.indexOf(s);if(o<r&&o>-1&&(this.modules.splice(o,1),r--,o=-1),-1==o){if(this.modules.splice(r++,0,s),t)for(let e=0;e<s.rules.length;e++)t.insertRule(s.rules[e],i++)}else{for(;r<o;)i+=this.modules[r++].rules.length;i+=s.rules.length,r++}}if(!t){let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e}}}class Es{eq(e){return this==e}range(e,t=e){return new As(e,t,this)}}Es.prototype.startSide=Es.prototype.endSide=0,Es.prototype.point=!1,Es.prototype.mapMode=Sn.TrackDel;class As{constructor(e,t,i){this.from=e,this.to=t,this.value=i}}function Ts(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class Ps{constructor(e,t,i,r){this.from=e,this.to=t,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,r=0){let n=i?this.to:this.from;for(let s=r,o=n.length;;){if(s==o)return s;let r=s+o>>1,a=n[r]-e||(i?this.value[r].endSide:this.value[r].startSide)-t;if(r==s)return a>=0?s:o;a>=0?o=r:s=r+1}}between(e,t,i,r){for(let n=this.findIndex(t,-1e9,!0),s=this.findIndex(i,1e9,!1,n);n<s;n++)if(!1===r(this.from[n]+e,this.to[n]+e,this.value[n]))return!1}map(e,t){let i=[],r=[],n=[],s=-1,o=-1;for(let a=0;a<this.value.length;a++){let l,h,c=this.value[a],u=this.from[a]+e,f=this.to[a]+e;if(u==f){let e=t.mapPos(u,c.startSide,c.mapMode);if(null==e)continue;l=h=e}else if(l=t.mapPos(u,c.startSide),h=t.mapPos(f,c.endSide),l>h||l==h&&c.startSide>0&&c.endSide<=0)continue;(h-l||c.endSide-c.startSide)<0||(s<0&&(s=l),c.point&&(o=Math.max(o,h-l)),i.push(c),r.push(l-s),n.push(h-s))}return{mapped:i.length?new Ps(r,n,i,o):null,pos:s}}}class Ls{constructor(e,t,i=Ls.empty,r){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=r}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:r=0,filterTo:n=this.length}=e,s=e.filter;if(0==t.length&&!s)return this;if(i&&t.slice().sort(Ts),this.isEmpty)return t.length?Ls.of(t):this;let o=new Ds(this,null,-1).goto(0),a=0,l=[],h=new Rs;for(;o.value||a<t.length;)if(a<t.length&&(o.from-t[a].from||o.startSide-t[a].value.startSide)>=0){let e=t[a++];h.addInner(e.from,e.to,e.value)||l.push(e)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(o.chunkIndex)<t[a].from)&&(!s||r>this.chunkEnd(o.chunkIndex)||n<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||r>o.to||n<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||l.push(new As(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!l.length?Ls.empty:this.nextLayer.update({add:l,filter:s,filterFrom:r,filterTo:n}))}map(e){if(0==e.length||this.isEmpty)return this;let t=[],i=[],r=-1;for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],o=this.chunk[n],a=e.touchesRange(s,s+o.length);if(!1===a)r=Math.max(r,o.maxPoint),t.push(o),i.push(e.mapPos(s));else if(!0===a){let{mapped:n,pos:a}=o.map(s,e);n&&(r=Math.max(r,n.maxPoint),t.push(n),i.push(a))}}let n=this.nextLayer.map(e);return 0==t.length?n:new Ls(i,t,n,r)}between(e,t,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let n=this.chunkPos[r],s=this.chunk[r];if(t>=n&&e<=n+s.length&&!1===s.between(n,e-n,t-n,i))return}this.nextLayer.between(e,t,i)}}iter(e=0){return Bs.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Bs.from(e).goto(t)}static compare(e,t,i,r,n=-1){let s=e.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=n)),o=t.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=n)),a=Ms(s,o,i),l=new Qs(s,a,n),h=new Qs(o,a,n);i.iterGaps(((e,t,i)=>$s(l,e,h,t,i,r))),i.empty&&0==i.length&&$s(l,0,h,0,0,r)}static eq(e,t,i=0,r){null==r&&(r=1e9);let n=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0)),s=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0));if(n.length!=s.length)return!1;if(!n.length)return!0;let o=Ms(n,s),a=new Qs(n,o,0).goto(i),l=new Qs(s,o,0).goto(i);for(;;){if(a.to!=l.to||!Hs(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>r)return!0;a.next(),l.next()}}static spans(e,t,i,r,n=-1){let s=new Qs(e,null,n).goto(t),o=t,a=s.openStart;for(;;){let e=Math.min(s.to,i);if(s.point?(r.point(o,e,s.point,s.activeForPoint(s.to),a),a=s.openEnd(e)+(s.to>e?1:0)):e>o&&(r.span(o,e,s.active,a),a=s.openEnd(e)),s.to>i)break;o=s.to,s.next()}return a}static of(e,t=!1){let i=new Rs;for(let r of e instanceof As?[e]:t?function(e){if(e.length>1)for(let t=e[0],i=1;i<e.length;i++){let r=e[i];if(Ts(t,r)>0)return e.slice().sort(Ts);t=r}return e}(e):e)i.add(r.from,r.to,r.value);return i.finish()}}Ls.empty=new Ls([],[],null,-1),Ls.empty.nextLayer=Ls.empty;class Rs{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Ps(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new Rs)).add(e,t,i)}addInner(e,t,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(r<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),0))}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(Ls.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=new Ls(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Ms(e,t,i){let r=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&r.set(t.chunk[e],t.chunkPos[e]);let n=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let s=r.get(e.chunk[t]);null!=s&&(i?i.mapPos(s):s)==e.chunkPos[t]&&n.add(e.chunk[t])}return n}class Ds{constructor(e,t,i,r=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.to-e.to||this.endSide-e.endSide}}class Bs{constructor(e){this.heap=e}static from(e,t=null,i=-1){let r=[];for(let n=0;n<e.length;n++)for(let s=e[n];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&r.push(new Ds(s,t,i,n));return 1==r.length?r[0]:new Bs(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)Is(this.heap,e);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)Is(this.heap,e);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Is(this.heap,0)}}}function Is(e,t){for(let i=e[t];;){let r=1+(t<<1);if(r>=e.length)break;let n=e[r];if(r+1<e.length&&n.compare(e[r+1])>=0&&(n=e[r+1],r++),i.compare(n)<0)break;e[r]=i,e[t]=n,t=r}}class Qs{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Bs.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ws(this.active,e),Ws(this.activeTo,e),Ws(this.activeRank,e),this.minActive=Fs(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:r,rank:n}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=n;)t++;Ns(this.active,t,i),Ns(this.activeTo,t,r),Ns(this.activeRank,t,n),e&&Ns(e,t,this.cursor.from),this.minActive=Fs(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,r=0;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>e){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&Ws(i,n)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let n=this.cursor.value;if(n.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=n,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=n.endSide,this.cursor.from<e&&(r=1),this.cursor.next(),this.to>e&&this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){let t=0;for(;t<i.length&&i[t]<e;)t++;this.openStart=t+r}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function $s(e,t,i,r,n,s){e.goto(t),i.goto(r);let o=r+n,a=r,l=r-t;for(;;){let t=e.to+l-i.to||e.endSide-i.endSide,r=t<0?e.to+l:i.to,n=Math.min(r,o);if(e.point||i.point?e.point&&i.point&&(e.point==i.point||e.point.eq(i.point))&&Hs(e.activeForPoint(e.to+l),i.activeForPoint(i.to))||s.comparePoint(a,n,e.point,i.point):n>a&&!Hs(e.active,i.active)&&s.compareRange(a,n,e.active,i.active),r>o)break;a=r,t<=0&&e.next(),t>=0&&i.next()}}function Hs(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!=t[i]&&!e[i].eq(t[i]))return!1;return!0}function Ws(e,t){for(let i=t,r=e.length-1;i<r;i++)e[i]=e[i+1];e.pop()}function Ns(e,t,i){for(let i=e.length-1;i>=t;i--)e[i+1]=e[i];e[t]=i}function Fs(e,t){let i=-1,r=1e9;for(let n=0;n<t.length;n++)(t[n]-r||e[n].endSide-e[i].endSide)<0&&(i=n,r=t[n]);return i}for(var js={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},Us={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},qs="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Xs="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),zs="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Vs="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Ys="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Gs=qs&&(Vs||+qs[1]<57)||zs&&Vs,Zs=0;Zs<10;Zs++)js[48+Zs]=js[96+Zs]=String(Zs);for(Zs=1;Zs<=24;Zs++)js[Zs+111]="F"+Zs;for(Zs=65;Zs<=90;Zs++)js[Zs]=String.fromCharCode(Zs+32),Us[Zs]=String.fromCharCode(Zs);for(var Ks in js)Us.hasOwnProperty(Ks)||(Us[Ks]=js[Ks]);function Js(e){let t;return t=11==e.nodeType?e.getSelection?e:e.ownerDocument:e,t.getSelection()}function eo(e,t){return!!t&&e.contains(1!=t.nodeType?t.parentNode:t)}function to(e,t){if(!t.anchorNode)return!1;try{return eo(e,t.anchorNode)}catch(e){return!1}}function io(e){return 3==e.nodeType?go(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function ro(e,t,i,r){return!!i&&(so(e,t,i,r,-1)||so(e,t,i,r,1))}function no(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function so(e,t,i,r,n){for(;;){if(e==i&&t==r)return!0;if(t==(n<0?0:oo(e))){if("DIV"==e.nodeName)return!1;let i=e.parentNode;if(!i||1!=i.nodeType)return!1;t=no(e)+(n<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if(1==(e=e.childNodes[t+(n<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=n<0?oo(e):0}}}function oo(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}const ao={left:0,right:0,top:0,bottom:0};function lo(e,t){let i=t?e.left:e.right;return{left:i,right:i,top:e.top,bottom:e.bottom}}function ho(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}class co{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=r}}let uo,fo=null;function po(e){if(e.setActive)return e.setActive();if(fo)return e.focus(fo);let t=[];for(let i=e;i&&(t.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(e.focus(null==fo?{get preventScroll(){return fo={preventScroll:!0},!0}}:void 0),!fo){fo=!1;for(let e=0;e<t.length;){let i=t[e++],r=t[e++],n=t[e++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=n&&(i.scrollLeft=n)}}}function go(e,t,i=t){let r=uo||(uo=document.createRange());return r.setEnd(e,i),r.setStart(e,t),r}function mo(e,t,i){let r={key:t,code:t,keyCode:i,which:i,cancelable:!0},n=new KeyboardEvent("keydown",r);n.synthetic=!0,e.dispatchEvent(n);let s=new KeyboardEvent("keyup",r);return s.synthetic=!0,e.dispatchEvent(s),n.defaultPrevented||s.defaultPrevented}function _o(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}class vo{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new vo(e.parentNode,no(e),t)}static after(e,t){return new vo(e.parentNode,no(e)+1,t)}}const yo=[];class bo{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(2&this.dirty){let t=this.dom,i=t.firstChild;for(let r of this.children){if(r.dirty){if(!r.dom&&i){let e=bo.get(i);e&&(e.parent||e.constructor!=r.constructor)||r.reuseDOM(i)}r.sync(e),r.dirty=0}if(e&&!e.written&&e.node==t&&i!=r.dom&&(e.written=!0),r.dom.parentNode==t){for(;i&&i!=r.dom;)i=Oo(i);i=r.dom.nextSibling}else t.insertBefore(r.dom,i)}for(i&&e&&e.node==t&&(e.written=!0);i;)i=Oo(i)}else if(1&this.dirty)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let r=0==oo(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==this.dom)break;0==r&&t.firstChild!=t.lastChild&&(r=e==t.firstChild?-1:1),e=t}i=r<0?e:e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!bo.get(i);)i=i.nextSibling;if(!i)return this.length;for(let e=0,t=0;;e++){let r=this.children[e];if(r.dom==i)return t;t+=r.length+r.breakAfter}}domBoundsAround(e,t,i=0){let r=-1,n=-1,s=-1,o=-1;for(let a=0,l=i,h=i;a<this.children.length;a++){let i=this.children[a],c=l+i.length;if(l<e&&c>t)return i.domBoundsAround(e,t,l);if(c>=e&&-1==r&&(r=a,n=l),l>t&&i.dom.parentNode==this.dom){s=a,o=h;break}h=c,l=c+i.breakAfter}return{from:n,to:o<0?i+this.length:o,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),1&t.dirty)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=yo){this.markDirty();for(let i=e;i<t;i++){let e=this.children[i];e.parent==this&&e.destroy()}this.children.splice(e,t-e,...i);for(let e=0;e<i.length;e++)i[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new wo(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,i,r,n,s){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}}function Oo(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}bo.prototype.breakAfter=0;class wo{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function So(e,t,i,r,n,s,o,a,l){let{children:h}=e,c=h.length?h[t]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(t==r&&c&&!o&&!f&&s.length<2&&c.merge(i,n,s.length?u:null,0==i,a,l))){if(r<h.length){let e=h[r];e&&n<e.length?(t==r&&(e=e.split(n),n=0),!f&&u&&e.merge(0,n,u,!0,0,l)?s[s.length-1]=e:(n&&e.merge(0,n,null,!1,0,l),s.push(e))):(null==e?void 0:e.breakAfter)&&(u?u.breakAfter=1:o=1),r++}for(c&&(c.breakAfter=o,i>0&&(!o&&s.length&&c.merge(i,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,a,0),t++));t<r&&s.length;)if(h[r-1].become(s[s.length-1]))r--,s.pop(),l=s.length?0:a;else{if(!h[t].become(s[0]))break;t++,s.shift(),a=s.length?0:l}!s.length&&t&&r<h.length&&!h[t-1].breakAfter&&h[r].merge(0,0,h[t-1],!1,a,l)&&t--,(t<r||s.length)&&e.replaceChildren(t,r,s)}}function Co(e,t,i,r,n,s){let o=e.childCursor(),{i:a,off:l}=o.findPos(i,1),{i:h,off:c}=o.findPos(t,-1),u=t-i;for(let e of r)u+=e.length;e.length+=u,So(e,h,c,a,l,r,0,n,s)}let[ko,xo]="undefined"!=typeof navigator?[navigator,document]:[{userAgent:"",vendor:"",platform:""},{documentElement:{style:{}}}];const Eo=/Edge\/(\d+)/.exec(ko.userAgent),Ao=/MSIE \d/.test(ko.userAgent),To=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ko.userAgent),Po=!!(Ao||To||Eo),Lo=!Po&&/gecko\/(\d+)/i.test(ko.userAgent),Ro=!Po&&/Chrome\/(\d+)/.exec(ko.userAgent),Mo="webkitFontSmoothing"in xo.documentElement.style,Do=!Po&&/Apple Computer/.test(ko.vendor),Bo=Do&&(/Mobile\/\w+/.test(ko.userAgent)||ko.maxTouchPoints>2);var Io={mac:Bo||/Mac/.test(ko.platform),windows:/Win/.test(ko.platform),linux:/Linux|X11/.test(ko.platform),ie:Po,ie_version:Ao?xo.documentMode||6:To?+To[1]:Eo?+Eo[1]:0,gecko:Lo,gecko_version:Lo?+(/Firefox\/(\d+)/.exec(ko.userAgent)||[0,0])[1]:0,chrome:!!Ro,chrome_version:Ro?+Ro[1]:0,ios:Bo,android:/Android\b/.test(ko.userAgent),webkit:Mo,safari:Do,webkit_version:Mo?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=xo.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class Qo extends bo{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,i){return(!i||i instanceof Qo&&!(this.length-(t-e)+i.length>256))&&(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Qo(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new vo(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Ho(this.dom,e,t)}}class $o extends bo{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let e of t)e.setParent(this)}setAttrs(e){if(_o(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,i,r,n,s){return!(i&&(!(i instanceof $o&&i.mark.eq(this.mark))||e&&n<=0||t<this.length&&s<=0)||(Co(this,e,t,i?i.children:[],n-1,s-1),this.markDirty(),0))}split(e){let t=[],i=0,r=-1,n=0;for(let s of this.children){let o=i+s.length;o>e&&t.push(i<e?s.split(e-i):s),r<0&&i>=e&&(r=n),i=o,n++}let s=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new $o(this.mark,t,s)}domAtPos(e){return Uo(this.dom,this.children,e)}coordsAt(e,t){return Xo(this,e,t)}}function Ho(e,t,i){let r=e.nodeValue.length;t>r&&(t=r);let n=t,s=t,o=0;0==t&&i<0||t==r&&i>=0?Io.chrome||Io.gecko||(t?(n--,o=1):(s++,o=-1)):i<0?n--:s++;let a=go(e,n,s).getClientRects();if(!a.length)return ao;let l=a[(o?o<0:i>=0)?0:a.length-1];return Io.safari&&!o&&0==l.width&&(l=Array.prototype.find.call(a,(e=>e.width))||l),o?lo(l,o<0):l||null}class Wo extends bo{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i}static create(e,t,i){return new(e.customView||Wo)(e,t,i)}split(e){let t=Wo.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,r,n,s){return!(i&&(!(i instanceof Wo&&this.widget.compare(i.widget))||e>0&&n<=0||t<this.length&&s<=0)||(this.length=e+(i?i.length:0)+(this.length-t),0))}become(e){return e.length==this.length&&e instanceof Wo&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.eq(e.widget)||this.markDirty(!0),this.widget=e.widget,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return dn.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,i=t&&t.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):dn.empty}domAtPos(e){return 0==e?vo.before(this.dom):vo.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),r=null;if(!i.length)return ao;for(let t=e>0?i.length-1:0;r=i[t],!(e>0?0==t:t==i.length-1||r.top<r.bottom);t+=e>0?-1:1);return 0==e&&t>0||e==this.length&&t<=0?r:lo(r,0==e)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class No extends Wo{domAtPos(e){return new vo(this.widget.text,e)}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){return t?3==e.nodeType?Math.min(t,this.length):this.length:0}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){return Ho(this.widget.text,e,t)}get isEditable(){return!0}}const Fo=Io.android?"":"";class jo extends bo{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof jo&&e.side==this.side}split(){return new jo(this.side)}sync(){this.dom?this.dirty&&this.dom.nodeValue!=Fo&&(this.dom.nodeValue=Fo):this.setDOM(document.createTextNode(Fo))}getSide(){return this.side}domAtPos(e){return vo.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=io(this.dom);return t[t.length-1]||null}get overrideDOMText(){return dn.of([this.dom.nodeValue.replace(/\u200b/g,"")])}}function Uo(e,t,i){let r=0;for(let n=0;r<t.length;r++){let s=t[r],o=n+s.length;if(!(o==n&&s.getSide()<=0)){if(i>n&&i<o&&s.dom.parentNode==e)return s.domAtPos(i-n);if(i<=n)break;n=o}}for(;r>0;r--){let i=t[r-1].dom;if(i.parentNode==e)return vo.after(i)}return new vo(e,0)}function qo(e,t,i){let r,{children:n}=e;i>0&&t instanceof $o&&n.length&&(r=n[n.length-1])instanceof $o&&r.mark.eq(t.mark)?qo(r,t.children[0],i-1):(n.push(t),t.setParent(e)),e.length+=t.length}function Xo(e,t,i){for(let r=0,n=0;n<e.children.length;n++){let s,o=e.children[n],a=r+o.length;if((i<=0||a==e.length||o.getSide()>0?a>=t:a>t)&&(t<a||n+1==e.children.length||(s=e.children[n+1]).length||s.getSide()>0)){let e=0;if(a==r){if(o.getSide()<=0)continue;e=i=-o.getSide()}let n=o.coordsAt(t-r,i);return e&&n?lo(n,i<0):n}r=a}let r=e.dom.lastChild;if(!r)return e.dom.getBoundingClientRect();let n=io(r);return n[n.length-1]||null}function zo(e,t){for(let i in e)"class"==i&&t.class?t.class+=" "+e.class:"style"==i&&t.style?t.style+=";"+e.style:t[i]=e[i];return t}function Vo(e,t){if(e==t)return!0;if(!e||!t)return!1;let i=Object.keys(e),r=Object.keys(t);if(i.length!=r.length)return!1;for(let n of i)if(-1==r.indexOf(n)||e[n]!==t[n])return!1;return!0}function Yo(e,t,i){if(t)for(let r in t)i&&r in i||e.removeAttribute(r);if(i)for(let r in i)t&&t[r]==i[r]||e.setAttribute(r,i[r])}Qo.prototype.children=Wo.prototype.children=jo.prototype.children=yo;class Go{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var Zo=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(Zo||(Zo={}));class Ko extends Es{constructor(e,t,i,r){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Jo(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new ta(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,{start:i,end:r}=ia(e,t);return new ta(e,t?i?-3e8:-1:4e8,t?r?2e8:1:-5e8,t,e.widget||null,!0)}static line(e){return new ea(e)}static set(e,t=!1){return Ls.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}Ko.none=Ls.empty;class Jo extends Ko{constructor(e){let{start:t,end:i}=ia(e);super(t?-1:4e8,i?1:-5e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof Jo&&this.tagName==e.tagName&&this.class==e.class&&Vo(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Jo.prototype.point=!1;class ea extends Ko{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ea&&Vo(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}ea.prototype.mapMode=Sn.TrackBefore,ea.prototype.point=!0;class ta extends Ko{constructor(e,t,i,r,n,s){super(t,i,n,e),this.block=r,this.isReplace=s,this.mapMode=r?t<=0?Sn.TrackBefore:Sn.TrackAfter:Sn.TrackDel}get type(){return this.startSide<this.endSide?Zo.WidgetRange:this.startSide<=0?Zo.WidgetBefore:Zo.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof ta&&((t=this.widget)==(i=e.widget)||!!(t&&i&&t.compare(i)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide;var t,i}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function ia(e,t=!1){let{inclusiveStart:i,inclusiveEnd:r}=e;return null==i&&(i=e.inclusive),null==r&&(r=e.inclusive),{start:null!=i?i:t,end:null!=r?r:t}}function ra(e,t,i,r=0){let n=i.length-1;n>=0&&i[n]+r>e?i[n]=Math.max(i[n],t):i.push(e,t)}ta.prototype.point=!0;class na extends bo{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,r,n,s){if(i){if(!(i instanceof na))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),Co(this,e,t,i?i.children:[],n,s),!0}split(e){let t=new na;if(t.breakAfter=this.breakAfter,0==this.length)return t;let{i,off:r}=this.childPos(e);r&&(t.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let e=i;e<this.children.length;e++)t.append(this.children[e],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Vo(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){qo(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=zo(t,this.attrs||{})),i&&(this.attrs=zo(t,{class:i}))}domAtPos(e){return Uo(this.dom,this.children,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?4&this.dirty&&(_o(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Yo(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let i=this.dom.lastChild;for(;i&&bo.get(i)instanceof $o;)i=i.lastChild;if(!i||"BR"!=i.nodeName&&0==(null===(t=bo.get(i))||void 0===t?void 0:t.isEditable)&&(!Io.ios||!this.children.some((e=>e instanceof Qo)))){let e=document.createElement("BR");e.cmIgnore=!0,this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof Qo))return null;let i=io(t.dom);if(1!=i.length)return null;e+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return Xo(this,e,t)}become(e){return!1}get type(){return Zo.Text}static find(e,t){for(let i=0,r=0;;i++){let n=e.children[i],s=r+n.length;if(s>=t){if(n instanceof na)return n;if(n.length)return null}r=s+n.breakAfter}}}class sa extends bo{constructor(e,t,i){super(),this.widget=e,this.length=t,this.type=i,this.breakAfter=0}merge(e,t,i,r,n,s){return!(i&&(!(i instanceof sa&&this.widget.compare(i.widget))||e>0&&n<=0||t<this.length&&s<=0)||(this.length=e+(i?i.length:0)+(this.length-t),0))}domAtPos(e){return 0==e?vo.before(this.dom):vo.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new sa(this.widget,t,this.type);return i.breakAfter=this.breakAfter,i}get children(){return yo}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):dn.empty}domBoundsAround(){return null}become(e){return e instanceof sa&&e.type==this.type&&e.widget.constructor==this.widget.constructor&&(e.widget.eq(this.widget)||this.markDirty(!0),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class oa{constructor(e,t,i){this.doc=e,this.pos=t,this.end=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof sa&&e.type==Zo.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new na),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(aa(new jo(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:t,lineBreak:i,done:r}=this.cursor.next(this.skip);if(this.skip=0,r)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}this.text=t,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t),this.getLine().append(aa(new Qo(this.text.slice(this.textOff,this.textOff+r)),t),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,t,i,r){this.buildText(t-e,i,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,i,r,n){let s=t-e;if(i instanceof ta)if(i.block){let{type:e}=i;e!=Zo.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new sa(i.widget||new la("div"),s,e))}else{let o=Wo.create(i.widget||new la("span"),s,i.startSide),a=this.atCursorPos&&!o.isEditable&&n<=r.length&&(e<t||i.startSide>0),l=!o.isEditable&&(e<t||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||a||(this.pendingBuffer=0),this.flushBuffer(r),a&&(h.append(aa(new jo(1),r),n),n=r.length+Math.max(0,n-r.length)),h.append(aa(o,r),n),this.atCursorPos=l,this.pendingBuffer=l?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);s&&(this.textOff+s<=this.text.length?this.textOff+=s:(this.skip+=s-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=n)}static build(e,t,i,r){let n=new oa(e,t,i);return n.openEnd=Ls.spans(r,t,i,n),n.openStart<0&&(n.openStart=n.openEnd),n.finish(n.openEnd),n}}function aa(e,t){for(let i of t)e=new $o(i,[e],e.length);return e}class la extends Go{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const ha=[],ca=Qn.define(),ua=Qn.define(),fa=Qn.define(),da=Qn.define(),pa=Qn.define(),ga=Qn.define(),ma=ls.define({map:(e,t)=>e.map(t)}),_a=ls.define({map:(e,t)=>e.map(t)});class va{constructor(e,t="nearest",i="nearest",r=5,n=5){this.range=e,this.y=t,this.x=i,this.yMargin=r,this.xMargin=n}map(e){return e.empty?this:new va(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const ya=ls.define({map:(e,t)=>e.map(t)});function ba(e,t,i){let r=e.facet(da);r.length?r[0](t):window.onerror?window.onerror(String(t),i,void 0,void 0,t):i?console.error(i+":",t):console.error(t)}const Oa=Qn.define({combine:e=>!e.length||e[0]});class wa{constructor(e,t){this.field=e,this.get=t}}class Sa{from(e){return new wa(this,e)}static define(){return new Sa}}Sa.decorations=Sa.define(),Sa.atomicRanges=Sa.define(),Sa.scrollMargins=Sa.define();let Ca=0;const ka=Qn.define();class xa{constructor(e,t,i){this.id=e,this.create=t,this.fields=i,this.extension=ka.of(this)}static define(e,t){let{eventHandlers:i,provide:r,decorations:n}=t||{},s=[];if(r)for(let e of Array.isArray(r)?r:[r])s.push(e);return i&&s.push(Ea.from((e=>({plugin:e,handlers:i})))),n&&s.push(Sa.decorations.from(n)),new xa(Ca++,e,s)}static fromClass(e,t){return xa.define((t=>new e(t)),t)}}const Ea=Sa.define();class Aa{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}takeField(e,t){if(this.spec)for(let{field:i,get:r}of this.spec.fields)i==e&&t.push(r(this.value))}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if(ba(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(e){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){ba(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null===(t=this.value)||void 0===t?void 0:t.destroy)try{this.value.destroy()}catch(t){ba(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Ta=Qn.define(),Pa=Qn.define(),La=Qn.define(),Ra=Qn.define();class Ma{constructor(e,t,i,r){this.fromA=e,this.toA=t,this.fromB=i,this.toB=r}join(e){return new Ma(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(0==t.length)return e;let i=[];for(let r=0,n=0,s=0,o=0;;r++){let a=r==e.length?null:e[r],l=s-o,h=a?a.fromB:1e9;for(;n<t.length&&t[n]<h;){let e=t[n],r=t[n+1],s=Math.max(o,e),a=Math.min(h,r);if(s<=a&&new Ma(s+l,a+l,s,a).addToSet(i),r>h)break;n+=2}if(!a)return i;new Ma(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),s=a.toA,o=a.toB}}}class Da{constructor(e,t,i=ha){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=kn.empty(this.startState.doc.length);for(let e of i)this.changes=this.changes.compose(e.changes);let r=[];this.changes.iterChangedRanges(((e,t,i,n)=>r.push(new Ma(e,t,i,n)))),this.changedRanges=r;let n=e.hasFocus;n!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=n,this.flags|=1),this.docChanged&&(this.flags|=2)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((e=>e.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var Ba=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(Ba||(Ba={}));const Ia=Ba.LTR,Qa=Ba.RTL;function $a(e){let t=[];for(let i=0;i<e.length;i++)t.push(1<<+e[i]);return t}const Ha=$a("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Wa=$a("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Na=Object.create(null),Fa=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),i=e.charCodeAt(1);Na[t]=i,Na[i]=-t}const ja=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class Ua{constructor(e,t,i){this.from=e,this.to=t,this.level=i}get dir(){return this.level%2?Qa:Ia}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,r){let n=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==i)return s;(n<0||(0!=r?r<0?o.from<t:o.to>t:e[n].level>o.level))&&(n=s)}}if(n<0)throw new RangeError("Index out of range");return n}}const qa=[];function Xa(e){return[new Ua(0,e,0)]}let za="";function Va(e,t,i,r,n){var s;let o=r.head-e.from,a=-1;if(0==o){if(!n||!e.length)return null;t[0].level!=i&&(o=t[0].side(!1,i),a=0)}else if(o==e.length){if(n)return null;let e=t[t.length-1];e.level!=i&&(o=e.side(!0,i),a=t.length-1)}a<0&&(a=Ua.find(t,o,null!==(s=r.bidiLevel)&&void 0!==s?s:-1,r.assoc));let l=t[a];o==l.side(n,i)&&(l=t[a+=n?1:-1],o=l.side(!n,i));let h=n==(l.dir==i),c=rn(e.text,o,h);if(za=e.text.slice(Math.min(o,c),Math.max(o,c)),c!=l.side(n,i))return Mn.cursor(c+e.from,h?-1:1,l.level);let u=a==(n?t.length-1:0)?null:t[a+(n?1:-1)];return u||l.level==i?u&&u.level<l.level?Mn.cursor(u.side(!n,i)+e.from,n?1:-1,u.level):Mn.cursor(c+e.from,n?-1:1,l.level):Mn.cursor(n?e.to:e.from,n?-1:1,i)}class Ya{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineBreak=t.state.lineBreak}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r),this.readNode(r);let e=r.nextSibling;if(e==t)break;let n=bo.get(r),s=bo.get(e);(n&&s?n.breakAfter:(n?n.breakAfter:Ga(r))||Ga(e)&&("BR"!=r.nodeName||r.cmIgnore))&&(this.text+=this.lineBreak),r=e}return this.findPointBefore(i,t),this}readNode(e){if(e.cmIgnore)return;let t,i=bo.get(e),r=i&&i.overrideDOMText;null!=r?t=r.sliceString(0,void 0,this.lineBreak):3==e.nodeType?t=e.nodeValue:"BR"==e.nodeName?t=e.nextSibling?this.lineBreak:"":1==e.nodeType&&this.readRange(e.firstChild,null),null!=t&&(this.findPointIn(e,t.length),this.text+=t,Io.chrome&&13==this.view.inputState.lastKeyCode&&!e.nextSibling&&/\n\n$/.test(this.text)&&(this.text=this.text.slice(0,-1)))}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointIn(e,t){for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t))}}function Ga(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}class Za{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Ka extends bo{constructor(e){super(),this.view=e,this.compositionDeco=Ko.none,this.decorations=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new na],this.children[0].setParent(this),this.updateInner([new Ma(0,0,0,e.state.doc.length)],this.updateDeco(),0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every((({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo))?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Ko.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=function(e,t){let i=e.observer.selectionRange,r=i.focusNode&&tl(i.focusNode,i.focusOffset,0);if(!r)return Ko.none;let n=e.docView.nearest(r);if(!n)return Ko.none;let s,o,a=r;if(n instanceof na){for(;a.parentNode!=n.dom;)a=a.parentNode;let e=a.previousSibling;for(;e&&!bo.get(e);)e=e.previousSibling;s=o=e?bo.get(e).posAtEnd:n.posAtStart}else{for(;;){let{parent:e}=n;if(!e)return Ko.none;if(e instanceof na)break;n=e}s=n.posAtStart,o=s+n.length,a=n.dom}let l=t.mapPos(s,1),h=Math.max(l,t.mapPos(o,-1)),{state:c}=e,u=3==a.nodeType?a.nodeValue:new Ya([],e).readRange(a.firstChild,null).text;if(h-l<u.length)if(c.sliceDoc(l,Math.min(c.doc.length,l+u.length))==u)h=l+u.length;else{if(c.sliceDoc(Math.max(0,h-u.length),h)!=u)return Ko.none;l=h-u.length}else if(c.sliceDoc(l,h)!=u)return Ko.none;return Ko.set(Ko.replace({widget:new el(a,r)}).range(l,h))}(this.view,e.changes)),(Io.ie||Io.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,r=this.updateDeco(),n=function(e,t,i){let r=new il;return Ls.compare(e,t,i,r),r.changes}(i,r,e.changes);return t=Ma.extendWithRanges(t,n),(0!=this.dirty||0!=t.length)&&(this.updateInner(t,r,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:r}=this.view;r.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.minWidth=this.minWidth?this.minWidth+"px":"";let e=Io.chrome||Io.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(e),this.dirty=0,e&&(e.written||r.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.children)e instanceof sa&&e.widget instanceof Ja&&n.push(e.dom);r.updateGaps(n)}updateChildren(e,t,i){let r=this.childCursor(i);for(let i=e.length-1;;i--){let n=i>=0?e[i]:null;if(!n)break;let{fromA:s,toA:o,fromB:a,toB:l}=n,{content:h,breakAtStart:c,openStart:u,openEnd:f}=oa.build(this.view.state.doc,a,l,t),{i:d,off:p}=r.findPos(o,1),{i:g,off:m}=r.findPos(s,-1);So(this,g,m,d,p,h,c,u,f)}}updateSelection(e=!1,t=!1){if(e&&this.view.observer.readSelectionRange(),!t&&!this.mayControlSelection()||Io.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,n=this.domAtPos(r.anchor),s=r.empty?n:this.domAtPos(r.head);if(Io.gecko&&r.empty&&1==(o=n).node.nodeType&&o.node.firstChild&&(0==o.offset||"false"==o.node.childNodes[o.offset-1].contentEditable)&&(o.offset==o.node.childNodes.length||"false"==o.node.childNodes[o.offset].contentEditable)){let e=document.createTextNode("");this.view.observer.ignore((()=>n.node.insertBefore(e,n.node.childNodes[n.offset]||null))),n=s=new vo(e,0),i=!0}var o;let a=this.view.observer.selectionRange;!i&&a.focusNode&&ro(n.node,n.offset,a.anchorNode,a.anchorOffset)&&ro(s.node,s.offset,a.focusNode,a.focusOffset)||(this.view.observer.ignore((()=>{Io.android&&Io.chrome&&this.dom.contains(a.focusNode)&&function(e,t){for(let i=e;i&&i!=t;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(a.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let e=Js(this.root);if(r.empty){if(Io.gecko){let e=(t=n.node,i=n.offset,1!=t.nodeType?0:(i&&"false"==t.childNodes[i-1].contentEditable?1:0)|(i<t.childNodes.length&&"false"==t.childNodes[i].contentEditable?2:0));if(e&&3!=e){let t=tl(n.node,n.offset,1==e?1:-1);t&&(n=new vo(t,1==e?0:t.nodeValue.length))}}e.collapse(n.node,n.offset),null!=r.bidiLevel&&null!=a.cursorBidiLevel&&(a.cursorBidiLevel=r.bidiLevel)}else if(e.extend)e.collapse(n.node,n.offset),e.extend(s.node,s.offset);else{let t=document.createRange();r.anchor>r.head&&([n,s]=[s,n]),t.setEnd(s.node,s.offset),t.setStart(n.node,n.offset),e.removeAllRanges(),e.addRange(t)}var t,i})),this.view.observer.setSelectionRange(n,s)),this.impreciseAnchor=n.precise?null:new vo(a.anchorNode,a.anchorOffset),this.impreciseHead=s.precise?null:new vo(a.focusNode,a.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=Js(this.root);if(!e.empty||!e.assoc||!t.modify)return;let i=na.find(this,e.head);if(!i)return;let r=i.posAtStart;if(e.head==r||e.head==r+i.length)return;let n=this.coordsAt(e.head,-1),s=this.coordsAt(e.head,1);if(!n||!s||n.bottom>s.top)return;let o=this.domAtPos(e.head+e.assoc);t.collapse(o.node,o.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(Oa)?this.root.activeElement==this.dom:to(this.dom,this.view.observer.selectionRange)}nearest(e){for(let t=e;t;){let e=bo.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(i<e.length||e instanceof na)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,r=this.children.length-1;;r--){let n=this.children[r],s=i-n.breakAfter-n.length;if(e>s||e==s&&n.type!=Zo.WidgetBefore&&n.type!=Zo.WidgetAfter&&(!r||2==t||this.children[r-1].breakAfter||this.children[r-1].type==Zo.WidgetBefore&&t>-2))return n.coordsAt(e-s,t);i=s}}measureVisibleLineHeights(){let e=[],{from:t,to:i}=this.view.viewState.viewport,r=this.view.contentDOM.clientWidth,n=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,s=-1;for(let o=0,a=0;a<this.children.length;a++){let l=this.children[a],h=o+l.length;if(h>i)break;if(o>=t){let t=l.dom.getBoundingClientRect();if(e.push(t.height),n){let e=l.dom.lastChild,i=e?io(e):[];if(i.length){let e=i[i.length-1],n=this.view.textDirection==Ba.LTR?e.right-t.left:t.right-e.left;n>s&&(s=n,this.minWidth=r,this.minWidthFrom=o,this.minWidthTo=h)}}}o=h+l.breakAfter}return e}measureTextSize(){for(let e of this.children)if(e instanceof na){let t=e.measureTextSize();if(t)return t}let e,t,i=document.createElement("div");return i.className="cm-line",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let r=io(i.firstChild)[0];e=i.getBoundingClientRect().height,t=r?r.width/27:7,i.remove()})),{lineHeight:e,charWidth:t}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new wo(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,r=0;;r++){let n=r==t.viewports.length?null:t.viewports[r],s=n?n.from-1:this.length;if(s>i){let r=t.lineBlockAt(s).bottom-t.lineBlockAt(i).top;e.push(Ko.replace({widget:new Ja(r),block:!0,inclusive:!0}).range(i,s))}if(!n)break;i=n.to+1}return Ko.set(e)}updateDeco(){return this.decorations=[...this.view.pluginField(Sa.decorations),...this.view.state.facet(La),this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let t,{range:i}=e,r=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!r)return;!i.empty&&(t=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(r={left:Math.min(r.left,t.left),top:Math.min(r.top,t.top),right:Math.max(r.right,t.right),bottom:Math.max(r.bottom,t.bottom)});let n=0,s=0,o=0,a=0;for(let e of this.view.pluginField(Sa.scrollMargins))if(e){let{left:t,right:i,top:r,bottom:l}=e;null!=t&&(n=Math.max(n,t)),null!=i&&(s=Math.max(s,i)),null!=r&&(o=Math.max(o,r)),null!=l&&(a=Math.max(a,l))}let l={left:r.left-n,top:r.top-o,right:r.right+s,bottom:r.bottom+a};!function(e,t,i,r,n,s,o,a){let l=e.ownerDocument,h=l.defaultView;for(let c=e;c;)if(1==c.nodeType){let e,u=c==l.body;if(u)e=ho(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let t=c.getBoundingClientRect();e={left:t.left,right:t.left+c.clientWidth,top:t.top,bottom:t.top+c.clientHeight}}let f=0,d=0;if("nearest"==n)t.top<e.top?(d=-(e.top-t.top+o),i>0&&t.bottom>e.bottom+d&&(d=t.bottom-e.bottom+d+o)):t.bottom>e.bottom&&(d=t.bottom-e.bottom+o,i<0&&t.top-d<e.top&&(d=-(e.top+d-t.top+o)));else{let r=t.bottom-t.top,s=e.bottom-e.top;d=("center"==n&&r<=s?t.top+r/2-s/2:"start"==n||"center"==n&&i<0?t.top-o:t.bottom-s+o)-e.top}if("nearest"==r?t.left<e.left?(f=-(e.left-t.left+s),i>0&&t.right>e.right+f&&(f=t.right-e.right+f+s)):t.right>e.right&&(f=t.right-e.right+s,i<0&&t.left<e.left+f&&(f=-(e.left+f-t.left+s))):f=("center"==r?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==r==a?t.left-s:t.right-(e.right-e.left)+s)-e.left,f||d)if(u)h.scrollBy(f,d);else{if(d){let e=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-e}if(f){let e=c.scrollLeft;c.scrollLeft+=f,f=c.scrollLeft-e}t={left:t.left-f,top:t.top-d,right:t.right-f,bottom:t.bottom-d}}if(u)break;c=c.assignedSlot||c.parentNode,r=n="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,l,i.head<i.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Ba.LTR)}}class Ja extends Go{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}class el extends Go{constructor(e,t){super(),this.top=e,this.text=t}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return No}}function tl(e,t,i){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0&&i<=0)t=oo(e=e.childNodes[t-1]);else{if(!(1==e.nodeType&&t<e.childNodes.length&&i>=0))return null;e=e.childNodes[t],t=0}}}class il{constructor(){this.changes=[]}compareRange(e,t){ra(e,t,this.changes)}comparePoint(e,t){ra(e,t,this.changes)}}function rl(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function nl(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function sl(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function ol(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function al(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function ll(e,t,i){let r,n,s,o,a,l,h,c;for(let u=e.firstChild;u;u=u.nextSibling){let e=io(u);for(let f=0;f<e.length;f++){let d=e[f];n&&sl(n,d)&&(d=ol(al(d,n.bottom),n.top));let p=rl(t,d),g=nl(i,d);if(0==p&&0==g)return 3==u.nodeType?hl(u,t,i):ll(u,t,i);(!r||o>g||o==g&&s>p)&&(r=u,n=d,s=p,o=g),0==p?i>d.bottom&&(!h||h.bottom<d.bottom)?(a=u,h=d):i<d.top&&(!c||c.top>d.top)&&(l=u,c=d):h&&sl(h,d)?h=al(h,d.bottom):c&&sl(c,d)&&(c=ol(c,d.top))}}if(h&&h.bottom>=i?(r=a,n=h):c&&c.top<=i&&(r=l,n=c),!r)return{node:e,offset:0};let u=Math.max(n.left,Math.min(n.right,t));return 3==r.nodeType?hl(r,u,i):s||"true"!=r.contentEditable?{node:e,offset:Array.prototype.indexOf.call(e.childNodes,r)+(t>=(n.left+n.right)/2?1:0)}:ll(r,u,i)}function hl(e,t,i){let r=e.nodeValue.length,n=-1,s=1e9,o=0;for(let a=0;a<r;a++){let r=go(e,a,a+1).getClientRects();for(let l=0;l<r.length;l++){let h=r[l];if(h.top==h.bottom)continue;o||(o=t-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&c<s){let i=t>=(h.left+h.right)/2,r=i;if((Io.chrome||Io.gecko)&&go(e,a).getBoundingClientRect().left==h.right&&(r=!i),c<=0)return{node:e,offset:a+(r?1:0)};n=a+(r?1:0),s=c}}}return{node:e,offset:n>-1?n:o>0?e.nodeValue.length:0}}function cl(e,{x:t,y:i},r,n=-1){var s;let o,a=e.contentDOM.getBoundingClientRect(),l=a.top+e.viewState.paddingTop,{docHeight:h}=e.viewState,c=Math.max(0,Math.min(i-l,h));for(let t=e.defaultLineHeight/2,i=!1;o=e.elementAtHeight(c),o.type!=Zo.Text;)for(;c=n>0?o.bottom+t:o.top-t,!(c>=0&&c<=h);){if(i)return r?null:0;i=!0,n=-n}i=l+c;let u=o.from;if(u<e.viewport.from)return 0==e.viewport.from?0:r?ul(e,a,o,t,i):null;if(u>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:r?ul(e,a,o,t,i):null;let f=e.dom.ownerDocument,d=e.root.elementFromPoint?e.root:f,p=d.elementFromPoint(t,i);p&&!e.contentDOM.contains(p)&&(p=null),p||(t=Math.max(a.left+1,Math.min(a.right-1,t)),p=d.elementFromPoint(t,i),p&&!e.contentDOM.contains(p)&&(p=null));let g,m=-1;if(p&&0!=(null===(s=e.docView.nearest(p))||void 0===s?void 0:s.isEditable))if(f.caretPositionFromPoint){let e=f.caretPositionFromPoint(t,i);e&&({offsetNode:g,offset:m}=e)}else if(f.caretRangeFromPoint){let e=f.caretRangeFromPoint(t,i);e&&(({startContainer:g,startOffset:m}=e),Io.safari&&function(e,t,i){let r;if(3!=e.nodeType||t!=(r=e.nodeValue.length))return!1;for(let t=e.nextSibling;t;t=t.nextSibling)if(1!=t.nodeType||"BR"!=t.nodeName)return!1;return go(e,r-1,r).getBoundingClientRect().left>i}(g,m,t)&&(g=void 0))}if(!g||!e.docView.dom.contains(g)){let r=na.find(e.docView,u);({node:g,offset:m}=ll(r.dom,t,i))}return e.docView.posFromDOM(g,m)}function ul(e,t,i,r,n){let s=Math.round((r-t.left)*e.defaultCharacterWidth);e.lineWrapping&&i.height>1.5*e.defaultLineHeight&&(s+=Math.floor((n-i.top)/e.defaultLineHeight)*e.viewState.heightOracle.lineLength);let o=e.state.sliceDoc(i.from,i.to);return i.from+fn(o,s,e.state.tabSize)}function fl(e,t,i,r){let n=e.state.doc.lineAt(t.head),s=e.bidiSpans(n);for(let o=t,a=null;;){let t=Va(n,s,e.textDirection,o,i),l=za;if(!t){if(n.number==(i?e.state.doc.lines:1))return o;l="\n",n=e.state.doc.line(n.number+(i?1:-1)),s=e.bidiSpans(n),t=Mn.cursor(i?n.from:n.to)}if(a){if(!a(l))return o}else{if(!r)return t;a=r(l)}o=t}}function dl(e,t,i){let r=e.pluginField(Sa.atomicRanges);for(;;){let e=!1;for(let n of r)n.between(i.from-1,i.from+1,((r,n,s)=>{i.from>r&&i.from<n&&(i=t.from>i.from?Mn.cursor(r,1):Mn.cursor(n,-1),e=!0)}));if(!e)return i}}class pl{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let t in yl){let i=yl[t];e.contentDOM.addEventListener(t,(r=>{"keydown"==t&&this.keydown(e,r)||vl(e,r)&&!this.ignoreDuringComposition(r)&&(this.mustFlushObserver(r)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,r)?r.preventDefault():i(e,r))})),this.registeredEvents.push(t)}this.notifiedFocused=e.hasFocus,this.ensureHandlers(e),Io.safari&&e.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e){let t=this.customHandlers=e.pluginField(Ea);for(let i of t)for(let t in i.handlers)this.registeredEvents.indexOf(t)<0&&"scroll"!=t&&(this.registeredEvents.push(t),e.contentDOM.addEventListener(t,(i=>{vl(e,i)&&this.runCustomHandlers(t,e,i)&&i.preventDefault()})))}runCustomHandlers(e,t,i){for(let r of this.customHandlers){let n=r.handlers[e];if(n)try{if(n.call(r.plugin,i,t)||i.defaultPrevented)return!0}catch(e){ba(t.state,e)}}return!1}runScrollHandlers(e,t){for(let i of this.customHandlers){let r=i.handlers.scroll;if(r)try{r.call(i.plugin,t,e)}catch(t){ba(e.state,t)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),this.screenKeyEvent(e,t))return!0;if(Io.android&&Io.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return!(!Io.ios||!(i=gl.find((e=>e.keyCode==t.keyCode)))||t.ctrlKey||t.altKey||t.metaKey||t.synthetic||(this.pendingIOSKey=i,setTimeout((()=>this.flushIOSKey(e)),250),0))}flushIOSKey(e){let t=this.pendingIOSKey;return!!t&&(this.pendingIOSKey=void 0,mo(e.contentDOM,t.key,t.keyCode))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(this.composing>0||!!(Io.safari&&Date.now()-this.compositionEndedAt<500)&&(this.compositionEndedAt=0,!0))}screenKeyEvent(e,t){let i=9==t.keyCode&&Date.now()<this.lastEscPress+2e3;return 27==t.keyCode?this.lastEscPress=Date.now():ml.indexOf(t.keyCode)<0&&(this.lastEscPress=0),i}mustFlushObserver(e){return"keydown"==e.type&&229!=e.keyCode||"compositionend"==e.type&&!Io.ios}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const gl=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],ml=[16,17,18,20,91,92,224,225];class _l{constructor(e,t,i,r){this.view=e,this.style=i,this.mustSelect=r,this.lastEvent=t;let n=e.contentDOM.ownerDocument;n.addEventListener("mousemove",this.move=this.move.bind(this)),n.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ys.allowMultipleSelections)&&function(e,t){let i=e.state.facet(ca);return i.length?i[0](t):Io.mac?t.metaKey:t.ctrlKey}(e,t),this.dragMove=function(e,t){let i=e.state.facet(ua);return i.length?i[0](t):Io.mac?!t.altKey:!t.ctrlKey}(e,t),this.dragging=!(!function(e,t){let{main:i}=e.state.selection;if(i.empty)return!1;let r=Js(e.root);if(0==r.rangeCount)return!0;let n=r.getRangeAt(0).getClientRects();for(let e=0;e<n.length;e++){let i=n[e];if(i.left<=t.clientX&&i.right>=t.clientX&&i.top<=t.clientY&&i.bottom>=t.clientY)return!0}return!1}(e,t)||1!=Rl(t))&&null,!1===this.dragging&&(t.preventDefault(),this.select(t))}move(e){if(0==e.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=e)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);!this.mustSelect&&t.eq(this.view.state.selection)&&t.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function vl(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i,r=t.target;r!=e.contentDOM;r=r.parentNode)if(!r||11==r.nodeType||(i=bo.get(r))&&i.ignoreEvent(t))return!1;return!0}const yl=Object.create(null),bl=Io.ie&&Io.ie_version<15||Io.ios&&Io.webkit_version<604;function Ol(e,t){let i,{state:r}=e,n=1,s=r.toText(t),o=s.lines==r.selection.ranges.length;if(null!=Dl&&r.selection.ranges.every((e=>e.empty))&&Dl==s.toString()){let e=-1;i=r.changeByRange((i=>{let a=r.doc.lineAt(i.from);if(a.from==e)return{range:i};e=a.from;let l=r.toText((o?s.line(n++).text:t)+r.lineBreak);return{changes:{from:a.from,insert:l},range:Mn.cursor(i.from+l.length)}}))}else i=o?r.changeByRange((e=>{let t=s.line(n++);return{changes:{from:e.from,to:e.to,insert:t.text},range:Mn.cursor(e.from+t.length)}})):r.replaceSelection(s);e.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}yl.keydown=(e,t)=>{e.inputState.setSelectionOrigin("select")};let wl=0;function Sl(e,t,i,r){if(1==r)return Mn.cursor(t,i);if(2==r)return function(e,t,i=1){let r=e.charCategorizer(t),n=e.doc.lineAt(t),s=t-n.from;if(0==n.length)return Mn.cursor(t);0==s?i=1:s==n.length&&(i=-1);let o=s,a=s;i<0?o=rn(n.text,s,!1):a=rn(n.text,s);let l=r(n.text.slice(o,a));for(;o>0;){let e=rn(n.text,o,!1);if(r(n.text.slice(e,o))!=l)break;o=e}for(;a<n.length;){let e=rn(n.text,a);if(r(n.text.slice(a,e))!=l)break;a=e}return Mn.range(o+n.from,a+n.from)}(e.state,t,i);{let i=na.find(e.docView,t),r=e.state.doc.lineAt(i?i.posAtEnd:t),n=i?i.posAtStart:r.from,s=i?i.posAtEnd:r.to;return s<e.state.doc.length&&s==r.to&&s++,Mn.range(n,s)}}yl.touchstart=(e,t)=>{wl=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},yl.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},yl.mousedown=(e,t)=>{if(e.observer.flush(),wl>Date.now()-2e3&&1==Rl(t))return;let i=null;for(let r of e.state.facet(fa))if(i=r(e,t),i)break;if(i||0!=t.button||(i=function(e,t){let i=El(e,t),r=Rl(t),n=e.state.selection,s=i,o=t;return{update(e){e.docChanged&&(i&&(i.pos=e.changes.mapPos(i.pos)),n=n.map(e.changes),o=null)},get(t,a,l){let h;if(o&&t.clientX==o.clientX&&t.clientY==o.clientY?h=s:(h=s=El(e,t),o=t),!h||!i)return n;let c=Sl(e,h.pos,h.bias,r);if(i.pos!=h.pos&&!a){let t=Sl(e,i.pos,i.bias,r),n=Math.min(t.from,c.from),s=Math.max(t.to,c.to);c=n<c.from?Mn.range(n,s):Mn.range(s,n)}return a?n.replaceRange(n.main.extend(c.from,c.to)):l?n.addRange(c):Mn.create([c])}}}(e,t)),i){let r=e.root.activeElement!=e.contentDOM;r&&e.observer.ignore((()=>po(e.contentDOM))),e.inputState.startMouseSelection(new _l(e,t,i,r))}};let Cl=(e,t)=>e>=t.top&&e<=t.bottom,kl=(e,t,i)=>Cl(t,i)&&e>=i.left&&e<=i.right;function xl(e,t,i,r){let n=na.find(e.docView,t);if(!n)return 1;let s=t-n.posAtStart;if(0==s)return 1;if(s==n.length)return-1;let o=n.coordsAt(s,-1);if(o&&kl(i,r,o))return-1;let a=n.coordsAt(s,1);return a&&kl(i,r,a)?1:o&&Cl(r,o)?-1:1}function El(e,t){let i=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:i,bias:xl(e,i,t.clientX,t.clientY)}}const Al=Io.ie&&Io.ie_version<=11;let Tl=null,Pl=0,Ll=0;function Rl(e){if(!Al)return e.detail;let t=Tl,i=Ll;return Tl=e,Ll=Date.now(),Pl=!t||i>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(Pl+1)%3:1}function Ml(e,t,i,r){if(!i)return;let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1);t.preventDefault();let{mouseSelection:s}=e.inputState,o=r&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,a={from:n,insert:i},l=e.state.changes(o?[o,a]:a);e.focus(),e.dispatch({changes:l,selection:{anchor:l.mapPos(n,-1),head:l.mapPos(n,1)},userEvent:o?"move.drop":"input.drop"})}yl.dragstart=(e,t)=>{let{selection:{main:i}}=e.state,{mouseSelection:r}=e.inputState;r&&(r.dragging=i),t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(i.from,i.to)),t.dataTransfer.effectAllowed="copyMove")},yl.drop=(e,t)=>{if(!t.dataTransfer)return;if(e.state.readOnly)return t.preventDefault();let i=t.dataTransfer.files;if(i&&i.length){t.preventDefault();let r=Array(i.length),n=0,s=()=>{++n==i.length&&Ml(e,t,r.filter((e=>null!=e)).join(e.state.lineBreak),!1)};for(let e=0;e<i.length;e++){let t=new FileReader;t.onerror=s,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(r[e]=t.result),s()},t.readAsText(i[e])}}else Ml(e,t,t.dataTransfer.getData("Text"),!0)},yl.paste=(e,t)=>{if(e.state.readOnly)return t.preventDefault();e.observer.flush();let i=bl?null:t.clipboardData;i?(Ol(e,i.getData("text/plain")),t.preventDefault()):function(e){let t=e.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{e.focus(),i.remove(),Ol(e,i.value)}),50)}(e)};let Dl=null;function Bl(e,t){if(e.docView.compositionDeco.size){e.inputState.rapidCompositionStart=t;try{e.update([])}finally{e.inputState.rapidCompositionStart=!1}}}yl.copy=yl.cut=(e,t)=>{let{text:i,ranges:r,linewise:n}=function(e){let t=[],i=[],r=!1;for(let r of e.selection.ranges)r.empty||(t.push(e.sliceDoc(r.from,r.to)),i.push(r));if(!t.length){let n=-1;for(let{from:r}of e.selection.ranges){let s=e.doc.lineAt(r);s.number>n&&(t.push(s.text),i.push({from:s.from,to:Math.min(e.doc.length,s.to+1)})),n=s.number}r=!0}return{text:t.join(e.lineBreak),ranges:i,linewise:r}}(e.state);if(!i&&!n)return;Dl=n?i:null;let s=bl?null:t.clipboardData;s?(t.preventDefault(),s.clearData(),s.setData("text/plain",i)):function(e,t){let i=e.dom.parentNode;if(!i)return;let r=i.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout((()=>{r.remove(),e.focus()}),50)}(e,i),"cut"!=t.type||e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})},yl.focus=yl.blur=e=>{setTimeout((()=>{e.hasFocus!=e.inputState.notifiedFocused&&e.update([])}),10)},yl.beforeprint=e=>{e.viewState.printing=!0,e.requestMeasure(),setTimeout((()=>{e.viewState.printing=!1,e.requestMeasure()}),2e3)},yl.compositionstart=yl.compositionupdate=e=>{null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0,e.docView.compositionDeco.size&&(e.observer.flush(),Bl(e,!0)))},yl.compositionend=e=>{e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionFirstChange=null,setTimeout((()=>{e.inputState.composing<0&&Bl(e,!1)}),50)},yl.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},yl.beforeinput=(e,t)=>{var i;let r;if(Io.chrome&&Io.android&&(r=gl.find((e=>e.inputType==t.inputType)))&&(e.observer.delayAndroidKey(r.key,r.keyCode),"Backspace"==r.key||"Delete"==r.key)){let t=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())}),100)}};const Il=["pre-wrap","normal","pre-line","break-spaces"];class Ql{constructor(){this.doc=dn.empty,this.lineWrapping=!1,this.direction=Ba.LTR,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForStyle(e,t){return Il.indexOf(e)>-1!=this.lineWrapping||this.direction!=t}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(10*r)]||(t=!0,this.heightSamples[Math.floor(10*r)]=!0)}return t}refresh(e,t,i,r,n,s){let o=Il.indexOf(e)>-1,a=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=o||this.direction!=t;if(this.lineWrapping=o,this.direction=t,this.lineHeight=i,this.charWidth=r,this.lineLength=n,a){this.heightSamples={};for(let e=0;e<s.length;e++){let t=s[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return a}}class $l{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Hl{constructor(e,t,i,r,n){this.from=e,this.length=t,this.top=i,this.height=r,this.type=n}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new Hl(this.from,this.length+e.length,this.top,this.height+e.height,t)}moveY(e){return e?new Hl(this.from,this.length,this.top+e,this.height,Array.isArray(this.type)?this.type.map((t=>t.moveY(e))):this.type):this}}var Wl=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(Wl||(Wl={}));const Nl=.001;class Fl{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>Nl&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return Fl.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,r){let n=this;for(let s=r.length-1;s>=0;s--){let{fromA:o,toA:a,fromB:l,toB:h}=r[s],c=n.lineAt(o,Wl.ByPosNoHeight,t,0,0),u=c.to>=a?c:n.lineAt(a,Wl.ByPosNoHeight,t,0,0);for(h+=u.to-a,a=u.to;s>0&&c.from<=r[s-1].toA;)o=r[s-1].fromA,l=r[s-1].fromB,s--,o<c.from&&(c=n.lineAt(o,Wl.ByPosNoHeight,t,0,0));l+=c.from-o,o=c.from;let f=Vl.build(i,e,l,h);n=n.replace(o,a,f)}return n.updateHeight(i,0)}static empty(){return new Ul(0,0)}static of(e){if(1==e.length)return e[0];let t=0,i=e.length,r=0,n=0;for(;;)if(t==i)if(r>2*n){let n=e[t-1];n.break?e.splice(--t,1,n.left,null,n.right):e.splice(--t,1,n.left,n.right),i+=1+n.break,r-=n.size}else{if(!(n>2*r))break;{let t=e[i];t.break?e.splice(i,1,t.left,null,t.right):e.splice(i,1,t.left,t.right),i+=2+t.break,n-=t.size}}else if(r<n){let i=e[t++];i&&(r+=i.size)}else{let t=e[--i];t&&(n+=t.size)}let s=0;return null==e[t-1]?(s=1,t--):null==e[t]&&(s=1,i++),new Xl(Fl.of(e.slice(0,t)),s,Fl.of(e.slice(i)))}}Fl.prototype.size=1;class jl extends Fl{constructor(e,t,i){super(e,t),this.type=i}blockAt(e,t,i,r){return new Hl(r,this.length,i,this.height,this.type)}lineAt(e,t,i,r,n){return this.blockAt(0,i,r,n)}forEachLine(e,t,i,r,n,s){s(this.blockAt(0,i,r,n))}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ul extends jl{constructor(e,t){super(e,t,Zo.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,i){let r=i[0];return 1==i.length&&(r instanceof Ul||r instanceof ql&&4&r.flags)&&Math.abs(this.length-r.length)<10?(r instanceof ql?r=new Ul(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Fl.of(i)}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ql extends Fl{constructor(e){super(e,0)}lines(e,t){let i=e.lineAt(t).number,r=e.lineAt(t+this.length).number;return{firstLine:i,lastLine:r,lineHeight:this.height/(r-i+1)}}blockAt(e,t,i,r){let{firstLine:n,lastLine:s,lineHeight:o}=this.lines(t,r),a=Math.max(0,Math.min(s-n,Math.floor((e-i)/o))),{from:l,length:h}=t.line(n+a);return new Hl(l,h,i+o*a,o,Zo.Text)}lineAt(e,t,i,r,n){if(t==Wl.ByHeight)return this.blockAt(e,i,r,n);if(t==Wl.ByPosNoHeight){let{from:t,to:r}=i.lineAt(e);return new Hl(t,r-t,0,0,Zo.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,n),{from:a,length:l,number:h}=i.lineAt(e);return new Hl(a,l,r+o*(h-s),o,Zo.Text)}forEachLine(e,t,i,r,n,s){let{firstLine:o,lineHeight:a}=this.lines(i,n);for(let l=Math.max(e,n),h=Math.min(n+this.length,t);l<=h;){let t=i.lineAt(l);l==e&&(r+=a*(t.number-o)),s(new Hl(t.from,t.length,r,a,Zo.Text)),r+=a,l=t.to+1}}replace(e,t,i){let r=this.length-t;if(r>0){let e=i[i.length-1];e instanceof ql?i[i.length-1]=new ql(e.length+r):i.push(null,new ql(r-1))}if(e>0){let t=i[0];t instanceof ql?i[0]=new ql(e+t.length):i.unshift(new ql(e-1),null)}return Fl.of(i)}decomposeLeft(e,t){t.push(new ql(e-1),null)}decomposeRight(e,t){t.push(null,new ql(this.length-e-1))}updateHeight(e,t=0,i=!1,r){let n=t+this.length;if(r&&r.from<=t+this.length&&r.more){let i=[],s=Math.max(t,r.from),o=-1,a=e.heightChanged;for(r.from>t&&i.push(new ql(r.from-t-1).updateHeight(e,t));s<=n&&r.more;){let t=e.doc.lineAt(s).length;i.length&&i.push(null);let n=r.heights[r.index++];-1==o?o=n:Math.abs(n-o)>=Nl&&(o=-2);let a=new Ul(t,n);a.outdated=!1,i.push(a),s+=t+1}s<=n&&i.push(null,new ql(n-s).updateHeight(e,s));let l=Fl.of(i);return e.heightChanged=a||o<0||Math.abs(l.height-this.height)>=Nl||Math.abs(o-this.lines(e.doc,t).lineHeight)>=Nl,l}return(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Xl extends Fl{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return 1&this.flags}blockAt(e,t,i,r){let n=i+this.left.height;return e<n?this.left.blockAt(e,t,i,r):this.right.blockAt(e,t,n,r+this.left.length+this.break)}lineAt(e,t,i,r,n){let s=r+this.left.height,o=n+this.left.length+this.break,a=t==Wl.ByHeight?e<s:e<o,l=a?this.left.lineAt(e,t,i,r,n):this.right.lineAt(e,t,i,s,o);if(this.break||(a?l.to<o:l.from>o))return l;let h=t==Wl.ByPosNoHeight?Wl.ByPosNoHeight:Wl.ByPos;return a?l.join(this.right.lineAt(o,h,i,s,o)):this.left.lineAt(o,h,i,r,n).join(l)}forEachLine(e,t,i,r,n,s){let o=r+this.left.height,a=n+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,i,r,n,s),t>=a&&this.right.forEachLine(e,t,i,o,a,s);else{let l=this.lineAt(a,Wl.ByPos,i,r,n);e<l.from&&this.left.forEachLine(e,l.from-1,i,r,n,s),l.to>=e&&l.from<=t&&s(l),t>l.to&&this.right.forEachLine(l.to+1,t,i,o,a,s)}}replace(e,t,i){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,i));let n=[];e>0&&this.decomposeLeft(e,n);let s=n.length;for(let e of i)n.push(e);if(e>0&&zl(n,s-1),t<this.length){let e=n.length;this.decomposeRight(t,n),zl(n,e)}return Fl.of(n)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Fl.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,r){let{left:n,right:s}=this,o=t+n.length+this.break,a=null;return r&&r.from<=t+n.length&&r.more?a=n=n.updateHeight(e,t,i,r):n.updateHeight(e,t,i),r&&r.from<=o+s.length&&r.more?a=s=s.updateHeight(e,o,i,r):s.updateHeight(e,o,i),a?this.balanced(n,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function zl(e,t){let i,r;null==e[t]&&(i=e[t-1])instanceof ql&&(r=e[t+1])instanceof ql&&e.splice(t-1,3,new ql(i.length+1+r.length))}class Vl{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Ul?i.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new Ul(e-this.pos,-1)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0;r<0&&(r=this.oracle.lineHeight);let n=t-e;i.block?this.addBlock(new jl(n,r,i.type)):(n||r>=5)&&this.addLineDeco(r,n)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ul(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new ql(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ul)return e;let t=new Ul(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type!=Zo.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=Zo.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let i=this.ensureLine();i.length+=t,i.collapsed+=t,i.widgetHeight=Math.max(i.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof Ul||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Ul(0,-1));let i=e;for(let e of this.nodes)e instanceof Ul&&e.updateHeight(this.oracle,i),i+=e?e.length:1;return this.nodes}static build(e,t,i,r){let n=new Vl(i,e);return Ls.spans(t,i,r,n,0),n.finish(i)}}class Yl{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,r){(e<t||i&&i.heightRelevant||r&&r.heightRelevant)&&ra(e,t,this.changes,5)}}class Gl{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],n=t[i];if(r.from!=n.from||r.to!=n.to||r.size!=n.size)return!1}return!0}draw(e){return Ko.replace({widget:new Zl(this.size,e)}).range(this.from,this.to)}}class Zl extends Go{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Kl{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.heightOracle=new Ql,this.scaler=sh,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.heightMap=Fl.empty().applyChanges(e.facet(La),dn.empty,this.heightOracle.setDoc(e.doc),[new Ma(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ko.set(this.lineGaps.map((e=>e.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let r=i?t.head:t.anchor;if(!e.some((({from:e,to:t})=>r>=e&&r<=t))){let{from:t,to:i}=this.lineBlockAt(r);e.push(new Jl(t,i))}}this.viewports=e.sort(((e,t)=>e.from-t.from)),this.scaler=this.heightMap.height<=7e6?sh:new oh(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(e=>{this.viewportLines.push(1==this.scaler.scale?e:ah(e,this.scaler))}))}update(e,t=null){let i=this.state;this.state=e.state;let r=this.state.facet(La),n=e.changedRanges,s=Ma.extendWithRanges(n,function(e,t,i){let r=new Yl;return Ls.compare(e,t,i,r,0),r.changes}(e.startState.facet(La),r,e?e.changes:kn.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(r,i.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=!e.changes.empty||2&e.flags||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),r=this.heightOracle,n=i.whiteSpace,s="rtl"==i.direction?Ba.RTL:Ba.LTR,o=this.heightOracle.mustRefreshForStyle(n,s),a=o||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight,l=0,h=0;if(a){this.mustMeasureContent=!1,this.contentDOMHeight=t.clientHeight;let e=parseInt(i.paddingTop)||0,r=parseInt(i.paddingBottom)||0;this.paddingTop==e&&this.paddingBottom==r||(l|=8,this.paddingTop=e,this.paddingBottom=r)}let c=this.printing?{top:-1e8,bottom:1e8,left:-1e8,right:1e8}:function(e,t){let i=e.getBoundingClientRect(),r=Math.max(0,i.left),n=Math.min(innerWidth,i.right),s=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom),a=e.ownerDocument.body;for(let t=e.parentNode;t&&t!=a;)if(1==t.nodeType){let e=t,i=window.getComputedStyle(e);if((e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&"visible"!=i.overflow){let t=e.getBoundingClientRect();r=Math.max(r,t.left),n=Math.min(n,t.right),s=Math.max(s,t.top),o=Math.min(o,t.bottom)}t="absolute"==i.position||"fixed"==i.position?e.offsetParent:e.parentNode}else{if(11!=t.nodeType)break;t=t.host}return{left:r-i.left,right:Math.max(r,n)-i.left,top:s-(i.top+t),bottom:Math.max(s,o)-(i.top+t)}}(t,this.paddingTop),u=c.top-this.pixelViewport.top,f=c.bottom-this.pixelViewport.bottom;this.pixelViewport=c;let d=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(d!=this.inView&&(this.inView=d,d&&(a=!0)),!this.inView)return 0;if(a){let i=e.docView.measureVisibleLineHeights();r.mustRefreshForHeights(i)&&(o=!0);let a=t.clientWidth;if(o||r.lineWrapping&&Math.abs(a-this.contentDOMWidth)>r.charWidth){let{lineHeight:t,charWidth:h}=e.docView.measureTextSize();o=r.refresh(n,s,t,h,a/h,i),o&&(e.docView.minWidth=0,l|=8)}this.contentDOMWidth!=a&&(this.contentDOMWidth=a,l|=8),this.editorHeight!=e.scrollDOM.clientHeight&&(this.editorHeight=e.scrollDOM.clientHeight,l|=8),u>0&&f>0?h=Math.max(u,f):u<0&&f<0&&(h=Math.min(u,f)),r.heightChanged=!1,this.heightMap=this.heightMap.updateHeight(r,0,o,new $l(this.viewport.from,i)),r.heightChanged&&(l|=2)}let p=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return p&&(this.viewport=this.getViewport(h,this.scrollTarget)),this.updateForViewport(),(2&l||p)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,n=this.state.doc,{visibleTop:s,visibleBottom:o}=this,a=new Jl(r.lineAt(s-1e3*i,Wl.ByHeight,n,0,0).from,r.lineAt(o+1e3*(1-i),Wl.ByHeight,n,0,0).to);if(t){let{head:e}=t.range,i=this.editorHeight;if(e<a.from||e>a.to){let s,o=r.lineAt(e,Wl.ByPos,n,0,0);s="center"==t.y?(o.top+o.bottom)/2-i/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-i,a=new Jl(r.lineAt(s-500,Wl.ByHeight,n,0,0).from,r.lineAt(s+i+500,Wl.ByHeight,n,0,0).to)}}return a}mapViewport(e,t){let i=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new Jl(this.heightMap.lineAt(i,Wl.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(r,Wl.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Wl.ByPos,this.state.doc,0,0),{bottom:n}=this.heightMap.lineAt(t,Wl.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==e||r<=s-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||n>=o+Math.max(10,Math.min(i,250)))&&r>s-2e3&&n<o+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let r of e)t.touchesRange(r.from,r.to)||i.push(new Gl(t.mapPos(r.from),t.mapPos(r.to),r.size));return i}ensureLineGaps(e){let t=[];if(this.heightOracle.direction!=Ba.LTR)return t;for(let i of this.viewportLines){if(i.length<4e3)continue;let r,n,s=eh(i.from,i.to,this.state);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let e=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;r=th(s,(this.visibleTop-i.top-e)/i.height),n=th(s,(this.visibleBottom-i.top+e)/i.height)}else{let e=s.total*this.heightOracle.charWidth,t=2e3*this.heightOracle.charWidth;r=th(s,(this.pixelViewport.left-t)/e),n=th(s,(this.pixelViewport.right+t)/e)}let o=[];r>i.from&&o.push({from:i.from,to:r}),n<i.to&&o.push({from:n,to:i.to});let a=this.state.selection.main;a.from>=i.from&&a.from<=i.to&&rh(o,a.from-10,a.from+10),!a.empty&&a.to>=i.from&&a.to<=i.to&&rh(o,a.to-10,a.to+10);for(let{from:r,to:n}of o)n-r>1e3&&t.push(nh(e,(e=>e.from>=i.from&&e.to<=i.to&&Math.abs(e.from-r)<1e3&&Math.abs(e.to-n)<1e3))||new Gl(r,n,this.gapSize(i,r,n,s)))}return t}gapSize(e,t,i,r){let n=ih(r,i)-ih(r,t);return this.heightOracle.lineWrapping?e.height*n:r.total*this.heightOracle.charWidth*n}updateLineGaps(e){Gl.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ko.set(e.map((e=>e.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let e=this.state.facet(La);this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];Ls.spans(e,this.viewport.from,this.viewport.to,{span(e,i){t.push({from:e,to:i})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some(((e,i)=>e.from!=t[i].from||e.to!=t[i].to));return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find((t=>t.from<=e&&t.to>=e))||ah(this.heightMap.lineAt(e,Wl.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return ah(this.heightMap.lineAt(this.scaler.fromDOM(e),Wl.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return ah(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Jl{constructor(e,t){this.from=e,this.to=t}}function eh(e,t,i){let r=[],n=e,s=0;return Ls.spans(i.facet(La),e,t,{span(){},point(e,t){e>n&&(r.push({from:n,to:e}),s+=e-n),n=t}},20),n<t&&(r.push({from:n,to:t}),s+=t-n),{total:s,ranges:r}}function th({total:e,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let r=Math.floor(e*i);for(let e=0;;e++){let{from:i,to:n}=t[e],s=n-i;if(r<=s)return i+r;r-=s}}function ih(e,t){let i=0;for(let{from:r,to:n}of e.ranges){if(t<=n){i+=t-r;break}i+=n-r}return i/e.total}function rh(e,t,i){for(let r=0;r<e.length;r++){let n=e[r];if(n.from<i&&n.to>t){let s=[];n.from<t&&s.push({from:n.from,to:t}),n.to>i&&s.push({from:i,to:n.to}),e.splice(r,1,...s),r+=s.length-1}}}function nh(e,t){for(let i of e)if(t(i))return i}const sh={toDOM:e=>e,fromDOM:e=>e,scale:1};class oh{constructor(e,t,i){let r=0,n=0,s=0;this.viewports=i.map((({from:i,to:n})=>{let s=t.lineAt(i,Wl.ByPos,e,0,0).top,o=t.lineAt(n,Wl.ByPos,e,0,0).bottom;return r+=o-s,{from:i,to:n,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-r)/(t.height-r);for(let e of this.viewports)e.domTop=s+(e.top-n)*this.scale,s=e.domBottom=e.domTop+(e.bottom-e.top),n=e.bottom}toDOM(e){for(let t=0,i=0,r=0;;t++){let n=t<this.viewports.length?this.viewports[t]:null;if(!n||e<n.top)return r+(e-i)*this.scale;if(e<=n.bottom)return n.domTop+(e-n.top);i=n.bottom,r=n.domBottom}}fromDOM(e){for(let t=0,i=0,r=0;;t++){let n=t<this.viewports.length?this.viewports[t]:null;if(!n||e<n.domTop)return i+(e-r)/this.scale;if(e<=n.domBottom)return n.top+(e-n.domTop);i=n.bottom,r=n.domBottom}}}function ah(e,t){if(1==t.scale)return e;let i=t.toDOM(e.top),r=t.toDOM(e.bottom);return new Hl(e.from,e.length,i,r-i,Array.isArray(e.type)?e.type.map((e=>ah(e,t))):e.type)}const lh=Qn.define({combine:e=>e.join(" ")}),hh=Qn.define({combine:e=>e.indexOf(!0)>-1}),ch=Cs.newName(),uh=Cs.newName(),fh=Cs.newName(),dh={"&light":"."+uh,"&dark":"."+fh};function ph(e,t,i){return new Cs(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,(t=>{if("&"==t)return e;if(!i||!i[t])throw new RangeError(`Unsupported selector: ${t}`);return i[t]})):e+" "+t})}const gh=ph("."+ch,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},dh),mh={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},_h=Io.ie&&Io.ie_version<=11;class vh{constructor(e,t,i){this.view=e,this.onChange=t,this.onScrollChanged=i,this.active=!1,this.selectionRange=new co,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver((t=>{for(let e of t)this.queue.push(e);(Io.ie&&Io.ie_version<=11||Io.ios&&e.composing)&&t.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),_h&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))})),this.resize.observe(e.scrollDOM)),this.start(),this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some(((t,i)=>t!=e[i])))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:t}=this,i=this.selectionRange;if(t.state.facet(Oa)?t.root.activeElement!=this.dom:!to(t.dom,i))return;let r=i.anchorNode&&t.docView.nearest(i.anchorNode);r&&r.ignoreEvent(e)||((Io.ie&&Io.ie_version<=11||Io.android&&Io.chrome)&&!t.state.selection.main.empty&&i.focusNode&&ro(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:e}=this.view,t=Js(e),i=Io.safari&&11==e.nodeType&&function(){let e=document.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}()==this.view.contentDOM&&function(e){let t=null;function i(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}if(e.contentDOM.addEventListener("beforeinput",i,!0),document.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",i,!0),!t)return null;let r=t.startContainer,n=t.startOffset,s=t.endContainer,o=t.endOffset,a=e.docView.domAtPos(e.state.selection.main.anchor);return ro(a.node,a.offset,s,o)&&([r,n,s,o]=[s,o,r,n]),{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:o}}(this.view)||t;return!this.selectionRange.eq(i)&&(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(1==i.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,mh),_h&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),_h&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.observer.takeRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||requestAnimationFrame((()=>{let e=this.delayedAndroidKey;this.delayedAndroidKey=null;let t=this.view.state;mo(this.view.contentDOM,e.key,e.keyCode)?this.processRecords():this.flush(),this.view.state==t&&this.view.update([])})),this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let e=this.queue;for(let t of this.observer.takeRecords())e.push(t);e.length&&(this.queue=[]);let t=-1,i=-1,r=!1;for(let n of e){let e=this.readMutation(n);e&&(e.typeOver&&(r=!0),-1==t?({from:t,to:i}=e):(t=Math.min(e.from,t),i=Math.max(e.to,i)))}return{from:t,to:i,typeOver:r}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;e&&this.readSelectionRange();let{from:t,to:i,typeOver:r}=this.processRecords(),n=this.selectionChanged&&to(this.dom,this.selectionRange);if(t<0&&!n)return;this.selectionChanged=!1;let s=this.view.state;this.onChange(t,i,r),this.view.state==s&&this.view.update([])}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.dirty|=4),"childList"==e.type){let i=yh(t,e.previousSibling||e.target.previousSibling,-1),r=yh(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}destroy(){var e,t,i;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(i=this.resize)||void 0===i||i.disconnect();for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function yh(e,t,i){for(;t;){let r=bo.get(t);if(r&&r.parent==e)return r;let n=t.parentNode;t=n!=e.dom?n:i>0?t.nextSibling:t.previousSibling}return null}class bh{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(e=>this.update([e])),this.dispatch=this.dispatch.bind(this),this.root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new Kl(e.state||ys.create()),this.plugins=this.state.facet(ka).map((e=>new Aa(e)));for(let e of this.plugins)e.update(this);this.observer=new vh(this,((e,t,i)=>{!function(e,t,i,r){let n,s,o=e.state.selection.main;if(t>-1){let r=e.docView.domBoundsAround(t,i,0);if(!r||e.state.readOnly)return;let{from:a,to:l}=r,h=e.docView.impreciseHead||e.docView.impreciseAnchor?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:i,anchorOffset:r,focusNode:n,focusOffset:s}=e.observer.selectionRange;return i&&(t.push(new Za(i,r)),n==i&&s==r||t.push(new Za(n,s))),t}(e),c=new Ya(h,e);c.readRange(r.startDOM,r.endDOM),s=function(e,t){if(0==e.length)return null;let i=e[0].pos,r=2==e.length?e[1].pos:i;return i>-1&&r>-1?Mn.single(i+t,r+t):null}(h,a);let u=o.from,f=null;(8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100||Io.android&&c.text.length<l-a)&&(u=o.to,f="end");let d=function(e,t,i,r){let n=Math.min(e.length,t.length),s=0;for(;s<n&&e.charCodeAt(s)==t.charCodeAt(s);)s++;if(s==n&&e.length==t.length)return null;let o=e.length,a=t.length;for(;o>0&&a>0&&e.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;return"end"==r&&(i-=o+Math.max(0,s-Math.min(o,a))-s),o<s&&e.length<t.length?(s-=i<=s&&i>=o?s-i:0,a=s+(a-o),o=s):a<s&&(s-=i<=s&&i>=a?s-i:0,o=s+(o-a),a=s),{from:s,toA:o,toB:a}}(e.state.sliceDoc(a,l),c.text,u-a,f);d&&(n={from:a+d.from,to:a+d.toA,insert:e.state.toText(c.text.slice(d.from,d.toB))})}else if(e.hasFocus||!e.state.facet(Oa)){let t=e.observer.selectionRange,{impreciseHead:i,impreciseAnchor:r}=e.docView,n=i&&i.node==t.focusNode&&i.offset==t.focusOffset||!eo(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),a=r&&r.node==t.anchorNode&&r.offset==t.anchorOffset||!eo(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset);n==o.head&&a==o.anchor||(s=Mn.single(a,n))}if(n||s)if(!n&&r&&!o.empty&&s&&s.main.empty?n={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,o.to)}:n&&n.from>=o.from&&n.to<=o.to&&(n.from!=o.from||n.to!=o.to)&&o.to-o.from-(n.to-n.from)<=4&&(n={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,o.to))}),n){let t=e.state;if(Io.ios&&e.inputState.flushIOSKey(e))return;if(Io.android&&(n.from==o.from&&n.to==o.to&&1==n.insert.length&&2==n.insert.lines&&mo(e.contentDOM,"Enter",13)||n.from==o.from-1&&n.to==o.to&&0==n.insert.length&&mo(e.contentDOM,"Backspace",8)||n.from==o.from&&n.to==o.to+1&&0==n.insert.length&&mo(e.contentDOM,"Delete",46)))return;let i,r=n.insert.toString();if(e.state.facet(ga).some((t=>t(e,n.from,n.to,r))))return;if(e.inputState.composing>=0&&e.inputState.composing++,n.from>=o.from&&n.to<=o.to&&n.to-n.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==n.from+n.insert.length)){let r=o.from<n.from?t.sliceDoc(o.from,n.from):"",s=o.to>n.to?t.sliceDoc(n.to,o.to):"";i=t.replaceSelection(e.state.toText(r+n.insert.sliceString(0,void 0,e.state.lineBreak)+s))}else{let e=t.changes(n);i={changes:e,selection:s&&!t.selection.main.eq(s.main)&&s.main.to<=e.newLength?t.selection.replaceRange(s.main):void 0}}let a="input.type";e.composing&&(a+=".compose",e.inputState.compositionFirstChange&&(a+=".start",e.inputState.compositionFirstChange=!1)),e.dispatch(i,{scrollIntoView:!0,userEvent:a})}else if(s&&!s.main.eq(o)){let t=!1,i="select";e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),i=e.inputState.lastSelectionOrigin),e.dispatch({selection:s,scrollIntoView:t,userEvent:i})}}(this,e,t,i)}),(e=>{this.inputState.runScrollHandlers(this,e),this.observer.intersecting&&this.measure()})),this.inputState=new pl(this),this.docView=new Ka(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,window.addEventListener("resize",(()=>{-1==Sh&&(Sh=setTimeout(Ch,50))})),this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}dispatch(...e){this._dispatch(1==e.length&&e[0]instanceof hs?e[0]:this.state.update(...e))}update(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t,i=!1,r=this.state;for(let t of e){if(t.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=t.state}if(this.destroyed)return void(this.viewState.state=r);if(r.facet(ys.phrases)!=this.state.facet(ys.phrases))return this.setState(r);t=new Da(this,r,e);let n=null;try{this.updateState=2;for(let t of e){if(n&&(n=n.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;n=new va(e.empty?e:Mn.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(ma)?n=new va(e.value):e.is(_a)?n=new va(e.value,"center"):e.is(ya)&&(n=e.value)}this.viewState.update(t,n),this.bidiCache=xh.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),i=this.docView.update(t),this.state.facet(Ra)!=this.styleModules&&this.mountStyles(),this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(i,e.some((e=>e.isUserEvent("select.pointer"))))}finally{this.updateState=0}if((i||n||this.viewState.mustEnforceCursorAssoc)&&this.requestMeasure(),!t.empty)for(let e of this.state.facet(pa))e(t)}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=e;else{this.updateState=2;try{for(let e of this.plugins)e.destroy(this);this.viewState=new Kl(e),this.plugins=e.facet(ka).map((e=>new Aa(e))),this.pluginMap.clear();for(let e of this.plugins)e.update(this);this.docView=new Ka(this),this.inputState.ensureHandlers(this),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}this.requestMeasure()}}updatePlugins(e){let t=e.startState.facet(ka),i=e.state.facet(ka);if(t!=i){let r=[];for(let n of i){let i=t.indexOf(n);if(i<0)r.push(new Aa(n));else{let t=this.plugins[i];t.mustUpdate=e,r.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=r,this.pluginMap.clear(),this.inputState.ensureHandlers(this)}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.flush();let t=null;try{for(let e=0;;e++){this.updateState=1;let i=this.viewport,r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let n=[];4&r||([this.measureRequests,n]=[n,this.measureRequests]);let s=n.map((e=>{try{return e.read(this)}catch(e){return ba(this.state,e),kh}})),o=new Da(this,this.state),a=!1;o.flags|=r,t?t.flags|=r:t=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),a=this.docView.update(o));for(let e=0;e<n.length;e++)if(s[e]!=kh)try{let t=n[e];t.write&&t.write(s[e],this)}catch(e){ba(this.state,e)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null),a&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(pa))e(t)}get themeClasses(){return ch+" "+(this.state.facet(hh)?fh:uh)+" "+this.state.facet(lh)}updateAttrs(){let e=Eh(this,Ta,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Oa)?"true":"false",class:"cm-content",style:`${Io.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Eh(this,Pa,t),this.observer.ignore((()=>{Yo(this.contentDOM,this.contentAttrs,t),Yo(this.dom,this.editorAttrs,e)})),this.editorAttrs=e,this.contentAttrs=t}showAnnouncements(e){let t=!0;for(let i of e)for(let e of i.effects)e.is(bh.announce)&&(t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=e.value)}mountStyles(){this.styleModules=this.state.facet(Ra),Cs.mount(this.root,this.styleModules.concat(gh).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),e){if(null!=e.key)for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key)return void(this.measureRequests[t]=e);this.measureRequests.push(e)}}pluginField(e){let t=[];for(let i of this.plugins)i.update(this).takeField(e,t);return t}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find((t=>t.spec==e))||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}blockAtHeight(e,t){let i=wh(t,this);return this.elementAtHeight(e-i).moveY(i)}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}visualLineAtHeight(e,t){let i=wh(t,this);return this.lineBlockAtHeight(e-i).moveY(i)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}viewportLines(e,t){let i=wh(t,this);for(let t of this.viewportLineBlocks)e(t.moveY(i))}get viewportLineBlocks(){return this.viewState.viewportLines}visualLineAt(e,t=0){return this.lineBlockAt(e).moveY(t+this.viewState.paddingTop)}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return dl(this,e,fl(this,e,t,i))}moveByGroup(e,t){return dl(this,e,fl(this,e,t,(t=>function(e,t,i){let r=e.state.charCategorizer(t),n=r(i);return e=>{let t=r(e);return n==ms.Space&&(n=t),n==t}}(this,e.head,t))))}moveToLineBoundary(e,t,i=!0){return function(e,t,i,r){let n=e.state.doc.lineAt(t.head),s=r&&e.lineWrapping?e.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head):null;if(s){let t=e.dom.getBoundingClientRect(),r=e.posAtCoords({x:i==(e.textDirection==Ba.LTR)?t.right-1:t.left+1,y:(s.top+s.bottom)/2});if(null!=r)return Mn.cursor(r,i?-1:1)}let o=na.find(e.docView,t.head),a=o?i?o.posAtEnd:o.posAtStart:i?n.to:n.from;return Mn.cursor(a,i?-1:1)}(this,e,t,i)}moveVertically(e,t,i){return dl(this,e,function(e,t,i,r){let n=t.head,s=i?1:-1;if(n==(i?e.state.doc.length:0))return Mn.cursor(n);let o,a=t.goalColumn,l=e.contentDOM.getBoundingClientRect(),h=e.coordsAtPos(n),c=e.documentTop;if(h)null==a&&(a=h.left-l.left),o=s<0?h.top:h.bottom;else{let t=e.viewState.lineBlockAt(n-c);null==a&&(a=Math.min(l.right-l.left,e.defaultCharacterWidth*(n-t.from))),o=(s<0?t.top:t.bottom)+c}let u=l.left+a,f=null!=r?r:e.defaultLineHeight>>1;for(let t=0;;t+=10){let i=o+(f+t)*s,r=cl(e,{x:u,y:i},!1,s);if(i<l.top||i>l.bottom||(s<0?r<n:r>n))return Mn.cursor(r,void 0,void 0,a)}}(this,e,t,i))}scrollPosIntoView(e){this.dispatch({effects:ma.of(Mn.cursor(e))})}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),cl(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),n=this.bidiSpans(r);return lo(i,n[Ua.find(n,e-r.from,-1,t)].dir==Ba.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.heightOracle.direction}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Oh)return Xa(e.length);let t=this.textDirection;for(let i of this.bidiCache)if(i.from==e.from&&i.dir==t)return i.order;let i=function(e,t){let i=e.length,r=t==Ia?1:2,n=t==Ia?2:1;if(!e||1==r&&!ja.test(e))return Xa(i);for(let t=0,n=r,o=r;t<i;t++){let i=(s=e.charCodeAt(t))<=247?Ha[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Wa[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203||8204==s?256:1;512==i?i=n:8==i&&4==o&&(i=16),qa[t]=4==i?2:i,7&i&&(o=i),n=i}var s;for(let e=0,t=r,n=r;e<i;e++){let r=qa[e];if(128==r)e<i-1&&t==qa[e+1]&&24&t?r=qa[e]=t:qa[e]=256;else if(64==r){let r=e+1;for(;r<i&&64==qa[r];)r++;let s=e&&8==t||r<i&&8==qa[r]?1==n?1:8:256;for(let t=e;t<r;t++)qa[t]=s;e=r-1}else 8==r&&1==n&&(qa[e]=1);t=r,7&r&&(n=r)}for(let t,s,o,a=0,l=0,h=0;a<i;a++)if(s=Na[t=e.charCodeAt(a)])if(s<0){for(let e=l-3;e>=0;e-=3)if(Fa[e+1]==-s){let t=Fa[e+2],i=2&t?r:4&t?1&t?n:r:0;i&&(qa[a]=qa[Fa[e]]=i),l=e;break}}else{if(189==Fa.length)break;Fa[l++]=a,Fa[l++]=t,Fa[l++]=h}else if(2==(o=qa[a])||1==o){let e=o==r;h=e?0:1;for(let t=l-3;t>=0;t-=3){let i=Fa[t+2];if(2&i)break;if(e)Fa[t+2]|=2;else{if(4&i)break;Fa[t+2]|=4}}}for(let e=0;e<i;e++)if(256==qa[e]){let t=e+1;for(;t<i&&256==qa[t];)t++;let n=1==(e?qa[e-1]:r),s=n==(1==(t<i?qa[t]:r))?n?1:2:r;for(let i=e;i<t;i++)qa[i]=s;e=t-1}let o=[];if(1==r)for(let e=0;e<i;){let t=e,r=1!=qa[e++];for(;e<i&&r==(1!=qa[e]);)e++;if(r)for(let i=e;i>t;){let e=i,r=2!=qa[--i];for(;i>t&&r==(2!=qa[i-1]);)i--;o.push(new Ua(i,e,r?2:1))}else o.push(new Ua(t,e,0))}else for(let e=0;e<i;){let t=e,r=2==qa[e++];for(;e<i&&r==(2==qa[e]);)e++;o.push(new Ua(t,e,r?1:2))}return o}(e.text,this.textDirection);return this.bidiCache.push(new xh(e.from,e.to,t,i)),i}get hasFocus(){var e;return(document.hasFocus()||Io.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{po(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return ya.of(new va("number"==typeof e?Mn.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return xa.define((()=>({})),{eventHandlers:e})}static theme(e,t){let i=Cs.newName(),r=[lh.of(i),Ra.of(ph(`.${i}`,e))];return t&&t.dark&&r.push(hh.of(!0)),r}static baseTheme(e){return Un.lowest(Ra.of(ph("."+ch,e,dh)))}}bh.scrollTo=ma,bh.centerOn=_a,bh.styleModule=Ra,bh.inputHandler=ga,bh.exceptionSink=da,bh.updateListener=pa,bh.editable=Oa,bh.mouseSelectionStyle=fa,bh.dragMovesSelection=ua,bh.clickAddsSelectionRange=ca,bh.decorations=La,bh.contentAttributes=Pa,bh.editorAttributes=Ta,bh.lineWrapping=bh.contentAttributes.of({class:"cm-lineWrapping"}),bh.announce=ls.define();const Oh=4096;function wh(e,t){return(null==e?t.contentDOM.getBoundingClientRect().top:e)+t.viewState.paddingTop}let Sh=-1;function Ch(){Sh=-1;let e=document.querySelectorAll(".cm-content");for(let t=0;t<e.length;t++){let i=bo.get(e[t]);i&&i.editorView.requestMeasure()}}const kh={};class xh{constructor(e,t,i,r){this.from=e,this.to=t,this.dir=i,this.order=r}static update(e,t){if(t.empty)return e;let i=[],r=e.length?e[e.length-1].dir:Ba.LTR;for(let n=Math.max(0,e.length-10);n<e.length;n++){let s=e[n];s.dir!=r||t.touchesRange(s.from,s.to)||i.push(new xh(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.order))}return i}}function Eh(e,t,i){for(let r=e.state.facet(t),n=r.length-1;n>=0;n--){let t=r[n],s="function"==typeof t?t(e):t;s&&zo(s,i)}return i}const Ah=Io.mac?"mac":Io.windows?"win":Io.linux?"linux":"key";function Th(e,t,i){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==i&&t.shiftKey&&(e="Shift-"+e),e}const Ph=bh.domEventHandlers({keydown:(e,t)=>Bh(Mh(t.state),e,t,"editor")}),Lh=Qn.define({enables:Ph}),Rh=new WeakMap;function Mh(e){let t=e.facet(Lh),i=Rh.get(t);return i||Rh.set(t,i=function(e,t=Ah){let i=Object.create(null),r=Object.create(null),n=(e,t)=>{let i=r[e];if(null==i)r[e]=t;else if(i!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},s=(e,r,s,o)=>{let a=i[e]||(i[e]=Object.create(null)),l=r.split(/ (?!$)/).map((e=>function(e,t){const i=e.split(/-(?!$)/);let r,n,s,o,a=i[i.length-1];"Space"==a&&(a=" ");for(let e=0;e<i.length-1;++e){const a=i[e];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))s=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==t?o=!0:n=!0}}return r&&(a="Alt-"+a),n&&(a="Ctrl-"+a),o&&(a="Meta-"+a),s&&(a="Shift-"+a),a}(e,t)));for(let t=1;t<l.length;t++){let i=l.slice(0,t).join(" ");n(i,!0),a[i]||(a[i]={preventDefault:!0,commands:[t=>{let r=Dh={view:t,prefix:i,scope:e};return setTimeout((()=>{Dh==r&&(Dh=null)}),4e3),!0}]})}let h=l.join(" ");n(h,!1);let c=a[h]||(a[h]={preventDefault:!1,commands:[]});c.commands.push(s),o&&(c.preventDefault=!0)};for(let i of e){let e=i[t]||i.key;if(e)for(let t of i.scope?i.scope.split(" "):["editor"])s(t,e,i.run,i.preventDefault),i.shift&&s(t,"Shift-"+e,i.shift,i.preventDefault)}return i}(t.reduce(((e,t)=>e.concat(t)),[]))),i}let Dh=null;function Bh(e,t,i,r){let n=function(e){var t=!(Gs&&(e.ctrlKey||e.altKey||e.metaKey)||(Xs||Ys)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?Us:js)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(t),s=1==n.length&&" "!=n,o="",a=!1;Dh&&Dh.view==i&&Dh.scope==r&&(o=Dh.prefix+" ",(a=ml.indexOf(t.keyCode)<0)&&(Dh=null));let l,h=e=>{if(e){for(let t of e.commands)if(t(i))return!0;e.preventDefault&&(a=!0)}return!1},c=e[r];if(c){if(h(c[o+Th(n,t,!s)]))return!0;if(s&&(t.shiftKey||t.altKey||t.metaKey)&&(l=js[t.keyCode])&&l!=n){if(h(c[o+Th(l,t,!0)]))return!0}else if(s&&t.shiftKey&&h(c[o+Th(n,t,!0)]))return!0}return a}const Ih=!Io.ios,Qh=Qn.define({combine:e=>bs(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function $h(e={}){return[Qh.of(e),Wh,Fh]}class Hh{constructor(e,t,i,r,n){this.left=e,this.top=t,this.width=i,this.height=r,this.className=n}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const Wh=xa.fromClass(class{constructor(e){this.view=e,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=e.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(Qh).cursorBlinkRate+"ms"}update(e){let t=e.startState.facet(Qh)!=e.state.facet(Qh);(t||e.selectionSet||e.geometryChanged||e.viewportChanged)&&this.view.requestMeasure(this.measureReq),e.transactions.some((e=>e.scrollIntoView))&&(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),t&&this.setBlinkRate()}readPos(){let{state:e}=this.view,t=e.facet(Qh),i=e.selection.ranges.map((e=>e.empty?[]:function(e,t){if(t.to<=e.viewport.from||t.from>=e.viewport.to)return[];let i=Math.max(t.from,e.viewport.from),r=Math.min(t.to,e.viewport.to),n=e.textDirection==Ba.LTR,s=e.contentDOM,o=s.getBoundingClientRect(),a=jh(e),l=window.getComputedStyle(s.firstChild),h=o.left+parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)),c=o.right-parseInt(l.paddingRight),u=qh(e,i),f=qh(e,r),d=u.type==Zo.Text?u:null,p=f.type==Zo.Text?f:null;if(e.lineWrapping&&(d&&(d=Uh(e,i,d)),p&&(p=Uh(e,r,p))),d&&p&&d.from==p.from)return m(_(t.from,t.to,d));{let i=d?_(t.from,null,d):v(u,!1),r=p?_(null,t.to,p):v(f,!0),n=[];return(d||u).to<(p||f).from-1?n.push(g(h,i.bottom,c,r.top)):i.bottom<r.top&&e.elementAtHeight((i.bottom+r.top)/2).type==Zo.Text&&(i.bottom=r.top=(i.bottom+r.top)/2),m(i).concat(n).concat(m(r))}function g(e,t,i,r){return new Hh(e-a.left,t-a.top,i-e,r-t,"cm-selectionBackground")}function m({top:e,bottom:t,horizontal:i}){let r=[];for(let n=0;n<i.length;n+=2)r.push(g(i[n],e,i[n+1],t));return r}function _(t,i,r){let s=1e9,o=-1e9,a=[];function l(t,i,l,u,f){let d=e.coordsAtPos(t,t==r.to?-2:2),p=e.coordsAtPos(l,l==r.from?2:-2);s=Math.min(d.top,p.top,s),o=Math.max(d.bottom,p.bottom,o),f==Ba.LTR?a.push(n&&i?h:d.left,n&&u?c:p.right):a.push(!n&&u?h:p.left,!n&&i?c:d.right)}let u=null!=t?t:r.from,f=null!=i?i:r.to;for(let r of e.visibleRanges)if(r.to>u&&r.from<f)for(let n=Math.max(r.from,u),s=Math.min(r.to,f);;){let r=e.state.doc.lineAt(n);for(let o of e.bidiSpans(r)){let e=o.from+r.from,a=o.to+r.from;if(e>=s)break;a>n&&l(Math.max(e,n),null==t&&e<=u,Math.min(a,s),null==i&&a>=f,o.dir)}if(n=r.to+1,n>=s)break}return 0==a.length&&l(u,null==t,f,null==i,e.textDirection),{top:s,bottom:o,horizontal:a}}function v(e,t){let i=o.top+(t?e.top:e.bottom);return{top:i,bottom:i,horizontal:[]}}}(this.view,e))).reduce(((e,t)=>e.concat(t))),r=[];for(let i of e.selection.ranges){let n=i==e.selection.main;if(i.empty?!n||Ih:t.drawRangeCursor){let e=Xh(this.view,i,n);e&&r.push(e)}}return{rangePieces:i,cursors:r}}drawSel({rangePieces:e,cursors:t}){if(e.length!=this.rangePieces.length||e.some(((e,t)=>!e.eq(this.rangePieces[t])))){this.selectionLayer.textContent="";for(let t of e)this.selectionLayer.appendChild(t.draw());this.rangePieces=e}if(t.length!=this.cursors.length||t.some(((e,t)=>!e.eq(this.cursors[t])))){let e=this.cursorLayer.children;if(e.length!==t.length){this.cursorLayer.textContent="";for(const e of t)this.cursorLayer.appendChild(e.draw())}else t.forEach(((t,i)=>t.adjust(e[i])));this.cursors=t}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),Nh={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Ih&&(Nh[".cm-line"].caretColor="transparent !important");const Fh=Un.highest(bh.theme(Nh));function jh(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==Ba.LTR?t.left:t.right-e.scrollDOM.clientWidth)-e.scrollDOM.scrollLeft,top:t.top-e.scrollDOM.scrollTop}}function Uh(e,t,i){let r=Mn.cursor(t);return{from:Math.max(i.from,e.moveToLineBoundary(r,!1,!0).from),to:Math.min(i.to,e.moveToLineBoundary(r,!0,!0).from),type:Zo.Text}}function qh(e,t){let i=e.lineBlockAt(t);if(Array.isArray(i.type))for(let e of i.type)if(e.to>t||e.to==t&&(e.to==i.to||e.type==Zo.Text))return e;return i}function Xh(e,t,i){let r=e.coordsAtPos(t.head,t.assoc||1);if(!r)return null;let n=jh(e);return new Hh(r.left-n.left,r.top-n.top,-1,r.bottom-r.top,i?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const zh=ls.define({map:(e,t)=>null==e?null:t.mapPos(e)}),Vh=Fn.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce(((e,t)=>t.is(zh)?t.value:e),e))}),Yh=xa.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let i=e.state.field(Vh);null==i?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(Vh)!=i||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let e=this.view.state.field(Vh),t=null!=e&&this.view.coordsAtPos(e);if(!t)return null;let i=this.view.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+this.view.scrollDOM.scrollLeft,top:t.top-i.top+this.view.scrollDOM.scrollTop,height:t.bottom-t.top}}drawCursor(e){this.cursor&&(e?(this.cursor.style.left=e.left+"px",this.cursor.style.top=e.top+"px",this.cursor.style.height=e.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(Vh)!=e&&this.view.dispatch({effects:zh.of(e)})}},{eventHandlers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Gh(){return[Vh,Yh]}function Zh(e,t,i,r,n){t.lastIndex=0;for(let s,o=e.iterRange(i,r),a=i;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;s=t.exec(o.value);)n(a+s.index,a+s.index+s[0].length,s)}class Kh{constructor(e){let{regexp:t,decoration:i,boundary:r,maxLength:n=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=t,this.getDeco="function"==typeof i?i:()=>i,this.boundary=r,this.maxLength=n}createDeco(e){let t=new Rs;for(let{from:i,to:r}of function(e,t){let i=e.visibleRanges;if(1==i.length&&i[0].from==e.viewport.from&&i[0].to==e.viewport.to)return i;let r=[];for(let{from:n,to:s}of i)n=Math.max(e.state.doc.lineAt(n).from,n-t),s=Math.min(e.state.doc.lineAt(s).to,s+t),r.length&&r[r.length-1].to>=n?r[r.length-1].to=s:r.push({from:n,to:s});return r}(e,this.maxLength))Zh(e.state.doc,this.regexp,i,r,((i,r,n)=>t.add(i,r,this.getDeco(n,e,i))));return t.finish()}updateDeco(e,t){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges(((t,n,s,o)=>{o>e.view.viewport.from&&s<e.view.viewport.to&&(i=Math.min(s,i),r=Math.max(o,r))})),e.viewportChanged||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),i,r):t}updateRange(e,t,i,r){for(let n of e.visibleRanges){let s=Math.max(n.from,i),o=Math.min(n.to,r);if(o>s){let i=e.state.doc.lineAt(s),r=i.to<o?e.state.doc.lineAt(o):i,a=Math.max(n.from,i.from),l=Math.min(n.to,r.to);if(this.boundary){for(;s>i.from;s--)if(this.boundary.test(i.text[s-1-i.from])){a=s;break}for(;o<r.to;o++)if(this.boundary.test(r.text[o-r.from])){l=o;break}}let h,c=[];if(i==r)for(this.regexp.lastIndex=a-i.from;(h=this.regexp.exec(i.text))&&h.index<l-i.from;){let t=h.index+i.from;c.push(this.getDeco(h,e,t).range(t,t+h[0].length))}else Zh(e.state.doc,this.regexp,a,l,((t,i,r)=>c.push(this.getDeco(r,e,t).range(t,i))));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:c})}}return t}}const Jh=null!=/x/.unicode?"gu":"g",ec=new RegExp("[\0-\b\n--\u2028\u2029\ufeff-]",Jh),tc={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ic=null;const rc=Qn.define({combine(e){let t=bs(e,{render:null,specialChars:ec,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==ic&&"undefined"!=typeof document&&document.body){let t=document.body.style;ic=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)}return ic||!1}())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,Jh)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Jh)),t}});function nc(e={}){return[rc.of(e),sc||(sc=xa.fromClass(class{constructor(e){this.view=e,this.decorations=Ko.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(rc)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new Kh({regexp:e.specialChars,decoration:(t,i,r)=>{let{doc:n}=i.state,s=ln(t[0],0);if(9==s){let e=n.lineAt(r),t=i.state.tabSize,s=un(e.text,t,r-e.from);return Ko.replace({widget:new ac((t-s%t)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=Ko.replace({widget:new oc(e,s)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(rc);e.startState.facet(rc)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}let sc=null;class oc extends Go{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=function(e){return e>=32?"":10==e?"":String.fromCharCode(9216+e)}(this.code),i=e.state.phrase("Control character")+" "+(tc[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,t);if(r)return r;let n=document.createElement("span");return n.textContent=t,n.title=i,n.setAttribute("aria-label",i),n.className="cm-specialChar",n}ignoreEvent(){return!1}}class ac extends Go{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function lc(){return cc}const hc=Ko.line({class:"cm-activeLine"}),cc=xa.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,i=[];for(let r of e.state.selection.ranges){if(!r.empty)return Ko.none;let n=e.lineBlockAt(r.head);n.from>t&&(i.push(hc.range(n.from)),t=n.from)}return Ko.set(i)}},{decorations:e=>e.decorations});class uc{constructor(e,t){this.yanchor=e,this.yhead=t}toJSON(){return{yanchor:Ft(this.yanchor),yhead:Ft(this.yhead)}}static fromJSON(e){return new uc(jt(e.yanchor),jt(e.yhead))}}class fc{constructor(e,t){this.ytext=e,this.awareness=t,this.undoManager=new vi(e)}toYPos(e,t=0){return Xt(this.ytext,e,t)}fromYPos(e){const t=zt(jt(e),this.ytext.doc);if(null==t||t.type!==this.ytext)throw new Error("[y-codemirror] The position you want to retrieve was created by a different document");return{pos:t.index,assoc:t.assoc}}toYRange(e){const t=e.assoc,i=this.toYPos(e.anchor,t),r=this.toYPos(e.head,t);return new uc(i,r)}fromYRange(e){const t=this.fromYPos(e.yanchor),i=this.fromYPos(e.yhead);return t.pos===i.pos?Mn.cursor(i.pos,i.assoc):Mn.range(t.pos,i.pos)}}const dc=Qn.define({combine:e=>e[e.length-1]}),pc=ss.define(),gc=xa.fromClass(class{constructor(e){this.view=e,this.conf=e.state.facet(dc),this.conf.ytext.observe(((t,i)=>{if(i.origin!==this.conf){const i=t.delta,r=[];let n=0;for(let e=0;e<i.length;e++){const t=i[e];null!=t.insert?r.push({from:n,to:n,insert:t.insert}):null!=t.delete?(r.push({from:n,to:n+t.delete,insert:""}),n+=t.delete):n+=t.retain}e.dispatch({changes:r,annotations:[pc.of(this.conf)]})}}))}update(e){if(!e.docChanged||e.transactions.length>0&&e.transactions[0].annotation(pc)===this.conf)return;const t=this.conf.ytext;t.doc.transact((()=>{let i=0;e.changes.iterChanges(((e,r,n,s,o)=>{const a=o.sliceString(0,o.length,"\n");e!==r&&t.delete(e+i,r-e),a.length>0&&t.insert(e+i,a),i+=a.length-(r-e)}))}),this.conf)}destroy(){}}),mc=bh.baseTheme({".cm-ySelection":{},".cm-yLineSelection":{padding:0,margin:"0px 2px 0px 4px"},".cm-ySelectionCaret":{position:"relative",borderLeft:"1px solid black",borderRight:"1px solid black",marginLeft:"-1px",marginRight:"-1px",boxSizing:"border-box",display:"inline"},".cm-ySelectionCaret::before":{content:'""',borderRadius:"50%",position:"absolute",width:".4em",height:".4em",top:"-.2em",left:"-.2em",backgroundColor:"inherit",transition:"transform .3s ease-in-out"},".cm-ySelectionCaret:hover::before":{transformOrigin:"bottom center",transform:"scale(0)"},".cm-ySelectionInfo":{position:"absolute",top:"-1.05em",left:"-1px",fontSize:".75em",fontFamily:"serif",fontStyle:"normal",fontWeight:"normal",lineHeight:"normal",userSelect:"none",color:"white",paddingLeft:"2px",paddingRight:"2px",zIndex:101,transition:"opacity .3s ease-in-out",backgroundColor:"inherit",opacity:0,transitionDelay:"0s"},".cm-ySelectionCaret:hover > .cm-ySelectionInfo":{opacity:1,transitionDelay:"0s"}}),_c=ss.define();class vc extends Go{constructor(e,t){super(),this.color=e,this.name=t}toDOM(){return $e("span",[Be("class","cm-ySelectionCaret"),Be("style",`background-color: ${this.color}; border-color: ${this.color}`)],[$e("div",[Be("class","cm-ySelectionInfo")],[(e=this.name,Ie.createTextNode(e))])]);var e}eq(e){return e.color===this.color}compare(e){return e.color===this.color}updateDOM(){return!1}get estimatedHeight(){return-1}ignoreEvent(){return!0}}const yc=xa.fromClass(class{constructor(e){this.conf=e.state.facet(dc),this.conf.awareness.on("change",(({added:t,updated:i,removed:r},n,s)=>{t.concat(i).concat(r).findIndex((e=>e!==this.conf.awareness.doc.clientID))>=0&&e.dispatch({annotations:[_c.of([])]})})),this.decorations=Ls.of([])}update(e){const t=this.conf.ytext,i=t.doc,r=this.conf.awareness,n=[],s=this.conf.awareness.getLocalState();if(null!=s){const i=e.state.selection.main,n=null==s.cursor?null:jt(s.cursor.anchor),o=null==s.cursor?null:jt(s.cursor.head);if(null!=i){const e=Xt(t,i.anchor),a=Xt(t,i.head);null!=s.cursor&&Vt(n,e)&&Vt(o,a)||r.setLocalStateField("cursor",{anchor:e,head:a})}else null!=s.cursor&&r.setLocalStateField("cursor",null)}r.getStates().forEach(((s,o)=>{if(o===r.doc.clientID)return;const a=s.cursor;if(null==a||null==a.anchor||null==a.head)return;const l=zt(a.anchor,i),h=zt(a.head,i);if(null==l||null==h||l.type!==t||h.type!==t)return;const{color:c="#30bced",name:u="Anonymous"}=s.user||{},p=s.user&&s.user.colorLight||c+"33",g=f(l.index,h.index),m=d(l.index,h.index),_=e.view.state.doc.lineAt(g),v=e.view.state.doc.lineAt(m);if(_.number===v.number)n.push({from:g,to:m,value:Ko.mark({attributes:{style:`background-color: ${p}`},class:"cm-ySelection"})});else{n.push({from:g,to:_.from+_.length,value:Ko.mark({attributes:{style:`background-color: ${p}`},class:"cm-ySelection"})}),n.push({from:v.from,to:m,value:Ko.mark({attributes:{style:`background-color: ${p}`},class:"cm-ySelection"})});for(let t=_.number+1;t<v.number;t++){const i=e.view.state.doc.line(t).from;n.push({from:i,to:i,value:Ko.line({attributes:{style:`background-color: ${p}`,class:"cm-yLineSelection"}})})}}n.push({from:h.index,to:h.index,value:Ko.widget({side:h.index-l.index>0?-1:1,block:!1,widget:new vc(c,u)})})})),this.decorations=Ko.set(n,!0)}},{decorations:e=>e.decorations}),bc=()=>{let e=!0;return(t,i)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==i&&i()}};class Oc{constructor(e){this.undoManager=e}addTrackedOrigin(e){this.undoManager.trackedOrigins.add(e)}removeTrackedOrigin(e){this.undoManager.trackedOrigins.delete(e)}undo(){return null!=this.undoManager.undo()}redo(){return null!=this.undoManager.redo()}}const wc=Qn.define({combine:e=>e[e.length-1]});ss.define();const Sc=xa.fromClass(class{constructor(e){this.view=e,this.conf=e.state.facet(wc),this.syncConf=e.state.facet(dc),this._beforeChangeSelection=null,this._mux=bc(),this._onStackItemAdded=({stackItem:e,changedParentTypes:t})=>{t.has(this.syncConf.ytext)&&this._beforeChangeSelection&&!e.meta.has(this)&&e.meta.set(this,this._beforeChangeSelection)},this._onStackItemPopped=({stackItem:t})=>{const i=t.meta.get(this);if(i){const t=this.syncConf.fromYRange(i);e.dispatch(e.state.update({selection:t})),this._storeSelection()}},this._storeSelection=()=>{this._beforeChangeSelection=this.syncConf.toYRange(this.view.state.selection.main)},this.conf.undoManager.on("stack-item-added",this._onStackItemAdded),this.conf.undoManager.on("stack-item-popped",this._onStackItemPopped)}update(e){!e.selectionSet||0!==e.transactions.length&&e.transactions[0].annotation(pc)===this.syncConf||this._storeSelection()}destroy(){this.conf.undoManager.off("stack-item-added",this._onStackItemAdded),this.conf.undoManager.off("stack-item-popped",this._onStackItemPopped)}}),Cc=({state:e,dispatch:t})=>e.facet(wc).undo()||!0,kc=({state:e,dispatch:t})=>e.facet(wc).redo()||!0,xc=[{key:"Mod-z",run:Cc,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:kc,preventDefault:!0}],Ec=e=>{if(e.shouldConnect&&null===e.ws){const t=new WebSocket(e.url),i=e.binaryType;let r=null;i&&(t.binaryType=i),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=t=>{e.lastMessageReceived=We();const i=t.data,n="string"==typeof i?JSON.parse(i):i;n&&"pong"===n.type&&(clearTimeout(r),r=setTimeout(s,15e3)),e.emit("message",[n,e])};const n=t=>{null!==e.ws&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:t},e])):e.unsuccessfulReconnects++,setTimeout(Ec,f(1200*u(e.unsuccessfulReconnects+1),2500),e)),clearTimeout(r)},s=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>n(null),t.onerror=e=>n(e),t.onopen=()=>{e.lastMessageReceived=We(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(s,15e3)}}};class Ac extends l{constructor(e,{binaryType:t}={}){super(),this.url=e,this.ws=null,this.binaryType=t||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval((()=>{this.connected&&3e4<We()-this.lastMessageReceived&&this.ws.close()}),15e3),Ec(this)}send(e){this.ws&&this.ws.send(JSON.stringify(e))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.connected||null!==this.ws||Ec(this)}}const Tc=new Map,Pc="undefined"==typeof BroadcastChannel?class{constructor(e){this.room=e,this.onmessage=null,S||addEventListener("storage",(t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:M(t.newValue||"")})))}postMessage(e){C.setItem(this.room,R(new Uint8Array(e)))}}:BroadcastChannel,Lc=e=>r(Tc,e,(()=>{const t=new Set,i=new Pc(e);return i.onmessage=e=>t.forEach((t=>t(e.data))),{bc:i,subs:t}}));var Rc=i(963);const Mc=(e,t)=>{j(e,0);const i=(e=>((e,t=new Ct)=>(e instanceof Map?Pt(t,e):((e,t)=>{Pt(e,ti(t.store))})(t,e),t.toUint8Array()))(e,new wt))(t);z(e,i)},Dc=(e,t,i)=>{j(e,1),z(e,((e,t)=>At(e,t,new St))(t,i))},Bc=(e,t,i)=>{try{((e,t,i)=>{Et(e,t,i,bt)})(t,se(e),i)}catch(e){console.error("Caught error while handling a Yjs update",e)}},Ic=Bc;class Qc extends l{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const e=We();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach(((i,r)=>{r!==this.clientID&&3e4<=e-i.lastUpdated&&this.states.has(r)&&t.push(r)})),t.length>0&&$c(this,t,"timeout")}),h(3e3)),e.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,i=this.meta.get(t),r=void 0===i?0:i.clock+1,n=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:r,lastUpdated:We()});const s=[],o=[],a=[],l=[];null===e?l.push(t):null==n?null!=e&&s.push(t):(o.push(t),Re(n,e)||a.push(t)),(s.length>0||a.length>0||l.length>0)&&this.emit("change",[{added:s,updated:a,removed:l},"local"]),this.emit("update",[{added:s,updated:o,removed:l},"local"])}setLocalStateField(e,t){const i=this.getLocalState();null!==i&&this.setLocalState({...i,[e]:t})}getStates(){return this.states}}const $c=(e,t,i)=>{const r=[];for(let i=0;i<t.length;i++){const n=t[i];if(e.states.has(n)){if(e.states.delete(n),n===e.clientID){const t=e.meta.get(n);e.meta.set(n,{clock:t.clock+1,lastUpdated:We()})}r.push(n)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},i]),e.emit("update",[{added:[],updated:[],removed:r},i]))},Hc=(e,t,i=e.states)=>{const r=t.length,n=H();j(n,r);for(let s=0;s<r;s++){const r=t[s],o=i.get(r)||null,a=e.meta.get(r).clock;j(n,r),j(n,a),q(n,JSON.stringify(o))}return W(n)},Wc=(e,t)=>{if(!t)return Se(e);const i=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:i},t,e).then((e=>{const t=H();return q(t,"AES-GCM"),z(t,i),z(t,new Uint8Array(e)),W(t)}))},Nc=(e,t)=>{if(!t)return Se(e);const i=ne(e);var r;"AES-GCM"!==he(i)&&(r=Ce("Unknown encryption algorithm"),Promise.reject(r));const n=se(i),s=se(i);return crypto.subtle.decrypt({name:"AES-GCM",iv:n},t,s).then((e=>new Uint8Array(e)))},Fc=(e=>{const t=tt[it],i=T("log"),r=null!==i&&("*"===i||"true"===i||new RegExp(i,"gi").test(e));return it=(it+1)%tt.length,e+=": ",r?(...i)=>{const r=We(),n=r-rt;rt=r,Je(t,e,Ye,...i.map((e=>"string"==typeof e||"symbol"==typeof e?e:JSON.stringify(e))),t," +"+n+"ms")}:Le})("y-webrtc"),jc=new Map,Uc=new Map,qc=e=>{let t=!0;e.webrtcConns.forEach((e=>{e.synced||(t=!1)})),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),Fc("synced ",Ne,e.name,Fe," with all peers"))},Xc=(e,t,i)=>{const r=ne(t),n=H(),s=ae(r);if(void 0===e)return null;const o=e.awareness,a=e.doc;let l=!1;switch(s){case 0:{j(n,0);const t=((e,t,i,r)=>{const n=ae(e);switch(n){case 0:((e,t,i)=>{Dc(t,i,se(e))})(e,t,i);break;case 1:Bc(e,i,r);break;case 2:Ic(e,i,r);break;default:throw new Error("Unknown message type")}return n})(r,n,a,e);1!==t||e.synced||i(),0===t&&(l=!0);break}case 3:j(n,1),z(n,Hc(o,Array.from(o.getStates().keys()))),l=!0;break;case 1:((e,t,i)=>{const r=ne(t),n=We(),s=[],o=[],a=[],l=[],h=ae(r);for(let t=0;t<h;t++){const t=ae(r);let i=ae(r);const h=JSON.parse(he(r)),c=e.meta.get(t),u=e.states.get(t),f=void 0===c?0:c.clock;(f<i||f===i&&null===h&&e.states.has(t))&&(null===h?t===e.clientID&&null!=e.getLocalState()?i++:e.states.delete(t):e.states.set(t,h),e.meta.set(t,{clock:i,lastUpdated:n}),void 0===c&&null!==h?s.push(t):void 0!==c&&null===h?l.push(t):null!==h&&(Re(h,u)||a.push(t),o.push(t)))}(s.length>0||a.length>0||l.length>0)&&e.emit("change",[{added:s,updated:a,removed:l},i]),(s.length>0||o.length>0||l.length>0)&&e.emit("update",[{added:s,updated:o,removed:l},i])})(o,se(r),e);break;case 4:{const t=1===oe(r),i=he(r);if(i!==e.peerId&&(e.bcConns.has(i)&&!t||!e.bcConns.has(i)&&t)){const r=[],n=[];t?(e.bcConns.add(i),n.push(i)):(e.bcConns.delete(i),r.push(i)),e.provider.emit("peers",[{added:n,removed:r,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),Kc(e)}break}default:return console.error("Unable to compute message"),n}return l?n:null},zc=(e,t)=>{Fc("send message to ",Ne,e.remotePeerId,Fe,Ue," (",e.room.name,")",Ye);try{e.peer.send(W(t))}catch(e){}};class Vc{constructor(e,t,i,r){Fc("establishing connection to ",Ne,i),this.room=r,this.remotePeerId=i,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Rc({initiator:t,...r.provider.peerOpts}),this.peer.on("signal",(t=>{eu(e,r,{to:i,from:r.peerId,type:"signal",signal:t})})),this.peer.on("connect",(()=>{Fc("connected to ",Ne,i),this.connected=!0;const e=r.provider.doc,t=r.awareness,n=H();j(n,0),Mc(n,e),zc(this,n);const s=t.getStates();if(s.size>0){const e=H();j(e,1),z(e,Hc(t,Array.from(s.keys()))),zc(this,e)}})),this.peer.on("close",(()=>{this.connected=!1,this.closed=!0,r.webrtcConns.has(this.remotePeerId)&&(r.webrtcConns.delete(this.remotePeerId),r.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(r.webrtcConns.keys()),bcPeers:Array.from(r.bcConns)}])),qc(r),this.peer.destroy(),Fc("closed connection to ",Ne,i),Zc(r)})),this.peer.on("error",(e=>{Fc("Error in connection to ",Ne,i,": ",e),Zc(r)})),this.peer.on("data",(e=>{const t=((e,t)=>{const i=e.room;return Fc("received message from ",Ne,e.remotePeerId,Ue," (",i.name,")",Fe,Ye),Xc(i,t,(()=>{e.synced=!0,Fc("synced ",Ne,i.name,Fe," with ",Ne,e.remotePeerId),qc(i)}))})(this,e);null!==t&&zc(this,t)}))}destroy(){this.peer.destroy()}}const Yc=(e,t)=>Wc(t,e.key).then((t=>e.mux((()=>((e,t)=>{const i=Lc(e);i.bc.postMessage(t),i.subs.forEach((e=>e(t)))})(e.name,t))))),Gc=(e,t)=>{e.bcconnected&&Yc(e,t),((e,t)=>{Fc("broadcast message in ",Ne,e.name,Fe),e.webrtcConns.forEach((e=>{try{e.peer.send(t)}catch(e){}}))})(e,t)},Zc=e=>{jc.forEach((t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&eu(t,e,{type:"announce",from:e.peerId}))}))},Kc=e=>{if(e.provider.filterBcConns){const t=H();j(t,4),F(t,1),q(t,e.peerId),Yc(e,W(t))}};class Jc{constructor(e,t,i,r){this.peerId=we(),this.doc=e,this.awareness=t.awareness,this.provider=t,this.synced=!1,this.name=i,this.key=r,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=bc(),this.bcconnected=!1,this._bcSubscriber=e=>Nc(new Uint8Array(e),r).then((e=>this.mux((()=>{const t=Xc(this,e,(()=>{}));t&&Yc(this,W(t))})))),this._docUpdateHandler=(e,t)=>{const i=H();j(i,0),((e,t)=>{j(e,2),z(e,t)})(i,e),Gc(this,W(i))},this._awarenessUpdateHandler=({added:e,updated:t,removed:i},r)=>{const n=e.concat(t).concat(i),s=H();j(s,1),z(s,Hc(this.awareness,n)),Gc(this,W(s))},window.addEventListener("beforeunload",(()=>{$c(this.awareness,[e.clientID],"window unload"),Uc.forEach((e=>{e.disconnect()}))}))}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Zc(this);var e,t;e=this.name,t=this._bcSubscriber,Lc(e).subs.add(t),this.bcconnected=!0,Kc(this);const i=H();j(i,0),Mc(i,this.doc),Yc(this,W(i));const r=H();j(r,0),Dc(r,this.doc),Yc(this,W(r));const n=H();j(n,3),Yc(this,W(n));const s=H();j(s,1),z(s,Hc(this.awareness,[this.doc.clientID])),Yc(this,W(s))}disconnect(){jc.forEach((e=>{e.connected&&e.send({type:"unsubscribe",topics:[this.name]})})),$c(this.awareness,[this.doc.clientID],"disconnect");const e=H();var t,i;j(e,4),F(e,0),q(e,this.peerId),Yc(this,W(e)),t=this.name,i=this._bcSubscriber,Lc(t).subs.delete(i),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach((e=>e.destroy()))}destroy(){this.disconnect()}}const eu=(e,t,i)=>{t.key?((e,t)=>{const i=H();return G(i,e),Wc(W(i),t)})(i,t.key).then((i=>{e.send({type:"publish",topic:t.name,data:R(i)})})):e.send({type:"publish",topic:t.name,data:i})};class tu extends Ac{constructor(e){super(e),this.providers=new Set,this.on("connect",(()=>{Fc(`connected (${e})`);const t=Array.from(Uc.keys());this.send({type:"subscribe",topics:t}),Uc.forEach((e=>eu(this,e,{type:"announce",from:e.peerId})))})),this.on("message",(e=>{if("publish"===e.type){const n=e.topic,s=Uc.get(n);if(null==s||"string"!=typeof n)return;const o=e=>{const t=s.webrtcConns,i=s.peerId;if(null==e||e.from===i||void 0!==e.to&&e.to!==i||s.bcConns.has(e.from))return;const n=t.has(e.from)?()=>{}:()=>s.provider.emit("peers",[{removed:[],added:[e.from],webrtcPeers:Array.from(s.webrtcConns.keys()),bcPeers:Array.from(s.bcConns)}]);switch(e.type){case"announce":t.size<s.provider.maxConns&&(r(t,e.from,(()=>new Vc(this,!0,e.from,s))),n());break;case"signal":e.to===i&&(r(t,e.from,(()=>new Vc(this,!1,e.from,s))).peer.signal(e.signal),n())}};s.key?"string"==typeof e.data&&(t=M(e.data),i=s.key,Nc(t,i).then((e=>fe(ne(new Uint8Array(e)))))).then(o):o(e.data)}var t,i})),this.on("disconnect",(()=>Fc(`disconnect (${e})`)))}}const iu=ss.define(),ru=ss.define(),nu=Qn.define(),su=Qn.define({combine:e=>bs(e,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}),ou=Fn.define({create:()=>Ou.empty,update(e,t){let i=t.state.facet(su),r=t.annotation(iu);if(r){let n=du.fromTransaction(t),s=r.side,o=0==s?e.undone:e.done;return o=n?pu(o,o.length,i.minDepth,n):_u(o,t.startState.selection),new Ou(0==s?r.rest:o,0==s?o:r.rest)}let n=t.annotation(ru);if("full"!=n&&"before"!=n||(e=e.isolate()),!1===t.annotation(hs.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let s=du.fromTransaction(t),o=t.annotation(hs.time),a=t.annotation(hs.userEvent);return s?e=e.addChanges(s,o,a,i.newGroupDelay,i.minDepth):t.selection&&(e=e.addSelection(t.startState.selection,o,a,i.newGroupDelay)),"full"!=n&&"after"!=n||(e=e.isolate()),e},toJSON:e=>({done:e.done.map((e=>e.toJSON())),undone:e.undone.map((e=>e.toJSON()))}),fromJSON:e=>new Ou(e.done.map(du.fromJSON),e.undone.map(du.fromJSON))});function au(e={}){return[ou,su.of(e),bh.domEventHandlers({beforeinput:(e,t)=>"historyUndo"==e.inputType?hu(t):"historyRedo"==e.inputType&&cu(t)})]}function lu(e,t){return function({state:i,dispatch:r}){let n=i.field(ou,!1);if(!n)return!1;let s=n.pop(e,i,t);return!!s&&(r(s),!0)}}const hu=lu(0,!1),cu=lu(1,!1),uu=lu(0,!0),fu=lu(1,!0);class du{constructor(e,t,i,r,n){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=r,this.selectionsAfter=n}setSelAfter(e){return new du(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map((e=>e.toJSON()))}}static fromJSON(e){return new du(e.changes&&kn.fromJSON(e.changes),[],e.mapped&&Cn.fromJSON(e.mapped),e.startSelection&&Mn.fromJSON(e.startSelection),e.selectionsAfter.map(Mn.fromJSON))}static fromTransaction(e){let t=mu;for(let i of e.startState.facet(nu)){let r=i(e);r.length&&(t=t.concat(r))}return!t.length&&e.changes.empty?null:new du(e.changes.invert(e.startState.doc),t,void 0,e.startState.selection,mu)}static selection(e){return new du(void 0,mu,void 0,void 0,e)}}function pu(e,t,i,r){let n=t+1>i+20?t-i-1:0,s=e.slice(n,t);return s.push(r),s}function gu(e,t){return e.length?t.length?e.concat(t):e:t}const mu=[];function _u(e,t){if(e.length){let i=e[e.length-1],r=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),pu(e,e.length-1,1e9,i.setSelAfter(r)))}return[du.selection([t])]}function vu(e){let t=e[e.length-1],i=e.slice();return i[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),i}function yu(e,t){if(!e.length)return e;let i=e.length,r=mu;for(;i;){let n=bu(e[i-1],t,r);if(n.changes&&!n.changes.empty||n.effects.length){let t=e.slice(0,i);return t[i-1]=n,t}t=n.mapped,i--,r=n.selectionsAfter}return r.length?[du.selection(r)]:mu}function bu(e,t,i){let r=gu(e.selectionsAfter.length?e.selectionsAfter.map((e=>e.map(t))):mu,i);if(!e.changes)return du.selection(r);let n=e.changes.map(t),s=t.mapDesc(e.changes,!0),o=e.mapped?e.mapped.composeDesc(s):s;return new du(n,ls.mapEffects(e.effects,t),o,e.startSelection.map(s),r)}class Ou{constructor(e,t,i=0,r){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new Ou(this.done,this.undone):this}addChanges(e,t,i,r,n){let s=this.done,o=s[s.length-1];return s=o&&o.changes&&!o.changes.empty&&e.changes&&(!o.selectionsAfter.length&&t-this.prevTime<r&&function(e,t){let i=[],r=!1;return e.iterChangedRanges(((e,t)=>i.push(e,t))),t.iterChangedRanges(((e,t,n,s)=>{for(let e=0;e<i.length;){let t=i[e++],o=i[e++];s>=t&&n<=o&&(r=!0)}})),r}(o.changes,e.changes)||"input.type.compose"==i)?pu(s,s.length-1,n,new du(e.changes.compose(o.changes),gu(e.effects,o.effects),o.mapped,o.startSelection,mu)):pu(s,s.length,n,e),new Ou(s,mu,t,i)}addSelection(e,t,i,r){let n=this.done.length?this.done[this.done.length-1].selectionsAfter:mu;return n.length>0&&t-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&(s=n[n.length-1],o=e,s.ranges.length==o.ranges.length&&0===s.ranges.filter(((e,t)=>e.empty!=o.ranges[t].empty)).length)?this:new Ou(_u(this.done,e),this.undone,t,i);var s,o}addMapping(e){return new Ou(yu(this.done,e),yu(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let r=0==e?this.done:this.undone;if(0==r.length)return null;let n=r[r.length-1];if(i&&n.selectionsAfter.length)return t.update({selection:n.selectionsAfter[n.selectionsAfter.length-1],annotations:iu.of({side:e,rest:vu(r)}),userEvent:0==e?"select.undo":"select.redo"});if(n.changes){let i=1==r.length?mu:r.slice(0,r.length-1);return n.mapped&&(i=yu(i,n.mapped)),t.update({changes:n.changes,selection:n.startSelection,effects:n.effects,annotations:iu.of({side:e,rest:i}),filter:!1,userEvent:0==e?"undo":"redo"})}return null}}Ou.empty=new Ou(mu,mu);const wu=[{key:"Mod-z",run:hu,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:cu,preventDefault:!0},{key:"Mod-u",run:uu,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:fu,preventDefault:!0}],Su=1024;let Cu=0;class ku{constructor(e,t){this.from=e,this.to=t}}class xu{constructor(e={}){this.id=Cu++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=Au.match(e)),t=>{let i=e(t);return void 0===i?null:[this,i]}}}xu.closedBy=new xu({deserialize:e=>e.split(" ")}),xu.openedBy=new xu({deserialize:e=>e.split(" ")}),xu.group=new xu({deserialize:e=>e.split(" ")}),xu.contextHash=new xu({perNode:!0}),xu.lookAhead=new xu({perNode:!0}),xu.mounted=new xu({perNode:!0});const Eu=Object.create(null);class Au{constructor(e,t,i,r=0){this.name=e,this.props=t,this.id=i,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Eu,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),r=new Au(e.name||"",t,e.id,i);if(e.props)for(let i of e.props)if(Array.isArray(i)||(i=i(r)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[i[0].id]=i[1]}return r}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(xu.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let r of i.split(" "))t[r]=e[i];return e=>{for(let i=e.prop(xu.group),r=-1;r<(i?i.length:0);r++){let n=t[r<0?e.name:i[r]];if(n)return n}}}}Au.none=new Au("",Object.create(null),0,8);class Tu{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let r=null;for(let t of e){let e=t(i);e&&(r||(r=Object.assign({},i.props)),r[e[0].id]=e[1])}t.push(r?new Au(i.name,r,i.id,i.flags):i)}return new Tu(t)}}const Pu=new WeakMap,Lu=new WeakMap;class Ru{constructor(e,t,i,r,n){if(this.type=e,this.children=t,this.positions=i,this.length=r,this.props=null,n&&n.length){this.props=Object.create(null);for(let[e,t]of n)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=this.prop(xu.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let i=e.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e,t=0){let i=null!=e&&Pu.get(this)||this.topNode,r=new Fu(i);return null!=e&&(r.moveTo(e,t),Pu.set(this,r._tree)),r}fullCursor(){return new Fu(this.topNode,1)}get topNode(){return new $u(this,0,0,null)}resolve(e,t=0){let i=Qu(Pu.get(this)||this.topNode,e,t,!1);return Pu.set(this,i),i}resolveInner(e,t=0){let i=Qu(Lu.get(this)||this.topNode,e,t,!0);return Lu.set(this,i),i}iterate(e){let{enter:t,leave:i,from:r=0,to:n=this.length}=e;for(let e=this.cursor(),s=()=>e.node;;){let o=!1;if(e.from<=n&&e.to>=r&&(e.type.isAnonymous||!1!==t(e.type,e.from,e.to,s))){if(e.firstChild())continue;e.type.isAnonymous||(o=!0)}for(;o&&i&&i(e.type,e.from,e.to,s),o=e.type.isAnonymous,!e.nextSibling();){if(!e.parent())return;o=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Xu(Au.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,i)=>new Ru(this.type,e,t,i,this.propValues)),e.makeTree||((e,t,i)=>new Ru(Au.none,e,t,i)))}static build(e){return function(e){var t;let{buffer:i,nodeSet:r,maxBufferLength:n=Su,reused:s=[],minRepeatType:o=r.types.length}=e,a=Array.isArray(i)?new Mu(i,i.length):i,l=r.types,h=0,c=0;function u(e,t,i,g,m){let{id:_,start:v,end:y,size:b}=a,O=c;for(;b<0;){if(a.next(),-1==b){let t=s[_];return i.push(t),void g.push(v-e)}if(-3==b)return void(h=_);if(-4==b)return void(c=_);throw new RangeError(`Unrecognized record size: ${b}`)}let w,S,C=l[_],k=v-e;if(y-v<=n&&(S=function(e,t){let i=a.fork(),r=0,s=0,l=0,h=i.end-n,c={size:0,start:0,skip:0};e:for(let n=i.pos-e;i.pos>n;){let e=i.size;if(i.id==t&&e>=0){c.size=r,c.start=s,c.skip=l,l+=4,r+=4,i.next();continue}let a=i.pos-e;if(e<0||a<n||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>a;){if(i.size<0){if(-3!=i.size)break e;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,r+=e,l+=u}return(t<0||r==e)&&(c.size=r,c.start=s,c.skip=l),c.size>4?c:void 0}(a.pos-t,m))){let t=new Uint16Array(S.size-S.skip),i=a.pos-S.size,n=t.length;for(;a.pos>i;)n=p(S.start,t,n);w=new Du(t,y-S.start,r),k=S.start-e}else{let e=a.pos-b;a.next();let t=[],i=[],r=_>=o?_:-1,s=0,l=y;for(;a.pos>e;)r>=0&&a.id==r&&a.size>=0?(a.end<=l-n&&(f(t,i,v,s,a.end,l,r,O),s=t.length,l=a.end),a.next()):u(v,e,t,i,r);if(r>=0&&s>0&&s<t.length&&f(t,i,v,s,v,l,r,O),t.reverse(),i.reverse(),r>-1&&s>0){let e=function(e){return(t,i,r)=>{let n,s,o=0,a=t.length-1;if(a>=0&&(n=t[a])instanceof Ru){if(!a&&n.type==e&&n.length==r)return n;(s=n.prop(xu.lookAhead))&&(o=i[a]+n.length+s)}return d(e,t,i,r,o)}}(C);w=Xu(C,t,i,0,t.length,0,y-v,e,e)}else w=d(C,t,i,y-v,O-y)}i.push(w),g.push(k)}function f(e,t,i,n,s,o,a,l){let h=[],c=[];for(;e.length>n;)h.push(e.pop()),c.push(t.pop()+i-s);e.push(d(r.types[a],h,c,o-s,l-o)),t.push(s-i)}function d(e,t,i,r,n=0,s){if(h){let e=[xu.contextHash,h];s=s?[e].concat(s):[e]}if(n>25){let e=[xu.lookAhead,n];s=s?[e].concat(s):[e]}return new Ru(e,t,i,r,s)}function p(e,t,i){let{id:r,start:n,end:s,size:l}=a;if(a.next(),l>=0&&r<o){let o=i;if(l>4){let r=a.pos-(l-4);for(;a.pos>r;)i=p(e,t,i)}t[--i]=o,t[--i]=s-e,t[--i]=n-e,t[--i]=r}else-3==l?h=r:-4==l&&(c=r);return i}let g=[],m=[];for(;a.pos>0;)u(e.start||0,e.bufferStart||0,g,m,-1);let _=null!==(t=e.length)&&void 0!==t?t:g.length?m[0]+g[0].length:0;return new Ru(l[e.topID],g.reverse(),m.reverse(),_)}(e)}}Ru.empty=new Ru(Au.none,[],[],0);class Mu{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Mu(this.buffer,this.index)}}class Du{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Au.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],r=this.set.types[t],n=r.name;if(/\W/.test(n)&&!r.isError&&(n=JSON.stringify(n)),i==(e+=4))return n;let s=[];for(;e<i;)s.push(this.childString(e)),e=this.buffer[e+3];return n+"("+s.join(",")+")"}findChild(e,t,i,r,n){let{buffer:s}=this,o=-1;for(let a=e;a!=t&&!(Bu(n,r,s[a+1],s[a+2])&&(o=a,i>0));a=s[a+3]);return o}slice(e,t,i,r){let n=this.buffer,s=new Uint16Array(t-e);for(let r=e,o=0;r<t;)s[o++]=n[r++],s[o++]=n[r++]-i,s[o++]=n[r++]-i,s[o++]=n[r++]-e;return new Du(s,r-i,this.set)}}function Bu(e,t,i,r){switch(e){case-2:return i<t;case-1:return r>=t&&i<t;case 0:return i<t&&r>t;case 1:return i<=t&&r>t;case 2:return r>t;case 4:return!0}}function Iu(e,t){let i=e.childBefore(t);for(;i;){let t=i.lastChild;if(!t||t.to!=i.to)break;t.type.isError&&t.from==t.to?(e=i,i=t.prevSibling):i=t}return e}function Qu(e,t,i,r){for(var n;e.from==e.to||(i<1?e.from>=t:e.from>t)||(i>-1?e.to<=t:e.to<t);){let t=!r&&e instanceof $u&&e.index<0?null:e.parent;if(!t)return e;e=t}if(r)for(let r=e,s=r.parent;s;r=s,s=r.parent)r instanceof $u&&r.index<0&&(null===(n=s.enter(t,i,!0))||void 0===n?void 0:n.from)!=r.from&&(e=s);for(;;){let n=e.enter(t,i,r);if(!n)return e;e=n}}class $u{constructor(e,t,i,r){this.node=e,this._from=t,this.index=i,this._parent=r}get type(){return this.node.type}get name(){return this.node.type.name}get from(){return this._from}get to(){return this._from+this.node.length}nextChild(e,t,i,r,n=0){for(let s=this;;){for(let{children:o,positions:a}=s.node,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],h=a[e]+s._from;if(Bu(r,i,h,h+l.length))if(l instanceof Du){if(2&n)continue;let o=l.findChild(0,l.buffer.length,t,i-h,r);if(o>-1)return new Nu(new Wu(s,l,e,h),null,o)}else if(1&n||!l.type.isAnonymous||ju(l)){let o;if(!(1&n)&&l.props&&(o=l.prop(xu.mounted))&&!o.overlay)return new $u(o.tree,h,e,s);let a=new $u(l,h,e,s);return 1&n||!a.type.isAnonymous?a:a.nextChild(t<0?l.children.length-1:0,t,i,r)}}if(1&n||!s.type.isAnonymous)return null;if(e=s.index>=0?s.index+t:t<0?-1:s._parent.node.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this.node.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this.node.children.length-1,-1,e,-2)}enter(e,t,i=!0,r=!0){let n;if(i&&(n=this.node.prop(xu.mounted))&&n.overlay){let i=e-this.from;for(let{from:e,to:r}of n.overlay)if((t>0?e<=i:e<i)&&(t<0?r>=i:r>i))return new $u(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r?0:2)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get cursor(){return new Fu(this)}get tree(){return this.node}toTree(){return this.node}resolve(e,t=0){return Qu(this,e,t,!1)}resolveInner(e,t=0){return Qu(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Iu(this,e)}getChild(e,t=null,i=null){let r=Hu(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return Hu(this,e,t,i)}toString(){return this.node.toString()}}function Hu(e,t,i,r){let n=e.cursor,s=[];if(!n.firstChild())return s;if(null!=i)for(;!n.type.is(i);)if(!n.nextSibling())return s;for(;;){if(null!=r&&n.type.is(r))return s;if(n.type.is(t)&&s.push(n.node),!n.nextSibling())return null==r?s:[]}}class Wu{constructor(e,t,i,r){this.parent=e,this.buffer=t,this.index=i,this.start=r}}class Nu{constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:r}=this.context,n=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,i);return n<0?null:new Nu(this.context,this,n)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i,r=!0){if(!r)return null;let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Nu(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Nu(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Nu(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get cursor(){return new Fu(this)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,r=this.index+4,n=i.buffer[this.index+3];if(n>r){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];e.push(i.slice(r,n,s,o)),t.push(0)}return new Ru(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Qu(this,e,t,!1)}resolveInner(e,t=0){return Qu(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Iu(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let r=Hu(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return Hu(this,e,t,i)}}class Fu{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof $u)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return!!e&&(e instanceof $u?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree.node.children.length-1:0,e,t,i,this.mode));let{buffer:r}=this.buffer,n=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,i);return!(n<0)&&(this.stack.push(this.index),this.yieldBuf(n))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=!0,r=!0){return this.buffer?!!r&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i&&!(1&this.mode),r))}parent(){if(!this.buffer)return this.yieldNode(1&this.mode?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=1&this.mode?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let e=i<0?0:this.stack[i]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(e)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(r.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:i}=r)}else({index:t,_parent:i}=this._tree);for(;i;({index:t,_parent:i}=i))if(t>-1)for(let r=t+e,n=e<0?-1:i.node.children.length;r!=n;r+=e){let e=i.node.children[r];if(1&this.mode||e instanceof Du||!e.type.isAnonymous||ju(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,n=this.stack.length;n>=0;){for(let s=e;s;s=s._parent)if(s.index==r){if(r==this.index)return s;t=s,i=n+1;break e}r=this.stack[--n]}for(let e=i;e<this.stack.length;e++)t=new Nu(this.buffer,t,this.stack[e]);return this.bufferNode=new Nu(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree.node}}function ju(e){return e.children.some((e=>e instanceof Du||!e.type.isAnonymous||ju(e)))}const Uu=new WeakMap;function qu(e,t){if(!e.isAnonymous||t instanceof Du||t.type!=e)return 1;let i=Uu.get(t);if(null==i){i=1;for(let r of t.children){if(r.type!=e||!(r instanceof Ru)){i=1;break}i+=qu(e,r)}Uu.set(t,i)}return i}function Xu(e,t,i,r,n,s,o,a,l){let h=0;for(let i=r;i<n;i++)h+=qu(e,t[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function t(i,r,n,o,a){for(let h=n;h<o;){let n=h,d=r[h],p=qu(e,i[h]);for(h++;h<o;h++){let t=qu(e,i[h]);if(p+t>=c)break;p+=t}if(h==n+1){if(p>c){let e=i[n];t(e.children,e.positions,0,e.children.length,r[n]+a);continue}u.push(i[n])}else{let t=r[h-1]+i[h-1].length-d;u.push(Xu(e,i,r,n,h,d,t,null,l))}f.push(d+a-s)}}(t,i,r,n,0),(a||l)(u,f,o)}class zu{constructor(e,t,i,r,n=!1,s=!1){this.from=e,this.to=t,this.tree=i,this.offset=r,this.open=(n?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],i=!1){let r=[new zu(0,e.length,e,0,!1,i)];for(let i of t)i.to>e.length&&r.push(i);return r}static applyChanges(e,t,i=128){if(!t.length)return e;let r=[],n=1,s=e.length?e[0]:null;for(let o=0,a=0,l=0;;o++){let h=o<t.length?t[o]:null,c=h?h.fromA:1e9;if(c-a>=i)for(;s&&s.from<c;){let t=s;if(a>=t.from||c<=t.to||l){let e=Math.max(t.from,a)-l,i=Math.min(t.to,c)-l;t=e>=i?null:new zu(e,i,t.tree,t.offset+l,o>0,!!h)}if(t&&r.push(t),s.to>c)break;s=n<e.length?e[n++]:null}if(!h)break;a=h.toA,l=h.toA-h.toB}return r}}class Vu{startParse(e,t,i){return"string"==typeof e&&(e=new Yu(e)),i=i?i.length?i.map((e=>new ku(e.from,e.to))):[new ku(0,0)]:[new ku(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let r=this.startParse(e,t,i);for(;;){let e=r.advance();if(e)return e}}}class Yu{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new xu({perNode:!0});const Gu=new xu;class Zu{constructor(e,t,i,r=[]){this.data=e,this.topNode=i,ys.prototype.hasOwnProperty("tree")||Object.defineProperty(ys.prototype,"tree",{get(){return ef(this)}}),this.parser=t,this.extension=[hf.of(this),ys.languageData.of(((e,t,i)=>e.facet(Ku(e,t,i))))].concat(r)}isActiveAt(e,t,i=-1){return Ku(e,t,i)==this.data}findRegions(e){let t=e.facet(hf);if((null==t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],r=(e,t)=>{if(e.prop(Gu)==this.data)return void i.push({from:t,to:t+e.length});let n=e.prop(xu.mounted);if(n){if(n.tree.prop(Gu)==this.data){if(n.overlay)for(let e of n.overlay)i.push({from:e.from+t,to:e.to+t});else i.push({from:t,to:t+e.length});return}if(n.overlay){let e=i.length;if(r(n.tree,n.overlay[0].from+t),i.length>e)return}}for(let i=0;i<e.children.length;i++){let n=e.children[i];n instanceof Ru&&r(n,e.positions[i]+t)}};return r(ef(e),0),i}get allowsNesting(){return!0}}function Ku(e,t,i){let r=e.facet(hf);if(!r)return null;let n=r.data;if(r.allowsNesting)for(let r=ef(e).topNode;r;r=r.enter(t,i,!0,!1))n=r.type.prop(Gu)||n;return n}Zu.setState=ls.define();class Ju extends Zu{constructor(e,t){super(e,t,t.topNode),this.parser=t}static define(e){let t=(i=e.languageData,Qn.define({combine:i?e=>e.concat(i):void 0}));var i;return new Ju(t,e.parser.configure({props:[Gu.add((e=>e.isTop?t:void 0))]}))}configure(e){return new Ju(this.data,this.parser.configure(e))}get allowsNesting(){return this.parser.wrappers.length>0}}function ef(e){let t=e.field(Zu.state,!1);return t?t.tree:Ru.empty}class tf{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let rf=null;class nf{constructor(e,t,i=[],r,n,s,o,a){this.parser=e,this.state=t,this.fragments=i,this.tree=r,this.treeLen=n,this.viewport=s,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}startParse(){return this.parser.startParse(new tf(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ru.empty&&this.isDone(null!=t?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;let r=Date.now()+e;for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let e=this.parse.advance();if(e){if(this.fragments=this.withoutTempSkipped(zu.addTree(e,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=e,this.parse=null,!(this.treeLen<(null!=t?t:this.state.doc.length)))return!0;this.parse=this.startParse()}if(Date.now()>r)return!1}}))}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext((()=>{for(;!(t=this.parse.advance()););})),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(zu.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=rf;rf=this;try{return e()}finally{rf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=sf(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:r,treeLen:n,viewport:s,skipped:o}=this;if(this.takeTree(),!e.empty){let t=[];if(e.iterChangedRanges(((e,i,r,n)=>t.push({fromA:e,toA:i,fromB:r,toB:n}))),i=zu.applyChanges(i,t),r=Ru.empty,n=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length){o=[];for(let t of this.skipped){let i=e.mapPos(t.from,1),r=e.mapPos(t.to,-1);i<r&&o.push({from:i,to:r})}}}return new nf(this.parser,t,i,r,n,s,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:i,to:r}=this.skipped[t];i<e.to&&r>e.from&&(this.fragments=sf(this.fragments,i,r),this.skipped.splice(t--,1))}return!(this.skipped.length>=t||(this.reset(),0))}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Vu{createParse(t,i,r){let n=r[0].from,s=r[r.length-1].to;return{parsedPos:n,advance(){let t=rf;if(t){for(let e of r)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=s,new Ru(Au.none,[],[],s-n)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return rf}}function sf(e,t,i){return zu.applyChanges(e,[{fromA:t,toA:i,fromB:t,toB:i}])}class of{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new of(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=new nf(e.facet(hf).parser,e,[],Ru.empty,0,{from:0,to:t},[],null);return i.work(20,t)||i.takeTree(),new of(i)}}Zu.state=Fn.define({create:of.init,update(e,t){for(let e of t.effects)if(e.is(Zu.setState))return e.value;return t.startState.facet(hf)!=t.state.facet(hf)?of.init(t.state):e.apply(t)}});let af=e=>{let t=setTimeout((()=>e()),500);return()=>clearTimeout(t)};"undefined"!=typeof requestIdleCallback&&(af=e=>{let t=-1,i=setTimeout((()=>{t=requestIdleCallback(e,{timeout:400})}),100);return()=>t<0?clearTimeout(i):cancelIdleCallback(t)});const lf=xa.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Zu.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Zu.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=af(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,n=i.field(Zu.state);if(n.tree==n.context.tree&&n.context.isDone(r+1e5))return;let s=Math.min(this.chunkBudget,100,e?Math.max(25,e.timeRemaining()-5):1e9),o=n.context.treeLen<r&&i.doc.length>r+1e3,a=n.context.work(s,r+(o?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(n.context.takeTree(),this.view.dispatch({effects:Zu.setState.of(new of(n.context))})),this.chunkBudget>0&&(!a||o)&&this.scheduleWork(),this.checkAsyncSchedule(n.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then((()=>this.scheduleWork())).catch((e=>ba(this.view.state,e))).then((()=>this.workScheduled--)),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return this.working||this.workScheduled>0}},{eventHandlers:{focus(){this.scheduleWork()}}}),hf=Qn.define({combine:e=>e.length?e[0]:null,enables:[Zu.state,lf]});const cf=Qn.define(),uf=Qn.define({combine:e=>{if(!e.length)return"  ";if(!/^(?: +|\t+)$/.test(e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return e[0]}});function ff(e){let t=e.facet(uf);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function df(e,t){let i="",r=e.tabSize;if(9==e.facet(uf).charCodeAt(0))for(;t>=r;)i+="\t",t-=r;for(let e=0;e<t;e++)i+=" ";return i}function pf(e,t){e instanceof ys&&(e=new gf(e));for(let i of e.state.facet(cf)){let r=i(e,t);if(null!=r)return r}let i=ef(e.state);return i?function(e,t,i){return vf(t.resolveInner(i).enterUnfinishedNodesBefore(i),i,e)}(e,i,t):null}class gf{constructor(e,t={}){this.state=e,this.options=t,this.unit=ff(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:r}=this.options;return null!=r&&r>=i.from&&r<=i.to?(t<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,t);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,t=1){let{text:i,from:r}=this.lineAt(e,t),n=this.countColumn(i,e-r),s=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return s>-1&&(n+=s-this.countColumn(i,i.search(/\S|$/))),n}countColumn(e,t=e.length){return un(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:r}=this.lineAt(e,t),n=this.options.overrideIndentation;if(n){let e=n(r);if(e>-1)return e}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const mf=new xu;function _f(e){let t=e.type.prop(mf);if(t)return t;let i,r=e.firstChild;if(r&&(i=r.type.prop(xu.closedBy))){let t=e.lastChild,r=t&&i.indexOf(t.name)>-1;return e=>function(e,t,i,r,n){let s=e.textAfter,o=s.match(/^\s*/)[0].length,a=r&&s.slice(o,o+r.length)==r||n==e.pos+o,l=t?function(e){let t=e.node,i=t.childAfter(t.from),r=t.lastChild;if(!i)return null;let n=e.options.simulateBreak,s=e.state.doc.lineAt(i.from),o=null==n||n<=s.from?s.to:Math.min(s.to,n);for(let e=i.to;;){let n=t.childAfter(e);if(!n||n==r)return null;if(!n.type.isSkipped)return n.from<o?i:null;e=n.to}}(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*i)}(e,!0,1,void 0,r&&!function(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}(e)?t.from:void 0)}return null==e.parent?yf:null}function vf(e,t,i){for(;e;e=e.parent){let r=_f(e);if(r)return r(new bf(i,t,e))}return null}function yf(){return 0}class bf extends gf{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.node=i}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(Of(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?vf(e,this.pos,this.base):0}}function Of(e,t){for(let i=t;i;i=i.parent)if(e==i)return!0;return!1}function wf({except:e,units:t=1}={}){return i=>{let r=e&&e.test(i.textAfter);return i.baseIndent+(r?0:t*i.unit)}}function Sf(){return ys.transactionFilter.of((e=>{if(!e.docChanged||!e.isUserEvent("input.type"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let i=e.newDoc,{head:r}=e.newSelection.main,n=i.lineAt(r);if(r>n.from+200)return e;let s=i.sliceString(n.from,r);if(!t.some((e=>e.test(s))))return e;let{state:o}=e,a=-1,l=[];for(let{head:e}of o.selection.ranges){let t=o.doc.lineAt(e);if(t.from==a)continue;a=t.from;let i=pf(o,t.from);if(null==i)continue;let r=/^\s*/.exec(t.text)[0],n=df(o,i);r!=n&&l.push({from:t.from,to:t.from+r.length,insert:n})}return l.length?[e,{changes:l,sequential:!0}]:e}))}const Cf=Qn.define(),kf=new xu;function xf(e,t,i){for(let r of e.facet(Cf)){let n=r(e,t,i);if(n)return n}return function(e,t,i){let r=ef(e);if(0==r.length)return null;let n=null;for(let s=r.resolveInner(i);s;s=s.parent){if(s.to<=i||s.from>i)continue;if(n&&s.from<t)break;let r=s.type.prop(kf);if(r){let o=r(s,e);o&&o.from<=i&&o.from>=t&&o.to>i&&(n=o)}}return n}(e,t,i)}class Ef extends Es{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ef.prototype.elementClass="",Ef.prototype.toDOM=void 0,Ef.prototype.mapMode=Sn.TrackBefore,Ef.prototype.startSide=Ef.prototype.endSide=-1,Ef.prototype.point=!0;const Af=Qn.define(),Tf={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Ls.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Pf=Qn.define();function Lf(e){return[Df(),Pf.of(Object.assign(Object.assign({},Tf),e))]}const Rf=bh.baseTheme({".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#999",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"}}),Mf=Qn.define({combine:e=>e.some((e=>e))});function Df(e){let t=[Bf,Rf];return e&&!1===e.fixed&&t.push(Mf.of(!0)),t}const Bf=xa.fromClass(class{constructor(e){this.view=e,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=e.state.facet(Pf).map((t=>new Hf(e,t)));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!e.state.facet(Mf),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,i=e.view.viewport,r=Math.min(t.to,i.to)-Math.max(t.from,i.from);this.syncGutters(r<.8*(i.to-i.from))}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Mf)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&this.dom.remove();let i=Ls.iter(this.view.state.facet(Af),this.view.viewport.from),r=[],n=this.gutters.map((e=>new $f(e,this.view.viewport,-this.view.documentPadding.top)));for(let e of this.view.viewportLineBlocks){let t;if(Array.isArray(e.type)){for(let i of e.type)if(i.type==Zo.Text){t=i;break}}else t=e.type==Zo.Text?e:void 0;if(t){r.length&&(r=[]),Qf(i,r,e.from);for(let e of n)e.line(this.view,t,r)}}for(let e of n)e.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(Pf),i=e.state.facet(Pf),r=e.docChanged||e.heightChanged||e.viewportChanged||!Ls.eq(e.startState.facet(Af),e.state.facet(Af),e.view.viewport.from,e.view.viewport.to);if(t==i)for(let t of this.gutters)t.update(e)&&(r=!0);else{r=!0;let n=[];for(let r of i){let i=t.indexOf(r);i<0?n.push(new Hf(this.view,r)):(this.gutters[i].update(e),n.push(this.gutters[i]))}for(let e of this.gutters)e.dom.remove(),n.indexOf(e)<0&&e.destroy();for(let e of n)this.dom.appendChild(e.dom);this.gutters=n}return r}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:Sa.scrollMargins.from((e=>0!=e.gutters.length&&e.fixed?e.view.textDirection==Ba.LTR?{left:e.dom.offsetWidth}:{right:e.dom.offsetWidth}:null))});function If(e){return Array.isArray(e)?e:[e]}function Qf(e,t,i){for(;e.value&&e.from<=i;)e.from==i&&t.push(e.value),e.next()}class $f{constructor(e,t,i){this.gutter=e,this.height=i,this.localMarkers=[],this.i=0,this.cursor=Ls.iter(e.markers,t.from)}line(e,t,i){this.localMarkers.length&&(this.localMarkers=[]),Qf(this.cursor,this.localMarkers,t.from);let r=i.length?this.localMarkers.concat(i):this.localMarkers,n=this.gutter.config.lineMarker(e,t,r);n&&r.unshift(n);let s=this.gutter;if(0==r.length&&!s.config.renderEmptyElements)return;let o=t.top-this.height;if(this.i==s.elements.length){let i=new Wf(e,t.height,o,r);s.elements.push(i),s.dom.appendChild(i.dom)}else s.elements[this.i].update(e,t.height,o,r);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Hf{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,(r=>{let n=e.lineBlockAtHeight(r.clientY-e.documentTop);t.domEventHandlers[i](e,n,r)&&r.preventDefault()}));this.markers=If(t.markers(e)),t.initialSpacer&&(this.spacer=new Wf(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=If(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let i=e.view.viewport;return!Ls.eq(this.markers,t,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}}class Wf{constructor(e,t,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.update(e,t,i,r)}update(e,t,i,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].compare(t[i]))return!1;return!0}(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let i="cm-gutterElement",r=this.dom.firstChild;for(let n=0,s=0;;){let o=s,a=n<t.length?t[n++]:null,l=!1;if(a){let e=a.elementClass;e&&(i+=" "+e);for(let e=s;e<this.markers.length;e++)if(this.markers[e].compare(a)){o=e,l=!0;break}}else o=this.markers.length;for(;s<o;){let e=this.markers[s++];if(e.toDOM){e.destroy(r);let t=r.nextSibling;r.remove(),r=t}}if(!a)break;a.toDOM&&(l?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),l&&s++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}const Nf=Qn.define(),Ff=Qn.define({combine:e=>bs(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let e in t){let r=i[e],n=t[e];i[e]=r?(e,t,i)=>r(e,t,i)||n(e,t,i):n}return i}})});class jf extends Ef{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Uf(e,t){return e.state.facet(Ff).formatNumber(t,e.state)}const qf=Pf.compute([Ff],(e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(Nf),lineMarker:(e,t,i)=>i.some((e=>e.toDOM))?null:new jf(Uf(e,e.state.doc.lineAt(t.from).number)),lineMarkerChange:e=>e.startState.facet(Ff)!=e.state.facet(Ff),initialSpacer:e=>new jf(Uf(e,zf(e.state.doc.lines))),updateSpacer(e,t){let i=Uf(t.view,zf(t.view.state.doc.lines));return i==e.number?e:new jf(i)},domEventHandlers:e.facet(Ff).domEventHandlers})));function Xf(e={}){return[Ff.of(e),Df(),qf]}function zf(e){let t=9;for(;t<e;)t=10*t+9;return t}const Vf=new class extends Ef{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Yf=Af.compute(["selection"],(e=>{let t=[],i=-1;for(let r of e.selection.ranges)if(r.empty){let n=e.doc.lineAt(r.head).from;n>i&&(i=n,t.push(Vf.range(n)))}return Ls.of(t)}));function Gf(){return Yf}function Zf(e,t){let i=t.mapPos(e.from,1),r=t.mapPos(e.to,-1);return i>=r?void 0:{from:i,to:r}}const Kf=ls.define({map:Zf}),Jf=ls.define({map:Zf});function ed(e){let t=[];for(let{head:i}of e.state.selection.ranges)t.some((e=>e.from<=i&&e.to>=i))||t.push(e.lineBlockAt(i));return t}const td=Fn.define({create:()=>Ko.none,update(e,t){e=e.map(t.changes);for(let i of t.effects)i.is(Kf)&&!rd(e,i.value.from,i.value.to)?e=e.update({add:[cd.range(i.value.from,i.value.to)]}):i.is(Jf)&&(e=e.update({filter:(e,t)=>i.value.from!=e||i.value.to!=t,filterFrom:i.value.from,filterTo:i.value.to}));if(t.selection){let i=!1,{head:r}=t.selection.main;e.between(r,r,((e,t)=>{e<r&&t>r&&(i=!0)})),i&&(e=e.update({filterFrom:r,filterTo:r,filter:(e,t)=>t<=r||e>=r}))}return e},provide:e=>bh.decorations.from(e)});function id(e,t,i){var r;let n=null;return null===(r=e.field(td,!1))||void 0===r||r.between(t,i,((e,t)=>{(!n||n.from>e)&&(n={from:e,to:t})})),n}function rd(e,t,i){let r=!1;return e.between(t,t,((e,n)=>{e==t&&n==i&&(r=!0)})),r}function nd(e,t){return e.field(td,!1)?t:t.concat(ls.appendConfig.of(hd()))}function sd(e,t,i=!0){let r=e.state.doc.lineAt(t.from).number,n=e.state.doc.lineAt(t.to).number;return bh.announce.of(`${e.state.phrase(i?"Folded lines":"Unfolded lines")} ${r} ${e.state.phrase("to")} ${n}.`)}const od=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of ed(e)){let i=xf(e.state,t.from,t.to);if(i)return e.dispatch({effects:nd(e.state,[Kf.of(i),sd(e,i)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(td,!1))return!1;let t=[];for(let i of ed(e)){let r=id(e.state,i.from,i.to);r&&t.push(Jf.of(r),sd(e,r,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,i=[];for(let r=0;r<t.doc.length;){let n=e.lineBlockAt(r),s=xf(t,n.from,n.to);s&&i.push(Kf.of(s)),r=(s?e.lineBlockAt(s.to):n).to+1}return i.length&&e.dispatch({effects:nd(e.state,i)}),!!i.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(td,!1);if(!t||!t.size)return!1;let i=[];return t.between(0,e.state.doc.length,((e,t)=>{i.push(Jf.of({from:e,to:t}))})),e.dispatch({effects:i}),!0}}],ad={placeholderDOM:null,placeholderText:""},ld=Qn.define({combine:e=>bs(e,ad)});function hd(e){let t=[td,pd];return e&&t.push(ld.of(e)),t}const cd=Ko.replace({widget:new class extends Go{ignoreEvents(){return!1}toDOM(e){let{state:t}=e,i=t.facet(ld),r=t=>{let i=e.lineBlockAt(e.posAtDOM(t.target)),r=id(e.state,i.from,i.to);r&&e.dispatch({effects:Jf.of(r)}),t.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(e,r);let n=document.createElement("span");return n.textContent=i.placeholderText,n.setAttribute("aria-label",t.phrase("folded code")),n.title=t.phrase("unfold"),n.className="cm-foldPlaceholder",n.onclick=r,n}}}),ud={openText:"",closedText:"",markerDOM:null};class fd extends Ef{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function dd(e={}){let t=Object.assign(Object.assign({},ud),e),i=new fd(t,!0),r=new fd(t,!1),n=xa.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(hf)!=e.state.facet(hf)||e.startState.field(td,!1)!=e.state.field(td,!1))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new Rs;for(let n of e.viewportLineBlocks){let s=id(e.state,n.from,n.to)?r:xf(e.state,n.from,n.to)?i:null;s&&t.add(n.from,n.from,s)}return t.finish()}});return[n,Lf({class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(n))||void 0===t?void 0:t.markers)||Ls.empty},initialSpacer:()=>new fd(t,!1),domEventHandlers:{click:(e,t)=>{let i=id(e.state,t.from,t.to);if(i)return e.dispatch({effects:Jf.of(i)}),!0;let r=xf(e.state,t.from,t.to);return!!r&&(e.dispatch({effects:Kf.of(r)}),!0)}}}),hd()]}const pd=bh.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),gd=bh.baseTheme({".cm-matchingBracket":{backgroundColor:"#328c8252"},".cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),md="()[]{}",_d=Qn.define({combine:e=>bs(e,{afterCursor:!0,brackets:md,maxScanDistance:1e4})}),vd=Ko.mark({class:"cm-matchingBracket"}),yd=Ko.mark({class:"cm-nonmatchingBracket"}),bd=Fn.define({create:()=>Ko.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let i=[],r=t.state.facet(_d);for(let e of t.state.selection.ranges){if(!e.empty)continue;let n=Cd(t.state,e.head,-1,r)||e.head>0&&Cd(t.state,e.head-1,1,r)||r.afterCursor&&(Cd(t.state,e.head,1,r)||e.head<t.state.doc.length&&Cd(t.state,e.head+1,-1,r));if(!n)continue;let s=n.matched?vd:yd;i.push(s.range(n.start.from,n.start.to)),n.end&&i.push(s.range(n.end.from,n.end.to))}return Ko.set(i,!0)},provide:e=>bh.decorations.from(e)}),Od=[bd,gd];function wd(e={}){return[_d.of(e),Od]}function Sd(e,t,i){let r=e.prop(t<0?xu.openedBy:xu.closedBy);if(r)return r;if(1==e.name.length){let r=i.indexOf(e.name);if(r>-1&&r%2==(t<0?1:0))return[i[r+t]]}return null}function Cd(e,t,i,r={}){let n=r.maxScanDistance||1e4,s=r.brackets||md,o=ef(e),a=o.resolveInner(t,i);for(let e=a;e;e=e.parent){let t=Sd(e.type,i,s);if(t&&e.from<e.to)return kd(0,0,i,e,t,s)}return function(e,t,i,r,n,s,o){let a=i<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=i>0)return null;let h={from:i<0?t-1:t,to:i>0?t+1:t},c=e.doc.iterRange(t,i>0?e.doc.length:0),u=0;for(let e=0;!c.next().done&&e<=s;){let s=c.value;i<0&&(e+=s.length);let a=t+e*i;for(let e=i>0?0:s.length-1,t=i>0?s.length:-1;e!=t;e+=i){let t=o.indexOf(s[e]);if(!(t<0||r.resolve(a+e,1).type!=n))if(t%2==0==i>0)u++;else{if(1==u)return{start:h,end:{from:a+e,to:a+e+1},matched:t>>1==l>>1};u--}}i>0&&(e+=s.length)}return c.done?{start:h,matched:!1}:null}(e,t,i,o,a.type,n,s)}function kd(e,t,i,r,n,s){let o=r.parent,a={from:r.from,to:r.to},l=0,h=null==o?void 0:o.cursor;if(h&&(i<0?h.childBefore(r.from):h.childAfter(r.to)))do{if(i<0?h.to<=r.from:h.from>=r.to){if(0==l&&n.indexOf(h.type.name)>-1&&h.from<h.to)return{start:a,end:{from:h.from,to:h.to},matched:!0};if(Sd(h.type,i,s))l++;else if(Sd(h.type,-i,s)&&(l--,0==l))return{start:a,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}}while(i<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function xd(e,t){return Mn.create(e.ranges.map(t),e.mainIndex)}function Ed(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Ad({state:e,dispatch:t},i){let r=xd(e.selection,i);return!r.eq(e.selection)&&(t(Ed(e,r)),!0)}function Td(e,t){return Mn.cursor(t?e.to:e.from)}function Pd(e,t){return Ad(e,(i=>i.empty?e.moveByChar(i,t):Td(i,t)))}const Ld=e=>Pd(e,e.textDirection!=Ba.LTR),Rd=e=>Pd(e,e.textDirection==Ba.LTR);function Md(e,t){return Ad(e,(i=>i.empty?e.moveByGroup(i,t):Td(i,t)))}function Dd(e,t,i){if(t.type.prop(i))return!0;let r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function Bd(e,t,i){let r,n,s=ef(e).resolveInner(t.head),o=i?xu.closedBy:xu.openedBy;for(let r=t.head;;){let t=i?s.childAfter(r):s.childBefore(r);if(!t)break;Dd(e,t,o)?s=t:r=i?t.to:t.from}return n=s.type.prop(o)&&(r=i?Cd(e,s.from,1):Cd(e,s.to,-1))&&r.matched?i?r.end.to:r.end.from:i?s.to:s.from,Mn.cursor(n,i?-1:1)}function Id(e,t){return Ad(e,(i=>{if(!i.empty)return Td(i,t);let r=e.moveVertically(i,t);return r.head!=i.head?r:e.moveToLineBoundary(i,t)}))}const Qd=e=>Id(e,!1),$d=e=>Id(e,!0);function Hd(e,t){return Ad(e,(i=>i.empty?e.moveVertically(i,t,e.dom.clientHeight):Td(i,t)))}const Wd=e=>Hd(e,!1),Nd=e=>Hd(e,!0);function Fd(e,t,i){let r=e.lineBlockAt(t.head),n=e.moveToLineBoundary(t,i);if(n.head==t.head&&n.head!=(i?r.to:r.from)&&(n=e.moveToLineBoundary(t,i,!1)),!i&&n.head==r.from&&r.length){let i=/^\s*/.exec(e.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;i&&t.head!=r.from+i&&(n=Mn.cursor(r.from+i))}return n}const jd=e=>Ad(e,(t=>Fd(e,t,!0))),Ud=e=>Ad(e,(t=>Fd(e,t,!1)));function qd(e,t){let i=xd(e.state.selection,(e=>{let i=t(e);return Mn.range(e.anchor,i.head,i.goalColumn)}));return!i.eq(e.state.selection)&&(e.dispatch(Ed(e.state,i)),!0)}function Xd(e,t){return qd(e,(i=>e.moveByChar(i,t)))}const zd=e=>Xd(e,e.textDirection!=Ba.LTR),Vd=e=>Xd(e,e.textDirection==Ba.LTR);function Yd(e,t){return qd(e,(i=>e.moveByGroup(i,t)))}function Gd(e,t){return qd(e,(i=>e.moveVertically(i,t)))}const Zd=e=>Gd(e,!1),Kd=e=>Gd(e,!0);function Jd(e,t){return qd(e,(i=>e.moveVertically(i,t,e.dom.clientHeight)))}const ep=e=>Jd(e,!1),tp=e=>Jd(e,!0),ip=e=>qd(e,(t=>Fd(e,t,!0))),rp=e=>qd(e,(t=>Fd(e,t,!1))),np=({state:e,dispatch:t})=>(t(Ed(e,{anchor:0})),!0),sp=({state:e,dispatch:t})=>(t(Ed(e,{anchor:e.doc.length})),!0),op=({state:e,dispatch:t})=>(t(Ed(e,{anchor:e.selection.main.anchor,head:0})),!0),ap=({state:e,dispatch:t})=>(t(Ed(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function lp({state:e,dispatch:t},i){if(e.readOnly)return!1;let r="delete.selection",n=e.changeByRange((e=>{let{from:t,to:n}=e;if(t==n){let e=i(t);e<t?r="delete.backward":e>t&&(r="delete.forward"),t=Math.min(t,e),n=Math.max(n,e)}return t==n?{range:e}:{changes:{from:t,to:n},range:Mn.cursor(t)}}));return!n.changes.empty&&(t(e.update(n,{scrollIntoView:!0,userEvent:r})),!0)}function hp(e,t,i){if(e instanceof bh)for(let r of e.pluginField(Sa.atomicRanges))r.between(t,t,((e,r)=>{e<t&&r>t&&(t=i?r:e)}));return t}const cp=(e,t)=>lp(e,(i=>{let r,n,{state:s}=e,o=s.doc.lineAt(i);if(!t&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(r=o.text.slice(0,i-o.from))){if("\t"==r[r.length-1])return i-1;let e=un(r,s.tabSize)%ff(s)||ff(s);for(let t=0;t<e&&" "==r[r.length-1-t];t++)i--;n=i}else n=rn(o.text,i-o.from,t)+o.from,n==i&&o.number!=(t?s.doc.lines:1)&&(n+=t?1:-1);return hp(e,n,t)})),up=e=>cp(e,!1),fp=e=>cp(e,!0),dp=(e,t)=>lp(e,(i=>{let r=i,{state:n}=e,s=n.doc.lineAt(r),o=n.charCategorizer(r);for(let e=null;;){if(r==(t?s.to:s.from)){r==i&&s.number!=(t?n.doc.lines:1)&&(r+=t?1:-1);break}let a=rn(s.text,r-s.from,t)+s.from,l=s.text.slice(Math.min(r,a)-s.from,Math.max(r,a)-s.from),h=o(l);if(null!=e&&h!=e)break;" "==l&&r==i||(e=h),r=a}return hp(e,r,t)})),pp=e=>dp(e,!1),gp=e=>lp(e,(t=>{let i=e.lineBlockAt(t).to;return hp(e,t<i?i:Math.min(e.state.doc.length,t+1),!0)}));function mp(e){let t=[],i=-1;for(let r of e.selection.ranges){let n=e.doc.lineAt(r.from),s=e.doc.lineAt(r.to);if(r.empty||r.to!=s.from||(s=e.doc.lineAt(r.to-1)),i>=n.number){let e=t[t.length-1];e.to=s.to,e.ranges.push(r)}else t.push({from:n.from,to:s.to,ranges:[r]});i=s.number+1}return t}function _p(e,t,i){if(e.readOnly)return!1;let r=[],n=[];for(let t of mp(e)){if(i?t.to==e.doc.length:0==t.from)continue;let s=e.doc.lineAt(i?t.to+1:t.from-1),o=s.length+1;if(i){r.push({from:t.to,to:s.to},{from:t.from,insert:s.text+e.lineBreak});for(let i of t.ranges)n.push(Mn.range(Math.min(e.doc.length,i.anchor+o),Math.min(e.doc.length,i.head+o)))}else{r.push({from:s.from,to:t.from},{from:t.to,insert:e.lineBreak+s.text});for(let e of t.ranges)n.push(Mn.range(e.anchor-o,e.head-o))}}return!!r.length&&(t(e.update({changes:r,scrollIntoView:!0,selection:Mn.create(n,e.selection.mainIndex),userEvent:"move.line"})),!0)}function vp(e,t,i){if(e.readOnly)return!1;let r=[];for(let t of mp(e))i?r.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):r.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const yp=Op(!1),bp=Op(!0);function Op(e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let r=t.changeByRange((i=>{let{from:r,to:n}=i,s=t.doc.lineAt(r),o=!e&&r==n&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let i,r=ef(e).resolveInner(t),n=r.childBefore(t),s=r.childAfter(t);return n&&s&&n.to<=t&&s.from>=t&&(i=n.type.prop(xu.closedBy))&&i.indexOf(s.name)>-1&&e.doc.lineAt(n.to).from==e.doc.lineAt(s.from).from?{from:n.to,to:s.from}:null}(t,r);e&&(r=n=(n<=s.to?s:t.doc.lineAt(n)).to);let a=new gf(t,{simulateBreak:r,simulateDoubleBreak:!!o}),l=pf(a,r);for(null==l&&(l=/^\s*/.exec(t.doc.lineAt(r).text)[0].length);n<s.to&&/\s/.test(s.text[n-s.from]);)n++;o?({from:r,to:n}=o):r>s.from&&r<s.from+100&&!/\S/.test(s.text.slice(0,r))&&(r=s.from);let h=["",df(t,l)];return o&&h.push(df(t,a.lineIndent(s.from,-1))),{changes:{from:r,to:n,insert:dn.of(h)},range:Mn.cursor(r+1+h[1].length)}}));return i(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function wp(e,t){let i=-1;return e.changeByRange((r=>{let n=[];for(let s=r.from;s<=r.to;){let o=e.doc.lineAt(s);o.number>i&&(r.empty||r.to>o.from)&&(t(o,n,r),i=o.number),s=o.to+1}let s=e.changes(n);return{changes:n,range:Mn.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}}))}const Sp=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(wp(e,((t,i)=>{i.push({from:t.from,insert:e.facet(uf)})})),{userEvent:"input.indent"})),!0),Cp=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(wp(e,((t,i)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let n=un(r,e.tabSize),s=0,o=df(e,Math.max(0,n-ff(e)));for(;s<r.length&&s<o.length&&r.charCodeAt(s)==o.charCodeAt(s);)s++;i.push({from:t.from+s,to:t.from+r.length,insert:o.slice(s)})})),{userEvent:"delete.dedent"})),!0),kp=[{key:"Ctrl-b",run:Ld,shift:zd,preventDefault:!0},{key:"Ctrl-f",run:Rd,shift:Vd},{key:"Ctrl-p",run:Qd,shift:Zd},{key:"Ctrl-n",run:$d,shift:Kd},{key:"Ctrl-a",run:e=>Ad(e,(t=>Mn.cursor(e.lineBlockAt(t.head).from,1))),shift:e=>qd(e,(t=>Mn.cursor(e.lineBlockAt(t.head).from)))},{key:"Ctrl-e",run:e=>Ad(e,(t=>Mn.cursor(e.lineBlockAt(t.head).to,-1))),shift:e=>qd(e,(t=>Mn.cursor(e.lineBlockAt(t.head).to)))},{key:"Ctrl-d",run:fp},{key:"Ctrl-h",run:up},{key:"Ctrl-k",run:gp},{key:"Ctrl-Alt-h",run:pp},{key:"Ctrl-o",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:dn.of(["",""])},range:Mn.cursor(e.from)})));return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange((t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let i=t.from,r=e.doc.lineAt(i),n=i==r.from?i-1:rn(r.text,i-r.from,!1)+r.from,s=i==r.to?i+1:rn(r.text,i-r.from,!0)+r.from;return{changes:{from:n,to:s,insert:e.doc.slice(i,s).append(e.doc.slice(n,i))},range:Mn.cursor(s)}}));return!i.changes.empty&&(t(e.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Alt-<",run:np},{key:"Alt->",run:sp},{key:"Ctrl-v",run:Nd},{key:"Alt-v",run:Wd}],xp=[{key:"ArrowLeft",run:Ld,shift:zd,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>Md(e,e.textDirection!=Ba.LTR),shift:e=>Yd(e,e.textDirection!=Ba.LTR)},{mac:"Cmd-ArrowLeft",run:Ud,shift:rp},{key:"ArrowRight",run:Rd,shift:Vd,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>Md(e,e.textDirection==Ba.LTR),shift:e=>Yd(e,e.textDirection==Ba.LTR)},{mac:"Cmd-ArrowRight",run:jd,shift:ip},{key:"ArrowUp",run:Qd,shift:Zd,preventDefault:!0},{mac:"Cmd-ArrowUp",run:np,shift:op},{mac:"Ctrl-ArrowUp",run:Wd,shift:ep},{key:"ArrowDown",run:$d,shift:Kd,preventDefault:!0},{mac:"Cmd-ArrowDown",run:sp,shift:ap},{mac:"Ctrl-ArrowDown",run:Nd,shift:tp},{key:"PageUp",run:Wd,shift:ep},{key:"PageDown",run:Nd,shift:tp},{key:"Home",run:Ud,shift:rp},{key:"Mod-Home",run:np,shift:op},{key:"End",run:jd,shift:ip},{key:"Mod-End",run:sp,shift:ap},{key:"Enter",run:yp},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:up,shift:up},{key:"Delete",run:fp},{key:"Mod-Backspace",mac:"Alt-Backspace",run:pp},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>dp(e,!0)},{mac:"Mod-Backspace",run:e=>lp(e,(t=>{let i=e.lineBlockAt(t).from;return hp(e,t>i?i:Math.max(0,t-1),!1)}))},{mac:"Mod-Delete",run:gp}].concat(kp.map((e=>({mac:e.key,run:e.run,shift:e.shift})))),Ep=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>Ad(e,(t=>Bd(e.state,t,e.textDirection!=Ba.LTR))),shift:e=>qd(e,(t=>Bd(e.state,t,e.textDirection!=Ba.LTR)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>Ad(e,(t=>Bd(e.state,t,e.textDirection==Ba.LTR))),shift:e=>qd(e,(t=>Bd(e.state,t,e.textDirection==Ba.LTR)))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>_p(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>vp(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>_p(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>vp(e,t,!0)},{key:"Escape",run:({state:e,dispatch:t})=>{let i=e.selection,r=null;return i.ranges.length>1?r=Mn.create([i.main]):i.main.empty||(r=Mn.create([Mn.cursor(i.main.head)])),!!r&&(t(Ed(e,r)),!0)}},{key:"Mod-Enter",run:bp},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:t})=>{let i=mp(e).map((({from:t,to:i})=>Mn.range(t,Math.min(i+1,e.doc.length))));return t(e.update({selection:Mn.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:t})=>{let i=xd(e.selection,(t=>{var i;let r=ef(e).resolveInner(t.head,1);for(;!(r.from<t.from&&r.to>=t.to||r.to>t.to&&r.from<=t.from)&&(null===(i=r.parent)||void 0===i?void 0:i.parent);)r=r.parent;return Mn.range(r.to,r.from)}));return t(Ed(e,i)),!0},preventDefault:!0},{key:"Mod-[",run:Cp},{key:"Mod-]",run:Sp},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=Object.create(null),r=new gf(e,{overrideIndentation:e=>{let t=i[e];return null==t?-1:t}}),n=wp(e,((t,n,s)=>{let o=pf(r,t.from);if(null==o)return;/\S/.test(t.text)||(o=0);let a=/^\s*/.exec(t.text)[0],l=df(e,o);(a!=l||s.from<t.from+a.length)&&(i[t.from]=o,n.push({from:t.from,to:t.from+a.length,insert:l}))}));return n.changes.empty||t(e.update(n,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,i=t.changes(mp(t).map((({from:e,to:i})=>(e>0?e--:i<t.doc.length&&i++,{from:e,to:i})))),r=xd(t.selection,(t=>e.moveVertically(t,!0))).map(i);return e.dispatch({changes:i,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:e,dispatch:t})=>function(e,t,i){let r=!1,n=xd(e.selection,(t=>{let n=Cd(e,t.head,-1)||Cd(e,t.head,1)||t.head>0&&Cd(e,t.head-1,1)||t.head<e.doc.length&&Cd(e,t.head+1,-1);if(!n||!n.end)return t;r=!0;let s=n.start.from==t.head?n.end.to:n.end.from;return i?Mn.range(t.anchor,s):Mn.cursor(s)}));return!!r&&(t(Ed(e,n)),!0)}(e,t,!1)}].concat(xp),Ap={key:"Tab",run:Sp,shift:Cp},Tp={brackets:["(","[","{","'",'"'],before:")]}'\":;>"},Pp=ls.define({map(e,t){let i=t.mapPos(e,-1,Sn.TrackAfter);return null==i?void 0:i}}),Lp=ls.define({map:(e,t)=>t.mapPos(e)}),Rp=new class extends Es{};Rp.startSide=1,Rp.endSide=-1;const Mp=Fn.define({create:()=>Ls.empty,update(e,t){if(t.selection){let i=t.state.doc.lineAt(t.selection.main.head).from,r=t.startState.doc.lineAt(t.startState.selection.main.head).from;i!=t.changes.mapPos(r,-1)&&(e=Ls.empty)}e=e.map(t.changes);for(let i of t.effects)i.is(Pp)?e=e.update({add:[Rp.range(i.value,i.value+1)]}):i.is(Lp)&&(e=e.update({filter:e=>e!=i.value}));return e}});function Dp(){return[bh.inputHandler.of($p),Mp]}const Bp="()[]{}<>";function Ip(e){for(let t=0;t<Bp.length;t+=2)if(Bp.charCodeAt(t)==e)return Bp.charAt(t+1);return hn(e<128?e:e+1)}function Qp(e,t){return e.languageDataAt("closeBrackets",t)[0]||Tp}function $p(e,t,i,r){if(e.composing)return!1;let n=e.state.selection.main;if(r.length>2||2==r.length&&1==cn(ln(r,0))||t!=n.from||i!=n.to)return!1;let s=function(e,t){let i=Qp(e,e.selection.main.head),r=i.brackets||Tp.brackets;for(let n of r){let s=Ip(ln(n,0));if(t==n)return s==n?Up(e,n,r.indexOf(n+n+n)>-1):Fp(e,n,s,i.before||Tp.before);if(t==s&&Wp(e,e.selection.main.from))return jp(e,0,s)}return null}(e.state,r);return!!s&&(e.dispatch(s),!0)}const Hp=[{key:"Backspace",run:({state:e,dispatch:t})=>{let i=Qp(e,e.selection.main.head).brackets||Tp.brackets,r=null,n=e.changeByRange((t=>{if(t.empty){let r=function(e,t){let i=e.sliceString(t-2,t);return cn(ln(i,0))==i.length?i:i.slice(1)}(e.doc,t.head);for(let n of i)if(n==r&&Np(e.doc,t.head)==Ip(ln(n,0)))return{changes:{from:t.head-n.length,to:t.head+n.length},range:Mn.cursor(t.head-n.length),userEvent:"delete.backward"}}return{range:r=t}}));return r||t(e.update(n,{scrollIntoView:!0})),!r}}];function Wp(e,t){let i=!1;return e.field(Mp).between(0,e.doc.length,(e=>{e==t&&(i=!0)})),i}function Np(e,t){let i=e.sliceString(t,t+2);return i.slice(0,cn(ln(i,0)))}function Fp(e,t,i,r){let n=null,s=e.changeByRange((s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:i,from:s.to}],effects:Pp.of(s.to+t.length),range:Mn.range(s.anchor+t.length,s.head+t.length)};let o=Np(e.doc,s.head);return!o||/\s/.test(o)||r.indexOf(o)>-1?{changes:{insert:t+i,from:s.head},effects:Pp.of(s.head+t.length),range:Mn.cursor(s.head+t.length)}:{range:n=s}}));return n?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function jp(e,t,i){let r=null,n=e.selection.ranges.map((t=>t.empty&&Np(e.doc,t.head)==i?Mn.cursor(t.head+i.length):r=t));return r?null:e.update({selection:Mn.create(n,e.selection.mainIndex),scrollIntoView:!0,effects:e.selection.ranges.map((({from:e})=>Lp.of(e)))})}function Up(e,t,i){let r=null,n=e.changeByRange((n=>{if(!n.empty)return{changes:[{insert:t,from:n.from},{insert:t,from:n.to}],effects:Pp.of(n.to+t.length),range:Mn.range(n.anchor+t.length,n.head+t.length)};let s=n.head,o=Np(e.doc,s);if(o==t){if(qp(e,s))return{changes:{insert:t+t,from:s},effects:Pp.of(s+t.length),range:Mn.cursor(s+t.length)};if(Wp(e,s)){let r=i&&e.sliceDoc(s,s+3*t.length)==t+t+t;return{range:Mn.cursor(s+t.length*(r?3:1)),effects:Lp.of(s)}}}else{if(i&&e.sliceDoc(s-2*t.length,s)==t+t&&qp(e,s-2*t.length))return{changes:{insert:t+t+t+t,from:s},effects:Pp.of(s+t.length),range:Mn.cursor(s+t.length)};if(e.charCategorizer(s)(o)!=ms.Word){let i=e.sliceDoc(s-1,s);if(i!=t&&e.charCategorizer(s)(i)!=ms.Word)return{changes:{insert:t+t,from:s},effects:Pp.of(s+t.length),range:Mn.cursor(s+t.length)}}}return{range:r=n}}));return r?null:e.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function qp(e,t){let i=ef(e).resolveInner(t+1);return i.parent&&i.from==t}const Xp=Qn.define({combine(e){let t,i;for(let r of e)t=t||r.topContainer,i=i||r.bottomContainer;return{topContainer:t,bottomContainer:i}}});function zp(e,t){let i=e.plugin(Vp),r=i?i.specs.indexOf(t):-1;return r>-1?i.panels[r]:null}const Vp=xa.fromClass(class{constructor(e){this.input=e.state.facet(Kp),this.specs=this.input.filter((e=>e)),this.panels=this.specs.map((t=>t(e)));let t=e.state.facet(Xp);this.top=new Yp(e,!0,t.topContainer),this.bottom=new Yp(e,!1,t.bottomContainer),this.top.sync(this.panels.filter((e=>e.top))),this.bottom.sync(this.panels.filter((e=>!e.top)));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(e){let t=e.state.facet(Xp);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Yp(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Yp(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=e.state.facet(Kp);if(i!=this.input){let t=i.filter((e=>e)),r=[],n=[],s=[],o=[];for(let i of t){let t,a=this.specs.indexOf(i);a<0?(t=i(e.view),o.push(t)):(t=this.panels[a],t.update&&t.update(e)),r.push(t),(t.top?n:s).push(t)}this.specs=t,this.panels=r,this.top.sync(n),this.bottom.sync(s);for(let e of o)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:Sa.scrollMargins.from((e=>({top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()})))});class Yp{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Gp(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Gp(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Gp(e){let t=e.nextSibling;return e.remove(),t}const Zp=bh.baseTheme({".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"}}),Kp=Qn.define({enables:[Vp,Zp]});function Jp(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){var n=i[r];"string"==typeof n?e.setAttribute(r,n):null!=n&&(e[r]=n)}t++}for(;t<arguments.length;t++)eg(e,arguments[t]);return e}function eg(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null==t);else if(null!=t.nodeType)e.appendChild(t);else{if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var i=0;i<t.length;i++)eg(e,t[i])}}const tg="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class ig{constructor(e,t,i=0,r=e.length,n){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=n?e=>n(tg(e)):tg,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ln(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=hn(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=cn(e);let r=this.normalize(t);for(let e=0,n=i;;e++){let s=r.charCodeAt(e),o=this.match(s,n);if(o)return this.value=o,this;if(e==r.length-1)break;n==i&&e<t.length&&t.charCodeAt(e)==s&&n++}}}match(e,t){let i=null;for(let r=0;r<this.matches.length;r+=2){let n=this.matches[r],s=!1;this.query.charCodeAt(n)==e&&(n==this.query.length-1?i={from:this.matches[r+1],to:t+1}:(this.matches[r]++,s=!0)),s||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?i={from:t,to:t+1}:this.matches.push(1,t)),i}}"undefined"!=typeof Symbol&&(ig.prototype[Symbol.iterator]=function(){return this});const rg={from:-1,to:-1,match:/.*/.exec("")},ng="gm"+(null==/x/.unicode?"":"u");class sg{constructor(e,t,i,r=0,n=e.length){if(this.to=n,this.curLine="",this.done=!1,this.value=rg,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new lg(e,t,i,r,n);this.re=new RegExp(t,ng+((null==i?void 0:i.ignoreCase)?"i":"")),this.iter=e.iter();let s=e.lineAt(r);this.curLineStart=s.from,this.matchPos=r,this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,r=i+t[0].length;if(this.matchPos=r+(i==r?1:0),i==this.curLine.length&&this.nextLine(),i<r||i>this.value.to)return this.value={from:i,to:r,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}const og=new WeakMap;class ag{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let r=og.get(e);if(!r||r.from>=i||r.to<=t){let r=new ag(t,e.sliceString(t,i));return og.set(e,r),r}if(r.from==t&&r.to==i)return r;let{text:n,from:s}=r;return s>t&&(n=e.sliceString(t,s)+n,s=t),r.to<i&&(n+=e.sliceString(r.to,i)),og.set(e,new ag(s,n)),new ag(t,n.slice(t-s,i-s))}}class lg{constructor(e,t,i,r,n){this.text=e,this.to=n,this.done=!1,this.value=rg,this.matchPos=r,this.re=new RegExp(t,ng+((null==i?void 0:i.ignoreCase)?"i":"")),this.flat=ag.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t&&this.flat.to<this.to&&t.index+t[0].length>this.flat.text.length-10&&(t=null),t){let e=this.flat.from+t.index,i=e+t[0].length;return this.value={from:e,to:i,match:t},this.matchPos=i+(e==i?1:0),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=ag.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function hg(e){let t=Jp("input",{class:"cm-textfield",name:"line"});function i(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!i)return;let{state:r}=e,n=r.doc.lineAt(r.selection.main.head),[,s,o,a,l]=i,h=a?+a.slice(1):0,c=o?+o:n.number;if(o&&l){let e=c/100;s&&(e=e*("-"==s?-1:1)+n.number/r.doc.lines),c=Math.round(r.doc.lines*e)}else o&&s&&(c=c*("-"==s?-1:1)+n.number);let u=r.doc.line(Math.max(1,Math.min(r.doc.lines,c)));e.dispatch({effects:cg.of(!1),selection:Mn.cursor(u.from+Math.max(0,Math.min(h,u.length))),scrollIntoView:!0}),e.focus()}return{dom:Jp("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:cg.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),i())},onsubmit:e=>{e.preventDefault(),i()}},Jp("label",e.state.phrase("Go to line"),": ",t)," ",Jp("button",{class:"cm-button",type:"submit"},e.state.phrase("go"))),pos:-10}}"undefined"!=typeof Symbol&&(sg.prototype[Symbol.iterator]=lg.prototype[Symbol.iterator]=function(){return this});const cg=ls.define(),ug=Fn.define({create:()=>!0,update(e,t){for(let i of t.effects)i.is(cg)&&(e=i.value);return e},provide:e=>Kp.from(e,(e=>e?hg:null))}),fg=bh.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),dg={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100},pg=Qn.define({combine:e=>bs(e,dg,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})});function gg(e){let t=[yg,vg];return e&&t.push(pg.of(e)),t}const mg=Ko.mark({class:"cm-selectionMatch"}),_g=Ko.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),vg=xa.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(pg),{state:i}=e,r=i.selection;if(r.ranges.length>1)return Ko.none;let n,s=r.main,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return Ko.none;let e=i.wordAt(s.head);if(!e)return Ko.none;o=i.charCategorizer(s.head),n=i.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return Ko.none;if(n=i.sliceDoc(s.from,s.to).trim(),!n)return Ko.none}let a=[];for(let r of e.visibleRanges){let e=new ig(i.doc,n,r.from,r.to);for(;!e.next().done;){let{from:r,to:n}=e.value;if((!o||(0==r||o(i.sliceDoc(r-1,r))!=ms.Word)&&(n==i.doc.length||o(i.sliceDoc(n,n+1))!=ms.Word))&&(o&&r<=s.from&&n>=s.to?a.push(_g.range(r,n)):(r>=s.to||n<=s.from)&&a.push(mg.range(r,n)),a.length>t.maxMatches))return Ko.none}}return Ko.set(a)}},{decorations:e=>e.decorations}),yg=bh.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),bg=Qn.define({combine(e){var t;return{top:e.reduce(((e,t)=>null!=e?e:t.top),void 0)||!1,caseSensitive:e.reduce(((e,t)=>null!=e?e:t.caseSensitive||t.matchCase),void 0)||!1,createPanel:(null===(t=e.find((e=>e.createPanel)))||void 0===t?void 0:t.createPanel)||(e=>new jg(e))}}});class Og{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,ng),!0}catch(e){return!1}}(this.search))}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp}create(){return this.regexp?new Cg(this):new Sg(this)}}class wg{constructor(e){this.spec=e}}class Sg extends wg{constructor(e){super(e),this.unquoted=e.search.replace(/\\([nrt\\])/g,((e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"))}cursor(e,t=0,i=e.length){return new ig(e,this.unquoted,t,i,this.spec.caseSensitive?void 0:e=>e.toLowerCase())}nextMatch(e,t,i){let r=this.cursor(e,i).nextOverlapping();return r.done&&(r=this.cursor(e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=i;;){let i=Math.max(t,r-1e4-this.unquoted.length),n=this.cursor(e,i,r),s=null;for(;!n.nextOverlapping().done;)s=n.value;if(s)return s;if(i==t)return null;r-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let i=this.cursor(e),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let n=this.cursor(e,Math.max(0,t-this.unquoted.length),Math.min(i+this.unquoted.length,e.length));for(;!n.next().done;)r(n.value.from,n.value.to)}}class Cg extends wg{cursor(e,t=0,i=e.length){return new sg(e,this.spec.search,this.spec.caseSensitive?void 0:{ignoreCase:!0},t,i)}nextMatch(e,t,i){let r=this.cursor(e,i).next();return r.done&&(r=this.cursor(e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=1;;r++){let n=Math.max(t,i-1e4*r),s=this.cursor(e,n,i),o=null;for(;!s.next().done;)o=s.value;if(o&&(n==t||o.from>n+10))return o;if(n==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,((t,i)=>"$"==i?"$":"&"==i?e.match[0]:"0"!=i&&+i<e.match.length?e.match[i]:t))}matchAll(e,t){let i=this.cursor(e),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let n=this.cursor(e,Math.max(0,t-250),Math.min(i+250,e.length));for(;!n.next().done;)r(n.value.from,n.value.to)}}const kg=ls.define(),xg=ls.define(),Eg=Fn.define({create:e=>new Ag(Hg(e).create(),$g),update(e,t){for(let i of t.effects)i.is(kg)?e=new Ag(i.value.create(),e.panel):i.is(xg)&&(e=new Ag(e.query,i.value?$g:null));return e},provide:e=>Kp.from(e,(e=>e.panel))});class Ag{constructor(e,t){this.query=e,this.panel=t}}const Tg=Ko.mark({class:"cm-searchMatch"}),Pg=Ko.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Lg=xa.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(Eg))}update(e){let t=e.state.field(Eg);(t!=e.startState.field(Eg)||e.docChanged||e.selectionSet)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return Ko.none;let{view:i}=this,r=new Rs;for(let t=0,n=i.visibleRanges,s=n.length;t<s;t++){let{from:o,to:a}=n[t];for(;t<s-1&&a>n[t+1].from-500;)a=n[++t].to;e.highlight(i.state.doc,o,a,((e,t)=>{let n=i.state.selection.ranges.some((i=>i.from==e&&i.to==t));r.add(e,t,n?Pg:Tg)}))}return r.finish()}},{decorations:e=>e.decorations});function Rg(e){return t=>{let i=t.state.field(Eg,!1);return i&&i.query.spec.valid?e(t,i):Wg(t)}}const Mg=Rg(((e,{query:t})=>{let{from:i,to:r}=e.state.selection.main,n=t.nextMatch(e.state.doc,i,r);return!(!n||n.from==i&&n.to==r||(e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Xg(e,n),userEvent:"select.search"}),0))})),Dg=Rg(((e,{query:t})=>{let{state:i}=e,{from:r,to:n}=i.selection.main,s=t.prevMatch(i.doc,r,n);return!!s&&(e.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:Xg(e,s),userEvent:"select.search"}),!0)})),Bg=Rg(((e,{query:t})=>{let i=t.matchAll(e.state.doc,1e3);return!(!i||!i.length||(e.dispatch({selection:Mn.create(i.map((e=>Mn.range(e.from,e.to)))),userEvent:"select.search.matches"}),0))})),Ig=Rg(((e,{query:t})=>{let{state:i}=e,{from:r,to:n}=i.selection.main;if(i.readOnly)return!1;let s=t.nextMatch(i.doc,r,r);if(!s)return!1;let o,a,l=[];if(s.from==r&&s.to==n&&(a=i.toText(t.getReplacement(s)),l.push({from:s.from,to:s.to,insert:a}),s=t.nextMatch(i.doc,s.from,s.to)),s){let e=0==l.length||l[0].from>=s.to?0:s.to-s.from-a.length;o={anchor:s.from-e,head:s.to-e}}return e.dispatch({changes:l,selection:o,scrollIntoView:!!o,effects:s?Xg(e,s):void 0,userEvent:"input.replace"}),!0})),Qg=Rg(((e,{query:t})=>{if(e.state.readOnly)return!1;let i=t.matchAll(e.state.doc,1e9).map((e=>{let{from:i,to:r}=e;return{from:i,to:r,insert:t.getReplacement(e)}}));return!!i.length&&(e.dispatch({changes:i,userEvent:"input.replace.all"}),!0)}));function $g(e){return e.state.facet(bg).createPanel(e)}function Hg(e,t){var i;let r=e.selection.main,n=r.empty||r.to>r.from+100?"":e.sliceDoc(r.from,r.to),s=null!==(i=null==t?void 0:t.caseSensitive)&&void 0!==i?i:e.facet(bg).caseSensitive;return t&&!n?t:new Og({search:n.replace(/\n/g,"\\n"),caseSensitive:s})}const Wg=e=>{let t=e.state.field(Eg,!1);if(t&&t.panel){let i=zp(e,$g);if(!i)return!1;let r=i.dom.querySelector("[name=search]");if(r!=e.root.activeElement){let i=Hg(e.state,t.query.spec);i.valid&&e.dispatch({effects:kg.of(i)}),r.focus(),r.select()}}else e.dispatch({effects:[xg.of(!0),t?kg.of(Hg(e.state,t.query.spec)):ls.appendConfig.of(Vg)]});return!0},Ng=e=>{let t=e.state.field(Eg,!1);if(!t||!t.panel)return!1;let i=zp(e,$g);return i&&i.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:xg.of(!1)}),!0},Fg=[{key:"Mod-f",run:Wg,scope:"editor search-panel"},{key:"F3",run:Mg,shift:Dg,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Mg,shift:Dg,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Ng,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:t})=>{let i=e.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:r,to:n}=i.main,s=[],o=0;for(let t=new ig(e.doc,e.sliceDoc(r,n));!t.next().done;){if(s.length>1e3)return!1;t.value.from==r&&(o=s.length),s.push(Mn.range(t.value.from,t.value.to))}return t(e.update({selection:Mn.create(s,o),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:e=>{let t=zp(e,hg);if(!t){let i=[cg.of(!0)];null==e.state.field(ug,!1)&&i.push(ls.appendConfig.of([ug,fg])),e.dispatch({effects:i}),t=zp(e,hg)}return t&&t.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:e,dispatch:t})=>{let{ranges:i}=e.selection;if(i.some((e=>e.from===e.to)))return(({state:e,dispatch:t})=>{let{selection:i}=e,r=Mn.create(i.ranges.map((t=>e.wordAt(t.head)||Mn.cursor(t.head))),i.mainIndex);return!r.eq(i)&&(t(e.update({selection:r})),!0)})({state:e,dispatch:t});let r=e.sliceDoc(i[0].from,i[0].to);if(e.selection.ranges.some((t=>e.sliceDoc(t.from,t.to)!=r)))return!1;let n=function(e,t){let{main:i,ranges:r}=e.selection,n=e.wordAt(i.head),s=n&&n.from==i.from&&n.to==i.to;for(let i=!1,n=new ig(e.doc,t,r[r.length-1].to);;){if(n.next(),!n.done){if(i&&r.some((e=>e.from==n.value.from)))continue;if(s){let t=e.wordAt(n.value.from);if(!t||t.from!=n.value.from||t.to!=n.value.to)continue}return n.value}if(i)return null;n=new ig(e.doc,t,0,Math.max(0,r[r.length-1].from-1)),i=!0}}(e,r);return!!n&&(t(e.update({selection:e.selection.addRange(Mn.range(n.from,n.to),!1),scrollIntoView:!0})),!0)},preventDefault:!0}];class jg{constructor(e){this.view=e;let t=this.query=e.state.field(Eg).query.spec;function i(e,t,i){return Jp("button",{class:"cm-button",name:e,onclick:t,type:"button"},i)}this.commit=this.commit.bind(this),this.searchField=Jp("input",{value:t.search,placeholder:Ug(e,"Find"),"aria-label":Ug(e,"Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Jp("input",{value:t.replace,placeholder:Ug(e,"Replace"),"aria-label":Ug(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=Jp("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit}),this.reField=Jp("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit}),this.dom=Jp("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,i("next",(()=>Mg(e)),[Ug(e,"next")]),i("prev",(()=>Dg(e)),[Ug(e,"previous")]),i("select",(()=>Bg(e)),[Ug(e,"all")]),Jp("label",null,[this.caseField,Ug(e,"match case")]),Jp("label",null,[this.reField,Ug(e,"regexp")]),...e.state.readOnly?[]:[Jp("br"),this.replaceField,i("replace",(()=>Ig(e)),[Ug(e,"replace")]),i("replaceAll",(()=>Qg(e)),[Ug(e,"replace all")]),Jp("button",{name:"close",onclick:()=>Ng(e),"aria-label":Ug(e,"close"),type:"button"},[""])]])}commit(){let e=new Og({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:kg.of(e)}))}keydown(e){!function(e,t,i){return Bh(Mh(e.state),t,e,"search-panel")}(this.view,e)?13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Dg:Mg)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),Ig(this.view)):e.preventDefault()}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(kg)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(bg).top}}function Ug(e,t){return e.state.phrase(t)}const qg=/[\s\.,:;?!]/;function Xg(e,{from:t,to:i}){let r=e.state.doc.lineAt(t).from,n=e.state.doc.lineAt(i).to,s=Math.max(r,t-30),o=Math.min(n,i+30),a=e.state.sliceDoc(s,o);if(s!=r)for(let e=0;e<30;e++)if(!qg.test(a[e+1])&&qg.test(a[e])){a=a.slice(e);break}if(o!=n)for(let e=a.length-1;e>a.length-30;e--)if(!qg.test(a[e-1])&&qg.test(a[e])){a=a.slice(0,e);break}return bh.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${e.state.doc.lineAt(t).number}`)}const zg=bh.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Vg=[Eg,Un.lowest(Lg),zg],Yg="undefined"!=typeof navigator&&!/Edge\/(\d+)/.exec(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Gg="-10000px";class Zg{constructor(e,t,i){this.facet=t,this.createTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter((e=>e)),this.tooltipViews=this.tooltips.map(i)}update(e){let t=e.state.facet(this.facet),i=t.filter((e=>e));if(t===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let r=[];for(let t=0;t<i.length;t++){let n=i[t],s=-1;if(n){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==n.create&&(s=e)}if(s<0)r[t]=this.createTooltipView(n);else{let i=r[t]=this.tooltipViews[s];i.update&&i.update(e)}}}for(let e of this.tooltipViews)r.indexOf(e)<0&&e.dom.remove();return this.input=t,this.tooltips=i,this.tooltipViews=r,!0}}function Kg(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const Jg=Qn.define({combine:e=>{var t,i,r;return{position:Yg?"absolute":(null===(t=e.find((e=>e.position)))||void 0===t?void 0:t.position)||"fixed",parent:(null===(i=e.find((e=>e.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(r=e.find((e=>e.tooltipSpace)))||void 0===r?void 0:r.tooltipSpace)||Kg}}}),em=xa.fromClass(class{constructor(e){this.view=e,this.inView=!0,this.lastTransaction=0,this.intersectionTimeout=-1;let t=e.state.facet(Jg);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Zg(e,rm,(e=>this.createTooltip(e))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((e=>{this.intersectionTimeout<0&&Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&(this.intersectionTimeout=setTimeout((()=>{this.intersectionTimeout=-1,this.maybeMeasure()}),50))}),{threshold:[1]}):null,this.observeIntersection(),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e);t&&this.observeIntersection();let i=t||e.geometryChanged,r=e.state.facet(Jg);if(r.position!=this.position){this.position=r.position;for(let e of this.manager.tooltipViews)e.dom.style.position=this.position;i=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let e of this.manager.tooltipViews)this.container.appendChild(e.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(e){let t=e.create(this.view);if(t.dom.classList.add("cm-tooltip"),e.arrow&&!t.dom.querySelector("cm-tooltip > cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",t.dom.appendChild(e)}return t.dom.style.position=this.position,t.dom.style.top=Gg,this.container.appendChild(t.dom),t.mount&&t.mount(this.view),t}destroy(){var e;for(let{dom:e}of this.manager.tooltipViews)e.remove();null===(e=this.intersectionObserver)||void 0===e||e.disconnect(),clearTimeout(this.intersectionTimeout)}readMeasure(){let e=this.view.dom.getBoundingClientRect();return{editor:e,parent:this.parent?this.container.getBoundingClientRect():e,pos:this.manager.tooltips.map((e=>this.view.coordsAtPos(e.pos))),size:this.manager.tooltipViews.map((({dom:e})=>e.getBoundingClientRect())),space:this.view.state.facet(Jg).tooltipSpace(this.view)}}writeMeasure(e){let{editor:t,space:i}=e,r=[];for(let n=0;n<this.manager.tooltips.length;n++){let s=this.manager.tooltips[n],o=this.manager.tooltipViews[n],{dom:a}=o,l=e.pos[n],h=e.size[n];if(!l||l.bottom<=Math.max(t.top,i.top)||l.top>=Math.min(t.bottom,i.bottom)||l.right<=Math.max(t.left,i.left)||l.left>=Math.min(t.right,i.right)){a.style.top=Gg;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,u=c?7:0,f=h.right-h.left,d=h.bottom-h.top,p=o.offset||im,g=this.view.textDirection==Ba.LTR,m=h.width>i.right-i.left?g?i.left:i.right-h.width:g?Math.min(l.left-(c?14:0)+p.x,i.right-f):Math.max(i.left,l.left-f+(c?14:0)-p.x),_=!!s.above;!s.strictSide&&(_?l.top-(h.bottom-h.top)-p.y<i.top:l.bottom+(h.bottom-h.top)+p.y>i.bottom)&&_==i.bottom-l.bottom>l.top-i.top&&(_=!_);let v=_?l.top-d-u-p.y:l.bottom+u+p.y,y=m+f;for(let e of r)e.left<y&&e.right>m&&e.top<v+d&&e.bottom>v&&(v=_?e.top-d-2-u:e.bottom+u+2);"absolute"==this.position?(a.style.top=v-e.parent.top+"px",a.style.left=m-e.parent.left+"px"):(a.style.top=v+"px",a.style.left=m+"px"),c&&(c.style.left=l.left+(g?p.x:-p.x)-(m+14-7)+"px"),r.push({left:m,top:v,right:y,bottom:v+d}),a.classList.toggle("cm-tooltip-above",_),a.classList.toggle("cm-tooltip-below",!_),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=Gg}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),tm=bh.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),im={x:0,y:0},rm=Qn.define({enables:[em,tm]}),nm=Qn.define();class sm{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Zg(e,nm,(e=>this.createHostedView(e)))}static create(e){return new sm(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}}const om=rm.compute([nm],(e=>{let t=e.facet(nm).filter((e=>e));return 0===t.length?null:{pos:Math.min(...t.map((e=>e.pos))),end:Math.max(...t.filter((e=>null!=e.end)).map((e=>e.end))),create:sm.create,above:t[0].above,arrow:t.some((e=>e.arrow))}}));class am{constructor(e,t,i,r,n){this.view=e,this.source=t,this.field=i,this.setHover=r,this.hoverTime=n,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){var e;clearTimeout(this.restartTimeout);let{lastMove:t}=this,i=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(null==i)return;let r=this.view.coordsAtPos(i);if(null==r||t.y<r.top||t.y>r.bottom||t.x<r.left-this.view.defaultCharacterWidth||t.x>r.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(i)).find((e=>e.from<=i&&e.to>=i)),s=n&&n.dir==Ba.RTL?-1:1,o=this.source(this.view,i,t.x<r.left?-s:s);if(null===(e=o)||void 0===e?void 0:e.then){let e=this.pending={pos:i};o.then((t=>{this.pending==e&&(this.pending=null,t&&this.view.dispatch({effects:this.setHover.of(t)}))}),(e=>ba(this.view.state,e,"hover tooltip")))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!function(e){for(let t=e;t;t=t.parentNode)if(1==t.nodeType&&t.classList.contains("cm-tooltip"))return!0;return!1}(this.lastMove.target)||this.pending){let{pos:r}=i||this.pending,n=null!==(t=null==i?void 0:i.end)&&void 0!==t?t:r;(r==n?this.view.posAtCoords(this.lastMove)==r:function(e,t,i,r,n,s){let o=document.createRange(),a=e.domAtPos(t),l=e.domAtPos(i);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let h=o.getClientRects();o.detach();for(let e=0;e<h.length;e++){let t=h[e];if(Math.max(t.top-n,n-t.bottom,t.left-r,r-t.right)<=6)return!0}return!1}(this.view,r,n,e.clientX,e.clientY))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function lm(e,t={}){let i=ls.define(),r=Fn.define({create:()=>null,update(e,r){if(e&&t.hideOnChange&&(r.docChanged||r.selection))return null;for(let e of r.effects){if(e.is(i))return e.value;if(e.is(hm))return null}if(e&&r.docChanged){let t=r.changes.mapPos(e.pos,-1,Sn.TrackDel);if(null==t)return null;let i=Object.assign(Object.create(null),e);return i.pos=t,null!=e.end&&(i.end=r.changes.mapPos(e.end)),i}return e},provide:e=>nm.from(e)}),n=t.hoverTime||600;return[r,xa.define((t=>new am(t,e,r,i,n))),om]}const hm=ls.define();class cm{constructor(e,t,i){this.state=e,this.pos=t,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let t=ef(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),r=t.text.slice(i-t.from,this.pos-t.from),n=r.search(pm(e,!1));return n<0?null:{from:i+n,to:this.pos,text:r.slice(n)}}get aborted(){return null==this.abortListeners}addEventListener(e,t){"abort"==e&&this.abortListeners&&this.abortListeners.push(t)}}function um(e){let t=Object.keys(e).join(""),i=/\w/.test(t);return i&&(t=t.replace(/\w/g,"")),`[${i?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}class fm{constructor(e,t,i){this.completion=e,this.source=t,this.match=i}}function dm(e){return e.selection.main.head}function pm(e,t){var i;let{source:r}=e,n=t&&"^"!=r[0],s="$"!=r[r.length-1];return n||s?new RegExp(`${n?"^":""}(?:${r})${s?"$":""}`,null!==(i=e.flags)&&void 0!==i?i:e.ignoreCase?"i":""):e}const gm=ss.define();function mm(e,t){let i=t.completion.apply||t.completion.label,r=t.source;"string"==typeof i?e.dispatch({changes:{from:r.from,to:r.to,insert:i},selection:{anchor:r.from+i.length},userEvent:"input.complete",annotations:gm.of(t.completion)}):i(e,t.completion,r.from,r.to)}const _m=new WeakMap;function vm(e){if(!Array.isArray(e))return e;let t=_m.get(e);return t||_m.set(e,t=function(e){let t=e.map((e=>"string"==typeof e?{label:e}:e)),[i,r]=t.every((e=>/^\w+$/.test(e.label)))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),i=Object.create(null);for(let{label:r}of e){t[r[0]]=!0;for(let e=1;e<r.length;e++)i[r[e]]=!0}let r=um(t)+um(i)+"*$";return[new RegExp("^"+r),new RegExp(r)]}(t);return e=>{let n=e.matchBefore(r);return n||e.explicit?{from:n?n.from:e.pos,options:t,span:i}:null}}(e)),t}class ym{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let i=ln(e,t),r=cn(i);this.chars.push(i);let n=e.slice(t,t+r),s=n.toUpperCase();this.folded.push(ln(s==n?n.toLowerCase():s,0)),t+=r}this.astral=e.length!=this.chars.length}match(e){if(0==this.pattern.length)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:r,precise:n,byWord:s}=this;if(1==t.length){let r=ln(e,0);return r==t[0]?[0,0,cn(r)]:r==i[0]?[-200,0,cn(r)]:null}let o=e.indexOf(this.pattern);if(0==o)return[0,0,this.pattern.length];let a=t.length,l=0;if(o<0){for(let n=0,s=Math.min(e.length,200);n<s&&l<a;){let s=ln(e,n);s!=t[l]&&s!=i[l]||(r[l++]=n),n+=cn(s)}if(l<a)return null}let h=0,c=0,u=!1,f=0,d=-1,p=-1,g=/[a-z]/.test(e);for(let r=0,l=Math.min(e.length,200),m=0;r<l&&c<a;){let l=ln(e,r);o<0&&(h<a&&l==t[h]&&(n[h++]=r),f<a&&(l==t[f]||l==i[f]?(0==f&&(d=r),p=r+1,f++):f=0));let _,v=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(_=hn(l))!=_.toLowerCase()?1:_!=_.toUpperCase()?2:0;(1==v&&g||0==m&&0!=v)&&(t[c]==l||i[c]==l&&(u=!0))&&(s[c++]=r),m=v,r+=cn(l)}return c==a&&0==s[0]?this.result((u?-200:0)-100,s,e):f==a&&0==d?[-200,0,p]:o>-1?[-700,o,o+this.pattern.length]:f==a?[-900,d,p]:c==a?this.result((u?-200:0)-100-700,s,e):2==t.length?null:this.result((r[0]?-700:0)-200-1100,r,e)}result(e,t,i){let r=[e],n=1;for(let e of t){let t=e+(this.astral?cn(ln(i,e)):1);n>1&&r[n-1]==e?r[n-1]=t:(r[n++]=e,r[n++]=t)}return r}}const bm=Qn.define({combine:e=>bs(e,{activateOnTyping:!0,override:null,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>i=>function(e,t){return e?t?e+" "+t:e:t}(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})});function Om(e,t,i){if(e<=i)return{from:0,to:e};if(t<=e>>1){let e=Math.floor(t/i);return{from:e*i,to:(e+1)*i}}let r=Math.floor((e-t)/i);return{from:e-(r+1)*i,to:e-r*i}}class wm{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:e=>this.positionInfo(e),key:this};let i=e.state.field(t),{options:r,selected:n}=i.open,s=e.state.facet(bm);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map((e=>"cm-completionIcon-"+e))),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,i){let r=document.createElement("span");r.className="cm-completionLabel";let{label:n}=e,s=0;for(let e=1;e<i.length;){let t=i[e++],o=i[e++];t>s&&r.appendChild(document.createTextNode(n.slice(s,t)));let a=r.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(n.slice(t,o))),a.className="cm-completionMatchedText",s=o}return s<n.length&&r.appendChild(document.createTextNode(n.slice(s))),r},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort(((e,t)=>e.position-t.position)).map((e=>e.render))}(s),this.optionClass=s.optionClass,this.range=Om(r.length,n,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",(t=>{for(let i,n=t.target;n&&n!=this.dom;n=n.parentNode)if("LI"==n.nodeName&&(i=/-(\d+)$/.exec(n.id))&&+i[1]<r.length)return mm(e,r[+i[1]]),void t.preventDefault()})),this.list=this.dom.appendChild(this.createListBox(r,i.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))}mount(){this.updateSel()}update(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Om(t.options.length,t.selected,this.view.state.facet(bm).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let e=t.options[t.selected];e.completion.info&&(this.info=this.dom.appendChild(function(e,t){let i=document.createElement("div");i.className="cm-tooltip cm-completionInfo";let{info:r}=e.completion;if("string"==typeof r)i.textContent=r;else{let n=r(e.completion);n.then?n.then((e=>i.appendChild(e)),(e=>ba(t.state,e,"completion info"))):i.appendChild(n)}return i}(e,this.view)),this.view.requestMeasure(this.placeInfo))}}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&function(e,t){let i=e.getBoundingClientRect(),r=t.getBoundingClientRect();r.top<i.top?e.scrollTop-=i.top-r.top:r.bottom>i.bottom&&(e.scrollTop+=r.bottom-i.bottom)}(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect();if(t.top>innerHeight-10||t.bottom<10)return null;let r=Math.max(0,Math.min(e.getBoundingClientRect().top,innerHeight-i.height))-t.top,n=this.view.textDirection==Ba.RTL,s=t.left,o=innerWidth-t.right;return n&&s<Math.min(i.width,o)?n=!1:!n&&o<Math.min(i.width,s)&&(n=!0),{top:r,left:n}}positionInfo(e){this.info&&(this.info.style.top=(e?e.top:-1e6)+"px",e&&(this.info.classList.toggle("cm-completionInfo-left",e.left),this.info.classList.toggle("cm-completionInfo-right",!e.left)))}createListBox(e,t,i){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox");for(let n=i.from;n<i.to;n++){let{completion:i,match:s}=e[n];const o=r.appendChild(document.createElement("li"));o.id=t+"-"+n,o.setAttribute("role","option");let a=this.optionClass(i);a&&(o.className=a);for(let e of this.optionContent){let t=e(i,this.view.state,s);t&&o.appendChild(t)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}}function Sm(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}class Cm{constructor(e,t,i,r,n){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=r,this.selected=n}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Cm(this.options,Em(t,e),this.tooltip,this.timestamp,e)}static build(e,t,i,r,n){let s=function(e,t){let i=[],r=0;for(let n of e)if(n.hasResult())if(!1===n.result.filter)for(let e of n.result.options)i.push(new fm(e,n,[1e9-r++]));else{let e,r=new ym(t.sliceDoc(n.from,n.to));for(let t of n.result.options)(e=r.match(t.label))&&(null!=t.boost&&(e[0]+=t.boost),i.push(new fm(t,n,e)))}i.sort(Tm);let n=[],s=null;for(let e of i.sort(Tm)){if(300==n.length)break;s&&s.label==e.completion.label&&s.detail==e.completion.detail&&s.type==e.completion.type&&s.apply==e.completion.apply?Sm(e.completion)>Sm(s)&&(n[n.length-1]=e):n.push(e),s=e.completion}return n}(e,t);if(!s.length)return null;let o=0;if(r&&r.selected){let e=r.options[r.selected].completion;for(let t=0;t<s.length&&!o;t++)s[t].completion==e&&(o=t)}return new Cm(s,Em(i,o),{pos:e.reduce(((e,t)=>t.hasResult()?Math.min(e,t.from):e),1e8),create:(a=Qm,e=>new wm(e,a)),above:n.aboveCursor},r?r.timestamp:Date.now(),o);var a}map(e){return new Cm(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class km{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new km(Am,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,i=t.facet(bm),r=(i.override||t.languageDataAt("autocomplete",dm(t)).map(vm)).map((t=>(this.active.find((e=>e.source==t))||new Lm(t,this.active.some((e=>0!=e.state))?1:0)).update(e,i)));r.length==this.active.length&&r.every(((e,t)=>e==this.active[t]))&&(r=this.active);let n=e.selection||r.some((t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to)))||!function(e,t){if(e==t)return!0;for(let i=0,r=0;;){for(;i<e.length&&!e[i].hasResult;)i++;for(;r<t.length&&!t[r].hasResult;)r++;let n=i==e.length,s=r==t.length;if(n||s)return n==s;if(e[i++].result!=t[r++].result)return!1}}(r,this.active)?Cm.build(r,t,this.id,this.open,i):this.open&&e.docChanged?this.open.map(e.changes):this.open;!n&&r.every((e=>1!=e.state))&&r.some((e=>e.hasResult()))&&(r=r.map((e=>e.hasResult()?new Lm(e.source,0):e)));for(let t of e.effects)t.is(Im)&&(n=n&&n.setSelected(t.value,this.id));return r==this.active&&n==this.open?this:new km(r,this.id,n)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:xm}}const xm={"aria-autocomplete":"list","aria-expanded":"false"};function Em(e,t){return{"aria-autocomplete":"list","aria-expanded":"true","aria-activedescendant":e+"-"+t,"aria-controls":e}}const Am=[];function Tm(e,t){return t.match[0]-e.match[0]||e.completion.label.localeCompare(t.completion.label)}function Pm(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}class Lm{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=Pm(e),r=this;i?r=r.handleUserEvent(e,i,t):e.docChanged?r=r.handleChange(e):e.selection&&0!=r.state&&(r=new Lm(r.source,0));for(let t of e.effects)if(t.is(Mm))r=new Lm(r.source,1,t.value?dm(e.state):-1);else if(t.is(Dm))r=new Lm(r.source,0);else if(t.is(Bm))for(let e of t.value)e.source==r.source&&(r=e);return r}handleUserEvent(e,t,i){return"delete"!=t&&i.activateOnTyping?new Lm(this.source,1):this.map(e.changes)}handleChange(e){return e.changes.touchesRange(dm(e.startState))?new Lm(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new Lm(this.source,this.state,e.mapPos(this.explicitPos))}}class Rm extends Lm{constructor(e,t,i,r,n,s){super(e,2,t),this.result=i,this.from=r,this.to=n,this.span=s}hasResult(){return!0}handleUserEvent(e,t,i){let r=e.changes.mapPos(this.from),n=e.changes.mapPos(this.to,1),s=dm(e.state);if((this.explicitPos>-1?s<r:s<=r)||s>n)return new Lm(this.source,"input"==t&&i.activateOnTyping?1:0);let o=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return this.span&&(r==n||this.span.test(e.state.sliceDoc(r,n)))?new Rm(this.source,o,this.result,r,n,this.span):new Lm(this.source,1,o)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new Lm(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Rm(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1),this.span)}}const Mm=ls.define(),Dm=ls.define(),Bm=ls.define({map:(e,t)=>e.map((e=>e.map(t)))}),Im=ls.define(),Qm=Fn.define({create:()=>km.start(),update:(e,t)=>e.update(t),provide:e=>[rm.from(e,(e=>e.tooltip)),bh.contentAttributes.from(e,(e=>e.attrs))]});function $m(e,t="option"){return i=>{let r=i.state.field(Qm,!1);if(!r||!r.open||Date.now()-r.open.timestamp<75)return!1;let n,s=1;"page"==t&&(n=i.dom.querySelector(".cm-tooltip-autocomplete"))&&(s=Math.max(2,Math.floor(n.offsetHeight/n.firstChild.offsetHeight)));let o=r.open.selected+s*(e?1:-1),{length:a}=r.open.options;return o<0?o="page"==t?0:a-1:o>=a&&(o="page"==t?a-1:0),i.dispatch({effects:Im.of(o)}),!0}}class Hm{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const Wm=xa.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let t of e.state.field(Qm).active)1==t.state&&this.startQuery(t)}update(e){let t=e.state.field(Qm);if(!e.selectionSet&&!e.docChanged&&e.startState.field(Qm)==t)return;let i=e.transactions.some((e=>(e.selection||e.docChanged)&&!Pm(e)));for(let t=0;t<this.running.length;t++){let r=this.running[t];if(i||r.updates.length+e.transactions.length>50&&r.time-Date.now()>1e3){for(let e of r.context.abortListeners)try{e()}catch(e){ba(this.view.state,e)}r.context.abortListeners=null,this.running.splice(t--,1)}else r.updates.push(...e.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=t.active.some((e=>1==e.state&&!this.running.some((t=>t.active.source==e.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let t of e.transactions)"input"==Pm(t)?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:e}=this.view,t=e.field(Qm);for(let e of t.active)1!=e.state||this.running.some((t=>t.active.source==e.source))||this.startQuery(e)}startQuery(e){let{state:t}=this.view,i=dm(t),r=new cm(t,i,e.explicitPos==i),n=new Hm(e,r);this.running.push(n),Promise.resolve(e.source(r)).then((e=>{n.context.aborted||(n.done=e||null,this.scheduleAccept())}),(e=>{this.view.dispatch({effects:Dm.of(null)}),ba(this.view.state,e)}))}scheduleAccept(){this.running.every((e=>void 0!==e.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),50))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],i=this.view.state.facet(bm);for(let r=0;r<this.running.length;r++){let n=this.running[r];if(void 0===n.done)continue;if(this.running.splice(r--,1),n.done){let r=new Rm(n.active.source,n.active.explicitPos,n.done,n.done.from,null!==(e=n.done.to)&&void 0!==e?e:dm(n.updates.length?n.updates[0].startState:this.view.state),n.done.span&&!1!==n.done.filter?pm(n.done.span,!0):null);for(let e of n.updates)r=r.update(e,i);if(r.hasResult()){t.push(r);continue}}let s=this.view.state.field(Qm).active.find((e=>e.source==n.active.source));if(s&&1==s.state)if(null==n.done){let e=new Lm(n.active.source,0);for(let t of n.updates)e=e.update(t,i);1!=e.state&&t.push(e)}else this.startQuery(s)}t.length&&this.view.dispatch({effects:Bm.of(t)})}},{eventHandlers:{compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:Mm.of(!1)})),20),this.composing=0}}}),Nm=bh.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#39e",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});function Fm(e={}){return[Qm,bm.of(e),Wm,Um,Nm]}const jm=[{key:"Ctrl-Space",run:e=>!!e.state.field(Qm,!1)&&(e.dispatch({effects:Mm.of(!0)}),!0)},{key:"Escape",run:e=>{let t=e.state.field(Qm,!1);return!(!t||!t.active.some((e=>0!=e.state))||(e.dispatch({effects:Dm.of(null)}),0))}},{key:"ArrowDown",run:$m(!0)},{key:"ArrowUp",run:$m(!1)},{key:"PageDown",run:$m(!0,"page")},{key:"PageUp",run:$m(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(Qm,!1);return!(e.state.readOnly||!t||!t.open||Date.now()-t.open.timestamp<75||(mm(e,t.open.options[t.open.selected]),0))}}],Um=Un.highest(Lh.computeN([bm],(e=>e.facet(bm).defaultKeymap?[jm]:[])));function qm(e,t){return({state:i,dispatch:r})=>{let n=e(t,i.selection.ranges,i);return!!n&&(r(i.update(n)),!0)}}const Xm=qm(Zm,0),zm=qm(Gm,0),Vm=[{key:"Mod-/",run:e=>{let t=Ym(e.state);return t.line?Xm(e):!!t.block&&zm(e)}},{key:"Alt-A",run:zm}];function Ym(e,t=e.selection.main.head){let i=e.languageDataAt("commentTokens",t);return i.length?i[0]:{}}function Gm(e,t,i){let r=t.map((e=>Ym(i,e.from).block));if(!r.every((e=>e)))return null;let n=t.map(((e,t)=>function(e,{open:t,close:i},r,n){let s,o,a=e.sliceDoc(r-50,r),l=e.sliceDoc(n,n+50),h=/\s*$/.exec(a)[0].length,c=/^\s*/.exec(l)[0].length,u=a.length-h;if(a.slice(u-t.length,u)==t&&l.slice(c,c+i.length)==i)return{open:{pos:r-h,margin:h&&1},close:{pos:n+c,margin:c&&1}};n-r<=100?s=o=e.sliceDoc(r,n):(s=e.sliceDoc(r,r+50),o=e.sliceDoc(n-50,n));let f=/^\s*/.exec(s)[0].length,d=/\s*$/.exec(o)[0].length,p=o.length-d-i.length;return s.slice(f,f+t.length)==t&&o.slice(p,p+i.length)==i?{open:{pos:r+f+t.length,margin:/\s/.test(s.charAt(f+t.length))?1:0},close:{pos:n-d-i.length,margin:/\s/.test(o.charAt(p-1))?1:0}}:null}(i,r[t],e.from,e.to)));if(2!=e&&!n.every((e=>e))){let e=0;return i.changeByRange((t=>{let{open:i,close:s}=r[e++];if(n[e])return{range:t};let o=i.length+1;return{changes:[{from:t.from,insert:i+" "},{from:t.to,insert:" "+s}],range:Mn.range(t.anchor+o,t.head+o)}}))}if(1!=e&&n.some((e=>e))){let e=[];for(let t,i=0;i<n.length;i++)if(t=n[i]){let n=r[i],{open:s,close:o}=t;e.push({from:s.pos-n.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+n.close.length})}return{changes:e}}return null}function Zm(e,t,i){let r=[],n=-1;for(let{from:e,to:s}of t){let t=r.length,o=1e9;for(let t=e;t<=s;){let a=i.doc.lineAt(t);if(a.from>n&&(e==s||s>a.from)){n=a.from;let e=Ym(i,t).line;if(!e)continue;let s=/^\s*/.exec(a.text)[0].length,l=s==a.length,h=a.text.slice(s,s+e.length)==e?s:-1;s<a.text.length&&s<o&&(o=s),r.push({line:a,comment:h,token:e,indent:s,empty:l,single:!1})}t=a.to+1}if(o<1e9)for(let e=t;e<r.length;e++)r[e].indent<r[e].line.text.length&&(r[e].indent=o);r.length==t+1&&(r[t].single=!0)}if(2!=e&&r.some((e=>e.comment<0&&(!e.empty||e.single)))){let e=[];for(let{line:t,token:i,indent:n,empty:s,single:o}of r)!o&&s||e.push({from:t.from+n,insert:i+" "});let t=i.changes(e);return{changes:t,selection:i.selection.map(t,1)}}if(1!=e&&r.some((e=>e.comment>=0))){let e=[];for(let{line:t,comment:i,token:n}of r)if(i>=0){let r=t.from+i,s=r+n.length;" "==t.text[s-t.from]&&s++,e.push({from:r,to:s})}return{changes:e}}return null}const Km=2e3;function Jm(e,t){let i=e.posAtCoords({x:t.clientX,y:t.clientY},!1),r=e.state.doc.lineAt(i),n=i-r.from,s=n>Km?-1:n==r.length?function(e,t){let i=e.coordsAtPos(e.viewport.from);return i?Math.round(Math.abs((i.left-t)/e.defaultCharacterWidth)):-1}(e,t.clientX):un(r.text,e.state.tabSize,i-r.from);return{line:r.number,col:s,off:n}}function e_(e){let t=(null==e?void 0:e.eventFilter)||(e=>e.altKey&&0==e.button);return bh.mouseSelectionStyle.of(((e,i)=>t(i)?function(e,t){let i=Jm(e,t),r=e.state.selection;return i?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(i.line).from),n=e.state.doc.lineAt(t);i={line:n.number,col:i.col,off:Math.min(i.off,n.length)},r=r.map(e.changes)}},get(t,n,s){let o=Jm(e,t);if(!o)return r;let a=function(e,t,i){let r=Math.min(t.line,i.line),n=Math.max(t.line,i.line),s=[];if(t.off>Km||i.off>Km||t.col<0||i.col<0){let o=Math.min(t.off,i.off),a=Math.max(t.off,i.off);for(let t=r;t<=n;t++){let i=e.doc.line(t);i.length<=a&&s.push(Mn.range(i.from+o,i.to+a))}}else{let o=Math.min(t.col,i.col),a=Math.max(t.col,i.col);for(let t=r;t<=n;t++){let i=e.doc.line(t),r=fn(i.text,o,e.tabSize,!0);if(r>-1){let t=fn(i.text,a,e.tabSize);s.push(Mn.range(i.from+r,i.from+t))}}}return s}(e.state,i,o);return a.length?s?Mn.create(a.concat(r.ranges)):Mn.create(a):r}}:null}(e,i):null))}let t_=0;class i_{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=t_++}static define(e){if(null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new i_([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new n_;return t=>t.modified.indexOf(e)>-1?t:n_.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}}let r_=0;class n_{constructor(){this.instances=[],this.id=r_++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find((i=>{return i.base==e&&(r=t,n=i.modified,r.length==n.length&&r.every(((e,t)=>e==n[t])));var r,n}));if(i)return i;let r=[],n=new i_(r,e,t);for(let e of t)e.instances.push(n);let s=s_(t);for(let t of e.set)for(let e of s)r.push(n_.get(t,e));return n}}function s_(e){let t=[e];for(let i=0;i<e.length;i++)for(let r of s_(e.slice(0,i).concat(e.slice(i+1))))t.push(r);return t}function o_(e){let t=Object.create(null);for(let i in e){let r=e[i];Array.isArray(r)||(r=[r]);for(let e of i.split(" "))if(e){let i=[],n=2,s=e;for(let t=0;;){if("..."==s&&t>0&&t+3==e.length){n=1;break}let r=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!r)throw new RangeError("Invalid path: "+e);if(i.push("*"==r[0]?null:'"'==r[0][0]?JSON.parse(r[0]):r[0]),t+=r[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){n=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);s=e.slice(t)}let o=i.length-1,a=i[o];if(!a)throw new RangeError("Invalid path: "+e);let l=new u_(r,n,o>0?i.slice(0,o):null);t[a]=l.sort(t[a])}}return a_.add(t)}const a_=new xu,l_=Qn.define({combine:e=>e.length?f_.combinedMatch(e):null}),h_=Qn.define({combine:e=>e.length?e[0].match:null});function c_(e){return e.facet(l_)||e.facet(h_)}class u_{constructor(e,t,i,r){this.tags=e,this.mode=t,this.context=i,this.next=r}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}class f_{constructor(e,t){let i;function r(e){let t=Cs.newName();return(i||(i=Object.create(null)))["."+t]=e,t}this.map=Object.create(null),this.all="string"==typeof t.all?t.all:t.all?r(t.all):null;for(let t of e){let e=(t.class||r(Object.assign({},t,{tag:null})))+(this.all?" "+this.all:""),i=t.tag;if(Array.isArray(i))for(let t of i)this.map[t.id]=e;else this.map[i.id]=e}this.module=i?new Cs(i):null,this.scope=t.scope||null,this.match=this.match.bind(this);let n=[p_];this.module&&n.push(bh.styleModule.of(this.module)),this.extension=n.concat(l_.of(this)),this.fallback=n.concat(h_.of(this))}match(e,t){if(this.scope&&t!=this.scope)return null;for(let t of e.set){let i=this.map[t.id];if(void 0!==i)return t!=e&&(this.map[e.id]=i),i}return this.map[e.id]=this.all}static combinedMatch(e){if(1==e.length)return e[0].match;let t=e.some((e=>e.scope))?void 0:Object.create(null);return(i,r)=>{let n=t&&t[i.id];if(void 0!==n)return n;let s=null;for(let t of e){let e=t.match(i,r);e&&(s=s?s+" "+e:e)}return t&&(t[i.id]=s),s}}static define(e,t){return new f_(e,t||{})}static get(e,t,i){let r=c_(e);return r&&r(t,i||Au.none)}}class d_{constructor(e){this.markCache=Object.create(null),this.tree=ef(e.state),this.decorations=this.buildDeco(e,c_(e.state))}update(e){let t=ef(e.state),i=c_(e.state),r=i!=e.startState.facet(l_);t.length<e.view.viewport.to&&!r&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i))}buildDeco(e,t){if(!t||!this.tree.length)return Ko.none;let i=new Rs;for(let{from:r,to:n}of e.visibleRanges)__(this.tree,r,n,t,((e,t,r)=>{i.add(e,t,this.markCache[r]||(this.markCache[r]=Ko.mark({class:r})))}));return i.finish()}}const p_=Un.extend(xa.fromClass(d_,{decorations:e=>e.decorations})),g_=[""];class m_{constructor(e,t,i){this.at=e,this.style=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,r,n,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=t)return;g_[n]=o.name,o.isTop&&(s=o);let h=r,c=o.prop(a_),u=!1;for(;c;){if(!c.context||v_(c.context,g_,n)){for(let e of c.tags){let t=this.style(e,s);t&&(h&&(h+=" "),h+=t,1==c.mode?r+=(r?" ":"")+t:0==c.mode&&(u=!0))}break}c=c.next}if(this.startSpan(e.from,h),u)return;let f=e.tree&&e.tree.prop(xu.mounted);if(f&&f.overlay){let o=e.node.enter(f.overlay[0].from+a,1),c=e.firstChild();for(let u=0,d=a;;u++){let p=u<f.overlay.length?f.overlay[u]:null,g=p?p.from+a:l,m=Math.max(t,d),_=Math.min(i,g);if(m<_&&c)for(;e.from<_&&(this.highlightRange(e,m,_,r,n+1,s),this.startSpan(Math.min(i,e.to),h),!(e.to>=g)&&e.nextSibling()););if(!p||g>i)break;d=p.to+a,d>t&&(this.highlightRange(o.cursor,Math.max(t,p.from+a),Math.min(i,d),r,n,f.tree.type),this.startSpan(d,h))}c&&e.parent()}else if(e.firstChild()){do{if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,r,n+1,s),this.startSpan(Math.min(i,e.to),h)}}while(e.nextSibling());e.parent()}}}function __(e,t,i,r,n){let s=new m_(t,r,n);s.highlightRange(e.cursor(),t,i,"",0,e.type),s.flush(i)}function v_(e,t,i){if(e.length>i-1)return!1;for(let r=i-1,n=e.length-1;n>=0;n--,r--){let i=e[n];if(i&&i!=t[r])return!1}return!0}const y_=i_.define,b_=y_(),O_=y_(),w_=y_(O_),S_=y_(O_),C_=y_(),k_=y_(C_),x_=y_(C_),E_=y_(),A_=y_(E_),T_=y_(),P_=y_(),L_=y_(),R_=y_(L_),M_=y_(),D_={comment:b_,lineComment:y_(b_),blockComment:y_(b_),docComment:y_(b_),name:O_,variableName:y_(O_),typeName:w_,tagName:y_(w_),propertyName:S_,attributeName:y_(S_),className:y_(O_),labelName:y_(O_),namespace:y_(O_),macroName:y_(O_),literal:C_,string:k_,docString:y_(k_),character:y_(k_),attributeValue:y_(k_),number:x_,integer:y_(x_),float:y_(x_),bool:y_(C_),regexp:y_(C_),escape:y_(C_),color:y_(C_),url:y_(C_),keyword:T_,self:y_(T_),null:y_(T_),atom:y_(T_),unit:y_(T_),modifier:y_(T_),operatorKeyword:y_(T_),controlKeyword:y_(T_),definitionKeyword:y_(T_),operator:P_,derefOperator:y_(P_),arithmeticOperator:y_(P_),logicOperator:y_(P_),bitwiseOperator:y_(P_),compareOperator:y_(P_),updateOperator:y_(P_),definitionOperator:y_(P_),typeOperator:y_(P_),controlOperator:y_(P_),punctuation:L_,separator:y_(L_),bracket:R_,angleBracket:y_(R_),squareBracket:y_(R_),paren:y_(R_),brace:y_(R_),content:E_,heading:A_,heading1:y_(A_),heading2:y_(A_),heading3:y_(A_),heading4:y_(A_),heading5:y_(A_),heading6:y_(A_),contentSeparator:y_(E_),list:y_(E_),quote:y_(E_),emphasis:y_(E_),strong:y_(E_),link:y_(E_),monospace:y_(E_),strikethrough:y_(E_),inserted:y_(),deleted:y_(),changed:y_(),invalid:y_(),meta:M_,documentMeta:y_(M_),annotation:y_(M_),processingInstruction:y_(M_),definition:i_.defineModifier(),constant:i_.defineModifier(),function:i_.defineModifier(),standard:i_.defineModifier(),local:i_.defineModifier(),special:i_.defineModifier()},B_=f_.define([{tag:D_.link,textDecoration:"underline"},{tag:D_.heading,textDecoration:"underline",fontWeight:"bold"},{tag:D_.emphasis,fontStyle:"italic"},{tag:D_.strong,fontWeight:"bold"},{tag:D_.strikethrough,textDecoration:"line-through"},{tag:D_.keyword,color:"#708"},{tag:[D_.atom,D_.bool,D_.url,D_.contentSeparator,D_.labelName],color:"#219"},{tag:[D_.literal,D_.inserted],color:"#164"},{tag:[D_.string,D_.deleted],color:"#a11"},{tag:[D_.regexp,D_.escape,D_.special(D_.string)],color:"#e40"},{tag:D_.definition(D_.variableName),color:"#00f"},{tag:D_.local(D_.variableName),color:"#30a"},{tag:[D_.typeName,D_.namespace],color:"#085"},{tag:D_.className,color:"#167"},{tag:[D_.special(D_.variableName),D_.macroName],color:"#256"},{tag:D_.definition(D_.propertyName),color:"#00c"},{tag:D_.comment,color:"#940"},{tag:D_.meta,color:"#7a757a"},{tag:D_.invalid,color:"#f00"}]);class I_{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class Q_{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let r=Ko.set(e.map((e=>e.from==e.to||e.from==e.to-1&&i.doc.lineAt(e.from).to==e.from?Ko.widget({widget:new G_(e),diagnostic:e}).range(e.from):Ko.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity},diagnostic:e}).range(e.from,e.to))),!0);return new Q_(r,t,$_(r))}}function $_(e,t=null,i=0){let r=null;return e.between(i,1e9,((e,i,{spec:n})=>{if(!t||n.diagnostic==t)return r=new I_(e,i,n.diagnostic),!1})),r}const H_=ls.define(),W_=ls.define(),N_=ls.define(),F_=Fn.define({create:()=>new Q_(Ko.none,null,null),update(e,t){if(t.docChanged){let i=e.diagnostics.map(t.changes),r=null;if(e.selected){let n=t.changes.mapPos(e.selected.from,1);r=$_(i,e.selected.diagnostic,n)||$_(i,null,n)}e=new Q_(i,e.panel,r)}for(let i of t.effects)i.is(H_)?e=Q_.init(i.value,e.panel,t.state):i.is(W_)?e=new Q_(e.diagnostics,i.value?K_.open:null,e.selected):i.is(N_)&&(e=new Q_(e.diagnostics,e.panel,i.value));return e},provide:e=>[Kp.from(e,(e=>e.panel)),bh.decorations.from(e,(e=>e.diagnostics))]}),j_=Ko.mark({class:"cm-lintRange cm-lintRange-active"});function U_(e,t,i){let{diagnostics:r}=e.state.field(F_),n=[],s=2e8,o=0;return r.between(t-(i<0?1:0),t+(i>0?1:0),((e,r,{spec:a})=>{t>=e&&t<=r&&(e==r||(t>e||i>0)&&(t<r||i<0))&&(n.push(a.diagnostic),s=Math.min(e,s),o=Math.max(r,o))})),n.length?{pos:s,end:o,above:e.state.doc.lineAt(s).to<o,create:()=>({dom:q_(e,n)})}:null}function q_(e,t){return Jp("ul",{class:"cm-tooltip-lint"},t.map((t=>Y_(e,t,!1))))}const X_=e=>{let t=e.state.field(F_,!1);return!(!t||!t.panel||(e.dispatch({effects:W_.of(!1)}),0))},z_=[{key:"Mod-Shift-m",run:e=>{let t=e.state.field(F_,!1);var i,r;t&&t.panel||e.dispatch({effects:(i=e.state,r=[W_.of(!0)],i.field(F_,!1)?r:r.concat(ls.appendConfig.of([F_,bh.decorations.compute([F_],(e=>{let{selected:t,panel:i}=e.field(F_);return t&&i&&t.from!=t.to?Ko.set([j_.range(t.from,t.to)]):Ko.none})),lm(U_),ev])))});let n=zp(e,K_.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0}},{key:"F8",run:e=>{let t=e.state.field(F_,!1);if(!t)return!1;let i=e.state.selection.main,r=t.diagnostics.iter(i.to+1);return!(!r.value&&(r=t.diagnostics.iter(0),!r.value||r.from==i.from&&r.to==i.to)||(e.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),0))}}];function V_(e){let t=[];if(e)e:for(let{name:i}of e){for(let e=0;e<i.length;e++){let r=i[e];if(/[a-zA-Z]/.test(r)&&!t.some((e=>e.toLowerCase()==r.toLowerCase()))){t.push(r);continue e}}t.push("")}return t}function Y_(e,t,i){var r;let n=i?V_(t.actions):[];return Jp("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},Jp("span",{class:"cm-diagnosticText"},t.message),null===(r=t.actions)||void 0===r?void 0:r.map(((i,r)=>{let s=r=>{r.preventDefault();let n=$_(e.state.field(F_).diagnostics,t);n&&i.apply(e,n.from,n.to)},{name:o}=i,a=n[r]?o.indexOf(n[r]):-1,l=a<0?o:[o.slice(0,a),Jp("u",o.slice(a,a+1)),o.slice(a+1)];return Jp("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":` Action: ${o}${a<0?"":` (access key "${n[r]})"`}.`},l)})),t.source&&Jp("div",{class:"cm-diagnosticSource"},t.source))}class G_ extends Go{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Jp("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Z_{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=Y_(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class K_{constructor(e){this.view=e,this.items=[],this.list=Jp("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)X_(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:i}=this.items[this.selectedIndex],r=V_(i.actions);for(let n=0;n<r.length;n++)if(r[n].toUpperCase().charCodeAt(0)==t.keyCode){let t=$_(this.view.state.field(F_).diagnostics,i);t&&i.actions[n].apply(e,t.from,t.to)}}}t.preventDefault()},onclick:e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)}}),this.dom=Jp("div",{class:"cm-panel-lint"},this.list,Jp("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>X_(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(F_).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(F_),i=0,r=!1,n=null;for(e.between(0,this.view.state.doc.length,((e,s,{spec:o})=>{let a,l=-1;for(let e=i;e<this.items.length;e++)if(this.items[e].diagnostic==o.diagnostic){l=e;break}l<0?(a=new Z_(this.view,o.diagnostic),this.items.splice(i,0,a),r=!0):(a=this.items[l],l>i&&(this.items.splice(i,l-i),r=!0)),t&&a.diagnostic==t.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),n=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),i++}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();0==this.items.length&&(this.items.push(new Z_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),n?(this.list.setAttribute("aria-activedescendant",n.id),this.view.requestMeasure({key:this,read:()=>({sel:n.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{e.top<t.top?this.list.scrollTop-=t.top-e.top:e.bottom>t.bottom&&(this.list.scrollTop+=e.bottom-t.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=$_(this.view.state.field(F_).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:N_.of(t)})}static open(e){return new K_(e)}}function J_(e){return function(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const ev=bh.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:J_("#d11")},".cm-lintRange-warning":{backgroundImage:J_("orange")},".cm-lintRange-info":{backgroundImage:J_("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),tv=[Xf(),Gf(),nc(),au(),dd(),$h(),Gh(),ys.allowMultipleSelections.of(!0),Sf(),B_.fallback,wd(),Dp(),Fm(),e_(),lc(),gg(),Lh.of([...Hp,...Ep,...Fg,...wu,...od,...Vm,...jm,...z_])];class iv{constructor(e,t,i,r,n,s,o,a,l,h=0,c){this.p=e,this.stack=t,this.state=i,this.reducePos=r,this.pos=n,this.score=s,this.buffer=o,this.bufferBase=a,this.curContext=l,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let r=e.parser.context;return new iv(e,[],t,i,i,0,[],0,r?new rv(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){let t=e>>19,i=65535&e,{parser:r}=this.p,n=r.dynamicPrecedence(i);if(n&&(this.score+=n),0==t)return i<r.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),this.pushState(r.getGoto(this.state,i,!0),this.reducePos),void this.reduceContext(i,this.reducePos);let s=this.stack.length-3*(t-1)-(262144&e?6:0),o=this.stack[s-2],a=this.stack[s-1],l=this.bufferBase+this.buffer.length-a;if(i<r.minRepeatTerm||131072&e){let e=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,o,e,l+4,!0)}if(262144&e)this.state=this.stack[s];else{let e=this.stack[s-3];this.state=r.getGoto(e,i,!0)}for(;this.stack.length>s;)this.stack.pop();this.reduceContext(i,o)}storeNode(e,t,i,r=4,n=!1){if(0==e){let e=this,r=this.buffer.length;if(0==r&&e.parent&&(r=e.bufferBase-e.parent.bufferBase,e=e.parent),r>0&&0==e.buffer[r-4]&&e.buffer[r-1]>-1){if(t==i)return;if(e.buffer[r-2]>=t)return void(e.buffer[r-2]=i)}}if(n&&this.pos!=i){let n=this.buffer.length;if(n>0&&0!=this.buffer[n-4])for(;n>0&&this.buffer[n-2]>i;)this.buffer[n]=this.buffer[n-4],this.buffer[n+1]=this.buffer[n-3],this.buffer[n+2]=this.buffer[n-2],this.buffer[n+3]=this.buffer[n-1],n-=4,r>4&&(r-=4);this.buffer[n]=e,this.buffer[n+1]=t,this.buffer[n+2]=i,this.buffer[n+3]=r}else this.buffer.push(e,t,i,r)}shift(e,t,i){let r=this.pos;if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let n=e,{parser:s}=this.p;(i>this.pos||t<=s.maxNode)&&(this.pos=i,s.stateFlag(n,1)||(this.reducePos=i)),this.pushState(n,r),this.shiftContext(t,r),t<=s.maxNode&&this.buffer.push(t,r,i,4)}else this.pos=i,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,i,4)}apply(e,t,i){65536&e?this.reduce(e):this.shift(e,t,i)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(i,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new iv(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new sv(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==(65536&i))return!0;if(0==i)return!1;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let r,n=0;n<t.length;n+=2)(r=t[n+1])!=this.state&&this.p.parser.hasAction(r,e)&&i.push(t[n],r);if(this.stack.length<120)for(let e=0;i.length<8&&e<t.length;e+=2){let r=t[e+1];i.some(((e,t)=>1&t&&e==r))||i.push(t[e],r)}t=i}let i=[];for(let e=0;e<t.length&&i.length<4;e+=2){let r=t[e+1];if(r==this.state)continue;let n=this.split();n.storeNode(0,n.pos,n.pos,4,!0),n.pushState(r,this.pos),n.shiftContext(t[e],this.pos),n.score-=200,i.push(n)}return i}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(0==(65536&e))return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let i=e>>19,r=65535&e,n=this.stack.length-3*i;if(n<0||t.getGoto(this.stack[n],r,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new rv(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class rv{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}var nv;!function(e){e[e.Insert=200]="Insert",e[e.Delete=190]="Delete",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(nv||(nv={}));class sv{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,i=e>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class ov{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new ov(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new ov(this.stack,this.pos,this.index)}}class av{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const lv=new av;class hv{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=lv,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,r=this.rangeIndex,n=this.pos+e;for(;n<i.from;){if(!r)return null;let e=this.ranges[--r];n-=i.from-e.to,i=e}for(;t<0?n>i.to:n>=i.to;){if(r==this.ranges.length-1)return null;let e=this.ranges[++r];n+=e.from-i.to,i=e}return n}peek(e){let t,i,r=this.chunkOff+e;if(r>=0&&r<this.chunk.length)t=this.pos+e,i=this.chunk.charCodeAt(r);else{let r=this.resolveOffset(e,1);if(null==r)return-1;if(t=r,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,r=this.range;for(;r.to<=t;)r=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>r.to&&(this.chunk2=this.chunk2.slice(0,r.to-t)),i=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),i}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=lv,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(i+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return i}}class cv{constructor(e,t){this.data=e,this.id=t}token(e,t){!function(e,t,i,r){let n=0,s=1<<r,{parser:o}=i.p,{dialect:a}=o;e:for(;0!=(s&e[n]);){let i=e[n+1];for(let r=n+3;r<i;r+=2)if((e[r+1]&s)>0){let i=e[r];if(a.allows(i)&&(-1==t.token.value||t.token.value==i||o.overrides(i,t.token.value))){t.acceptToken(i);break}}for(let r=t.next,s=0,o=e[n+2];s<o;){let a=s+o>>1,l=i+a+(a<<1),h=e[l],c=e[l+1];if(r<h)o=a;else{if(!(r>=c)){n=e[l+2],t.advance();continue e}s=a+1}}break}}(this.data,e,t,this.id)}}function uv(e,t=Uint16Array){if("string"!=typeof e)return e;let i=null;for(let r=0,n=0;r<e.length;){let s=0;for(;;){let t=e.charCodeAt(r++),i=!1;if(126==t){s=65535;break}t>=92&&t--,t>=34&&t--;let n=t-32;if(n>=46&&(n-=46,i=!0),s+=n,i)break;s*=46}i?i[n++]=s:i=new t(s)}return i}cv.prototype.contextual=cv.prototype.fallback=cv.prototype.extend=!1;const fv="undefined"!=typeof process&&/\bparse\b/.test(process.env.LOG);let dv=null;var pv,gv;function mv(e,t,i){let r=e.fullCursor();for(r.moveTo(t);;)if(!(i<0?r.childBefore(t):r.childAfter(t)))for(;;){if((i<0?r.to<t:r.from>t)&&!r.type.isError)return i<0?Math.max(0,Math.min(r.to-1,t-25)):Math.min(e.length,Math.max(r.from+1,t+25));if(i<0?r.prevSibling():r.nextSibling())break;if(!r.parent())return i<0?0:e.length}}!function(e){e[e.Margin=25]="Margin"}(pv||(pv={}));class _v{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?mv(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?mv(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],r=this.index[t];if(r==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let n=i.children[r],s=this.start[t]+i.positions[r];if(s>e)return this.nextStart=s,null;if(n instanceof Ru){if(s==e){if(s<this.safeFrom)return null;let e=s+n.length;if(e<=this.safeTo){let t=n.prop(xu.lookAhead);if(!t||e+t<this.fragment.to)return n}}this.index[t]++,s+n.length>=Math.max(this.safeFrom,e)&&(this.trees.push(n),this.start.push(s),this.index.push(0))}else this.index[t]++,this.nextStart=s+n.length}}}class vv{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new av))}getActions(e){let t=0,i=null,{parser:r}=e.p,{tokenizers:n}=r,s=r.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,a=0;for(let r=0;r<n.length;r++){if(0==(1<<r&s))continue;let l=n[r],h=this.tokens[r];if((!i||l.fallback)&&((l.contextual||h.start!=e.pos||h.mask!=s||h.context!=o)&&(this.updateCachedToken(h,l,e),h.mask=s,h.context=o),h.lookAhead>h.end+25&&(a=Math.max(h.lookAhead,a)),0!=h.value)){let r=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!l.extend&&(i=h,t>r))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),i||e.pos!=this.stream.end||(i=new av,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new av,{pos:i,p:r}=e;return t.start=i,t.end=Math.min(i+1,r.stream.end),t.value=i==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,i){if(t.token(this.stream.reset(i.pos,e),i),e.value>-1){let{parser:t}=i.p;for(let r=0;r<t.specialized.length;r++)if(t.specialized[r]==e.value){let n=t.specializers[r](this.stream.read(e.start,e.end),i);if(n>=0&&i.p.parser.dialect.allows(n>>1)){0==(1&n)?e.value=n>>1:e.extended=n>>1;break}}}else e.value=0,e.end=Math.min(i.p.stream.end,i.pos+1)}putAction(e,t,i,r){for(let t=0;t<r;t+=3)if(this.actions[t]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=i,r}addActions(e,t,i,r){let{state:n}=e,{parser:s}=e.p,{data:o}=s;for(let e=0;e<2;e++)for(let a=s.stateSlot(n,e?2:1);;a+=3){if(65535==o[a]){if(1!=o[a+1]){0==r&&2==o[a+1]&&(r=this.putAction(Sv(o,a+1),t,i,r));break}a=Sv(o,a+2)}o[a]==t&&(r=this.putAction(Sv(o,a+1),t,i,r))}return r}}!function(e){e[e.Distance=5]="Distance",e[e.MaxRemainingPerStep=3]="MaxRemainingPerStep",e[e.MinBufferLengthPrune=200]="MinBufferLengthPrune",e[e.ForceReduceLimit=10]="ForceReduceLimit"}(gv||(gv={}));class yv{constructor(e,t,i,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new hv(t,r),this.tokens=new vv(e,this.stream),this.topTerm=e.top[1];let{from:n}=r[0];this.stacks=[iv.start(this,e.top[0],n)],this.fragments=i.length&&this.stream.end-n>4*e.bufferLength?new _v(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,i=this.stacks,r=this.minStackPos,n=this.stacks=[];for(let s=0;s<i.length;s++){let o=i[s];for(;;){if(this.tokens.mainToken=null,o.pos>r)n.push(o);else{if(this.advanceStack(o,n,i))continue;{e||(e=[],t=[]),e.push(o);let i=this.tokens.getMainToken(o);t.push(i.value,i.end)}}break}}if(!n.length){let t=e&&function(e){let t=null;for(let i of e){let e=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=e&&i.pos>e)&&i.p.parser.stateFlag(i.state,2)&&(!t||t.score<i.score)&&(t=i)}return t}(e);if(t)return this.stackToTree(t);if(this.parser.strict)throw fv&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5)}if(this.recovering&&e){let i=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,n);if(i)return this.stackToTree(i.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(n.length>e)for(n.sort(((e,t)=>t.score-e.score));n.length>e;)n.pop();n.some((e=>e.reducePos>r))&&this.recovering--}else if(n.length>1)e:for(let e=0;e<n.length-1;e++){let t=n[e];for(let i=e+1;i<n.length;i++){let r=n[i];if(t.sameState(r)||t.buffer.length>200&&r.buffer.length>200){if(!((t.score-r.score||t.buffer.length-r.buffer.length)>0)){n.splice(e--,1);continue e}n.splice(i--,1)}}}this.minStackPos=n[0].pos;for(let e=1;e<n.length;e++)n[e].pos<this.minStackPos&&(this.minStackPos=n[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let r=e.pos,{parser:n}=this,s=fv?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,i=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(r);o;){let r=this.parser.nodeSet.types[o.type.id]==o.type?n.getGoto(e.state,o.type.id):-1;if(r>-1&&o.length&&(!t||(o.prop(xu.contextHash)||0)==i))return e.useNode(o,r),fv&&console.log(s+this.stackID(e)+` (via reuse of ${n.getName(o.type.id)})`),!0;if(!(o instanceof Ru)||0==o.children.length||o.positions[0]>0)break;let a=o.children[0];if(!(a instanceof Ru&&0==o.positions[0]))break;o=a}}let o=n.stateSlot(e.state,4);if(o>0)return e.reduce(o),fv&&console.log(s+this.stackID(e)+` (via always-reduce ${n.getName(65535&o)})`),!0;let a=this.tokens.getActions(e);for(let o=0;o<a.length;){let l=a[o++],h=a[o++],c=a[o++],u=o==a.length||!i,f=u?e:e.split();if(f.apply(l,h,c),fv&&console.log(s+this.stackID(f)+` (via ${0==(65536&l)?"shift":`reduce of ${n.getName(65535&l)}`} for ${n.getName(h)} @ ${r}${f==e?"":", split"})`),u)return!0;f.pos>r?t.push(f):i.push(f)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return bv(e,t),!0}}runRecovery(e,t,i){let r=null,n=!1;for(let s=0;s<e.length;s++){let o=e[s],a=t[s<<1],l=t[1+(s<<1)],h=fv?this.stackID(o)+" -> ":"";if(o.deadEnd){if(n)continue;if(n=!0,o.restart(),fv&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))continue}let c=o.split(),u=h;for(let e=0;c.forceReduce()&&e<10&&(fv&&console.log(u+this.stackID(c)+" (via force-reduce)"),!this.advanceFully(c,i));e++)fv&&(u=this.stackID(c)+" -> ");for(let e of o.recoverByInsert(a))fv&&console.log(h+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,i);this.stream.end>o.pos?(l==o.pos&&(l++,a=0),o.recoverByDelete(a,l),fv&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(a)})`),bv(o,i)):(!r||r.score<o.score)&&(r=o)}return r}stackToTree(e){return e.close(),Ru.build({buffer:ov.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(dv||(dv=new WeakMap)).get(e);return t||dv.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function bv(e,t){for(let i=0;i<t.length;i++){let r=t[i];if(r.pos==e.pos&&r.sameState(e))return void(t[i].score<e.score&&(t[i]=e))}t.push(e)}class Ov{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||0==this.disabled[e]}}class wv extends Vu{constructor(e){if(super(),this.wrappers=[],13!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (13)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let i=0;i<e.repeatNodeCount;i++)t.push("");let i=Object.keys(e.topRules).map((t=>e.topRules[t][1])),r=[];for(let e=0;e<t.length;e++)r.push([]);function n(e,t,i){r[e].push([t,t.deserialize(String(i))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];for(let i=1;i<t.length;){let r=t[i++];if(r>=0)n(r,e,t[i++]);else{let s=t[i+-r];for(let o=-r;o>0;o--)n(t[i++],e,s);i++}}}this.nodeSet=new Tu(t.map(((t,n)=>Au.define({name:n>=this.minRepeatTerm?void 0:t,id:n,props:r[n],top:i.indexOf(n)>-1,error:0==n,skipped:e.skippedNodes&&e.skippedNodes.indexOf(n)>-1})))),this.strict=!1,this.bufferLength=Su;let s=uv(e.tokenData);if(this.context=e.context,this.specialized=new Uint16Array(e.specialized?e.specialized.length:0),this.specializers=[],e.specialized)for(let t=0;t<e.specialized.length;t++)this.specialized[t]=e.specialized[t].term,this.specializers[t]=e.specialized[t].get;this.states=uv(e.states,Uint32Array),this.data=uv(e.stateData),this.goto=uv(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new cv(s,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let r=new yv(this,e,t,i);for(let n of this.wrappers)r=n(r,e,t,i);return r}getGoto(e,t,i=!1){let r=this.goto;if(t>=r[0])return-1;for(let n=r[t+1];;){let t=r[n++],s=1&t,o=r[n++];if(s&&i)return o;for(let i=n+(t>>1);n<i;n++)if(r[n]==e)return o;if(s)return-1}}hasAction(e,t){let i=this.data;for(let r=0;r<2;r++)for(let n,s=this.stateSlot(e,r?2:1);;s+=3){if(65535==(n=i[s])){if(1!=i[s+1]){if(2==i[s+1])return Sv(i,s+2);break}n=i[s=Sv(i,s+2)]}if(n==t||0==n)return Sv(i,s+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let i=this.stateSlot(e,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])return!1;i=Sv(this.data,i+2)}if(t==Sv(this.data,i+1))return!0}}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=Sv(this.data,i+2)}if(0==(1&this.data[i+2])){let e=this.data[i+1];t.some(((t,i)=>1&i&&t==e))||t.push(this.data[i],e)}}return t}overrides(e,t){let i=Cv(this.data,this.tokenPrecTable,t);return i<0||Cv(this.data,this.tokenPrecTable,e)<i}configure(e){let t=Object.assign(Object.create(wv.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let i=e.tokenizers.find((e=>e.from==t));return i?i.to:t}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map((()=>!1));if(e)for(let r of e.split(" ")){let e=t.indexOf(r);e>=0&&(i[e]=!0)}let r=null;for(let e=0;e<t.length;e++)if(!i[e])for(let i,n=this.dialects[t[e]];65535!=(i=this.data[n++]);)(r||(r=new Uint8Array(this.maxTerm+1)))[i]=1;return new Ov(e,i,r)}static deserialize(e){return new wv(e)}}function Sv(e,t){return e[t]|e[t+1]<<16}function Cv(e,t,i){for(let r,n=t;65535!=(r=e[n]);n++)if(r==i)return n-t;return-1}const kv={__proto__:null,true:34,false:34,null:40,void:44,byte:46,short:46,int:46,long:46,char:46,float:46,double:46,boolean:46,extends:60,super:62,class:74,this:76,new:82,public:98,protected:100,private:102,abstract:104,static:106,final:108,strictfp:110,default:112,synchronized:114,native:116,transient:118,volatile:120,throws:148,implements:158,interface:164,enum:174,instanceof:234,open:263,module:265,requires:270,transitive:272,exports:274,to:276,opens:278,uses:280,provides:282,with:284,package:288,import:292,if:304,else:306,while:310,for:314,var:321,assert:328,switch:332,case:338,do:342,break:346,continue:350,return:354,throw:360,try:364,catch:368,finally:376},xv=wv.deserialize({version:13,states:"# rQ]QPOOO&qQQO'#HYO(uQQO'#CbOOQO'#Cb'#CbO(|QPO'#CaOOQO'#H_'#H_OOQO'#Ct'#CtO*iQPO'#D^O+SQQO'#HfOOQO'#Hf'#HfO-hQQO'#HaO-oQQO'#HaOOQO'#Ha'#HaOOQO'#H`'#H`O/pQPO'#DTO/}QPO'#GjO2uQPO'#D^O2|QPO'#DyO(|QPO'#EZO3oQPO'#EZOOQO'#DU'#DUO4}QQO'#H]O7UQQO'#EdO7]QPO'#EcO7bQPO'#EeOOQO'#H^'#H^O5eQQO'#H^O8eQQO'#FfO8lQPO'#EvO8qQPO'#E{O8qQPO'#E}OOQO'#H]'#H]OOQO'#HU'#HUOOQO'#Ge'#GeOOQO'#HT'#HTO:OQPO'#FgOOQO'#HS'#HSOOQO'#Gd'#GdQ]QPOOOOQO'#Hl'#HlO:TQPO'#HlO:YQPO'#DzO:YQPO'#EUO:YQPO'#EPO:bQPO'#HiO:sQQO'#EeO(|QPO'#C`O:{QPO'#C`O(|QPO'#FaO;QQPO'#FcO;]QPO'#FiO;]QPO'#FlO:YQPO'#FqO;bQPO'#FnO8qQPO'#FuO;]QPO'#FwO]QPO'#F|O;gQPO'#GOO;rQPO'#GQO;}QPO'#GSO;]QPO'#GUO8qQPO'#GVO<UQPO'#GXOOQO'#HY'#HYO<uQQO,58{OOQO'#HW'#HWOOQO'#Hb'#HbO?PQPO,59dO@RQPO,59xOOQO-E:c-E:cO(|QPO,58zO@uQPO,58zO(|QPO,5;{O@zQPO'#DPOAPQPO'#DPOOQO'#Gg'#GgOBPQQO,59iOOQO'#Dl'#DlOChQPO'#HnOCrQPO'#DkODQQPO'#HmODYQPO,5<]OD_QPO,59]ODxQPO'#CwOOQO,59b,59bOEPQPO,59aOGXQQO'#HYOIlQQO'#CbOJSQPO'#D^OKXQQO'#HfOKiQQO,59oOKpQPO'#DuOLOQPO'#HuOLWQPO,5:_OL]QPO,5:_OLsQPO,5;lOMOQPO'#H|OMZQPO,5;cOM`QPO,5=UOOQO-E:h-E:hOOQO,5:e,5:eONvQPO,5:eON}QPO,5:uO! SQPO,5<]O(|QPO,5:uO:YQPO,5:fO:YQPO,5:pO:YQPO,5:kO:YQPO,5<]O! sQPO,59pO8qQPO,5:|O! zQPO,5;PO8qQPO,59TO!!YQPO'#DWOOQO,5:},5:}OOQO'#Ek'#EkOOQO'#Em'#EmO8qQPO,5;TO8qQPO,5;TO8qQPO,5;TO8qQPO,5;TO8qQPO,5;TO8qQPO,5;TO8qQPO,5;dOOQO,5;g,5;gOOQO,5<Q,5<QO!!aQPO,5;`O!!rQPO,5;bO!!aQPO'#CxO!!yQQO'#HfO!#XQQO,5;iO]QPO,5<ROOQO-E:b-E:bOOQO,5>W,5>WO!$iQPO,5:fO!$wQPO,5:pO!%PQPO,5:kO!%[QPO,5>TOKpQPO,5>TO! bQPO,59UO!%gQQO,58zO!%oQQO,5;{O!%wQQO,5;}O(|QPO,5;}O8qQPO'#DTO]QPO,5<TO]QPO,5<WO!&PQPO'#FpO]QPO,5<YO]QPO,5<_O!&aQQO,5<aO!&kQPO,5<cO!&pQPO,5<hOOQO'#Fh'#FhOOQO,5<j,5<jO!&uQPO,5<jOOQO,5<l,5<lO!&zQPO,5<lO!'PQQO,5<nOOQO,5<n,5<nO<XQPO,5<pO!'WQQO,5<qO!'_QPO'#GbO!(bQPO,5<sO<XQPO,5<{O(|QPO,58}O!,]QPO'#ChOOQO1G.k1G.kO!,gQPO,59iO!%gQQO1G.fO(|QPO1G.fO!,tQQO1G1gOOQO,59k,59kO!,|QPO,59kOOQO-E:e-E:eO!-RQPO,5>YO!-jQPO,5:VO:YQPO'#GlO!-qQPO,5>XOOQO1G1w1G1wOOQO1G.w1G.wO!.[QPO'#CxO!.zQPO'#HfO!/UQPO'#CyO!/dQPO'#HeO!/lQPO,59cOOQO1G.{1G.{OEPQPO1G.{O!0SQPO,59dO!0aQQO'#HYO!0rQQO'#CbOOQO,5:a,5:aO:YQPO,5:bOOQO,5:`,5:`O!1TQQO,5:`OOQO1G/Z1G/ZO!1YQPO,5:aO!1kQPO'#GoO!2OQPO,5>aOOQO1G/y1G/yO!2WQPO'#DuO!2iQPO'#D^O!2pQPO1G/yO!!aQPO'#GmO!2uQPO1G1WO8qQPO1G1WO:YQPO'#GuO!2}QPO,5>hOOQO1G0}1G0}OOQO1G0P1G0PO!3VQPO'#E[OOQO1G0a1G0aO!3vQPO1G1wON}QPO1G0aO!$iQPO1G0QO!$wQPO1G0[O!%PQPO1G0VOOQO1G/[1G/[O!3{QQO1G.pO7]QPO1G0iO(|QPO1G0iO:bQPO'#HiO!5oQQO1G.pOOQO1G.p1G.pO!5tQQO1G0hOOQO1G0k1G0kO!5{QPO1G0kO!6WQQO1G.oO!6nQQO'#HjO!6{QPO,59rO!8[QQO1G0oO!9sQQO1G0oO!;RQQO1G0oO!;`QQO1G0oO!<eQQO1G0oO!<{QQO1G0oO!=VQQO1G1OO!=^QQO'#HfOOQO1G0z1G0zO!>aQQO1G0|OOQO1G0|1G0|OOQO1G1m1G1mO! VQPO'#DpO!@bQPO'#DZO!!aQPO'#D{O!!aQPO'#D|OOQO1G0Q1G0QO!@iQPO1G0QO!@nQPO1G0QO!@vQPO1G0QO!ARQPO'#EWOOQO1G0[1G0[O!AfQPO1G0[O!AkQPO'#ESO!!aQPO'#EROOQO1G0V1G0VO!BeQPO1G0VO!BjQPO1G0VO!BrQPO'#EgO!ByQPO'#EgOOQO'#Gt'#GtO!CRQQO1G0lO!DrQQO1G3oO7]QPO1G3oO!FqQPO'#FVOOQO1G.f1G.fOOQO1G1g1G1gO!FxQPO1G1iOOQO1G1i1G1iO!GTQQO1G1iO!G]QPO1G1oOOQO1G1r1G1rO)UQPO'#D^O+SQQO,5<`O!KQQPO,5<`O!KcQPO,5<[O!KjQPO,5<[OOQO1G1t1G1tOOQO1G1y1G1yOOQO1G1{1G1{O8qQPO1G1{O# ZQPO'#FyOOQO1G1}1G1}O;]QPO1G2SOOQO1G2U1G2UOOQO1G2W1G2WOOQO1G2Y1G2YOOQO1G2[1G2[OOQO1G2]1G2]O# bQQO'#HYO#!]QQO'#CbO+SQQO'#HfO##WQQOOO##tQQO'#EdO##cQQO'#H^OKpQPO'#GcO##{QPO,5<|OOQO'#G|'#G|O#$TQPO1G2_O#(OQPO'#GZO<XQPO'#G_OOQO1G2_1G2_O#(TQPO1G2gOOQO1G.i1G.iO#-VQQO'#EdO#-gQQO'#H[O#-wQPO'#FROOQO'#H['#H[O#.RQPO'#H[O#.pQPO'#IPO#.xQPO,59SOOQO7+$Q7+$QO!%gQQO7+$QOOQO7+'R7+'ROOQO1G/V1G/VO#.}QPO'#DnO#/XQQO'#HoOOQO'#Ho'#HoOOQO1G/q1G/qOOQO,5=W,5=WOOQO-E:j-E:jO#/iQSO,58{O#/pQPO,59eOOQO,59e,59eO!!aQPO'#HhODdQPO'#GfO#0OQPO,5>POOQO1G.}1G.}OOQO7+$g7+$gOOQO1G/z1G/zO#0WQQO1G/zOOQO1G/|1G/|O#0]QPO1G/zOOQO1G/{1G/{O:YQPO1G/|OOQO,5=Z,5=ZOOQO-E:m-E:mOOQO7+%e7+%eOOQO,5=X,5=XOOQO-E:k-E:kO8qQPO7+&rOOQO7+&r7+&rOOQO,5=a,5=aOOQO-E:s-E:sO#0bQPO'#ETO#0pQPO'#ETOOQO'#Gs'#GsO#1XQPO,5:vOOQO,5:v,5:vOOQO7+'c7+'cOOQO7+%{7+%{OOQO7+%l7+%lO!@iQPO7+%lO!@nQPO7+%lO!@vQPO7+%lOOQO7+%v7+%vO!AfQPO7+%vOOQO7+%q7+%qO!BeQPO7+%qO!BjQPO7+%qOOQO7+&T7+&TOOQO'#Ed'#EdO7]QPO7+&TO7]QPO,5>TO#1xQPO7+$[OOQO7+&S7+&SOOQO7+&V7+&VO8qQPO'#GhO#2WQPO,5>UOOQO1G/^1G/^O8qQPO7+&jO#2cQQO,59dO#3fQPO'#DqO! VQPO'#DqO#3qQPO'#HrO#3yQPO,5:[O#4dQQO'#HbO#5PQQO'#CtO! SQPO'#HqO#5oQPO'#DoO#5yQPO'#HqO#6[QPO'#DoO#6dQPO'#HzO#6iQPO'#E_OOQO'#Hk'#HkOOQO'#Gi'#GiO#6qQPO,59uOOQO,59u,59uO#6xQPO'#HlOOQO,5:g,5:gO#8`QPO'#HwOOQO'#EO'#EOOOQO,5:h,5:hO#8kQPO'#EXO:YQPO'#EXO#8|QPO'#HxO#9XQPO,5:rO! SQPO'#HqO!!aQPO'#HqO#9aQPO'#DoOOQO'#Gq'#GqO#9hQPO,5:nOOQO,5:n,5:nOOQO,5:m,5:mOOQO,5;R,5;RO#:bQQO,5;RO#:iQPO,5;ROOQO-E:r-E:rOOQO7+&W7+&WOOQO7+)Z7+)ZO#:pQQO7+)ZOOQO'#Gx'#GxO#<^QPO,5;qOOQO,5;q,5;qO#<eQPO'#FWO(|QPO'#FWO(|QPO'#FWO(|QPO'#FWO#<sQPO7+'TO#<xQPO7+'TOOQO7+'T7+'TO]QPO7+'ZO#=TQPO1G1zO! SQPO1G1zO#=cQQO1G1vO!!YQPO1G1vO#=jQPO1G1vO#=qQQO7+'gOOQO'#G{'#G{O#=xQPO,5<eOOQO,5<e,5<eO#>PQPO'#HlO8qQPO'#FzO#>XQPO7+'nO#>^QPO,5<}O! SQPO,5<}O#>cQPO1G2hO#?iQPO1G2hOOQO1G2h1G2hOOQO-E:z-E:zOOQO7+'y7+'yO!1kQPO'#G]O<XQPO,5<uOOQO,5<y,5<yO#?qQPO7+(ROOQO7+(R7+(RO#ClQPO,59TO#CsQPO'#IOO#C{QPO,5;mO(|QPO'#GwO#DQQPO,5>kOOQO1G.n1G.nOOQO<<Gl<<GlO#DYQPO'#HpO#DbQPO,5:YOOQO1G/P1G/POOQO,5>S,5>SOOQO,5=Q,5=QOOQO-E:d-E:dO#DgQPO7+%fOOQO7+%f7+%fOOQO7+%h7+%hOOQO<<J^<<J^O#D}QPO'#HYO#EUQPO'#CbO#E]QPO,5:oO#EbQPO,5:wO#0bQPO,5:oOOQO-E:q-E:qOOQO1G0b1G0bOOQO<<IW<<IWO!@iQPO<<IWO!@nQPO<<IWOOQO<<Ib<<IbOOQO<<I]<<I]O!BeQPO<<I]OOQO<<Io<<IoO#EgQQO<<GvO7]QPO<<IoO(|QPO<<IoOOQO<<Gv<<GvO#GZQQO,5=SOOQO-E:f-E:fO#GhQQO<<JUOOQO,5:],5:]O!!aQPO'#DrO#HOQPO,5:]O! VQPO'#GnO#HZQPO,5>^OOQO1G/v1G/vO#HcQPO'#HnO#HjQPO,59wO#HoQPO,5>]O! SQPO,59wO#HzQPO,5:ZO#6iQPO,5:yO! SQPO,5>]O!!aQPO,5>]O#6dQPO,5>fOOQO,5:Z,5:ZOL]QPO'#DsOOQO,5>f,5>fO#ISQPO'#E`OOQO,5:y,5:yO#LQQPO,5:yO!!aQPO'#DwOOQO-E:g-E:gOOQO1G/a1G/aOOQO,5:x,5:xO!!aQPO'#GpO#LVQPO,5>cOOQO,5:s,5:sO#LbQPO,5:sO#LpQPO,5:sO#MRQPO'#GrO#MiQPO,5>dO#MtQPO'#EYOOQO1G0^1G0^O#M{QPO1G0^O! SQPO,5:oOOQO-E:o-E:oOOQO1G0Y1G0YOOQO1G0m1G0mO#NQQQO1G0mOOQO<<Lu<<LuOOQO-E:v-E:vOOQO1G1]1G1]O#NXQQO,5;rOOQO'#Gy'#GyO#<eQPO,5;rOOQO'#IQ'#IQO#NaQQO,5;rO#NrQQO,5;rOOQO<<Jo<<JoO#NzQPO<<JoOOQO<<Ju<<JuO8qQPO7+'fO$ PQPO7+'fO!!YQPO7+'bO$ _QPO7+'bO$ dQQO7+'bOOQO<<KR<<KROOQO-E:y-E:yOOQO1G2P1G2POOQO,5<f,5<fO$ kQQO,5<fOOQO<<KY<<KYO8qQPO1G2iO$ rQPO1G2iOOQO,5=j,5=jOOQO7+(S7+(SO$ wQPO7+(SOOQO-E:|-E:|O$#cQSO'#HaO$!}QSO'#HaO$#jQPO'#G^O:YQPO,5<wOKpQPO,5<wOOQO1G2a1G2aOOQO<<Km<<KmO$#{QQO1G.oOOQO1G1Y1G1YO$$VQPO'#GvO$$dQPO,5>jOOQO1G1X1G1XO$$lQPO'#FSOOQO,5=c,5=cOOQO-E:u-E:uO$$qQPO'#GkO$%OQPO,5>[OOQO1G/t1G/tOOQO<<IQ<<IQOOQO1G0Z1G0ZO$%WQPO1G0cO$%]QPO1G0ZO$%bQPO1G0cOOQOAN>rAN>rO!@iQPOAN>rOOQOAN>wAN>wOOQOAN?ZAN?ZO7]QPOAN?ZO$%gQPO,5:^OOQO1G/w1G/wOOQO,5=Y,5=YOOQO-E:l-E:lO$%rQPO,5>`OOQO1G/c1G/cOOQO1G3w1G3wO$&TQPO1G/cOOQO1G/u1G/uOOQO1G0e1G0eO#LQQPO1G0eO#6dQPO'#HtO$&YQPO1G3wO! SQPO1G3wOOQO1G4Q1G4QOJsQPO'#DuOJSQPO'#D^OOQO,5:z,5:zO$&eQPO,5:zO$&eQPO,5:zO$&lQQO'#H]O$&sQQO'#H^O$&}QQO'#EaO$'YQPO'#EaOOQO,5:c,5:cOOQO,5=[,5=[OOQO-E:n-E:nOOQO1G0_1G0_O$'bQPO1G0_OOQO,5=^,5=^OOQO-E:p-E:pO$'pQPO,5:tOOQO7+%x7+%xOOQO7+&X7+&XOOQO1G1^1G1^O$'wQQO1G1^OOQO-E:w-E:wO$(PQQO'#IRO$'zQPO1G1^O#NgQPO1G1^O(|QPO1G1^OOQOAN@ZAN@ZO$([QQO<<KQO8qQPO<<KQO$(cQPO<<J|OOQO<<J|<<J|O!!YQPO<<J|OOQO1G2Q1G2QO$(hQQO7+(TO8qQPO7+(TOOQO<<Kn<<KnP!'_QPO'#HOOKpQPO'#G}O$(rQPO,5<xO$(}QPO1G2cO:YQPO1G2cOOQO,5=b,5=bOOQO-E:t-E:tO#ClQPO,5;nOOQO,5=V,5=VOOQO-E:i-E:iO$)SQPO7+%}OOQO7+%u7+%uO$)bQPO7+%}OOQOG24^G24^OOQOG24uG24uO$)gQPO1G/xO$)rQPO1G3zOOQO7+$}7+$}OOQO7+&P7+&POOQO7+)c7+)cO$*TQPO7+)cO!/qQPO,5:`OOQO1G0f1G0fO$*`QPO1G0fO$*gQPO,59pO$*{QPO,5:{O7]QPO,5:{OOQO7+%y7+%yOOQO7+&x7+&xO(|QPO'#GzO$+QQPO,5>mO$+YQPO7+&xO$+_QQO'#ISOOQOAN@lAN@lO$+jQQOAN@lOOQOAN@hAN@hO$+qQPOAN@hO$+vQQO<<KoO$,QQPO,5=iOOQO-E:{-E:{OOQO7+'}7+'}O$,cQPO7+'}O$,hQPO<<IiOOQO<<Ii<<IiO#ClQPO<<IiO$,hQPO<<IiOOQO<<L}<<L}OOQO7+&Q7+&QO$,vQPO1G0iO$-RQQO1G0gOOQO1G0g1G0gO$-ZQPO1G0gO$-`QQO,5=fOOQO-E:x-E:xOOQO<<Jd<<JdO$-kQPO,5>nOOQOG26WG26WOOQOG26SG26SOOQO<<Ki<<KiOOQOAN?TAN?TO#ClQPOAN?TO$-sQPOAN?TO$-xQPOAN?TO7]QPO7+&RO$.WQPO7+&ROOQO7+&R7+&RO$.]QPOG24oOOQOG24oG24oO#ClQPOG24oO$.bQPO<<ImOOQO<<Im<<ImOOQOLD*ZLD*ZO$.gQPOLD*ZOOQOAN?XAN?XOOQO!$'Mu!$'MuO(|QPO'#CaO$.lQQO'#HYO$/PQQO'#CbO!!aQPO'#Cx",stateData:"$/g~OPOSQOS%uOS~OZ^O_TO`TOaTObTOcTOdTOf[Og[Oo}OuyOviOy|O|aO!OtO!RwO!SwO!TwO!UwO!VwO!WwO!XwO!YxO!Z!^O![wO!]wO!^wO!t{O!yzO#dnO#pmO#rnO#snO#w!PO#x!OO$U!QO$W!RO$^!SO$a!TO$c!VO$f!UO$j!WO$l!XO$q!YO$s!ZO$u![O$w!]O$z!_O$|!`O%ySO%{QO%}PO&mbO~OWhXW%|XZ%|XthXt%|X!O%|X!a%|X#[%|X#^%|X#`%|X#b%|X#c%|X#d%|X#e%|X#f%|X#g%|X#i%|X#m%|X#p%|X%yhX%{hX%}hX&V%|X&WhX&W%|X&g%|X&ohX&o%|X&q!`X~O#n$[X~P$tOWUXW&UXZUXtUXt&UX!OUX!aUX#[UX#^UX#`UX#bUX#cUX#dUX#eUX#fUX#gUX#iUX#mUX#pUX%y&UX%{&UX%}&UX&VUX&WUX&W&UX&gUX&oUX&o&UX&q!`X~O#n$[X~P&xO%{RO%}!aO~Of[Og[O!RwO!SwO!TwO!UwO!VwO!WwO!XwO!YxO![wO!]wO!^wO%ySO%{!dO%}UOf!QXg!QX$f!QX%{!QX%}!QX~O#w!iO#x!hO$U!jOu!QX!t!QX!y!QX&m!QX~P)UOW!tOt!kO%ySO%{!oO%}!oO&o&YX~OW!wOt&TX%y&TX%{&TX%}&TX&o&TXY&TXv&TX&g&TX&j&TXZ&TXp&TX&V&TX!O&TX#^&TX#`&TX#b&TX#c&TX#d&TX#e&TX#f&TX#g&TX#i&TX#m&TX#p&TX|&TX!q&TX#n&TXr&TX{&TX~O&W!uO~P+hO&W&TX~P+hOZ^O_TO`TOaTObTOcTOdTOf[Og[Oo}OviOy|O!RwO!SwO!TwO!UwO!VwO!WwO!XwO!YxO![wO!]wO!^wO#dnO#pmO#rnO#snO%ySO~O%{!yO%}!xOY&iP~P-vO%ySOf%^Xg%^Xu%^X!R%^X!S%^X!T%^X!U%^X!V%^X!W%^X!X%^X!Y%^X![%^X!]%^X!^%^X!t%^X!y%^X$f%^X%{%^X%}%^X&m%^X&W%^X~O!RwO!SwO!TwO!UwO!VwO!WwO!XwO!YxO![wO!]wO!^wOf!QXg!QXu!QX!t!QX!y!QX%{!QX%}!QX&m!QX&W!QX~O$f!QX~P1eO{#WO~P]Of[Og[Ou#]O!t#_O!y#^O%{!dO%}UO&m#[O~O$f#`O~P3TOt#bO&o#cO!O&PX#^&PX#`&PX#b&PX#c&PX#d&PX#e&PX#f&PX#g&PX#i&PX#m&PX#p&PX&V&PX&W&PX&g&PX~OW#aOY&PX#n&PXr&PXp&PX{&PX~P3vO!a#dO#[#dOW&QXt&QX!O&QX#^&QX#`&QX#b&QX#c&QX#d&QX#e&QX#f&QX#g&QX#i&QX#m&QX#p&QX&V&QX&W&QX&g&QX&o&QXY&QX#n&QXr&QXp&QX{&QX~OZ#WX~P5eOZ#eO~O&o#cO~O#^#iO#`#jO#b#kO#c#kO#d#lO#e#mO#f#nO#g#nO#i#rO#m#oO#p#pO&V#gO&W#gO&g#hO~O!O#qO~P7gO&q#sO~OZ^O_TO`TOaTObTOcTOdTOf[Og[Oo}OviOy|O#dnO#pmO#rnO#snO%ySO%{0cO%}0bO~O#n#wO~O!Z#yO~O%{!oO%}!oO~Of[Og[O%{!dO%}UO&W!uO~OW$PO&o#cO~O#x!hO~O!V$TO%{RO%}!aO~OZ$UO~OZ$XO~O!O$`O%{$_O%}$_O~O!O$bO%{$_O%}$_O~O!O$eO~P8qOZ$hO|aO~OW$kOZ$lOfTagTa%yTa%{Ta%}Ta~OuTa!RTa!STa!TTa!UTa!VTa!WTa!XTa!YTa![Ta!]Ta!^Ta!tTa!yTa#wTa#xTa$UTa$fTa&mTatTaYTa&WTapTa{Ta!OTa~P<^Ot!kO%ySOpla&VlaYla&gla!Ola~O&ola|la!qla~P>hO!RwO!SwO!TwO!UwO!VwO!WwO!XwO!YxO![wO!]wO!^wO~Of!Qag!Qau!Qa!t!Qa!y!Qa$f!Qa%{!Qa%}!Qa&m!Qa&W!Qa~P?^O#x$pO~Or$rO~Ot$sO%ySO~Ot!kO%yqa%{qa%}qa&oqaYqavqa&gqa&jqa!Oqa&Vqapqa~OWqa#^qa#`qa#bqa#cqa#dqa#eqa#fqa#gqa#iqa#mqa#pqa&Wqa#nqarqa{qa~PAXOt!kO%ySOp&bX!O&bX!a&bX~OY&bX#n&bX~PCVO!a$vOp!_X!O!_XY!_X~Op$wO!O&aX~O!O$yO~Ou$zO~Of[Og[O%y0aO%{!dO%}UO&Z$}O~O&V&XP~PDdO%ySO%{!dO%}UO~OWhXW%|XY%|XZ%|XthXt%|X!a%|X#[%|X#^%|X#`%|X#b%|X#c%|X#d%|X#e%|X#f%|X#g%|X#i%|X#m%|X#p%|X%yhX%{hX%}hX&V%|X&WhX&W%|X&g%|X&ohX&o%|X&q!`X~OYhXY!`Xp!`XvhX&ghX&jhX~PE[OWUXW&UXYUXZUXtUXt&UX!aUX#[UX#^UX#`UX#bUX#cUX#dUX#eUX#fUX#gUX#iUX#mUX#pUX%y&UX%{&UX%}&UX&VUX&WUX&W&UX&gUX&oUX&o&UX&q!`X~OY!`XY&UXp!`Xv&UX&g&UX&j&UX~PGoOf[Og[O%ySO%{!dO%}UOf!QXg!QX%{!QX%}!QX~P?^Ot!kOv%XO%ySO%{%UO%}%TO&j%WO~OW!tOY&YX&g&YX&o&YX~PJsOY%ZO~P7gOf[Og[O%{!dO%}UO~Op%]OY&iX~OY%_O~Of[Og[O%ySO%{!dO%}UOY&iP~P?^OY%eO&g%cO&o#cO~Op%fO&q#sOY&pX~OY%hO~O%ySOf%^ag%^au%^a!R%^a!S%^a!T%^a!U%^a!V%^a!W%^a!X%^a!Y%^a![%^a!]%^a!^%^a!t%^a!y%^a$f%^a%{%^a%}%^a&m%^a&W%^a~O{%iO~P]O|%jO~Ot!kO%ySO%{!oO%}!oO~Oo%vOv%wO%{RO%}!aO&W!uO~Oy%uO~P! bOy%yO%{RO%}!aO&W!uO~OY&^P~P8qOf[Og[O%ySO%{!dO%}UO~O|aO~P8qOW!tOt!kO%ySO&o&YX~O#p#pO!O#qa#^#qa#`#qa#b#qa#c#qa#d#qa#e#qa#f#qa#g#qa#i#qa#m#qa&V#qa&W#qa&g#qaY#qa#n#qar#qap#qa{#qa~On&^O|&]O!q&_O&W&[O~O|&dO!q&_O~On&hO|&gO&W&[O~OZ#eOt&lO%ySO~OW$kO|&rO~OW$kO!O&tO~OW&uO!O&vO~O$f!UO%{0cO%}0bO!O&^P~P-vO!O'RO#n'SO~P7gO|'TO~O$a'VO~O!O'WO~O!O'XO~O!O'YO~P7gO!O'[O~P7gOZ$UO_TO`TOaTObTOcTOdTOf[Og[Oo}OviOy|O%ySO%{'^O%}']O~P?^O%O'gO%S'hOZ${a_${a`${aa${ab${ac${ad${af${ag${ao${au${av${ay${a|${a!O${a!R${a!S${a!T${a!U${a!V${a!W${a!X${a!Y${a!Z${a![${a!]${a!^${a!t${a!y${a#d${a#p${a#r${a#s${a#w${a#x${a$U${a$W${a$^${a$a${a$c${a$f${a$j${a$l${a$q${a$s${a$u${a$w${a$z${a$|${a%s${a%y${a%{${a%}${a&m${a{${a$_${a$o${a~O|'nOY&sP~P8qO|qa!qqa&wqa~PAXOW$kO!O'uO~Or'vO~Ot!kO%ySOp&ba!O&ba!a&baY&ba#n&ba~O|'wO~P8qOp$wO!O&aa~Of[Og[O%y0aO%{!dO%}UO~O&Z(OO~P!-yOt!kO%ySOp&YX&V&YXY&YX&g&YX!O&YX~O|&YX!q&YX~P!.cOn(QOo(QOpmX&VmX~Op(RO&V&XX~O&V(TO~Ot!kOv(VO%ySO%{RO%}!aO~OYla&gla&ola~P!/qOW%|XY!`Xp!`Xt!`X%y!`X~OWUXY!`Xp!`Xt!`X%y!`X~OW(YO~Ot!kO%ySO%{!oO%}!oO&j([O~Of[Og[O%ySO%{!dO%}UO~P?^Op%]OY&ia~Ot!kO%ySO%{!oO%}!oO&j%WO~O%ySO~P1eOY(_O~OY(bO&g%cO~Op%fOY&pa~Of[Og[OuyO{(jO!t{O%ySO%{!dO%}UO&mbO~P?^O!O(kO~OW^iZ#WXt^i!O^i!a^i#[^i#^^i#`^i#b^i#c^i#d^i#e^i#f^i#g^i#i^i#m^i#p^i&V^i&W^i&g^i&o^iY^i#n^ir^ip^i{^i~OW(zO~Or({O~P7gOy(|O%{RO%}!aO~O!O]iY]i#n]ir]ip]i{]i~P7gOp(}OY&^X!O&^X~P7gOY)PO~O#p#pO!O#]i#^#]i#`#]i#b#]i#c#]i#d#]i#e#]i#i#]i#m#]i&V#]i&W#]i&g#]iY#]i#n#]ir#]ip#]i{#]i~O#f#nO#g#nO~P!7QO#^#iO#e#mO#f#nO#g#nO#i#rO#p#pO&V#gO&W#gO!O#]i#`#]i#b#]i#c#]i#m#]i&g#]iY#]i#n#]ir#]ip#]i{#]i~O#d#lO~P!8fO#^#iO#e#mO#f#nO#g#nO#i#rO#p#pO&V#gO&W#gO!O#]i#b#]i#c#]i#m#]iY#]i#n#]ir#]ip#]i{#]i~O#`#jO#d#lO&g#hO~P!9zO#d#]i~P!8fO#p#pO!O#]i#`#]i#b#]i#c#]i#d#]i#e#]i#m#]i&g#]iY#]i#n#]ir#]ip#]i{#]i~O#^#iO#f#nO#g#nO#i#rO&V#gO&W#gO~P!;gO#f#]i#g#]i~P!7QO#n)QO~P7gO#^&YX#`&YX#b&YX#c&YX#d&YX#e&YX#f&YX#g&YX#i&YX#m&YX#p&YX&W&YX#n&YXr&YX{&YX~P!.cO!O#jiY#ji#n#jir#jip#ji{#ji~P7gOf[Og[OuyO|aO!O)`O!RwO!SwO!TwO!UwO!V)dO!WwO!XwO!YxO![wO!]wO!^wO!t{O!yzO%ySO%{)WO%})XO&W&[O&mbO~O{)cO~P!>wO|&]O~O|&]O!q&_O~On&^O|&]O!q&_O~O%ySO%{!oO%}!oO{&lP!O&lP~P?^O|&dO~Of[Og[OuyO{)rO!O)pO!t{O!yzO%ySO%{!dO%}UO&W&[O&mbO~P?^O|&gO~On&hO|&gO~Or)tO~P8qOt)vO%ySO~Ot&lO|'wO%ySOW#Yi!O#Yi#^#Yi#`#Yi#b#Yi#c#Yi#d#Yi#e#Yi#f#Yi#g#Yi#i#Yi#m#Yi#p#Yi&V#Yi&W#Yi&g#Yi&o#YiY#Yi#n#Yir#Yip#Yi{#Yi~O|&]OW&]it&]i!O&]i#^&]i#`&]i#b&]i#c&]i#d&]i#e&]i#f&]i#g&]i#i&]i#m&]i#p&]i&V&]i&W&]i&g&]i&o&]iY&]i#n&]ir&]ip&]i{&]i~O#{*OO#}*PO$P*PO$Q*QO$R*RO~O{)}O~P!F`O$X*SO%{RO%}!aO~OW*TO!O*UO~O$_*VOZ$]i_$]i`$]ia$]ib$]ic$]id$]if$]ig$]io$]iu$]iv$]iy$]i|$]i!O$]i!R$]i!S$]i!T$]i!U$]i!V$]i!W$]i!X$]i!Y$]i!Z$]i![$]i!]$]i!^$]i!t$]i!y$]i#d$]i#p$]i#r$]i#s$]i#w$]i#x$]i$U$]i$W$]i$^$]i$a$]i$c$]i$f$]i$j$]i$l$]i$q$]i$s$]i$u$]i$w$]i$z$]i$|$]i%s$]i%y$]i%{$]i%}$]i&m$]i{$]i$o$]i~Of[Og[O$f#`O%{!dO%}UO~O!O*ZO~P8qO!O*[O~OZ^O_TO`TOaTObTOcTOdTOf[Og[Oo}OuyOviOy|O|aO!OtO!RwO!SwO!TwO!UwO!VwO!WwO!XwO!Y*aO!Z!^O![wO!]wO!^wO!t{O!yzO#dnO#pmO#rnO#snO#w!PO#x!OO$U!QO$W!RO$^!SO$a!TO$c!VO$f!UO$j!WO$l!XO$o*bO$q!YO$s!ZO$u![O$w!]O$z!_O$|!`O%ySO%{QO%}PO&mbO~O{*`O~P!KoOWhXW%|XY%|XZ%|XthXt%|X!O%|X%yhX%{hX%}hX&WhX&ohX&o%|X~OWUXW&UXYUXZUXtUXt&UX!OUX%y&UX%{&UX%}&UX&W&UX&oUX&o&UX~OW#aOt#bO&o#cO~OW&QXY%VXt&QX!O%VX&o&QX~OZ#WX~P##cOY*hO!O*fO~O%O'gO%S'hOZ${i_${i`${ia${ib${ic${id${if${ig${io${iu${iv${iy${i|${i!O${i!R${i!S${i!T${i!U${i!V${i!W${i!X${i!Y${i!Z${i![${i!]${i!^${i!t${i!y${i#d${i#p${i#r${i#s${i#w${i#x${i$U${i$W${i$^${i$a${i$c${i$f${i$j${i$l${i$q${i$s${i$u${i$w${i$z${i$|${i%s${i%y${i%{${i%}${i&m${i{${i$_${i$o${i~OZ*kO~O%O'gO%S'hOZ%Ti_%Ti`%Tia%Tib%Tic%Tid%Tif%Tig%Tio%Tiu%Tiv%Tiy%Ti|%Ti!O%Ti!R%Ti!S%Ti!T%Ti!U%Ti!V%Ti!W%Ti!X%Ti!Y%Ti!Z%Ti![%Ti!]%Ti!^%Ti!t%Ti!y%Ti#d%Ti#p%Ti#r%Ti#s%Ti#w%Ti#x%Ti$U%Ti$W%Ti$^%Ti$a%Ti$c%Ti$f%Ti$j%Ti$l%Ti$q%Ti$s%Ti$u%Ti$w%Ti$z%Ti$|%Ti%s%Ti%y%Ti%{%Ti%}%Ti&m%Ti{%Ti$_%Ti$o%Ti~OW&QXt&QX#^&QX#`&QX#b&QX#c&QX#d&QX#e&QX#f&QX#g&QX#i&QX#m&QX#p&QX&V&QX&W&QX&g&QX&o&QX~O!a*pO#[#dOY&QXZ#WX~P#,OOY&OXp&OX{&OX!O&OX~P7gO|'nO{&rP~P8qOY&OXf%XXg%XX%y%XX%{%XX%}%XXp&OX{&OX!O&OX~Op*sOY&sX~OY*uO~O|'wO{&dP~P8qOp&cX!O&cX{&cXY&cX~P7gO&ZTa~P<^On(QOo(QOpma&Vma~Op(RO&V&Xa~OW*}O~Ov+OO~Ot!kO%ySO%{+SO%}+RO~Of[Og[Ou#]O!t#_O%{!dO%}UO&m#[O~Of[Og[OuyO{+XO!t{O%ySO%{!dO%}UO&mbO~P?^Ov+dO%{RO%}!aO&W!uO~Op(}OY&^a!O&^a~O#^la#`la#bla#cla#dla#ela#fla#gla#ila#mla#pla&Wla#nlarla{la~P>hOn+iOp!eX&V!eX~Op+kO&V&fX~O&V+mO~OW&UXt&UX%y&UX%{&UX%}&UX&W&UX~OZ!`X~P#4OOWhXthX%yhX%{hX%}hX&WhX~OZ!`X~P#4kOf[Og[Ou#]O!t#_O!y#^O&W&[O&m#[O~O%{)WO%})XO~P#5WOf[Og[O%ySO%{)WO%})XO~O|aO!O+wO~OZ+xO~O|+zO!l+}O~O{,PO~P!>wO|aOf&`Xg&`Xu&`X!R&`X!S&`X!T&`X!U&`X!V&`X!W&`X!X&`X!Y&`X![&`X!]&`X!^&`X!t&`X!y&`X%y&`X%{&`X%}&`X&W&`X&m&`X~Op,RO|&kX!O&kX~OZ#eO|&]Op!{X{!{X!O!{X~Op,WO{&lX!O&lX~O{,ZO!O,YO~O&W&[O~P3TOf[Og[OuyO{,_O!O)pO!t{O!yzO%ySO%{!dO%}UO&W&[O&mbO~P?^Or,`O~P7gOr,`O~P8qO|&]OW&]qt&]q!O&]q#^&]q#`&]q#b&]q#c&]q#d&]q#e&]q#f&]q#g&]q#i&]q#m&]q#p&]q&V&]q&W&]q&g&]q&o&]qY&]q#n&]qr&]qp&]q{&]q~O{,dO~P!F`O!V,hO#|,hO%{RO%}!aO~O!O,kO~O$X,lO%{RO%}!aO~O!a$vO#n,nOp!_X!O!_X~O!O,pO~P7gO!O,pO~P8qO!O,sO~P7gO{,uO~P!KoO!Z#yO#n,vO~O!O,xO~O!a,yO~OY,|OZ$UO_TO`TOaTObTOcTOdTOf[Og[Oo}OviOy|O%ySO%{'^O%}']O~P?^OY,|O!O,}O~O%O'gO%S'hOZ%Tq_%Tq`%Tqa%Tqb%Tqc%Tqd%Tqf%Tqg%Tqo%Tqu%Tqv%Tqy%Tq|%Tq!O%Tq!R%Tq!S%Tq!T%Tq!U%Tq!V%Tq!W%Tq!X%Tq!Y%Tq!Z%Tq![%Tq!]%Tq!^%Tq!t%Tq!y%Tq#d%Tq#p%Tq#r%Tq#s%Tq#w%Tq#x%Tq$U%Tq$W%Tq$^%Tq$a%Tq$c%Tq$f%Tq$j%Tq$l%Tq$q%Tq$s%Tq$u%Tq$w%Tq$z%Tq$|%Tq%s%Tq%y%Tq%{%Tq%}%Tq&m%Tq{%Tq$_%Tq$o%Tq~O|'nO~P8qOp-YO{&rX~O{-[O~Op*sOY&sa~Op-`O{&dX~O{-bO~Ov-cO~Op!`Xt!`X!O!`X!a!`X%y!`X~OZ%|X~P#DlOZUX~P#DlO!O-dO~OZ-eO~OW^yZ#WXt^y!O^y!a^y#[^y#^^y#`^y#b^y#c^y#d^y#e^y#f^y#g^y#i^y#m^y#p^y&V^y&W^y&g^y&o^yY^y#n^yr^yp^y{^y~OY%[ap%[a!O%[a~P7gO!O#lyY#ly#n#lyr#lyp#ly{#ly~P7gOn+iOp!ea&V!ea~Op+kO&V&fa~OZ+xO~PCVO!O-rO~O!l+}O|&ea!O&ea~O|aO!O-uO~OZ^O_TO`TOaTObTOcTOdTOf[Og[Oo.TOuyOv.SOy|O{.OO|aO!OtO!Z!^O!t{O!yzO#dnO#pmO#rnO#snO#w!PO#x!OO$U!QO$W!RO$^!SO$a!TO$c!VO$f!UO$j!WO$l!XO$q!YO$s!ZO$u![O$w!]O$z!_O$|!`O%ySO%{QO%}PO&W!uO&mbO~P?^O|+zO~Op,RO|&ka!O&ka~O|&]Op!{a{!{a!O!{a~OZ#eO|&]Op!{a{!{a!O!{a~O%ySO%{!oO%}!oOp%fX{%fX!O%fX~P?^Op,WO{&la!O&la~O{!|X~P!>wO{._O~Or.`O~P7gOW$kO!O.aO~OW$kO$O.fO%{RO%}!aO!O&uP~OW$kO$S.gO~O!O.hO~O!a$vO#n.jOp!_X!O!_X~OY.lO~O!O.mO~P7gO#n.nO~P7gO!a.pO~OY.qOZ$UO_TO`TOaTObTOcTOdTOf[Og[Oo}OviOy|O%ySO%{'^O%}']O~P?^OW!wOt&TX%y&TX%{&TX%}&TX&w&TX~O&W!uO~P$!}Ot!kO%ySO&w.sO%{%QX%}%QX~OY&OXp&OX~P7gO|'nOp%jX{%jX~P8qOp-YO{&ra~O!a.yO~O|'wOp%_X{%_X~P8qOp-`O{&da~OY.|O~O!O.}O~OZ/OO~O&g%cOp!fa&V!fa~Ot!kO%ySO|&ha!O&ha!l&ha~O!O/TO~O!l+}O|&ei!O&ei~O{/YO~P]OW/[O~P3vOZ#eO!O&QX~P#,OOW$POZ#eO&o#cO~Oo/^Ov/^O~O|&]Op!{i{!{i!O!{i~O{!|a~P!>wOW$kO!O/`O~OW$kOp/aO!O&uX~OY/eO~P7gOY/gO~OY%Vq!O%Vq~P7gO&w.sO%{%Qa%}%Qa~OY/lO~Ot!kO!O/oO!Y/pO%ySO~OY/qO~O&g%cOp!fi&V!fi~Ot!kO%ySO|&hi!O&hi!l&hi~O!l+}O|&eq!O&eq~O{/sO~P]Oo/uOv%wOy%uO%{RO%}!aO&W!uO~O!O/vO~Op/aO!O&ua~O!O/zO~OW$kOp/aO!O&vX~OY/|O~P7gOY/}O~OY%Vy!O%Vy~P7gOt!kO%ySO%{%qa%}%qa&w%qa~OY0OO~Ot!kO!O0PO!Y0QO%ySO~Oo0TO%{RO%}!aO~OW(zOZ#eO~O!O0VO~OW$kOp%na!O%na~Op/aO!O&va~O!O0XO~Ot!kO!O0XO!Y0YO%ySO~O!O0[O~O!O0]O~O!O0_O~O!O0`O~O#n%|XY%|Xr%|Xp%|X{%|X~P$tO#nUXYUXrUXpUX{UX~P&xO`#e~",goto:"#&b&wPPPP&x']*l-oP']PP.T.X/mPPPPPP1XPP2q5b7{:f;O<sPPP<yP?_PPP@X1XPBQPPB{PCrCxPPPPPPPPPPPPEREjPHpHxISIlIrIxKhKlKlKtPLTMZM|NWPNmMZPNsN}! ^! fP!!T!!_!!eMZ!!h!!nCrCr!!r!!|!#P1X!$k1X1X!&dP.XP!&hP!'XPPPPPP.XP.X!'u.XPP.XP.XPP.X!)Z!)ePP!)k!)tPPPPPPPP&xP&xPP!)x!)x!*]!)xPP!)xP!)xP!*v!*yP!)x!+a!)xP!)xP!+d!+gP!)xP!)xP!)xP!)xP!)x!)xP!)xP!+kP!+q!+t!+zP!)x!,W!,Z!,c!,u!0r!0x!2O!2U!2`!3d!3j!3p!3z!4Q!4W!4^!4d!4j!4p!4v!4|!5S!5Y!5`!5f!5p!5v!6Q!6WPPP!6^!)x!7RP!:dP!;hP!=y!>a!A]1X!By!Fe!ISPP!Km!KpP!My!NP# m# |#!S##S##l#$g#$p#$s#%PP#%S#%`P#%g#%nP#%qP#%zP#%}#&Q#&T#&X#&_srOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/Z'kpOVW^_amnv!W!Y!]!_!e!l!p!u!w!z!{#Q#U#X#Z#b#d#e#i#j#k#l#m#n#o#r#s#t#u#w#}$U$V$W$X$Y$Z$h$l$u$v${$|%R%S%[%]%`%a%c%e%j&V&[&]&^&_&d&g&h&l&m&o&z&{&}'S'T'_'n'w(Q(R(b(f(i(})Q)R)T)Y)[)b)m)n)q)v*V*X*Z*[*_*b*e*f*k*p+V+i+k+n+q+t+u+x+z+},R,W,Y,],n,p,y,}-R-Y-`-q-z-|-}.P.Q.^.j.m.p.r.y.|/S/X/Z/j/n/p/q0Q0S0Y0d#rfO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0Yt!cS!O!Q!R!h!j$T$p*O*P*Q*R,g,i.f.g/a0aQ#YbS%Y!{-|Q%m#[U%r#a$P/[Q%y#cW'a$h*f,}.rU'k$k&u*TQ'l$lS(W%S/XU(w%t+c/tQ(|%zQ+U(fQ+a(zQ-]*sR-g+Vu!cS!O!Q!R!h!j$T$p*O*P*Q*R,g,i.f.g/a0aT$m!b'}#uoO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0Y#tjO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0YX'b$h*f,}.r#}iO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$h$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*f*p+z,n,p,y,}-Y-`.P.Q.j.m.p.r.y/Z/p0Q0Y%tYOV^acmnv|!W!Y!]!_!u!z!}#Q#X#b#d#e#i#j#k#l#m#n#o#r#s#t#w$O$U$V$W$X$Y$Z$h$l$v${%]%c%e%j%u&]&^&_&g&h&l&z&|&}'S'T'c'n'w(Q(R(b(g(i(})Q)Z)[)b)n)o)q)v*V*Z*[*_*b*f*p+i+u+x+z+},R,Y,n,p,y,}-Y-`-}.P.Q.^.j.m.p.r.y/Z/p0Q0Y0dQ%Q!wQ(U%RV-P*k-T.s%tYOV^acmnv|!W!Y!]!_!u!z!}#Q#X#b#d#e#i#j#k#l#m#n#o#r#s#t#w$O$U$V$W$X$Y$Z$h$l$v${%]%c%e%j%u&]&^&_&g&h&l&z&|&}'S'T'c'n'w(Q(R(b(g(i(})Q)Z)[)b)n)o)q)v*V*Z*[*_*b*f*p+i+u+x+z+},R,Y,n,p,y,}-Y-`-}.P.Q.^.j.m.p.r.y/Z/p0Q0Y0dV-P*k-T.s%tZOV^acmnv|!W!Y!]!_!u!z!}#Q#X#b#d#e#i#j#k#l#m#n#o#r#s#t#w$O$U$V$W$X$Y$Z$h$l$v${%]%c%e%j%u&]&^&_&g&h&l&z&|&}'S'T'c'n'w(Q(R(b(g(i(})Q)Z)[)b)n)o)q)v*V*Z*[*_*b*f*p+i+u+x+z+},R,Y,n,p,y,}-Y-`-}.P.Q.^.j.m.p.r.y/Z/p0Q0Y0dV-Q*k-T.sS!vY-PS$O|%uS%t#a$PQ%z#cQ+c(zQ.U+zR/t/[$eXO^amnv!W!Y!]!_!u#X#b#d#e#i#j#k#l#m#n#o#r#s#w$U$V$W$X$Y$Z$h$l$v%c%e&^&_&h&l&}'S'T'n'w(Q(R(b(})Q)v*V*Z*[*_*b*f*p+i+z+},R,n,p,y,}-Y-`.P.Q.j.m.p.r.y/Z/p0Q0YQ%O!uR*{(R%u]OV^acmnv!W!Y!]!_!u!z!}#Q#X#b#d#e#i#j#k#l#m#n#o#r#s#t#w$U$V$W$X$Y$Z$h$l$v${%]%c%e%j&]&^&_&g&h&l&z&|&}'S'T'c'n'w(Q(R(b(g(i(})Q)Z)[)b)n)o)q)v*V*Z*[*_*b*f*k*p+i+u+x+z+},R,Y,n,p,y,}-T-Y-`-}.P.Q.^.j.m.p.r.s.y/Z/p0Q0Y0d!o!mW!e!n!p!{#Z#u$n$u$|%S%[%`&V&{'_(f)R)Y)m*X*e+V+n+q+t,]-R-q-z-|.|/S/X/j/n/q0S#|iO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$h$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*f*p+z,n,p,y,}-Y-`.P.Q.j.m.p.r.y/Z/p0Q0YQ$V!SQ$W!TQ$]!XQ$f!^R*c'VQ#fgS&p#}(yQ(v%sQ)z&qQ+`(xQ,U)iQ-k+bQ.Z,VQ/Q-lS/].S.TQ/w/^Q0U/uR0Z0TQ&`#zW(m%n&a&b&cQ)y&pU+Y(n(o(pQ,T)iQ,b)zS-h+Z+[S.Y,U,VQ/P-iR/_.ZX)`&])b,Y.^rcOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZW!}^#Q%]+xQ&|$XW'c$h*f,}.rS(g%j(iW)Z&])b,Y.^S)j&d,WS)o&g)qR-T*kh!rW!U#Z#`&{(f)Y)m*X+V+q,]Q'{$wQ(X%WR+P([#rlOamnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0Yv!pW!U!{#Z#`$w%W%[%`&{'_([(f*X*e+V-S-|.vQ#S^Q#zyQ#{zQ#|{Q%n#]Q%o#^Q%p#_Q(d%fS)S&[+kY)^&])Z)b,Y.^S)i&d,WQ+j)TW+n)Y)m+q,]Q+v)[Q,V)jT-x+t-zU'y$v'w-`R)x&oW)`&])b,Y.^T)p&g)qQ&c#zQ&k#|Q(p%nQ(u%pY)[&])Z)b,Y.^V)n&g)o)qQ)U&[R-o+kQ+h)SR-n+j#tlO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0YQ+y)^S-q+n-xR-{+vT#Q^+xU#O^#Q+xR(]%]Q+|)_Q-s+pQ-w+sQ/V-yR/r/WrtOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZQ$i!`Q&Y#sQ'Z$fQ'j$jW)`&])b,Y.^Q*m'hQ+w)]Q,Q)dQ-U*lR-u+rrrOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZS(h%j(iW)`&])b,Y.^T)p&g)qQ&b#zS(o%n&cR+[(pQ&a#zQ&f#{U(n%n&b&cQ(r%oS+Z(o(pR-i+[Q)h&_R)s&hQ&j#|S(t%p&kR+_(uQ&i#|U(s%p&j&kS+^(t(uR-j+_S(h%j(iT)p&g)qrrOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZW)`&])b,Y.^T)p&g)qQ&e#{S(q%o&fR+](rQ)k&dR.[,WR,[)lQ%k#YR(l%mT(h%j(iQ+{)_S-v+s+|R/U-wR.Q+zWi$h*f,}.r#ujO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0Y#|gO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$h$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*f*p+z,n,p,y,}-Y-`.P.Q.j.m.p.r.y/Z/p0Q0YU%s#a$P/[S(x%t/tQ+b(zR-l+cT&n#}&o!]#ik!|$[$d$g%x%{%|&P&Q&R&S&U&X'm'x)u*Y*]+e+g,a,r,w-W.i.o/f/i!V#jk!|$[$d$g%x%{%|&Q&U&X'm'x)u*Y*]+e+g,a,r,w-W.i.o/f/i#ulO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p+z,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0Ya'o$l'n*p-Y.y/p0Q0YQ'q$lR-^*sQ&s$QQ's$oR*v'tT){&r)|stOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZrsOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZQ$a!ZR$c![R$Y!VrtOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZR&}$XR$Z!VR'U$]T*^'T*_X'e$i'f'j*nR*l'gQ-S*kR.v-TQ'i$iQ*j'fQ*o'jR-V*nR$j!`Q'd$hV,{*f,}.rQvOQ#XaW#xv#X.P/ZQ.P+zR/Z.QrVOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/Zl!gV!l!z#U#t${%R%a&m&z)T+u-}0d!j!lW!e!p!{#Z#u$u$|%S%[%`&V&{'_(f)R)Y)m*X*e+V+n+q+t,]-R-q-z-|.|/S/X/j/n/q0SQ!z^Q#U_#^#tmn!W!]!_#b#d#e#i#j#k#l#m#n#o#s$U$l$v%c%e&^&_&h&l&}'S'n'w(Q(b(})Q)v*Z*[*b*p+i+},R,n,p,y-Y-`.j.m.p.y/p0Q0YS${!u(RQ%R!wj%a#Q%]%j&]&d&g(i)b)q*k,W,Y.^S&m#}&oY&z$X$h*f,}.rS)T&[+kS+u)[)nQ-}+xR0d#rQ(S%OR*|(S^!nW!{#u&V&{'_)Rx$n!e#Z$|%S%[%`(f)Y)m*X*e+V+q+t,]-R-z-|/X/j[$t!n$n$u/S/n0SS$u!p+nQ/S-qQ/n.|R0S/qQ)O%|R+f)OQ)b&]S,O)b.^R.^,Y!l`O^av!Y#Q#X#w$V$W$X$Y$Z$h%]%j&]&d&g'T(i)b)q*V*_*f*k+x+z,W,Y,}.P.Q.^.r/ZY!fV!z%a&z-}T#V`!fQ-a*wR.{-aQ$x!rR'|$xQ%d#RS(a%d/RR/R-mQ+l)UR-p+lQ%^#OR(^%^Q,S)fR.X,SQ)q&gR,^)qQ,X)kR.],XQ(i%jR+W(iQ&o#}R)w&oQ%g#SR(e%gQ-Z*qR.x-ZQ*t'qR-_*tQ)|&rR,c)|Q,g*OR.c,gQ/b.dS/y/b/{R/{/dQ*_'TR,t*_Q'f$iS*i'f*nR*n'jQ.t-RR/k.tQ*g'dR-O*g`uOav#X+z.P.Q/ZQ$^!YQ&Z#wQ&x$VQ&y$WQ'P$YQ'Q$ZS*^'T*_R,m*V'YqOVW^_amnv!W!Y!]!_!e!l!p!u!w!z!{#Q#U#X#Z#b#d#e#i#j#k#l#m#n#o#r#s#t#u#w#}$U$V$W$X$Y$Z$h$u$v${$|%R%S%[%]%`%a%c%e%j&V&[&]&^&_&d&g&h&l&m&o&z&{&}'S'T'_'w(Q(R(b(f(i(})Q)R)T)Y)[)b)m)n)q)v*V*X*Z*[*_*b*e*f*k+V+i+k+n+q+t+u+x+z+},R,W,Y,],n,p,y,}-R-`-q-z-|-}.P.Q.^.j.m.p.r.|/S/X/Z/j/n/q0S0da'p$l'n*p-Y.y/p0Q0YQ!bSQ$Q!OQ$R!QQ$S!RQ$o!hQ$q!jQ&w$TQ't$pQ'}0aS,e*O*QQ,i*PQ,j*RQ.b,gS.d,i.fQ/d.gR/x/a%oROS^abmnv!O!Q!R!W!Y!]!_!h!j!{#X#[#a#b#c#d#e#i#j#k#l#m#n#o#s#w$P$T$U$V$W$X$Y$Z$h$k$l$p$v%S%e%t%z&l&u&}'S'T'n'w(b(f(z(})Q)v*O*P*Q*R*T*V*Z*[*_*b*f*p*s+V+c+z,g,i,n,p,y,}-Y-`-|.P.Q.f.g.j.m.p.r.y/X/Z/[/a/p/t0Q0Y0aQ'r$lQ*q'nS-X*p.yQ.w-YQ0R/pQ0W0QR0^0YrkOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZS!|^$UQ#pmQ#vnQ$[!WQ$d!]Q$g!_Q%x#bQ%{#dY%|#e$X*Z,p.mQ&O#iQ&P#jQ&Q#kQ&R#lQ&S#mQ&T#nQ&U#oQ&X#s^'m$l'n-Y.y/p0Q0YU'x$v'w-`Q(c%eQ)u&lQ*Y&}Q*]'SQ+Q(bQ+e(}Q+g)QQ,a)vQ,r*[Q,w*bQ-W*pQ.i,nQ.o,yQ/f.jR/i.p#reO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*p,n,p,y-Y-`.P.Q.j.m.p.y/Z/p0Q0YW'`$h*f,}.rR.R+zrWOav!Y#X#w$V$W$Y$Z'T*V*_+z.P.Q/ZW!eV#t${&zQ!{^Q#Zc!|#umn!W!]!_#b#d#e#i#j#k#l#m#n#o#s$U$l$v%e&l&}'S'n'w(b(})Q)v*Z*[*b*p,n,p,y-Y-`.j.m.p.y/p0Q0Yd$|!u%c&^&_&h(Q(R+i+},RQ%S!zQ%[!}S%`#Q%]Q&V#rQ&{$XW'_$h*f,}.rS(f%j(iQ)R0dW)Y&])b,Y.^S)m&g)qQ*X&|Q*e'cQ+V(gQ+q)ZS+t)[)nQ,])oS-R*k-TQ-z+uQ-|+xQ/X-}R/j.s%t]OV^acmnv!W!Y!]!_!u!z!}#Q#X#b#d#e#i#j#k#l#m#n#o#r#s#t#w$U$V$W$X$Y$Z$h$l$v${%]%c%e%j&]&^&_&g&h&l&z&|&}'S'T'c'n'w(Q(R(b(g(i(})Q)Z)[)b)n)o)q)v*V*Z*[*_*b*f*k*p+i+u+x+z+},R,Y,n,p,y,}-T-Y-`-}.P.Q.^.j.m.p.r.s.y/Z/p0Q0Y0dQ#}|Q&q$OR(y%u&PUOV^acmnv|!W!Y!]!_!u!w!z!}#Q#X#b#d#e#i#j#k#l#m#n#o#r#s#t#w$O$U$V$W$X$Y$Z$h$l$v${%R%]%c%e%j%u&]&^&_&g&h&l&z&|&}'S'T'c'n'w(Q(R(b(g(i(})Q)Z)[)b)n)o)q)v*V*Z*[*_*b*f*k*p+i+u+x+z+},R,Y,n,p,y,}-T-Y-`-}.P.Q.^.j.m.p.r.s.y/Z/p0Q0Y0dR%P!u#zhOamnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$h$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*f*p+z,n,p,y,}-Y-`.P.Q.j.m.p.r.y/Z/p0Q0YQ#R^Q%O!uQ&W#rQ(`%cQ)e&^U)f&_&h+}Q*z(QQ*{(RQ-m+iR.W,RQ(P$}R*y(O#|dO^amnv!W!Y!]!_#X#b#d#e#i#j#k#l#m#n#o#s#w$U$V$W$X$Y$Z$h$l$v%e&l&}'S'T'n'w(b(})Q)v*V*Z*[*_*b*f*p+z,n,p,y,}-Y-`.P.Q.j.m.p.r.y/Z/p0Q0YT%q#a/[Q%}#eQ'O$XQ,q*ZQ.k,pR/h.mX)a&])b,Y.^!{_OV^`av!Y!f!z#Q#X#w$V$W$X$Y$Z$h%]%a%j&]&d&g&z'T(i)b)q*V*_*f*k+x+z,W,Y,}-}.P.Q.^.r/ZU!sW!U&{U%l#Z#`*XS+T(f)mQ+o)YS-f+V,]R-t+qj!qW!U#Z#`$w%W([(f)Y)m+V+q,]U%V!{%`-|Q(Z%[Q*W&{Q*d'_Q,o*XQ,z*eQ.u-SR/m.vQ'z$vQ*w'wR.z-`R*x'w[)]&]&g)b)q,Y.^T+r)Z)oR)V&[W+p)Y)m+q,]Q-y+tR/W-zS#P^+xR%b#QS)g&_&hR.V+}R)l&dW)_&])b,Y.^R+s)ZR#T^R*r'nR'r$lT,f*O,gQ.e,iR/c.fR/c.g",nodeNames:" LineComment BlockComment Program ModuleDeclaration MarkerAnnotation Identifier ScopedIdentifier . Annotation ) ( AnnotationArgumentList AssignmentExpression FieldAccess IntegerLiteral FloatingPointLiteral BooleanLiteral CharacterLiteral StringLiteral null ClassLiteral void PrimitiveType TypeName ScopedTypeName GenericType TypeArguments AnnotatedType Wildcard extends super , ArrayType ] Dimension [ class this ParenthesizedExpression ObjectCreationExpression new ArgumentList } { ClassBody ; FieldDeclaration Modifiers public protected private abstract static final strictfp default synchronized native transient volatile VariableDeclarator Definition AssignOp ArrayInitializer MethodDeclaration TypeParameters TypeParameter TypeBound FormalParameters ReceiverParameter FormalParameter SpreadParameter Throws throws Block ClassDeclaration Superclass SuperInterfaces implements InterfaceTypeList InterfaceDeclaration interface ExtendsInterfaces InterfaceBody ConstantDeclaration EnumDeclaration enum EnumBody EnumConstant EnumBodyDeclarations AnnotationTypeDeclaration AnnotationTypeBody AnnotationTypeElementDeclaration StaticInitializer ConstructorDeclaration ConstructorBody ExplicitConstructorInvocation ArrayAccess MethodInvocation MethodName MethodReference ArrayCreationExpression Dimension AssignOp BinaryExpression CompareOp CompareOp LogicOp BitOp BitOp LogicOp ArithOp ArithOp ArithOp BitOp InstanceofExpression instanceof LambdaExpression InferredParameters TernaryExpression LogicOp : UpdateExpression UpdateOp UnaryExpression LogicOp BitOp CastExpression ElementValueArrayInitializer ElementValuePair open module ModuleBody ModuleDirective requires transitive exports to opens uses provides with PackageDeclaration package ImportDeclaration import Asterisk ExpressionStatement LabeledStatement Label IfStatement if else WhileStatement while ForStatement for ForSpec LocalVariableDeclaration var EnhancedForStatement ForSpec AssertStatement assert SwitchStatement switch SwitchBlock SwitchLabel case DoStatement do BreakStatement break ContinueStatement continue ReturnStatement return SynchronizedStatement ThrowStatement throw TryStatement try CatchClause catch CatchFormalParameter CatchType FinallyClause finally TryWithResourcesStatement ResourceSpecification Resource",maxTerm:269,nodeProps:[[xu.group,-26,4,46,75,76,81,86,91,143,145,148,149,151,154,156,159,161,163,165,170,172,174,176,178,179,181,189,"Statement",-24,6,13,14,15,16,17,18,19,20,21,38,39,40,98,99,101,102,105,116,118,120,123,125,128,"Expression",-7,22,23,24,25,26,28,33,"Type"],[xu.openedBy,10,"(",43,"{"],[xu.closedBy,11,")",44,"}"]],skippedNodes:[0,1,2],repeatNodeCount:27,tokenData:"7q~R{X^#xpq#xqr$mrs$ztu%ruv&Wvw&ewx&uxy(Pyz(Uz{(Z{|(e|}(u}!O(z!O!P)_!P!Q+j!Q!R,x!R![.n![!]3Z!]!^3h!^!_3m!_!`4Q!`!a4Y!a!b4p!b!c4w!c!}6W!}#O6l#P#Q6q#Q#R6v#R#S%r#T#o%r#o#p7O#p#q7T#q#r7g#r#s7l#y#z#x$f$g#x#BY#BZ#x$IS$I_#x$I|$JO#x$JT$JU#x$KV$KW#x&FU&FV#x~#}Y%u~X^#xpq#x#y#z#x$f$g#x#BY#BZ#x$IS$I_#x$I|$JO#x$JT$JU#x$KV$KW#x&FU&FV#xR$rP#rP!_!`$uQ$zO#^Q~$}UOY$zZr$zrs%as#O$z#O#P%f#P~$z~%fOc~~%iROY$zYZ$zZ~$z~%wT%{~tu%r!Q![%r!c!}%r#R#S%r#T#o%r~&]P#f~!_!`&`Q&eO#[Q~&jQ&g~vw&p!_!`&`~&uO#`~~&xTOY'XZw'Xx#O'X#O#P's#P~'X~'[UOY'XZw'Xwx'nx#O'X#O#P's#P~'X~'sOb~~'vROY'XYZ'XZ~'X~(UOZ~~(ZOY~R(bP$XP#eQ!_!`&`~(jQ#d~{|(p!_!`&`~(uO#p~~(zOp~~)PR#d~}!O(p!_!`&`!`!a)Y~)_O&q~~)dQWU!O!P)j!Q![)u~)mP!O!P)p~)uO&j~P)zW`P!Q![)u!f!g*d!g!h*i!h!i*d#R#S+d#W#X*d#X#Y*i#Y#Z*dP*iO`PP*lR{|*u}!O*u!Q![*{P*xP!Q![*{P+QU`P!Q![*{!f!g*d!h!i*d#R#S*u#W#X*d#Y#Z*dP+gP!Q![)u~+oR#eQz{+x!P!Q,m!_!`&`~+{ROz+xz{,U{~+x~,XTOz+xz{,U{!P+x!P!Q,h!Q~+x~,mOQ~~,rQP~OY,mZ~,m~,}a_~!O!P.S!Q![.n!d!e/q!f!g*d!g!h*i!h!i*d!n!o/f!q!r0`!z!{0w#R#S/k#U#V/q#W#X*d#X#Y*i#Y#Z*d#`#a/f#c#d0`#l#m0wP.XV`P!Q![)u!f!g*d!g!h*i!h!i*d#W#X*d#X#Y*i#Y#Z*d~.sZ_~!O!P.S!Q![.n!f!g*d!g!h*i!h!i*d!n!o/f#R#S/k#W#X*d#X#Y*i#Y#Z*d#`#a/f~/kO_~~/nP!Q![.n~/tQ!Q!R/z!R!S/z~0PT_~!Q!R/z!R!S/z!n!o/f#R#S/q#`#a/f~0cP!Q!Y0f~0kS_~!Q!Y0f!n!o/f#R#S0`#`#a/f~0zS!O!P1W!Q![1y!c!i1y#T#Z1yP1ZR!Q![1d!c!i1d#T#Z1dP1gU!Q![1d!c!i1d!r!s*i#R#S1W#T#Z1d#d#e*i~2OX_~!O!P2k!Q![1y!c!i1y!n!o/f!r!s*i#R#S2}#T#Z1y#`#a/f#d#e*iP2nT!Q![1d!c!i1d!r!s*i#T#Z1d#d#e*i~3QR!Q![1y!c!i1y#T#Z1y~3`P#n~![!]3c~3hO&o~~3mO!O~~3rQ&W~!^!_3x!_!`$u~3}P#g~!_!`&`~4VP!a~!_!`$u~4_Q&V~!_!`$u!`!a4e~4jQ#g~!_!`&`!`!a3xV4wO&ZT#mQ~4|P%y~#]#^5P~5SP#b#c5V~5YP#h#i5]~5`P#X#Y5c~5fP#f#g5i~5lP#Y#Z5o~5rP#T#U5u~5xP#V#W5{~6OP#X#Y6R~6WO&m~~6]T%}~tu6W!Q![6W!c!}6W#R#S6W#T#o6W~6qOt~~6vOr~Q6{P#bQ!_!`&`~7TO|~V7[Q&wT#bQ!_!`&`#p#q7bQ7gO#cQ~7lO{~~7qO#s~",tokenizers:[0,1,2],topRules:{Program:[0,3]},dynamicPrecedences:{26:1,228:-1,236:-1},specialized:[{term:227,get:e=>kv[e]||-1}],tokenPrec:7012}),Ev=Ju.define({parser:xv.configure({props:[mf.add({IfStatement:wf({except:/^\s*({|else\b)/}),TryStatement:wf({except:/^\s*({|catch|finally)\b/}),LabeledStatement:e=>e.baseIndent,SwitchBlock:e=>{let t=e.textAfter,i=/^\s*\}/.test(t),r=/^\s*(case|default)\b/.test(t);return e.baseIndent+(i?0:r?1:2)*e.unit},BlockComment:()=>-1,Statement:wf({except:/^{/})}),kf.add({"Block SwitchBlock ClassBody ElementValueArrayInitializer ModuleBody EnumBody ConstructorBody InterfaceBody ArrayInitializer":function(e){let t=e.firstChild,i=e.lastChild;return t&&t.to<i.from?{from:t.to,to:i.type.isError?e.to:i.from}:null},BlockComment:e=>({from:e.from+2,to:e.to-2})}),o_({null:D_.null,instanceof:D_.operatorKeyword,this:D_.self,"new super assert open to with void":D_.keyword,"class interface extends implements module package import enum":D_.definitionKeyword,"switch while for if else case default do break continue return try catch finally throw":D_.controlKeyword,"requires exports opens uses provides public private protected static transitive abstract final strictfp synchronized native transient volatile throws":D_.modifier,IntegerLiteral:D_.integer,FloatLiteral:D_.float,StringLiteral:D_.string,CharacterLiteral:D_.character,LineComment:D_.lineComment,BlockComment:D_.blockComment,BooleanLiteral:D_.bool,PrimitiveType:D_.standard(D_.typeName),TypeName:D_.typeName,Identifier:D_.variableName,"MethodName/Identifier":D_.function(D_.variableName),Definition:D_.definition(D_.variableName),ArithOp:D_.arithmeticOperator,LogicOp:D_.logicOperator,BitOp:D_.bitwiseOperator,CompareOp:D_.compareOperator,AssignOp:D_.definitionOperator,UpdateOp:D_.updateOperator,Asterisk:D_.punctuation,Label:D_.labelName,"( )":D_.paren,"[ ]":D_.squareBracket,"{ }":D_.brace,".":D_.derefOperator,", ;":D_.separator})]}),languageData:{commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\})$/}}),Av="#e06c75",Tv="#abb2bf",Pv="#7d8799",Lv="#d19a66",Rv="#2c313a",Mv="#282c34",Dv="#353a42",Bv="#528bff",Iv=[bh.theme({"&":{color:Tv,backgroundColor:Mv},".cm-content":{caretColor:Bv},"&.cm-focused .cm-cursor":{borderLeftColor:Bv},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:Tv},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:Rv},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{backgroundColor:Mv,color:Pv,border:"none"},".cm-activeLineGutter":{backgroundColor:Rv},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Dv},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Dv,borderBottomColor:Dv},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Rv,color:Tv}}},{dark:!0}),f_.define([{tag:D_.keyword,color:"#c678dd"},{tag:[D_.name,D_.deleted,D_.character,D_.propertyName,D_.macroName],color:Av},{tag:[D_.function(D_.variableName),D_.labelName],color:"#61afef"},{tag:[D_.color,D_.constant(D_.name),D_.standard(D_.name)],color:Lv},{tag:[D_.definition(D_.name),D_.separator],color:Tv},{tag:[D_.typeName,D_.className,D_.number,D_.changed,D_.annotation,D_.modifier,D_.self,D_.namespace],color:"#e5c07b"},{tag:[D_.operator,D_.operatorKeyword,D_.url,D_.escape,D_.regexp,D_.link,D_.special(D_.string)],color:"#56b6c2"},{tag:[D_.meta,D_.comment],color:Pv},{tag:D_.strong,fontWeight:"bold"},{tag:D_.emphasis,fontStyle:"italic"},{tag:D_.strikethrough,textDecoration:"line-through"},{tag:D_.link,color:Pv,textDecoration:"underline"},{tag:D_.heading,fontWeight:"bold",color:Av},{tag:[D_.atom,D_.bool,D_.special(D_.variableName)],color:Lv},{tag:[D_.processingInstruction,D_.string,D_.inserted],color:"#98c379"},{tag:D_.invalid,color:"#ffffff"}])];var Qv=i(320),$v=i(617),Hv=i(379),Wv=i.n(Hv),Nv=i(795),Fv=i.n(Nv),jv=i(569),Uv=i.n(jv),qv=i(565),Xv=i.n(qv),zv=i(216),Vv=i.n(zv),Yv=i(589),Gv=i.n(Yv),Zv=i(850),Kv={};function Jv(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)e[r]=i[r]}return e}Kv.styleTagTransform=Gv(),Kv.setAttributes=Xv(),Kv.insert=Uv().bind(null,"head"),Kv.domAPI=Fv(),Kv.insertStyleElement=Vv(),Wv()(Zv.Z,Kv),Zv.Z&&Zv.Z.locals&&Zv.Z.locals;var ey=function e(t,i){function r(e,r,n){if("undefined"!=typeof document){"number"==typeof(n=Jv({},i,n)).expires&&(n.expires=new Date(Date.now()+864e5*n.expires)),n.expires&&(n.expires=n.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var o in n)n[o]&&(s+="; "+o,!0!==n[o]&&(s+="="+n[o].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+s}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var i=document.cookie?document.cookie.split("; "):[],r={},n=0;n<i.length;n++){var s=i[n].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(r[a]=t.read(o,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",Jv({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Jv({},this.attributes,t))},withConverter:function(t){return e(Jv({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const ty=ey,iy=new vt,ry=new class extends l{constructor(e,t,{signaling:i=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:r=null,awareness:n=new Qc(t),maxConns:s=20+h(15*ye()),filterBcConns:o=!0,peerOpts:a={}}={}){super(),this.roomName=e,this.doc=t,this.filterBcConns=o,this.awareness=n,this.shouldConnect=!1,this.signalingUrls=i,this.signalingConns=[],this.maxConns=s,this.peerOpts=a,this.key=r?((e,t)=>{const i=b(e).buffer,r=b(t).buffer;return crypto.subtle.importKey("raw",i,"PBKDF2",!1,["deriveKey"]).then((e=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])))})(r,e):Se(null),this.room=null,this.key.then((i=>{this.room=((e,t,i,r)=>{if(Uc.has(i))throw Ce(`A Yjs Doc connected to room "${i}" already exists!`);const n=new Jc(e,t,i,r);return Uc.set(i,n),n})(t,this,e,i),this.shouldConnect?this.room.connect():this.room.disconnect()})),this.connect(),this.destroy=this.destroy.bind(this),t.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach((e=>{const t=r(jc,e,(()=>new tu(e)));this.signalingConns.push(t),t.providers.add(this)})),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach((e=>{e.providers.delete(this),0===e.providers.size&&(e.destroy(),jc.delete(e.url))})),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then((()=>{this.room.destroy(),Uc.delete(this.roomName)})),super.destroy()}}(window.location.pathname,iy),ny=iy.getText("codemirror"),sy="#"+Math.floor(16777215*Math.random()).toString(16);ty.get("name")||ty.set("name","User "+Math.floor(100*Math.random())),ry.awareness.setLocalStateField("user",{name:ty.get("name"),color:sy,colorLight:sy});const oy=document.getElementById("nameForum");oy.value=ty.get("name"),oy.onchange=()=>{ry.awareness.setLocalStateField("user",{name:oy.value}),ty.set("name",oy.value)};const ay=new bh({state:ys.create({doc:ny.toString(),extensions:[Lh.of(xc),((e,t,{undoManager:i=new vi(e)}={})=>{const r=[dc.of(new fc(e,t)),gc];return t&&r.push(mc,yc),!1!==i&&(i.trackedOrigins.add(fc),r.push(wc.of(new Oc(i)),Sc,bh.domEventHandlers({beforeinput:(e,t)=>"historyUndo"===e.inputType?Cc(t):"historyRedo"===e.inputType&&kc(t)}))),r})(ny,ry.awareness),tv,Lh.of(Ap),new class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}(Ev),Iv,bh.theme({"&":{height:"100%"},".cm-scroller":{overflow:"auto",scrollbarWidth:"thin"},".cm-scroller::-webkit-scrollbar":{width:"10px"},".cm-scroller::-webkit-scrollbar-track":{opacity:"0"},".cm-scroller::-webkit-scrollbar-thumb":{minHeight:"20px",backgroundColor:"#ffffff20"}})]}),parent:document.getElementById("editor")}),ly=new Qv.Terminal({fontFamily:'"Cascadia Code", Menlo, monospace',theme:{selection:"#44475A",background:"#282A36",foreground:"#F8F8F2",black:"#21222C",blue:"#BD93F9",cyan:"#8BE9FD",green:"#50FA7B",magenta:"#FF79C6",red:"#FF5555",white:"#F8F8F2",yellow:"#F1FA8C",brightBlack:"#6272A4",brightBlue:"#D6ACFF",brightCyan:"#A4FFFF",brightGreen:"#69FF94",brightMagenta:"#FF92DF",brightRed:"#FF6E6E",brightWhite:"#FFFFFF",brightYellow:"#FFFFA5"},cursorBlink:!0}),hy=new $v.FitAddon;ly.loadAddon(hy),ly.open(document.getElementById("terminal")),hy.fit(),ly.writeln(["","    Basicly Client Side (BCS) is a java IDE that attempts to combine the","    power of a full fledged a editor with the ease of use of the browser","","  [1mFeatures[0m ","                                                                             ","   [31;1mCollaboration just works                [32mPerformance[0m                       ","   have collaborators join                 xterm.js, codemirror 6, yjs, and  ","   alicalik1.github.io/editorv3/text       doppioJVM maximize performance    ","                                                                             ","   [33;1mAccessible                              [34mEasy to learn[0m                     ","   Works on any browser                    Anyone can quickly learn BSC      ","                                                                             "," ","",'    Just a note: "loading..." means loading an entire JVM',"    and javascript JVM emulator which can take a while."].join("\n\r"));const cy=new Worker(new URL(i.p+i.u(357),i.b)),uy=document.getElementById("loadButton");cy.onmessage=e=>{switch(e.data[0]){case"changeButton":uy.id=e.data[1];break;case"out":ly.write(e.data[1].replace("\n","\n\r"));break;default:console.log("default in main from: "+e.data)}};var fy="";ly.onData((e=>{for(let t in e)switch(e[t]){case/\r/g:case"\r":ly.write("\n\r"),"runningButton"===uy.id&&cy.postMessage(["in",fy]),fy="";break;case"":fy.length>0&&(ly.write("\b \b"),fy=fy.slice(0,-1));break;default:ly.write(e[t]),fy+=e[t]}})),ly.attachCustomKeyEventHandler((e=>("v"!==e.key||!e.ctrlKey)&&("c"===e.key&&e.ctrlKey?(navigator.clipboard.writeText(ly.getSelection()),!1):void 0))),uy.onclick=()=>{"runButton"==uy.id&&""!=ay.state.doc.toString()&&(uy.id="compilingButton",ly.reset(),fy="",cy.postMessage(["compileAndRun",ay.state.doc.toString()]))}})()})();